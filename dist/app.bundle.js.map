{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/ui/css/snapdragon-media.css","webpack:///./src/ui/css/snapdragon.css","webpack:///./src/ui/css/species-list.css","webpack:///./src/api/traits/traits-for-tests.js","webpack:///./src/img/powered_by_google_on_white_hdpi.png","webpack:///./src/index.js","webpack:///./src/redux/observe-store.js","webpack:///./src/redux/subscriptions.js","webpack:///./src/snapdragon-config/lesson-plans.js","webpack:///./src/snapdragon-config/plans/landscape/landscape-custom.js","webpack:///./src/snapdragon-config/plans/landscape/landscape-fungi.js","webpack:///./src/snapdragon-config/plans/landscape/landscape-static.js","webpack:///./src/snapdragon-config/plans/portrait/portrait-static.js","webpack:///./src/snapdragon-config/screen-layouts.js","webpack:///./src/snapdragon-config/screen-panels.js","webpack:///./src/snapdragon-config/snapdragon-iconic-taxa.js","webpack:///./src/snapdragon-engine/bonus/bonus-test-handler.js","webpack:///./src/snapdragon-engine/bonus/tests/birdsong-test.js","webpack:///./src/snapdragon-engine/bonus/tests/definition-test.js","webpack:///./src/snapdragon-engine/bonus/tests/lookalike-test.js","webpack:///./src/snapdragon-engine/bonus/tests/trait-test.js","webpack:///./src/snapdragon-engine/lesson-plan-handler.js","webpack:///./src/snapdragon-engine/lesson-planner.js","webpack:///./src/snapdragon-engine/pool-handler.js","webpack:///./src/snapdragon-engine/provider/provider-test-handler.js","webpack:///./src/snapdragon-engine/round-plan-handler.js","webpack:///./src/snapdragon-engine/round-planner.js","webpack:///./src/ui/create-guide-modal/categories-template.html","webpack:///./src/ui/create-guide-modal/categories.js","webpack:///./src/ui/create-guide-modal/common/actions-template.html","webpack:///./src/ui/create-guide-modal/common/save-guide.js","webpack:///./src/ui/create-guide-modal/common/snapdragon-switch.js","webpack:///./src/ui/create-guide-modal/create-guide.js","webpack:///./src/ui/create-guide-modal/inat-user-template.html","webpack:///./src/ui/create-guide-modal/inat-user.js","webpack:///./src/ui/create-guide-modal/location-template.html","webpack:///./src/ui/create-guide-modal/location.js","webpack:///./src/ui/create-guide-modal/species-search-options-template.html","webpack:///./src/ui/create-guide-modal/species-search-options.js","webpack:///./src/ui/create-guide-modal/species-search-template.html","webpack:///./src/ui/create-guide-modal/species-search.js","webpack:///./src/ui/create-guide-modal/species-summary-template.html","webpack:///./src/ui/css/snapdragon-media.css?6f1e","webpack:///./src/ui/css/snapdragon.css?662e","webpack:///./src/ui/css/species-list.css?1eb5","webpack:///./src/ui/fixtures/glossary-template.html","webpack:///./src/ui/fixtures/headers.js","webpack:///./src/ui/fixtures/language-template.html","webpack:///./src/ui/fixtures/language.js","webpack:///./src/ui/fixtures/login-template.html","webpack:///./src/ui/fixtures/login.js","webpack:///./src/ui/fixtures/logout-template.html","webpack:///./src/ui/fixtures/navigation-left-template.html","webpack:///./src/ui/fixtures/navigation-portrait-template.html","webpack:///./src/ui/fixtures/navigation-right-template.html","webpack:///./src/ui/fixtures/navigation.js","webpack:///./src/ui/fixtures/score-template.html","webpack:///./src/ui/fixtures/score.js","webpack:///./src/ui/fixtures/settings-template.html","webpack:///./src/ui/fixtures/settings.js","webpack:///./src/ui/helpers/class-behaviour.js","webpack:///./src/ui/helpers/cookie-handler.js","webpack:///./src/ui/helpers/function-lookups.js","webpack:///./src/ui/helpers/inat-autocomplete.js","webpack:///./src/ui/helpers/location-helper.js","webpack:///./src/ui/helpers/score-handler.js","webpack:///./src/ui/helpers/test-handler.js","webpack:///./src/ui/quick-fire-modal/quick-fire-api.js","webpack:///./src/ui/quick-fire-modal/quick-fire-filters-template.html","webpack:///./src/ui/quick-fire-modal/quick-fire-logic.js","webpack:///./src/ui/quick-fire-modal/quick-fire-questions-template.html","webpack:///./src/ui/quick-fire-modal/quick-fire-summary-template.html","webpack:///./src/ui/quick-fire-modal/quick-fire-ui.js","webpack:///./src/ui/quick-fire-modal/quick-fire.js","webpack:///./src/ui/screens/bonus/bonus-specimen-tiles.js","webpack:///./src/ui/screens/bonus/bonus-test.js","webpack:///./src/ui/screens/cards/cultivar-card-template.html","webpack:///./src/ui/screens/cards/cultivar-card.js","webpack:///./src/ui/screens/cards/non-taxon-card-specimen-tiles.js","webpack:///./src/ui/screens/cards/test-card-modal-handler.js","webpack:///./src/ui/screens/cards/test-card-template.html","webpack:///./src/ui/screens/cards/test-card.js","webpack:///./src/ui/screens/common/language-selection-template.html","webpack:///./src/ui/screens/common/language-selection.js","webpack:///./src/ui/screens/home/home-lesson-intro-text-template.html","webpack:///./src/ui/screens/home/home-lesson-intro-text.js","webpack:///./src/ui/screens/home/home-lesson-intro.js","webpack:///./src/ui/screens/home/home-template.html","webpack:///./src/ui/screens/home/home.js","webpack:///./src/ui/screens/landscape/specimen-tiles-template.html","webpack:///./src/ui/screens/landscape/specimen-tiles.js","webpack:///./src/ui/screens/lists/lesson-custom.js","webpack:///./src/ui/screens/lists/lesson-edit-template.html","webpack:///./src/ui/screens/lists/lesson-edit.js","webpack:///./src/ui/screens/lists/lesson-list-event-handler.js","webpack:///./src/ui/screens/lists/lesson-list-header-template.html","webpack:///./src/ui/screens/lists/lesson-list-header.js","webpack:///./src/ui/screens/lists/lesson-list-scroll-handler.js","webpack:///./src/ui/screens/lists/lesson-list-template.html","webpack:///./src/ui/screens/lists/lesson-list.js","webpack:///./src/ui/screens/lists/lesson-template.html","webpack:///./src/ui/screens/lists/lesson.js","webpack:///./src/ui/screens/media/landscape/media-players.js","webpack:///./src/ui/screens/multichoice/horizontal-strips.html","webpack:///./src/ui/screens/multichoice/horizontal-strips.js","webpack:///./src/ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images-template.html","webpack:///./src/ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images.js","webpack:///./src/ui/screens/multichoice/landscape/mixed-specimen/right/mixed-specimen-question-template.html","webpack:///./src/ui/screens/multichoice/landscape/mixed-specimen/right/mixed-specimen-question.js","webpack:///./src/ui/screens/multichoice/landscape/mixed-trait/left/mixed-trait-images-template.html","webpack:///./src/ui/screens/multichoice/landscape/mixed-trait/left/mixed-trait-images.js","webpack:///./src/ui/screens/multichoice/landscape/mixed-trait/mixed-trait-handler.js","webpack:///./src/ui/screens/multichoice/landscape/mixed-trait/right/mixed-trait-question-template.html","webpack:///./src/ui/screens/multichoice/landscape/mixed-trait/right/mixed-trait-question.js","webpack:///./src/ui/screens/multichoice/multi-strips-template.html","webpack:///./src/ui/screens/multichoice/multi-strips-with-images.html","webpack:///./src/ui/screens/multichoice/multi-strips.js","webpack:///./src/ui/screens/multichoice/portrait/mixed-specimen/mixed-specimen-combined-template.html","webpack:///./src/ui/screens/multichoice/portrait/mixed-specimen/mixed-specimen-combined.js","webpack:///./src/ui/screens/progress/history.js","webpack:///./src/ui/screens/progress/score-summary-handler.js","webpack:///./src/ui/screens/progress/score-summary-no-row-template.html","webpack:///./src/ui/screens/progress/score-summary-row-template.html","webpack:///./src/ui/screens/progress/score-summary-template.html","webpack:///./src/ui/screens/progress/score-summary.js","webpack:///./src/ui/screens/progress/summary.js","webpack:///./src/ui/screens/text-entry/species-text-entry.js","webpack:///./src/ui/screens/text-entry/text-complete-template.html","webpack:///./src/ui/screens/text-entry/text-complete.js","webpack:///./src/ui/screens/text-entry/text-entry-portrait-templates.html","webpack:///./src/ui/screens/text-entry/text-entry-templates.html","webpack:///./src/ui/screens/text-entry/text-entry.js","webpack:///./src/ui/setup/next-item.js","webpack:///./src/ui/setup/next-layout.js","webpack:///./src/ui/setup/next-lesson.js","webpack:///./src/ui/setup/setup-handler.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","getDefault","getModuleExports","object","property","p","jsonpArray","window","oldJsonpFunction","slice","___CSS_LOADER_API_IMPORT___","getTraitsForTests","enums","item","alreadyTestedTraits","undefined","traits","keys","constructor","excludedTraits","traitsHandler","getTraitsToExclude","filter","et","trait","getRandomTrait","unit","getTraitsPoolForUnits","role","getTraitsPoolForRoles","getTraitsPool","traitsPool","help","question","join","map","utils","capitaliseFirst","answers","getSetOfTraitAnswers","overrides","typedItemTraits","onLoadHandler","setTimeout","handleWindowResize","cookieHandler","hasUserBeenAwayTooLong","persistor","purge","location","reload","setLastVisitedCookie","Date","firebase","auth","store","getState","config","currentCounter","counter","statePlans","lessonPlan","collections","isPortraitMode","matchMedia","matches","isLandscapeMode","index","isLessonPaused","actions","boundUpdateConfig","boundStopStartLesson","firestore","getCollections","cloudCollections","boundUpdateCollections","subscription","add","renderHeaders","renderNavigation","renderLoginChanges","renderLoggedIn","renderHome","nextItem","nextLesson","nextLayout","renderScore","traitValuesHandler","updateConfig","initialiseConfig","initialisedConfig","guide","locationType","getDefinitionsByTaxa","glossary","sortAlphabeticallyBy","boundCreateGlossary","loadModalHTML","lessonModalHandler","onCloseModal","console","log","observeStore","select","onChange","domain","layout","currentState","hasStateSignificantlyChanged","handleChange","nextState","is","areEqual","calledBy","unsubscribe","subscribe","subscriptions","remove","sub","getByName","find","getByRole","removeByName","getAll","removeSubs","forEach","addSubs","screens","screen","func","funcByName","isSubscriptionRequired","checkRequired","state","userAction","isReviewingLesson","lessonStateHelper","getIsReviewingLesson","R","landscapeBirds","landscapeStatic","id","levels","bonusLayouts","types","portraitBirds","portraitStatic","layouts","L","mediaMatch","portraitFungi","landscapeFungi","portrait","traitPropertyMatch","portraitLichens","landscapeLichens","portraitCustom","landscapeCustom","portraitCustom2","landscapeCustom2","lessonPlans","landscapeStaticTaxonGroup","landscapeStaticProviderQuestionsOnly","portraitStaticTaxonGroup","default","mixedSpecimenImages","latinToCommonMatch","commonEntry","commonToLatinMatch","textCompleteGenus","genusEntry","textCompleteSpecies","speciesEntry","speciesGenusEntry","familyMatch","familyStripsMatch","propertyTrait","mixedTraitImages","description","speciesIdentificationMatch","specimenImages","panels","speciesCard","vernaculars","scientifics","text","leaf","leafName","family","familyStrips","taxon","nonTaxon","textComplete","cultivar","cultivarCard","epithets","definitions","specimenCommonMatch","specimenLatinMatch","definitionCard","traitProperty","symbioticProperty","lookalikeProperty","traitImages","nonTaxonSpecimenTiles","mixedSpecimenQuestions","mixedSpecimensLeft","mixedSpecimensRight","history","summary","birdsong","mixedTraitLeft","mediaPlayers","mixedTraitRight","providerHorizontalStripQuestions","speciesIdentification","mixedSpeciesMatch","type","score","kind","points","given","requirement","speciesRevision","taxonRevision","nonTaxonRevision","definitionRevision","multiSpecimenCommonMatch","multiSpecimenLatinMatch","bonus","lookalikePropertyMatch","symbioticPropertyMatch","cultivarMatch","leafEntry","latinEpithets","glossaryTerms","cultivars","providerHorizontalStrip","iconicTaxa","all","common","bonusHandler","getTests","collection","itemIndices","lessonName","levelName","itemsInThisRound","items","itemIndex","addLayoutToTest","traitTests","traitTest","getTraitTypeTests","Promise","resolve","getTraitTests","getTraitTypeBirdsongTests","getBirdsongTests","getTraitTypeLookalikeTests","getLookalikeTests","getDefinitionTypeTests","getDefinitionTests","getResolvedPromises","promises","testGroups","tests","group","g","taxonomy","toLowerCase","getBirdsongTest","birds","bird","birdNames","shuffleArray","vernacularName","binomial","getDefinitionTest","number","matchTaxon","definition","term","terms","genus","alternatives","init","getLookalikeTest","getItemLookalikes","lookaliketraits","lookalikes","lookalike","getLookalikes","getSpeciesByName","getNextRoundLayouts","lesson","activeLevelCount","level","levelId","isLevelComplete","goToNextLevelThatHasLayouts","iterateOverLevelsCheckingForAvailableLayouts","intialValue","increment","getLayouts","currentLevel","reviewLayouts","getCurrentLevelFromLessonPlan","lessonPlanner","createLessonPlan","moduleSize","currentRound","rounds","Math","floor","nextRoundLayoutTemplates","createNextRound","getPoolItems","poolSize","behaviour","otherItems","getItemsFromCollection","findRankByIconicTaxon","iconicTaxon","getSpeciesByIconicTaxon","taxonicMatches","isLichen","lichen","speciesPool","ci","isException","logError","getItemLayouts","itemQuestions","questionIds","getQuestionById","providerHandler","roundItemNames","species","sp","speciesQuestions","questions","sq","itemsQuestions","roundHandler","getRoundItems","start","end","progressScreens","itemsCountToDate","itemsLeft","layoutsToAdd","mixedTraitHandler","getMatchingTrait","requiredTraitValues","fetchTraits","requiredTraits","traitsToIgnore","speciesName","providerQuestions","providerLayouts","provider","lessonLayouts","calcItemIndex","Set","bonusTests","roundProgressIndex","parent","DOM","rightBody","layoutIndex","scores","roundScoreCount","reduce","accumulator","currentValue","questionCount","layoutCount","layoutNames","updatedLessonPlan","updatedCollection","updatedLesson","renderCategories","modal","createGuide","getConfig","template","document","createElement","innerHTML","categoriesTemplate","querySelector","renderTemplate","content","icons","querySelectorAll","icon","filterId","parentElement","classList","fungiIcon","elem","hasClass","hasChanged","category","addEventListener","event","currentTarget","commonName","innerText","setConfig","saveStep","saveGuide","step","chosen","handleSaveEvent","locationPlace","locationLongLat","returnTaxonIcon","inatId","switchHandler","idSwitch","startingPosition","callback","position","switchControl","leftText","rightText","switcher","CreateGuide","this","listeners","steps","title","nextStep","disabled","className","nextSteps","guideOption","LOCATION","INAT","PICKER","prevStep","currentStep","getElementById","modalTitle","navigationContainer","progressSteps","previousStepActionArrow","previousStepActionTxt","optionsTxt","nextStepActionArrow","nextStepActionTxt","ps","getCurrentStep","setCurrentStep","user","actionsTemplate","options","renderSpeciesSearchOptions","option","renderLocation","renderInatUser","renderSpeciesPicker","container","speciesSearch","direction","next","startLesson","addStepActions","dataset","previousStepProperties","stepDescription","createGuideHandler","goToNextStep","handleNextStepAction","parseInt","setAttribute","removeAttribute","element","handler","handlePreviousStepAction","callOnCreateCustomListeners","onCloseModalListeners","listener","pop","onCreateCustomLesson","inatTemplate","autocompleteRef","param","byType","inatIdentityInput","focus","handlerInatIdentityInput","e","removeEventListener","inatAutocomplete","preventDefault","keyCode","saveInatId","switchCallback","input","isLandsapeMode","locationTemplate","season","observableMonths","months","month","defaultNoOfRecords","noOfRecords","setLocationLongLatBtn","stopPropagation","getPlace","place","longLocation","handleSetLocationLongLat","locationPlaceInput","placeholder","handleLocationPlaceInput","saveLocation","range","speciesRange","rangeTxt","updateSlider","target","destroy","currentType","selectedText","selectedId","GooglePlaceDetails","geocoderResult","lat","geometry","long","lng","coordinates","speciesTemplate","nextStepName","languagePicker","warning","spinnerTemplate","feedback","count","interval","setInterval","viewGuideIcon","viewTaxaIcon","renderLessonSummary","clearTimeout","speciesSummaryTemplate","taxa","lessonStateHandler","changeRequest","requestType","lessonState","ADD_SPECIES_TO_COLLECTION","requestArgs","updatedConfig","clearGuide","editSpecies","selectedSpeciesDisplay","speciesInGuideEditor","editableCollectionName","UPDATE_COLLECTION","initLesson","collectionToLoad","GET_LESSON_PROGRESS","updatedCounter","isPrivate","OrdinalSuffixOf","k","request","page","numberOfRequests","listenToInatRequests","guideType","language","addingExtraSpecies","every","val","includes","hasVideo","video","initPicker","transform","locals","leftHeaderTxt","rightHeaderTxt","progressBar","max","renderLanguagePicker","languageTemplate","renderLogin","logoutTemplate","email","footer","logOut","signOut","then","boundUpdateUser","click","loginTemplate","password","logIn","signInWithEmailAndPassword","credentials","error","notLoggedIn","message","loggedIn","loggedOut","onLoseFocusListeners","onAddLoseFocusListener","navigationPortraitTemplate","navigationLeftTemplate","navigationRightTemplate","navIcons","clickedIcon","toggleIconOnOff","navigation","enumValueOf","LANDSCAPE_HOME","SETTINGS","PORTRAIT_HOME","GLOSSARY","EMAIL","LOGIN","LANGUAGE","settingsHandler","activeInfoIcon","PAUSE_LESSON","renderLessons","rightHeaderScoreTxt","quickFireHandlers","onLoadState","isLessonRehydrated","returningUser","isFirstTimeVisitor","total","boundUpdateHistory","settingsTemplate","delay","callbackTime","languages","clearCacheBtn","setDelayBtn","setDelayInput","delayTxt","removeFirstTimeVisitorCookie","classArray","show","hide","toggle","removeClass","cookie","SECURE","setFirstTimeVisitorCookie","isFirstVisit","indexOf","readCookie","date","setLastVisited","lastVisited","timeDiff","abs","beenGoneTooLong","ceil","nameEQ","ca","split","charAt","substring","cookieToAdd","replace","functions","renderMixedSpecimenImagesAndQuestion","renderNonTaxonCardSpecimenTiles","renderTextEntry","renderCard","renderMultiStrips","renderSummary","renderHistory","renderBonusTest","renderTaxonCard","renderNonTaxonCard","renderCompleteText","renderCultivarCard","renderBonusSpecimenTiles","renderMixedSpecimenQuestion","renderMediaPlayers","renderMixedTraitQuestion","renderHorizontalStrips","match","rb","getAutocompleteBy","users","results","label","login_autocomplete","photo","projects","autocomplete","fetch","update","getUserSuggestions","getPlaceSuggestions","predictions","prediction","place_id","GoogleAutocomplete","getProjectSuggestions","onSelect","minLength","debounceWaitMs","originalConfig","clone","getObservableMonths","getIPLocation","ipLocation","city","country_name","latitude","longitude","scoreHandler","test","genericScoreHandler","blockScoreHander","stripScoreHandler","imageScoreHandler","simpleScoreHandler","renderScoreHTMLResponse","response","success","correct","answer","incorrect","showResponseToAnswerHandler","questionText","continueLessonHandler","btn","timer","style","cursor","bindScore","markTest","callbackDelay","scoreUpdateTimer","_score","itemId","names","handleClickEvent","answerNode","trim","answerIndex","vernacular","answeredIndex","colour","strip","stripAnswer","stripAnswerIndex","stripAnswerName","_callback","selected","once","tile","img","parentNode","opacity","collectionId","boundUpdateScore","cleanText","isAnswerEqualToQuestion","eqValues","isTraitAnswerCorrect","doArraysHaveSameValues","isAnswerCorrect","isCorrect","alternativeIsCorrect","alternativeAccepted","quickFireAPI","getItems","includeTechnicalTerms","technical","getBranches","branches","branch","getQuickFire","quickFire","isComplete","termScore","isIncorrect","passes","fails","onClickFiltersLinkListeners","onClickGlossaryLinkListeners","lessonId","boundCreateQuickFire","quickFireLogic","selectAnswers","quickFireItems","spareItems","itemCount","renderResponse","updateBranchCounts","branchOptions","branchBadge","updateTaxonCounters","taxonCounters","taxonBadge","quickFireUI","updateTotalCounts","counters","branchCounters","updateHeaders","links","quickFireActions","filters","loadGlossary","quickFireGlossary","linkFromLesson","loadFilters","quickFireFilters","handleGlossaryLink","handleFiltersLink","quickFireStep","FILTERS","QUESTIONS","scoreMultipleChoice","quickFireMessage","scoreTextEntry","quickFireInput","continueQuickFireBtn","brackets","acceptableAnswers","acceptable","readyTemplate","headerTemplate","headers","args","templateCreateQuickFire","resetQuickFire","boundUpdateQuickFire","quickFireType","DEFINITION","updateArray","arr","getFilterTaxa","chkBox","selectedTaxon","updatedTaxa","getIncludeTechnicalTerms","createQuickFireBtn","quickFireOptions","checkedBranches","Array","from","b","checked","templateQuestionQuickFire","answered","quickFireInputContainer","quickFireQuestions","check","review","getTermsGlossary","def","glossaryTemplate","iconicTaxaKeys","templateSummaryQuickFire","pass","wiki","showWikiClass","fail","tab","summaryText","scoreSummary","continueReview","quickFireRevision","bonusLayout","lookalikesCount","renderSpecimenTiles","subspecies","locale","variety","form","eol","eolAlt","wikiAlt","cultivarTemplate","context","rank","a","display","subscribeToNonTaxaSelection","images","specimensTemplate","leftBody","modalImagesHandler","renderTestCardTemplate","testCardTemplate","headerClassName","statement","providerQuestion","progressLink","summaryContainer","renderSummaryCard","renderScoreSummary","toggleScreens","screenOne","screenTwo","hideCurrentCard","testCardContainer","toggleStatementAndQuestion","testCard","testCardIcon","card","showNextCard","selector","speciesContainer","taxonContainer","renderSpeciesCard","keyTrait","starred","url","taxonCard","renderIcon","clearInterval","languageSelectionTemplate","taxonLanguageBtn","lang","taxonLanguageTxt","textSetup","speciesCount","getSpeciesCount","textIntroTemplate","speciesSummary","getSpeciesSummary","lessonIntro","intro","handleSpeciesUpdate","itemNames","renderLessonIntro","videoPlayer","videoSetup","forceIntroDisplay","renderItemSpecimenTiles","prevItemIndex","collectionItems","allItems","getImagesFromItemFamily","imageUseCases","SPECIES_CARD","image","itemName","prepImagesForCarousel","itemCommon","scaleImage","VISUAL_MATCH","renderSpecimenImageTiles","acceptableScreens","snapLog","medium","useCase","itemImages","pool","pooledImage","uniqueImages","familyImages","imageToPrep","getUniqueImage","uniqueImage","prepImageForCarousel","renderCustomLesson","lessons","savedLessons","lessonTemplate","lessonListEventHandler","onLoadLessonViewState","hideVideoClass","hideTextIntroClass","onLessonTitleClickHandler","reviewLink","onReviewClickHandler","chevron","onLessonIconClickHandler","youtubeLessonIcon","scrollTo","left","top","behavior","renderEditLesson","lessonEditTemplate","showVideoIconClass","videoState","videoHandler","setVideoState","reviewState","hasTermsClass","isArray","isCollectionEditableClass","onClickViewState","isYoutubeIcon","isChevronIcon","row","speciesList","action","userEvent","START_LESSON","TOGGLE_SPECIES_LIST","DEFAULT","recordUserAction","hideOtherContentAndRevertChevrons","isSpeciesListAvailable","isSpeciesListHidden","lessonVideoState","iconIsChevron","lessonIsYoutubeIcon","requiresSpeciesList","revealSpeciesList","hideSpeciesList","selectedLessonId","chevronLessonId","loadAndDisplaySpeciesList","children","child","RENDER_SPECIES_LIST","lessonListScrollHandler","scrollToTitle","onLoadLessonsViewState","isItemActive","isActive","siblingChevron","START_LESSON_REVIEW","BEGIN_OR_RESUME_LESSON","renderLessonListHeader","header","lessonListHeaderTemplate","sibling","insertBefore","parseFloat","getComputedStyle","documentElement","getPropertyValue","siblingsBefore","siblings","before","scroll","scrollTop","lessonListTemplate","sort","tsa","seconds","renderLesson","youtubeLessonIcons","youtube","highlightActiveLesson","chevrons","reviews","termsReviewLink","savedLesson","saved","isPaused","renderReview","stripTemplate","strips","clue","findIndex","listenersToImageSelection","listenersToUserAnswer","listenToUserAnswer","listenToImageSelection","renderMixedSpecimenImages","noOfImagesPerItem","preselectedItems","randomSelection","imagesPerItem","renderSpecimenImages","mixedItems","imageIndex","MIXED_SPECIMENS","flat","imageTiles","selectedImage","selectedName","selectedItem","small","questionItem","answerItem","matchIcon","itemProperties","getVernacularName","answerVernacularName","renderMixedTraitImages","imagesTemplate","traitTiles","src","onClickTileHandler","onTraitsReadyListeners","onTraitClickedListeners","pendingScore","continueLessonBtn","layoutTraits","traitValues","obj","toCamelCase","v","entries","required","getTraitDefinitions","alt","multiples","getNMultiplesFromArray","multiple","onTraitsReady","onTraitClicked","tiles","questionTemplate","fromCamelCase","overrideLesson","defaultLanguage","render","helpDefault","stripWithImageTemplate","italicise","buildQuestion","renderBinomialQuestions","renderVernacularQuestions","quickId","renderIdQuestions","random","getRandomInt","getFamiliesByIconicTaxon","families","alternativeFamilies","f","epithet","latin","en","toUpperCase","indices","otherFamilies","otherFamiliesLatinNames","otherFamiliesCommonNames","of","audioMediaTemplate","xcID","getBirdsong","mp3","renderBirdsong","getPortraitImages","flatten","srcs","islandscapeMode","mixedSpecimenTemplate","imageSlider","identifier","boundScore","wrongItem","getLessonScores","stateScore","savedScore","historyIsUpToDate","isNextRound","scoreSummaryHandler","getSummaryRows","rows","getAnswer","isObj","hasImage","isTrue","parseToLowerCase","isWrongAnswer","summaryTemplate","actionLinks","link","layoutName","reverse","renderScoreSummaryRow","handleContinueLesson","NEXT_ROUND","handleNewLesson","purgeLesson","isLessonComplete","actionLink","summaryRowTemplate","summaryNoRowTemplate","noQuestionsText","el","q","renderInput","givenTaxon","questionTxt","completeTemplate","numerOfItems","itemTaxons","onlyUnique","itemTaxon","iconColour","answerIcon","block","textEntryTemplate","textEntryPortraitTemplate","inputTxt","helpTxt","answerBtn","scoreEventHandler","vernacularNames","renderPortrait","renderLandscape","TEXT_ENTRY","letterBlocks","letter","letters","deleteLetter","activeBlocks","activeLetters","activeBlock","lastLetter","indexInInput","lastIndexOf","newValue","correctBlocks","letterIndex","blocks","contains","keyboardBtn","hasAttribute","selectedBlock","blockArray","entry","setupHandler","isRequired","NEXT_ITEM","actionUpdate","NEXT_LAYOUT","NEXT_LESSON","planId","lessonPlanPortrait","lessonPlanLandscape","plan","asyncFunc","props","boundNextItem","boundNextLayout","SAVE_LESSON_PROGRESS","boundNextLesson"],"mappings":";aACE,SAASA,qBAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAKlC,IAFGe,GAAqBA,EAAoBhB,GAEtCO,EAASC,QACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,uBAER,SAASA,uBAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,oBAAoBA,oBAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,oBAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,qBAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,oBAAoBM,EAAIlB,EAGxBY,oBAAoBO,EAAIL,EAGxBF,oBAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,oBAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,oBAAoBe,EAAI,SAASZ,GACX,oBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,oBAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,oBAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,iBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,oBAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,oBAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,oBAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,SAASM,aAAe,OAAOvB,EAAgB,SAC/C,SAASwB,mBAAqB,OAAOxB,GAEtC,OADAJ,oBAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,oBAAoBW,EAAI,SAASkB,EAAQC,GAAY,OAAOhD,OAAOC,UAAUC,eAAeC,KAAK4C,EAAQC,IAGzG9B,oBAAoB+B,EAAI,GAExB,IAAIC,EAAaC,OAAqB,aAAIA,OAAqB,cAAK,GAChEC,EAAmBF,EAAW7C,KAAKsC,KAAKO,GAC5CA,EAAW7C,KAAOf,qBAClB4D,EAAaA,EAAWG,QACxB,IAAI,IAAIxD,EAAI,EAAGA,EAAIqD,EAAWnD,OAAQF,IAAKP,qBAAqB4D,EAAWrD,IAC3E,IAAIU,EAAsB6C,EAI1B3C,EAAgBJ,KAAK,CAAC,iBAAiB,yBAAyB,wBAAwB,oBAAoB,cAAc,uBAAuB,cAE1IM,uB,6FCrJTU,EADkC,EAAQ,gDAChCiC,EAA4B,IAE9BjD,KAAK,CAACiB,EAAOzB,EAAI,8pgBAAyqgB,KAElsgByB,EAAOD,QAAUA,G,qFCJjBA,EADkC,EAAQ,gDAChCiC,EAA4B,IAE9BjD,KAAK,CAACiB,EAAOzB,EAAI,y59CAAs79C,KAE/89CyB,EAAOD,QAAUA,G,uFCJjBA,EADkC,EAAQ,gDAChCiC,EAA4B,IAE9BjD,KAAK,CAACiB,EAAOzB,EAAI,g6HAAm6H,KAE57HyB,EAAOD,QAAUA,G,qlCCHV,IAAMkC,EAAoB,SAApBA,kBAAqBC,EAAOC,GAAmC,IAA7BC,EAA6B,uDAAP,GAEjE,QAAmBC,IAAhBF,EAAKG,QAA6D,IAApC5D,OAAO6D,KAAKJ,EAAKG,QAAQ7D,QAAgB0D,EAAKG,OAAOE,cAAgB9D,OAAS,MAAO,GAEtH,IAAM+D,EAAiB,6BAAKC,gBAAcC,sBAAnB,mBAA4CP,GAA5C,CAAiE,aAAc,kBAAkBQ,QAAO,SAAAC,GAAE,OAAIA,KAE/HC,EAAQJ,gBAAcK,eAAeZ,EAAKG,OAAQG,GAExD,GAAkC,IAA9B/D,OAAO6D,KAAKO,GAAOrE,QAAgBqE,EAAMN,cAAgB9D,OAAS,MAAO,GARL,MAWpEoE,EAAME,KACAN,gBAAcO,sBAAsBH,GACpCA,EAAMI,KACFR,gBAAcS,sBAAsBL,GACpCJ,gBAAcU,cAAcN,EAAOZ,GAL3CmB,EAVkE,EAUlEA,WAAYC,EAVsD,EAUtDA,KAOZC,EAAWT,EAAME,KACDF,EAAMhC,MAAM0C,KAAK,KACjBV,EAAMhC,MAAM0C,KAAK,KAEvCV,EAAMhC,MAAQgC,EAAMhC,MAAM2C,KAAI,SAAA1C,GAAC,OAAI2C,QAAMC,gBAAgB5C,MAEzD,IAAM6C,EAAUlB,gBAAcmB,qBAAqBR,EAAYP,GAIzDgB,EAAY,CAAEP,SAAU,kBAAmBD,KAFjDA,EAAOA,GAAQR,EAAM1B,IAEkC0B,SAEvD,MAAO,CAAES,WAAUK,UAASE,YAAWC,gBAAiB5B,EAAKG,U,6EChCjE,OAAe,qD,mxECgCO,SAAhB0B,gBAEFC,WAAU,2CAAE,uIAEVC,+BAEkBC,gBAAcC,0BAG5BC,YAAUC,QACVzC,OAAO0C,SAASC,QAAO,IAECL,gBAAcM,qBAAqBC,QAVrD,SAiBOC,SAASC,OAER,0BACG,iBApBX,EA0B2EC,QAAMC,WAA/EC,EA1BF,EA0BEA,OAAiBC,EA1BnB,EA0BUC,QAAqCC,EA1B/C,EA0BmCC,WAAwBC,EA1B3D,EA0B2DA,YAEpDF,EAEbH,EAAOM,eAAiBxD,OAAOyD,WAAW,sBAAsBC,QAChER,EAAOS,iBAAmBT,EAAOM,eAE3BJ,EAAUD,EAAiB,cAAH,GAAQA,GAAmB,CAAES,MAAO,KAAMC,gBAAgB,GAExFC,UAAQC,kBAAkBb,GAC1BY,UAAQE,qBAAqBZ,IAE1BG,GAAsC,IAAvBA,EAAY3G,OAtCxB,kCAuC6BqH,YAAUC,iBAvCvC,QAuCIC,EAvCJ,OAwCFL,UAAQM,uBAAuBD,GAxC7B,eA2CNE,eAAaC,IAAIC,gBAAe,aAAc,QAC9CC,6BACAH,eAAaC,IAAIE,mBAAkB,aAAc,QACjDC,+BACAJ,eAAaC,IAAIG,qBAAoB,OAAQ,QAC7CJ,eAAaC,IAAII,iBAAgB,OAAQ,QAEzCL,eAAaC,IAAIK,aAAY,UAAW,QAExCN,eAAaC,IAAIM,WAAU,SAAU,QACrCP,eAAaC,IAAIO,aAAY,UAAW,QACxCR,eAAaC,IAAIQ,aAAY,UAAW,QACxCT,eAAaC,IAAIS,cAAa,QAAS,QACvCV,eAAaC,IAAIU,qBAAoB,SAAU,gBAEzCC,EA1DA,4DA0De,kIACeC,2BAAiBhC,GADhC,OACXiC,EADW,OAEjBrB,UAAQC,kBAAkBoB,GAFT,sDA1Df,gBA0DAF,eA1DA,mCA+DF/B,EAAOkC,MAAMC,cACbJ,IAhEE,UAmEehB,YAAUqB,qBAAqB,CAAC,SAAU,UAAW,OAAQ,QAAS,YAnErF,QAmEFC,EAnEE,OAoEFA,EAAW1D,QAAM2D,qBAAqBD,EAAU,QACpDzB,UAAQ2B,oBAAoBF,GAE5BG,0BACAC,qBAAmBC,eAxEb,kDA4ENC,QAAQC,IAAI,oBAAZ,MA5EM,kEAmFhB3D,I,4DCrHA,oDAAO,IAAM4D,EAAe,SAAfA,aAAgB/C,EAAOgD,EAAQC,EAAUC,EAAQC,GAC1D,IAAIC,EAAe,KACfC,GAA+B,EAEnC,SAASC,eACP,IAAIC,EAAYP,EAAOhD,EAAMC,YAKzB,GAFAoD,EAA+BE,IAAcH,EAE1CA,GAAgBvJ,OAAO2J,GAAGJ,EAAaxC,MAAM,GAAI,CAClD,IAAI6C,GAAW,EAEXA,GADAA,EAAWA,GAAY5J,OAAO2J,GAAGD,EAAU3C,MAAOwC,EAAaxC,SACxC/G,OAAO2J,GAAGD,EAAU1C,eAAgBuC,EAAavC,gBAC5EwC,GAAgCI,EAGtC,GAAGL,GAAgBG,EACjB,OAAOJ,GACL,IAAK,sBACL,IAAK,oBACL,IAAK,wBACL,IAAK,sBACL,IAAK,wBACL,IAAK,0BACL,IAAK,yBACL,IAAK,0BACL,IAAK,yBACL,IAAK,cACHE,GAAgCE,EAAU3B,UAAY2B,EAAU3B,SAASpG,SAAW4H,EAAaxB,UAAYwB,EAAaxB,SAASpG,MAKtI6H,GAEDJ,EADAG,EAAeG,GAKnBD,aAAaJ,OAASA,EACtBI,aAAaI,SAAWT,EAASzH,KACjC,IAAImI,EAAc3D,EAAM4D,UAAUN,cAIlC,OAHGD,GACDC,eAEK,CAAEK,cAAanI,KAAMyH,EAASzH,Q,8iCCvCzC,IAAIqI,EAAgB,GAiBdC,EAAS,SAATA,OAASzC,GAOX,OALGA,IAECA,EAAasC,cACbE,EAAgBA,EAAc9F,QAAO,SAAAgG,GAAG,OAAIA,EAAIvI,OAAS6F,EAAa7F,SAEnEqI,GAULG,EAAY,SAAZA,UAAYxI,GACd,OAAOqI,EAAcI,MAAK,SAAAF,GAAG,OAAIA,EAAIvI,OAASA,MAG5C0I,EAAY,SAAZA,UAAY7F,GACd,OAAOwF,EAAc9F,QAAO,SAAAgG,GAAG,OAAIA,EAAI1F,OAASA,MAiEvCgD,EAAe,CACxBC,IAvGQ,SAANA,IAAOD,EAAc6B,EAAQ7E,EAAM8E,GAErC,IACMF,EAAW5B,EAEX0C,EAAMhB,uBAAa/C,SAHV,SAATgD,OAAShD,GAAK,OAAIA,EAAMkD,KAGUD,EAAUC,EAAQC,GAI1D,IAFoBa,EAAUD,EAAIvI,MAKlC,OADAqI,EAAc3J,KAAd,+BAAwB6J,GAAxB,IAA6B1F,UACtB0F,GA4FPD,SACAK,aAhFiB,SAAfA,aAAe3I,GACjB,IAAM6F,EAAe2C,EAAUxI,GAC/B,GAAG6F,EACC,OAAOyC,EAAOzC,IA8ElB2C,YACAE,YACAE,OApEW,SAATA,SACF,OAAOP,GAoEPQ,WAjEe,SAAbA,aAEYH,EAAU,UAEhBI,SAAQ,SAAAP,GAAG,OAAI1C,EAAayC,OAAOC,OA8D3CQ,QAjCY,SAAVA,QAAWpB,EAAQjD,GAEjBiD,GAEJA,EAAOqB,QAAQF,SAAS,SAACG,EAAQ7D,GAE7B,IAAM8D,EAAOC,qBAAWF,EAAOjJ,MAEzBoJ,EAlCQ,SAAhBC,cAAiBC,EAAO3B,GAAW,IAE7B4B,EAAuBD,EAAvBC,WAAY7E,EAAW4E,EAAX5E,OAEG8E,GAAoB,EAmB3C,SAjBAA,EAAoBC,oBAAkBC,qBAAqBH,EAAY7E,EAAQ8E,MAetCG,WAAWhC,EAAO3H,KAbrC,CAClB,sBACA,oBACA,wBACA,sBACA,wBACA,0BACA,yBACA,0BACA,yBACA,gBAgB+BqJ,CAAc7E,QAAMC,WAAYkD,GAE5DuB,GAAQE,EACJ1E,EAAOM,gBACO,IAAVI,GAA+B,YAAhB6D,EAAOjJ,MAEzB6F,EAAaC,IAAIoD,EAAMD,EAAOvB,OAAQ,SAAUC,EAASA,EAAO3H,KAAO,KAG3E6F,EAAayC,OAAOzC,EAAa2C,UAAU,aAC3C3C,EAAayC,OAAOzC,EAAa2C,UAAU,8B,itCC7FvD,IAAMoB,EAAiB,cAAH,iBAAQD,QAAQE,oBAAhB,IAAkCC,GAAI,IACjDF,EAAeG,OAAO,GAAGC,cAAcJ,EAAeG,OAAO,GAAGC,aAAa,GAAGC,MAAMvL,KAAK,QAEpG,IAAMwL,EAAgB,cAAH,iBAAQP,QAAQQ,mBAAhB,IAAiCL,GAAI,MAClDI,EAAcH,OAAO,GAAGK,QAAQ1L,KAAK2L,UAAEC,YAE7C,IAAMC,EAAgB,cAAH,iBAAQZ,QAAQa,mBAAhB,IAAiCV,GAAI,IAAKW,UAAU,IACjEF,EAAcR,OAAO,GAAGC,aAAe,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,iBAEnF,IAAMU,EAAkB,cAAH,iBAAQhB,QAAQiB,qBAAhB,IAAmCd,GAAI,IAAKW,UAAU,IACrEI,EAAiB,cAAH,iBAAQlB,QAAQmB,oBAAhB,IAAkChB,GAAI,IAAKW,UAAU,IACnEM,EAAkB,cAAH,iBAAQpB,QAAQqB,qBAAhB,IAAmClB,GAAI,IAAKW,UAAU,IAE9DQ,EAAc,CAEvBH,kBACAE,mBACAnB,kBACAqB,4BACAC,uCACAX,iBACAI,mBACAhB,EAEAiB,EACAE,EACAZ,iBACAiB,2BACAb,EACAI,EACAT,I,y+BCvCG,IAAMY,EAAkB,CAC3BhB,GAAI,EACJ9J,KAAK,WACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAEkB,mBACFlB,UAAEmB,YACFnB,UAAEoB,mBACFpB,UAAEqB,kBAAmBrB,UAAEsB,WACvBtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAEyB,kBACFzB,UAAE0B,YAAc1B,UAAE2B,mBAE9BhC,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,oBAKnDe,EAAmB,CAC5BlB,GAAI,EACJ9J,KAAK,WACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAE0B,YAAc1B,UAAE2B,mBAE9BhC,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,qB,+gCCjCzD,IAAMO,EAAiB,CAC1BV,GAAI,EACJ9J,KAAK,WACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAEkB,mBAAoBlB,UAAEmB,YACxBnB,UAAEoB,mBACFpB,UAAEqB,kBAAmBrB,UAAEsB,WACvBtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAE4B,cAAc5B,UAAE6B,iBAAkB,CAAC,aACrC7B,UAAE4B,cAAc5B,UAAE6B,iBAAkB,CAAC,mBACrC7B,UAAEyB,mBAEd9B,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,aAAc,oBAKjEW,EAAmB,cAAH,iBAAQjB,QAAQa,IAAhB,IAAiCV,GAAI,IAClEc,EAAiBb,OAAO,GAAK,CACzBD,GAAI,EACJ9J,KAAK,UACLmM,YAAa,sBACb/B,QAAS,CACLC,UAAEiB,uB,ujCC/BH,IAAMzB,EAAkB,CAC3BC,GAAI,GACJ9J,KAAK,WACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAEkB,mBACFlB,UAAEmB,YACFnB,UAAEoB,mBACFpB,UAAEqB,kBAAmBrB,UAAEsB,WACvBtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAE4B,cAAc5B,UAAE6B,iBAAkB,CAAC,WAAY,iBAAkB,YAAa,eAAgB,gBAAiB,eACjH7B,UAAEyB,kBACFzB,UAAE0B,YAAc1B,UAAE2B,mBAE9BhC,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,aAAc,oBAKjEiB,EAA4B,CACrCpB,GAAI,GACJ9J,KAAK,YACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAE+B,2BACF/B,UAAEkB,mBAAoBlB,UAAEmB,YACxBnB,UAAEoB,mBACFpB,UAAEqB,kBACFrB,UAAEsB,WACFtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAEyB,sBAObX,EAAuC,CAChDrB,GAAI,GACJ9J,KAAK,YACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,GACTJ,aAAc,O,8+BCxDnB,IAAMG,EAAiB,CAC1BL,GAAI,IACJ9J,KAAK,aACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBACFjB,UAAEkB,mBACFlB,UAAEmB,YACFnB,UAAEoB,mBACFpB,UAAEqB,kBAAmBrB,UAAEsB,WACvBtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAE4B,cAAc5B,UAAE6B,iBAAkB,CAAC,WAAY,iBAAkB,YAAa,eAAgB,gBAAiB,eACjH7B,UAAEyB,kBACFzB,UAAE0B,YAAc1B,UAAE2B,mBAE9BhC,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,oBAKnDmB,EAA2B,CACpCtB,GAAI,IACJ9J,KAAK,aACLyK,UAAU,EACVY,SAAS,EACTtB,OAAQ,CACJ,CAAID,GAAI,EACJ9J,KAAK,UACLoK,QAAS,CACGC,UAAEiB,oBAAqBjB,UAAEkB,mBAAoBlB,UAAEmB,YAC/CnB,UAAEoB,mBACFpB,UAAEqB,kBAAmBrB,UAAEsB,WACvBtB,UAAEuB,oBAAqBvB,UAAEwB,aACzBxB,UAAEyB,mBAEd9B,aAAc,CAAC,cAAD,iBAAOK,UAAEK,oBAAT,IAA6BT,MAAO,CAAE,aAAc,qB,08BCpC1EoC,EAkB0BC,SAlB1BD,eAAgBE,EAkBUD,SAlBVC,YAAaC,EAkBHF,SAlBGE,YAAaC,EAkBhBH,SAlBgBG,YAAaC,EAkB7BJ,SAlB6BI,KACvDC,EAiB0BL,SAjB1BK,KAAMC,EAiBoBN,SAjBpBM,SACNC,EAgB0BP,SAhB1BO,OAAQC,EAgBkBR,SAhBlBQ,aAAcC,EAgBIT,SAhBJS,MAAOC,EAgBHV,SAhBGU,SAAUC,EAgBbX,SAhBaW,aAAcC,EAgB3BZ,SAhB2BY,SAAUC,EAgBrCb,SAhBqCa,aAC/DC,EAe0Bd,SAf1Bc,SAAUC,EAegBf,SAfhBe,YACVC,EAc0BhB,SAd1BgB,oBAAqBC,EAcKjB,SAdLiB,mBACrBC,EAa0BlB,SAb1BkB,eACAC,EAY0BnB,SAZ1BmB,cAAeC,EAYWpB,SAZXoB,kBACbC,EAWwBrB,SAXxBqB,kBACAC,EAUwBtB,SAVxBsB,YACFC,EAS0BvB,SAT1BuB,sBACAC,EAQ0BxB,SAR1BwB,uBACAC,EAO0BzB,SAP1ByB,mBACAC,EAM0B1B,SAN1B0B,oBACAC,EAK0B3B,SAL1B2B,QAASC,EAKiB5B,SALjB4B,QACTC,EAI0B7B,SAJ1B6B,SACAC,GAG0B9B,SAJhB+B,aAIgB/B,SAH1B8B,gBACAE,EAE0BhC,SAF1BgC,gBACAC,EAC0BjC,SAD1BiC,iCACAC,EAA0BlC,SAA1BkC,sBAEEC,EAAoB,CACtBzO,KAAM,6BACN0O,KAAM,OACNC,MAAO,EACPC,KAAM,MACNC,OAAQ,EACRC,MAAO,qBACPC,YAAa,uBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAyB,KAIPkB,EAAkB,CACpBhP,KAAM,sBACN0O,KAAM,WACNC,MAAO,EACPC,KAAM,IACNC,OAAQ,EACRC,MAAO,wBACPC,YAAa,gBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAE,KAIP0C,EAAgB,CAClBjP,KAAM,oBACN0O,KAAK,WACLC,MAAO,EACPC,KAAM,IACNC,OAAQ,EACRC,MAAO,QACPC,YAAa,iBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAU,KAIPmC,EAAmB,CACrBlP,KAAM,wBACN0O,KAAK,WACLC,MAAO,EACPC,KAAM,KACNC,OAAQ,EACRC,MAAO,gBACPC,YAAa,QACb/F,QAAS,CAAC,cAAD,GACA6E,GADA,iBAEAb,KAIPmC,EAAqB,CACvBnP,KAAM,yBACN0O,KAAK,WACLC,MAAO,EACPC,KAAM,IACNC,OAAQ,EACRC,MAAO,iBACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAmB,KAIPjC,EAAqB,CACvBvL,KAAM,yBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,mBACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAG,KAIPf,EAAqB,CACvBzL,KAAM,yBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,oBACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAI,KAIPL,EAA6B,CAC/BpM,KAAM,gCACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,qBACPC,YAAa,wBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAmC,KAIP9C,EAAoB,CACtB1L,KAAM,0BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,qBACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAY,GAFA,IAEcyB,KAAM,0BAI3BU,EAA2B,CAC7BpP,KAAM,gCACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,MACNE,MAAO,8BACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAiB,KAIP+B,EAA0B,CAC5BrP,KAAM,+BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,MACNE,MAAO,8BACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAkB,KAIP7C,EAAqB,CACvB1K,KAAM,uBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNU,OAAO,EACPR,MAAO,2BACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACA4E,GADA,iBAEAH,KAIP8B,EAAyB,CAC3BvP,KAAM,2BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNU,OAAO,EACPR,MAAO,2BACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACA4E,GADA,iBAEAD,KAIP6B,EAAyB,CAC3BxP,KAAM,2BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,8BACPC,YAAa,yBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAqB,KAIP3B,EAAc,CAChB/L,KAAM,2BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,eACPC,YAAa,gBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAQ,KAIP4C,GAAgB,CAClBzP,KAAM,6BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,gBACPC,YAAa,eACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAa,KAIPlB,GAAoB,CACtBhM,KAAM,+BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,qBACPC,YAAa,gBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAS,KAIPnB,GAAa,CACf3L,KAAM,qBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,qBACPC,YAAa,mBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAK,GAFA,IAEMK,MAAO,YAIpBlB,GAAe,CACjB7L,KAAM,uBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,mBACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAK,GAFA,IAEMK,MAAO,cAIpBjB,GAAoB,CACtB9L,KAAM,wBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,oBACPC,YAAa,mBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAK,GAFA,IAEMK,MAAO,WAIpB2C,GAAY,CACdhB,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACN5F,QAAS,CAAC,cAAD,GACA2D,GADA,iBAEAC,KAKPhB,GAAsB,CACxB5L,KAAM,4BACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,mBACPC,YAAa,sBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAY,GAFA,IAEcyB,KAAM,4BAI3BlD,GAAc,CAChBxL,KAAM,sBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,qBACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,+BAEAK,GAFA,IAEMK,MAAO,iBAKpB4C,GAAgB,CAClB3P,KAAM,kBACN0O,KAAM,OACNC,MAAO,EACPE,OAAQ,EACRD,KAAM,KACNE,MAAO,UACPC,YAAa,2BACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAe,KA6FAhD,GAAU,CACrBqE,oBACAO,kBACAC,gBACAC,mBACAC,qBAEA5D,qBACAE,qBACAC,oBACA0D,2BACAC,0BACA3E,qBACA6E,yBACAC,yBACAzD,cACA0D,iBACAzD,qBACAL,cACAE,gBACAC,qBACAF,uBACAJ,eACAkE,aACAE,cAjHoB,CAClB5P,KAAM,qBACN0O,KAAM,OACNC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,sBACPC,YAAa,oBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAgB,KAwGXsC,iBACAE,UArGgB,CACd7P,KAAM,mBACN0O,KAAM,OACNC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,oBACPC,YAAa,kBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAc,GAFA,iBAGAD,KA2FX5B,oBAvF0B,CAC1BtL,KAAM,wBACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,kBACPC,YAAa,uBACb/F,QAAS,CAAC,cAAD,GACA+E,GADA,iBAEAC,KA8ETC,UACAC,UACA5D,WA5EiB,CACftK,KAAM,cACN0O,KAAK,OACLC,MAAO,EACPE,OAAQ,EACRD,KAAM,IACNE,MAAO,eACPC,YAAa,iBACb/F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAGA8B,KAkEXjC,iBA9DuB,CACrBlM,KAAM,qBACN0O,KAAK,OACLE,KAAM,IACND,MAAO,EACPE,OAAQ,EACRC,MAAO,eACPC,YAAa,qBACb/F,QAAS,CAAC,cAAD,GACAoF,GADA,iBAEAE,KAqDXwB,wBAjD8B,CAC5B9P,KAAM,4BACN0O,KAAM,OACNC,MAAO,EACP3F,QAAS,CAAC,cAAD,GACAqD,GADA,iBAEAkC,KA4CXnC,6BACAH,cAzCoB,SAAhBA,cAAiBvB,EAAoBzI,GACvC,IAAM0F,EAASgC,QAAQe,GAGvB,OAFA/C,EAAOqB,QAAQ,GAAG/G,OAASA,EAC3B0F,EAAOqB,QAAQ,GAAG/G,OAASA,EACpB0F,K,wEChcX,kDAuLe2E,EAAS,CACpBD,eAxLmB,CACnBrM,KAAM,kBACN0H,OAAQ,cAuLRuG,QA/Kc,CACdjO,KAAM,UACN0H,OAAQ,WA+KR6E,YA5KkB,CAClBvM,KAAM,eACN0H,OAAQ,cA2KR8F,eAxKqB,CACrBxN,KAAM,kBACN0H,OAAQ,cAuKR+E,YApKkB,CAClBzM,KAAM,sBACN0H,OAAQ,aACRqF,MAAO,QAkKPP,YArJkB,CAClBxM,KAAM,sBACN0H,OAAQ,aACRqF,MAAO,QAmJPL,KAhJW,CACX1M,KAAM,aACN0H,OAAQ,cA+IRwG,QAtIc,CACdlO,KAAM,UACN0H,OAAQ,WAsIRiF,KA9HW,CACX3M,KAAM,aACN0H,OAAQ,cA6HRkF,SA1He,CACf5M,KAAM,YACN0H,OAAQ,cA0HR0F,SAvHe,CACfpN,KAAM,UACN0H,OAAQ,cAsHR2F,YAnHkB,CAClBrN,KAAM,aACN0H,OAAQ,eAkHRmF,OA/Ga,CACb7M,KAAM,SACN0H,OAAQ,cA8GRoF,aA3GmB,CACnB9M,KAAM,gBACN0H,OAAQ,cA2GRqF,MAxGY,CACZ/M,KAAM,aACN0H,OAAQ,cAuGRsF,SApGe,CACfhN,KAAM,iBACN0H,OAAQ,cAmGRmG,sBAhG4B,CAC5B7N,KAAM,2BACN0H,OAAQ,cA+FRuF,aAzJmB,CACnBjN,KAAM,gBACN0H,OAAQ,aACRxE,SAAU,2BAuJViK,aA7FmB,CACnBnN,KAAM,gBACN0H,OAAQ,cA4FRwF,SAzFe,CACflN,KAAM,iBACN0H,OAAQ,cAyFR4F,oBAtF0B,CAC1BtN,KAAM,eACN0H,OAAQ,aACRgH,KAAM,cAoFNnB,mBAjFyB,CACzBvN,KAAM,eACN0H,OAAQ,aACRgH,KAAM,YA+ENjB,cA5EoB,CACpBzN,KAAM,iBACN0H,OAAQ,eA2ERiG,kBAxEwB,CACxB3N,KAAM,qBACN0H,OAAQ,eAuERgG,kBApEwB,CACxB1N,KAAM,qBACN0H,OAAQ,cAoERoG,uBAxJ6B,CAC7B9N,KAAM,2BACN0H,OAAQ,cAwJRqG,mBAnEyB,CACzB/N,KAAM,wBACN0H,OAAQ,cAkERsG,oBA/D0B,CAC1BhO,KAAM,0BACN0H,OAAQ,cA+DRyG,SA7Le,CACfnO,KAAM,WACN0H,OAAQ,eA4LR2G,aAzLmB,CACnBrO,KAAM,gBACN0H,OAAQ,cAwLRkG,YAzNgB,CAChB5N,KAAM,eACN0H,OAAQ,eAyNR0G,eAhEqB,CACrBpO,KAAM,qBACN0H,OAAQ,cA+DR4G,gBA5DsB,CACtBtO,KAAM,uBACN0H,OAAQ,cA2DR6G,iCAxDuC,CACvCvO,KAAM,sCACN0H,OAAQ,cAuDR8G,sBAnD4B,CAC5BxO,KAAM,yBACN0H,OAAQ,aACRqF,MAAO,U,iFCnLX,sDAmCagD,EAAa,CACtBC,IApCQ,CACR,CACElG,GAAI,QACJmG,OAAQ,mBAEV,CACEnG,GAAI,WACJmG,OAAQ,cAEV,CACEnG,GAAI,WACJmG,OAAQ,WAEV,CACEnG,GAAI,UACJmG,OAAQ,UAEV,CACEnG,GAAI,cACJmG,OAAQ,uBAEV,CACEnG,GAAI,UACJmG,OAAQ,WAEV,CACEnG,GAAI,OACJmG,OAAQ,SAEV,CACEnG,GAAI,WACJmG,OAAQ,e,kjDCxBd,IA8EaC,EAAe,CACxBC,SA/EU,4DAAG,kBAAOC,EAAYC,EAAarG,EAAcsG,EAAYC,GAA1D,mHAEPC,EAAmBJ,EAAWK,MAAMrN,KAAI,SAACtB,EAAMsD,GACjD,OAAGuE,WAAWvE,EAAOiL,GACjB,+BAAYvO,GAAZ,IAAkB4O,UAAWtL,IACnB,QACf7C,QAAO,SAAAT,GAAI,OAAIA,KAEZ6O,EAAkB,SAAlBA,gBAAkBC,GAMpB,OALyBA,EAAWxN,KAAI,SAAAyN,GAGpC,OAFAA,EAAUH,UAAYG,EAAU/O,KAAO+O,EAAU/O,KAAK4O,UAAY,EAClEG,EAAY,cAAH,+BAAQA,GAAclJ,GAAtB,IAA8B2I,aAAYC,kBAMrDO,EAAoB,SAApBA,kBAAoBN,GACtB,OAAO,IAAIO,SAAQ,SAAAC,GAAO,OAAIA,EAAQC,wBAAcT,QAGlDU,EAA4B,SAA5BA,0BAA6BV,EAAkBJ,GACjD,OAAO,IAAIW,SAAQ,SAAAC,GAAO,OAAIA,EAAQG,2BAAiBX,EAAkBJ,QAGvEgB,EAA6B,SAA7BA,2BAA6BZ,GAC/B,OAAOa,4BAAkBb,IAGvBc,EAAyB,SAAzBA,uBAAyBd,GAC3B,OAAOe,6BAAmBf,IAG1BI,EAAa,GAAoB,GAAqB,GAAsB,KAE5EjJ,EAASqC,EAAavB,MAAK,SAAAd,GAAM,MAAoB,yBAAhBA,EAAO3H,SAnCnC,qBAuCN2H,EAAOsC,MAvCD,wBAyCCuH,EAzCD,4DAyCuB,wIACL7J,EAAOsC,MAAM7G,IAAb,4DAAiB,iBAAMsL,GAAN,8FAC7BA,EAD6B,OAE3B,WAF2B,OAI3B,SAJ2B,OAM3B,eAN2B,OAQ3B,eAR2B,+CAGrBoC,EAAkBN,IAHG,gCAKrBU,EAA0BV,EAAkBJ,IALvB,gCAOrBgB,EAA2BZ,IAPN,gCASrBc,EAAuBd,IATF,sDAAjB,uDADK,cACtBiB,EADsB,gBAcHV,QAAQf,IAAIyB,GAdT,cActBC,EAdsB,OAgBtBC,EAAQD,EAAWtO,KAAI,SAAAwO,GAEzB,OADAA,EAAQA,EAAMrP,QAAO,SAAAsP,GAAC,OAAIA,EAAE3O,YACrByN,EAAgBiB,MAlBC,kBAqBrBD,GArBqB,uDAzCvB,gBAyCCH,sBAzCD,6CAiEUA,IAjEV,QAiETZ,EAjES,+BAoELA,EAAaE,EAAkBN,GACfU,EAA0BV,EAAkBJ,GAC3CgB,EAA2BZ,GAC1Bc,EAAuBd,GAvEpC,iCA2EN7G,UAAUiH,IA3EJ,wDAAH,gBAART,SAAQ,gD,8jBCHP,IAAMgB,EAAmB,SAAnBA,iBAAoBX,EAAkBJ,GAE/C,YAAwBpO,IAArBwO,EAAuC,GAE5BA,EAAiBpN,KAAI,SAAAtB,GAE/B,GAAGA,EAAKgQ,SAAL,OAA6D,SAAtChQ,EAAKgQ,SAAL,MAAoBC,cAA0B,MAAO,GAFxC,MAIEC,EAAgBlQ,EAAM0O,EAAkBJ,GAAzElN,EAJ+B,EAI/BA,SAAUK,EAJqB,EAIrBA,QAASE,EAJY,EAIZA,UAE3B,OAAIP,EAEG,CACHpB,OACAoB,WACAK,UACAE,aANiB,OAavBuO,EAAkB,SAAlBA,gBAAmBlQ,EAAM0O,EAAkBJ,GAE7C,GAAItO,EAAKG,QAA8C,IAApC5D,OAAO6D,KAAKJ,EAAKG,QAAQ7D,OAA5C,CAEA,IACM+P,E,uYAAW,CAAH,CAAKnO,KADN,QACe8B,EAAKG,OAAL,MAIxBgQ,EAAQtI,OAAO,EAAGyG,EAAWK,MAAMlO,QAAO,SAAA2P,GAAI,OAAIA,EAAKlS,KAAK+R,gBAAkBjQ,EAAK9B,KAAK+R,kBACxFE,EAAMvT,KAAKoD,GAEf,IAAMqQ,EAAY9O,QAAM+O,aAAaH,EAAM7O,KAAI,SAAA8O,GAAI,OAAIA,EAAKlS,SAM5D,MAAO,CAAEkD,SAJQpB,EAAK9B,KAIHuD,QAHH4O,EAGY1O,UAFV,CAAEP,SAAU,qBAAsBmP,eAAgB,cAAeC,SAAU,aAAc7P,MAAO0L,O,81CCpC/G,IAAMoD,EAAqB,SAArBA,mBAAqBf,GAE9B,YAAwBxO,IAArBwO,EAAuC,GAE5BA,EAAiBpN,KAAI,SAAAtB,GAE/B,OAAOyQ,EAAkBzQ,OAO3ByQ,EAAiB,iB,oRAAA,0BAAG,iBAAMzQ,GAAN,gIAEmB0C,QAAMC,WAAvCC,EAFc,EAEdA,OAAQ0L,EAFM,EAENA,WAAYrJ,EAFN,EAEMA,SAEbrC,EAAOM,eAAhBwN,EAAiC,EAEjCzF,EAAQ0F,qBAAW3Q,EAAKgQ,SAAU/B,cAAYtP,MAEhD4M,EAActG,EAASxE,QAAO,SAAAmQ,GAAU,OAAI/I,WAAW+I,EAAW3F,MAAO,CAAEA,EAAO,cAEtFM,EAAchK,QAAM+O,aAAa/E,GAE3BsF,EAAO7Q,EAAK8Q,MACAvP,QAAM+O,aAAatQ,EAAK8Q,OAAO,GAC/B9Q,EAAK+Q,OACD/Q,EAAK+Q,MAAMD,MACP9Q,EAAK+Q,MAAMD,MAAMxC,EAAWM,WACxB5O,EAAK+Q,MAAMD,MAAMxC,EAAWM,WACxB5O,EAAK+K,QACL/K,EAAK+K,OAAO+F,MACRvP,QAAM+O,aAAatQ,EAAK+K,OAAO+F,OAAO,GAE1C,KAEZ,KAGhBF,EAAeC,EACftF,EAAY5E,MAAK,SAAAiK,GAAU,OAAIA,EAAWC,KAAKZ,gBAAkBY,EAAKZ,iBACtE1E,EAAY,GAEZyF,EAAenJ,OAAO6I,EAAO,EAAG7I,OAAO6I,EAAQnP,QAAM+O,aAAa/E,IAAc9K,QAAO,SAAAxC,GAAC,OAAIA,EAAE4S,KAAKZ,gBAAkBW,EAAWC,KAAKZ,kBAAgB3O,KAAI,SAAArD,GAAC,OAAIsD,QAAMC,gBAAgBvD,EAAE2S,eAEtLxP,EAAWwP,EAAWA,WACtBnP,EAAUF,QAAM+O,aAAN,CAAoBlP,GAApB,0BAAiC4P,KAC3C7P,EAAOyB,EAAOS,gBAAkB,4BAA8B,wBAnC9C,kBAqCf,CAAEjC,WAAUK,UAASE,UAAY,CAAEP,SAAUwP,EAAWC,KAAM1P,OAAMqP,SAAUxQ,EAAK9B,KAAMqS,eAAgBvQ,EAAKuQ,kBArC/F,uDAAH,gBAAjBE,kBAAiB,uC,uhDClBhB,IAAMlB,EAAiB,4DAAG,kBAAMb,GAAN,yGAEvBuC,EAFuB,4DAEhB,sHAEe/Q,IAArBwO,EAFM,yCAEiC,IAAIO,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,QAFhE,gCAIFD,QAAQf,IAAIQ,EAAiBpN,IAAjB,4DAAqB,iBAAMtB,GAAN,qHAEWkR,EAAiBlR,GAF5B,mBAE5BoB,EAF4B,EAE5BA,SAAUK,EAFkB,EAElBA,QAASE,EAFS,EAETA,UAEvBP,EAJgC,yCAIf,IAAI6N,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,QAJhB,gCAM7B,CACHlP,OACAoB,WACAK,UACAE,cAVgC,sDAArB,yDAJV,uDAFgB,gBAEvBsP,OAFuB,4CAqBTA,IArBS,cAqBvBpB,EArBuB,yBAuBtBA,GAvBsB,uDAAH,gBAAjBN,kBAAiB,sCA0BjB4B,EAAiB,4DAAG,kBAAMnR,GAAN,uGAEzBA,EAAKG,QAA8C,IAApC5D,OAAO6D,KAAKJ,EAAKG,QAAQ7D,OAFf,yCAEoC,IAFpC,UAIvB8U,EAAkBpR,EAAKG,OAAL,WAJK,yCAMD,IAAI8O,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,QAN9B,UAUJ,KAFrBmC,EAAaD,EAAgB9P,KAAI,SAAAX,GAAK,OAAIA,EAAM2Q,UAAUpT,SAEhD5B,OAVe,yCAUM,IAVN,cAcvBiV,EAduB,4DAcP,uIACXtC,QAAQf,IAAImD,EAAW/P,IAAX,4DAAe,kBAAMpD,GAAN,0GACjByF,YAAU6N,iBAAiBtT,GADV,+FAAf,yDADD,uDAdO,gBAcvBqT,gBAduB,6CAoBVA,IApBU,eAqB7BF,GADAA,EApB6B,QAqBL5Q,QAAO,SAAA6Q,GAAS,OAAIA,KArBf,kBAuBtBD,GAvBsB,wDAAH,gBAAjBF,kBAAiB,sCA0BxBD,EAAmB,SAAnBA,iBAAmBlR,GAarB,OAXU,4DAAG,wIAEgBmR,EAAkBnR,GAFlC,cAEHqR,EAFG,OAIHjQ,EAAWiQ,EAAW/U,OAAS,EAAI0D,EAAK9B,KAAO,KAC/CuD,EALG,CAKSL,GALT,0BAKsBiQ,EAAW/P,KAAI,SAAAtB,GAAI,OAAIA,EAAK9B,UALlD,kBAQF,CAAEkD,WAAUK,UAASE,UAAY,CAAEP,SAAU,oBAAqBD,KAAM,2BAA4BqP,SAAU,aAAcD,eAAgB,cAAe5P,MAAO,CAAEzC,KAAM,aAAcmT,iBARtL,uDAAH,gBAAJJ,OAAI,kCAWHA,K,iFCnEX,iIAGa9B,EAAgB,SAAhBA,cAAgBT,GAEzB,YAAwBxO,IAArBwO,EAAuC,GAE5BA,EAAiBpN,KAAI,SAAAtB,GAAQ,IAE/BD,EAAU2C,QAAMC,WAAhB5C,MAF+B,EAIED,4BAAkBC,EAAOC,GAA1DoB,EAJ+B,EAI/BA,SAAUK,EAJqB,EAIrBA,QAASE,EAJY,EAIZA,UAE3B,OAAIP,EAEG,CACHpB,OACAoB,WACAK,UACAE,aANiB,Q,uhCCbtB,IAAM8P,EAAsB,SAAtBA,oBAAuBzO,EAAYJ,EAAQ8O,GAIpDA,EAAOC,iBAAmB3O,EAAWiF,OAAOxH,QAAO,SAAAmR,GAAK,OAAIA,EAAMtJ,QAAQhM,OAAS,KAAGA,OAEtF,IA+CIuV,EAAUH,EAAOE,MAAM5J,GAS3B,OAPG0J,EAAOI,kBACND,IACAH,EAAOE,MAAQ5O,EAAWiF,OAAOtB,MAAK,SAAAiL,GAAK,OAAIA,EAAM5J,KAAO6J,MAnC5B,SAA9BE,4BAA+B/O,EAAY6O,GAE7C,IAAIvJ,EAAU,GAAIkG,EAAa,GAAIC,EAAY,GA0B/C,OAxBqD,SAA/CuD,6CAAgDC,EAAaJ,GAE/D,IAAIK,EAAYD,EAEhB,KAAG3J,EAAQhM,OAAS,GAApB,CAEA,IAAMsV,EAAQ5O,EAAWiF,OAAOtB,MAAK,SAAAiL,GAAK,OAAIA,EAAM5J,KAAO6J,EAAUK,KAEjEN,IAEJF,EAAOE,MAAQA,EAEfF,EAAOE,MAAQA,EACfpD,EAAakD,EAAOxT,KACpBuQ,EAAYiD,EAAOE,MAAM1T,KACzBoK,EA/BW,SAAb6J,WAAcC,EAAcvT,GAC9B,OAAOA,GACH,IAAK,QAED,OADAuT,EAAalK,aAAekK,EAAalK,cAAgB,GACzD,6BAAYkK,EAAa9J,QAAQ7H,QAAO,SAAA3C,GAAC,OAAIA,MAA7C,mBAAoDsU,EAAalK,eACrE,IAAK,SACD,OAAOkK,EAAaC,eAAiB,GACzC,QACI,OAAOD,EAAa9J,SAuBd6J,CAnCoB,SAAhCG,8BAAiCtP,EAAY6O,GAC/C,OAAO7O,EAAWiF,OAAOtB,MAAK,SAAAiL,GAAK,OAAIA,EAAM5J,KAAO6J,KAkC3BS,CAA8BtP,EAAY6O,EAAUK,GAAYtP,EAAO/D,MAI5FmT,+CAFAE,EAEwDL,KAG5DG,CAA6C,EAAGH,GAEzC,CAAErD,aAAYC,YAAWnG,WAUhByJ,CAA4B/O,EAAY6O,GAApDvJ,U,wpCCxDJ8D,EAAqB9D,UAArB8D,QAASD,EAAY7D,UAAZ6D,QA6BJoG,EAAgB,CACzBC,iBA5BkB,iB,oRAAA,0BAAG,iBAAOxP,EAAYJ,EAAQ0L,EAAYoD,GAAvC,oGAErBA,EAAOe,WAAaf,EAAOe,YAAcnE,EAAWmE,YAAc7P,EAAO6P,WACzEf,EAAOgB,aAAehB,EAAOgB,cAAgB,EAEzCC,EAASrE,EAAWK,MAAMrS,OAASoV,EAAOe,WAC1CE,EAASrE,EAAWK,MAAMrS,OAASoV,EAAOe,YAAe,EAAIE,EAAoB,IAAXA,EAAe,EAAIC,KAAKC,MAAMF,GAAU,EAElHjB,OAA0BxR,IAAjBwR,EAAOE,MAAP,6CACMF,GAAW1O,GADjB,IAC6B4O,MAAO,CAAE5J,GAAI,GAAK2K,WAC9CjB,EAEJoB,EAA2BrB,8BAAoBzO,EAAYJ,EAAQ8O,QAErDxR,IAAjBwR,EAAOE,MAdW,yCAeV,IAAI3C,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,UAfrB,wBAkBR6D,0BACT/P,EACA8P,EACA,CAAE1G,EAASD,GACXmC,EACAoD,GAvBiB,gGAAH,gBAAhBc,iBAAgB,8C,w1CCCf,IAAMQ,EAAY,iB,oRAAA,0BAAG,iBAAO1E,GAAP,4HAAmB2E,EAAnB,+BAA8B,EAA9B,SAIlBjT,EAAOsO,EAAWhK,SAEI,WAAzBgK,EAAW4E,UANU,sBAOhBC,EAAa7E,EAAWK,MAAMlO,QAAO,SAAArE,GAAC,OAAIA,EAAE8B,OAAS8B,EAAK9B,UAC/CiV,EAAW7W,OAAS,GARf,yCASb8W,EAAuBD,EAAYnT,EAAMiT,IAT5B,cAaXI,gCAAsBrT,EAAKgQ,SAAUhQ,EAAKsT,aAb/B,UAeG3P,YAAU4P,wBAAwBvT,GAfrC,WAepBwT,EAfoB,OAiBc,UAAnCxT,EAAKsT,YAAYrD,gBACVwD,EAAWzT,EAAK0T,OACtBF,EAAiBC,EAAWD,EAAe/S,QAAO,SAAAT,GAAI,OAAIA,EAAK0T,UAAUF,EAAe/S,QAAO,SAAAT,GAAI,OAAKA,EAAK0T,WAG3GC,EAAcpS,QAAM+O,aAAakD,EAAe/S,QAAO,SAAAmT,GAAE,OAAIA,EAAG1V,KAAK+R,gBAAkBjQ,EAAK9B,KAAK+R,kBAIjG4D,EAAiD,aAAnC7T,EAAKsT,YAAYrD,eAAmE,aAAnCjQ,EAAKsT,YAAYrD,cAElF0D,EA5BoB,iBA6BtBX,EAAa1E,GA7BS,6BAkChBqF,EAAYrX,OAAS2W,IAAaY,EAlClB,iBAmCtBb,EAAa1E,GAnCS,+BAuChBK,EAAQ9G,OAAOoL,EAAUU,IAEzB/W,KAAKoD,GAzCW,UA2CT2O,EA3CS,mGA8CxBmF,mBAAS,4CAAD,MA9CgB,gEAAH,gBAAZd,aAAY,sCAkDjBI,EAAyB,SAAzBA,uBAA0BD,EAAYnT,EAAMiT,GAChD,IAAMtE,EAAQ9G,OAAOoL,EAAU1R,QAAM+O,aAAa6C,IAClD,OAAO5R,QAAM+O,aAAN,6BAAwB3B,GAAxB,CAA+B3O,O,ioBCvD1C,IAAM+T,EAAc,4DAAG,kBAAMC,GAAN,6FACfA,EAAcC,YADC,yCACmB,IAAIhF,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,UADlD,gCAEZD,QAAQf,IAAI8F,EAAcC,YAAY3S,IAA1B,4DAA8B,iBAAM0G,GAAN,yGAAkBrE,YAAUuQ,gBAAgBlM,EAAIgM,EAAc9V,MAA9D,8FAA9B,yDAFA,uDAAH,gBAAd6V,eAAc,sCA+BPI,EAAkB,CAC3BhC,WA3BY,4DAAG,kBAAO7D,EAAY8F,GAAnB,0GAEZ9F,EAAW+F,QAFC,oBAILA,EAAU/F,EAAW+F,QAAQ5T,QAAO,SAAA6T,GAAE,OAAIzM,WAAWyM,EAAGpW,KAAMkW,SAC9DG,EAAmBF,EAAQ5T,QAAO,SAAA6T,GAAE,OAAIA,EAAGE,cAE7BlY,OAAS,GAPlB,yCAQA2S,QAAQf,IAAIqG,EAAiBjT,KAAI,SAAAmT,GAAE,OAAIA,EAAGD,eAR1C,YAWLE,EAAiBpG,EAAWK,MAAMlO,QAAO,SAAArE,GAAC,OAAIyL,WAAWzL,EAAE8B,KAAMkW,MAAiB9S,KAAI,SAAAlF,GAAO,MAAO,CAAE8B,KAAM9B,EAAE8B,KAAM+V,YAAa7X,EAAE6X,iBAX9H,wBAcDtE,EAAW+E,EAAepT,IAAf,4DAAmB,kBAAO0S,GAAP,8FAC7BA,EAAcC,YADe,gCACWF,EAAeC,GAD1B,+FAAnB,uDAdV,UAiBM/E,QAAQf,IAAIyB,GAjBlB,0EAmBA,IAAIV,SAAQ,SAAAC,GAAO,OAAIA,EAAQ,UAnB/B,yDAsBJ,IAtBI,wDAAH,gBAAViD,WAAU,0C,6ECThB,wDAOawC,EAAe,CACxBC,cARkB,SAAhBA,cAAiBlC,EAAcD,EAAY9D,GAE7C,IAAMkG,GAASnC,EAAe,GAAKD,EAC7BqC,EAAMD,EAAQpC,EACpB,OAAO9D,EAAM/O,MAAMiV,EAAOC,M,+yFCQvB,IAAM/B,EAAkB,SAAlBA,gBAAmB/P,EAAY8P,EAA0BiC,EAAiBzG,EAAYoD,GAyI/F,OAvIU,4DAAG,mJAET1O,EAAWsF,QAAU,GAEfmK,EAAaf,EAAOe,WACpBjE,EAAakD,EAAOxT,KACpBuQ,EAAYiD,EAAOE,MAAM1T,KACzB8W,GAAoBtD,EAAOgB,aAAe,GAAKD,EAC/CwC,EAAY3G,EAAWK,MAAMrS,OAAS0Y,EAEtCE,EAAezC,EAAawC,EAAYA,EAAYxC,EACpD2B,EAAiBO,eAAaC,cAAclD,EAAOgB,aAAcD,EAAYnE,EAAWK,MAAMrN,KAAI,SAAAlF,GAAC,OAAIA,EAAE8B,SAE/G4U,EAAyB9L,QAAzB,4DAAkC,kBAAOnB,EAAQvC,GAAf,kGAC1BsL,EAAY,EADc,UAGP,uBAAhB/I,EAAO3H,KAHgB,mMAKhB8B,EAAOsO,EAAWK,MAAMhI,MAAK,SAAAvK,GAAC,OAAIA,EAAE8B,OAASkW,EAAexF,MAL5C,EAOiBuG,oBAAkBC,iBAAiB7T,QAAM+O,aAAazK,EAAOqB,QAAQ,GAAG/G,QAASH,EAAKG,QAArHkV,EAPc,EAOdA,oBAAqB1U,EAPP,EAOOA,MAPP,4EAWmBwU,oBAAkBG,YAAY3U,EAAO0U,EAAqB/G,EAAWrJ,UAXxF,mBAWd9E,EAXc,EAWdA,QAAQoV,EAXM,EAWNA,iBAEOpV,EAbD,8DAetB0F,EAAOlF,MAAQA,EACfkF,EAAO1F,OAASA,EAChB0F,EAAO0P,eAAiBA,EAElBC,EAAiB,CAAE,MAAO,UACZD,EAAe5O,MAAK,SAAA/H,GAAC,OAAKiJ,WAAWjJ,EAAEiS,KAAKZ,cAAeuF,OAG3ExS,EAAWsF,QAAQ1L,KAAnB,+BAA4BiJ,GAA5B,IAAoC2I,aAAYC,YAAWgH,YAAarB,EAAexF,MAvBrE,gLA2BtB5L,EAAWsF,QAAQ1L,KAAnB,+BAA4BiJ,GAA5B,IAAoC2I,aAAYC,YAAWgH,YAAarB,EAAexF,MA3BjE,OA8B1BA,IA9B0B,WAgCrBA,EAAYsG,EAhCS,wEAAlC,yDAmCuB,IAApBxD,EAAOE,MAAM5J,GAhDP,kCAiDyBmM,kBAAgBhC,WAAW7D,EAAY8F,GAjDhE,QAiDDsB,EAjDC,OAkDDA,EAAoB7N,UAAU6N,GAAmBjV,QAAO,SAAAoF,GAAM,OAAIA,MAElE8P,EAAkBD,EAAkBpU,KAAI,SAAAsU,GACxC,sCAAYrN,UAAEyF,yBAAd,IAAuCQ,WAAW,WAAYC,UAAU,UAAWgH,YAAaG,EAAS1X,MAAQ0X,EAAS3K,MAAO2K,mBAIjI5S,EAAWsF,QAAX,6BAA0BtF,EAAWsF,SAArC,mBAAiDqN,KAzDhD,WA6DHzN,EAAelF,EAAWsF,QAAQ7H,QAAO,SAAAoF,GAAM,OAAIA,EAAO2H,SAE5DqI,EAAgB7S,EAAWsF,QAAQ7H,QAAO,SAAAoF,GAAM,OAAKA,EAAO2H,SAAOlM,KAAI,SAACuE,EAAQzJ,GAEhF,OADAyJ,EAAO+I,eAAiC1O,IAArB2F,EAAO+I,UAA0BrN,QAAMuU,cAAcd,EAAkBE,EAAc9Y,GAAKyJ,EAAO+I,UACpH,iBAAY/I,MAGV0I,EApEG,mBAoEgB,IAAIwH,IAAI/S,EAAWsF,QAAQhH,KAAI,SAAAuE,GAAM,OAAIA,EAAO+I,aAAWnO,QAAO,SAAArE,GAAC,YAAU8D,IAAN9D,OAEhG4G,EAAWsF,QAAUuN,EAEE,IAApBnE,EAAOE,MAAM5J,GAxEP,qBA0EFE,EA1EE,kCA2EwBkG,eAAaC,SAASC,EAAYC,EAAarG,EAAcsG,EAAYC,GA3EjG,QA2EKuH,EA3EL,OA4EDhT,EAAWsF,QAAX,6BAA0BtF,EAAWsF,SAArC,mBAAiD0N,IA5EhD,eAgFTH,EAAgB7S,EAAWsF,QAAQhH,KAAI,SAACuE,EAAQzJ,GAE5C,OADAyJ,EAAOoQ,mBAAqB7Z,EAAI,EAChC,iBAAYyJ,MAGM7C,EAAW2F,SAC3B,CACEzK,KAAM,UACNgJ,QAAS,CAAC,CACNhJ,KAAM,UACN0H,OAAQ,UACRsQ,OAAQC,MAAIC,YAEhB5H,aACAC,YACA4H,YAAarT,EAAWsF,QAAQhM,OAChCsS,UAAW,GAEb,CACE1Q,KAAM,UACNgJ,QAAS,mBAAI6N,GACbvG,aACAC,YACA4H,YAAarT,EAAWsF,QAAQhM,OAChCsS,UAAW,GAKnB5L,EAAWsF,QAAQ1L,KAAK,CACpBsB,KAAM,UACNgJ,QAAS,CAAC,CACNhJ,KAAM,UACN0H,OAAQ,UACRsQ,OAAQC,MAAIC,YAEhB5H,aACAC,YACA4H,YAAarT,EAAWsF,QAAQhM,OAChCsS,UAAW,IAGT0H,EAAStT,EAAWsF,QAAQhH,KAAI,SAAAuE,GAAM,OAAIA,EAAOgH,OAAS,KAC1D0J,EAAkBD,EAAOE,QAAO,SAACC,EAAaC,GAAd,OAA+BD,EAAcC,KAEnF1T,EAAWsF,QAAQhH,KAAI,SAAAuE,GAAM,OAAIA,EAAO0Q,gBAAkBA,KAE1D7E,EAAOiF,cAAgB3T,EAAWsF,QAAQ7H,QAAO,SAAAoF,GAAM,MAAoB,SAAhBA,EAAO+G,QAAiBtQ,OAEnFoV,EAAOkF,YAAc5T,EAAWsF,QAAQhM,OACxCoV,EAAOmF,YAAc7T,EAAWsF,QAAQhH,KAAI,SAAAuE,GAAM,OAAIA,EAAO3H,QAlIpD,kBAoIF,CAAE4Y,kBAAmB9T,EAAY+T,kBAAmBzI,EAAY0I,cAAetF,IApI7E,wDAAH,gBAAJT,OAAI,kCAuIHA,K,qEClJXpT,EAAOD,QAFI,4lE,yECDX,mTAQaqZ,EAAmB,SAAnBA,iBAAoBC,EAAOC,GAEpC,IAAMvU,EAASuU,EAAYC,YACrBxU,EAAOkC,MAAMmJ,WAAarL,EAAOkC,MAAMmJ,YAAcA,aAAWC,IAEtE,IAEMmJ,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYC,IAE3B,IAAMvB,EAASgB,EAAMQ,cAAc,eAC7BxB,EAAOsB,UAAY,GAEzBG,yBAAe,GAAIN,EAASO,QAAS1B,GAErC,IAAM2B,EAAQ3B,EAAO4B,iBAAiB,uDAEnClV,EAAOkC,MAAMmJ,YACZ4J,EAAM7Q,SAAQ,SAAA+Q,GACV,IAAMC,EAAWD,EAAKE,cAAcjQ,GACjCH,WAAWmQ,EAAUpV,EAAOkC,MAAMmJ,WAAW3M,KAAI,SAAA2J,GAAK,OAAIA,EAAMjD,QAC/D+P,EAAKG,UAAUlU,IAhBC,2BAqB5BlC,YAAW,WACP,IAAMqW,EAAYjB,EAAMQ,cAAc,gBAClCS,GACDC,OAAKC,SAASF,EAAW,yBACxBA,EAAUT,cAAc,OAAOQ,UAAUlU,IAAI,uBAEnD,KAEFpB,EAAOkC,MAAMwT,YAAa,EAE1BT,EAAM7Q,SAAQ,SAAAuR,GACVA,EAASC,iBAAiB,SAAS,SAAAC,GAE/B7V,EAAOkC,MAAMwT,YAAa,EAE1B,IAAM7X,EAASgY,EAAMC,cACfV,EAAWvX,EAAOwX,cAAcjQ,GAChC2Q,EAAalY,EAAOwX,cAAcW,UAErChW,EAAOkC,MAAMmJ,WAAWtH,MAAK,SAAAsE,GAAK,OAAIA,EAAMjD,KAAOgQ,MAElC,UAAbA,GACCvX,EAAOiX,cAAc,OAAOQ,UAAU1R,OAAO,qBAE9C5D,EAAOkC,MAAMmJ,WAAW3R,OAAS,IAChCmE,EAAOyX,UAAU1R,OA9CL,wBA+CZ5D,EAAOkC,MAAMmJ,WAAarL,EAAOkC,MAAMmJ,WAAWxN,QAAO,SAAAwK,GAAK,OAAIA,EAAMjD,KAAOgQ,QAKnE,UAAbA,GACCvX,EAAOiX,cAAc,OAAOQ,UAAUlU,IAAI,qBAE9CvD,EAAOyX,UAAUlU,IAvDD,wBAyDhBpB,EAAOkC,MAAMmJ,WAAWrR,KACpB,CACIoL,GAAIgQ,EACJ7J,OAAQwK,KAKpBxB,EAAY0B,UAAUjW,GACtBuU,EAAY2B,SAAS,OAAQlW,SAIrCuU,EAAY2B,SAAS,QAErBxB,SAASI,cAAc,+BAA+BF,UAAY,kD,yEClFtE3Z,EAAOD,QAFI,mS,gFCDX,6FAEamb,EAAY,SAAZA,UAAanW,EAAQoW,GAAwB,IAEhDC,EAAS3B,SAASI,cAAc,gCAEhCwB,EAAkB,SAAlBA,kBAEF,OAAOF,GAEH,IAAK,UAEL,MAEA,IAAK,WAMEpW,EAAOkC,MAAMC,eACZkU,EAAOzB,UAA0C,UAA9B5U,EAAOkC,MAAMC,aAC1BnC,EAAOkC,MAAMqU,eACbvW,EAAOS,gBACHT,EAAOkC,MAAMsU,kBAG3B,MAEJ,IAAK,OAEDH,EAAOzB,UAAY,GACnB,IAAIK,EAAQ,GACTjV,EAAOkC,MAAMmJ,WAAW3R,OAAS,GAChCsG,EAAOkC,MAAMmJ,WAAWjH,SAAQ,SAAAiE,GAC5B,IAAM8M,EAAOsB,0BAAgBpO,EAAMjD,IACnC6P,GAASE,KAEbkB,EAAOzB,UAAYK,GAEnBoB,EAAOzB,UAAY,cAEvB,MAEJ,IAAK,OAEE5U,EAAOkC,MAAMwU,OAAOra,IACnBga,EAAOzB,UAAY5U,EAAOkC,MAAMwU,OAAOra,KAAO,GAE9Cga,EAAOzB,UAAY,KAMnC,OAAO0B,I,uFCvDX,qDAAO,IAAMK,EAAgB,SAAhBA,cAAiBC,EAAUC,EAAkBC,GAEtD,GAAIF,EAAJ,CAEA,IAAMhS,EAAQ,CAAEmS,SAA+B,SAArBF,EAA8B,QAAU,QAE9DG,EAAgBJ,EAAS9B,cAAc,OACvCmC,EAAWL,EAASvB,cAAcP,cAAc,aAChDoC,EAAYN,EAASvB,cAAcP,cAAc,cAE/CqC,EAAW,SAAXA,WAEF,OAAOvS,EAAMmS,UACT,IAAK,OACDC,EAAc3B,cAAcC,UAAUlU,IAAI,SAC1C4V,EAAc3B,cAAcC,UAAU1R,OAAO,QAC7CqT,EAAS3B,UAAU1R,OAAO,YAC1BsT,EAAU5B,UAAUlU,IAAI,YACxBwD,EAAMmS,SAAW,QACjB,MACJ,IAAK,QACDC,EAAc3B,cAAcC,UAAUlU,IAAI,QAC1C4V,EAAc3B,cAAcC,UAAU1R,OAAO,SAC7CqT,EAAS3B,UAAUlU,IAAI,YACvB8V,EAAU5B,UAAU1R,OAAO,YAC3BgB,EAAMmS,SAAW,OAGzBD,EAASlS,EAAMmS,WAGnBI,IAEAP,EAAShB,iBAAiB,SAAS,SAAAC,GAC/BsB,U,u8BCpBFC,E,WAEF,qBAAYhB,GAAM,Y,4GAAA,mBAEdiB,KAAKC,UAAY,GAEjBD,KAAKE,MAAQ,CACT,CAAEzJ,OAAQ,EAAG0J,MAAO,iBAAkB/P,YAAa,aAAcgQ,SAAU,GAAIC,UAAU,EAAMC,UAAU,kBACrGC,UAAW,CACP,CAAExS,GAAIjI,QAAM0a,YAAYC,SAASxc,KAAM8a,KAAM,YAC7C,CAAEhR,GAAIjI,QAAM0a,YAAYE,KAAKzc,KAAM8a,KAAM,YACzC,CAAEhR,GAAIjI,QAAM0a,YAAYG,OAAO1c,KAAM8a,KAAM,YAEnD,CAAEtI,OAAQ,EAAG0J,MAAO,iBAAkB/P,YAAa,WAAYgQ,SAAU,OAAQQ,SAAU,aAAcP,UAAU,EAAMC,UAAU,oBACnI,CAAE7J,OAAQ,EAAG0J,MAAO,iBAAkB/P,YAAa,SAAUgQ,SAAU,UAAWQ,SAAU,aAAcP,UAAU,EAAMC,UAAU,oBACpI,CAAE7J,OAAQ,EAAG0J,MAAO,iBAAkB/P,YAAa,OAAQgQ,SAAU,UAAWC,UAAU,EAAMC,UAAU,gBAC1G,CAAE7J,OAAQ,EAAG0J,MAAO,iBAAkB/P,YAAa,UAAWgQ,SAAU,aAAcC,UAAU,EAAMC,UAAU,mBAGpHN,KAAKa,YAAcb,KAAKE,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAEgT,QAAUsI,KAEpDiB,KAAK/C,MAAQI,SAASyD,eAAe,eAEjCd,KAAK/C,QAET+C,KAAKe,WAAaf,KAAK/C,MAAMQ,cAAc,0BAC3CuC,KAAKgB,oBAAsBhB,KAAK/C,MAAMQ,cAAc,8BACpDuC,KAAKiB,cAAgBjB,KAAK/C,MAAMY,iBAAiB,wCAEjDmC,KAAKkB,wBAA0BlB,KAAK/C,MAAMQ,cAAc,YACxDuC,KAAKmB,sBAAwBnB,KAAK/C,MAAMQ,cAAc,mBAEtDuC,KAAKoB,WAAapB,KAAK/C,MAAMQ,cAAc,qBAE3CuC,KAAKqB,oBAAsBrB,KAAK/C,MAAMQ,cAAc,aACpDuC,KAAKsB,kBAAoBtB,KAAK/C,MAAMQ,cAAc,oBAElDuC,KAAKiB,cAAclU,SAAQ,SAACwU,EAAGlY,GAC3BkY,EAAGhE,UAAY,EAAK2C,MAAM7W,GAAO+G,eAGrC4P,KAAKrX,OAASqX,KAAKrX,QAAUF,QAAMC,WAAWC,OAE9CqX,KAAK7C,UAAY,WACb,OAAO,EAAKxU,QAGhBqX,KAAKpB,UAAY,SAACjW,GACd,EAAKA,OAASA,EACdY,UAAQC,kBAAkBb,IAG9BqX,KAAKwB,eAAiB,WAClB,OAAO,EAAKX,aAGhBb,KAAKyB,eAAiB,SAAA1C,GAClB,EAAK8B,YAAc,EAAKX,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAEgT,SAAWsI,MAGzDiB,KAAK0B,KAAOjZ,QAAMC,WAAWgZ,M,6KAQlBtB,GAAU,WAErB,GAAIA,EAAJ,CAEA,IAAMnE,EAAS+D,KAAK/C,MAAMQ,cAAc,2BAClCxB,EAAOsB,UAAY,GACzB,IAAMH,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYoE,IAC3B,IAAMvR,EAAc4P,KAAKE,MAAMxT,MAAK,SAAAqS,GAAI,OAAIA,EAAKtI,SAAW,EAAKoK,YAAYpK,UAAQrG,YAErFsN,yBAAe,CAAE4C,UAAWF,EAASE,WAAalD,EAASO,QAAS1B,GAEpE,IAAM2F,EAAU5B,KAAK/C,MAAMQ,cAAc,oBAEzC,OAAOrN,GACH,IAAK,aACDwR,EAAQrE,UAAY,0CACpBsE,qCAA2B7B,MAC3B,MACJ,IAAK,WAED,OADA4B,EAAQrE,UAAY,yCACbyC,KAAK8B,QACR,KAAKhc,QAAM0a,YAAYC,SAASxc,KAC5B8d,yBAAe/B,KAAK/C,MAAO+C,MAC3B,MACJ,KAAKla,QAAM0a,YAAYE,KAAKzc,KACxB+d,yBAAehC,KAAK/C,MAAO+C,MAC3B,MACJ,KAAKla,QAAM0a,YAAYG,OAAO1c,KACP+b,KAAK/C,MAAMQ,cAAc,cAC3BQ,UAAUlU,IAAI,kBAC/BsT,SAASI,cAAc,6CAA6CQ,UAAUlU,IAAI,0BAClFkY,8BAAoB,CAChBC,UAAWlC,KAAK/C,MAChBtU,OAAQqX,KAAKrX,OACbiW,UAAWoB,KAAKpB,WACjBoB,KAAK/C,MAAMQ,cAAc,gBACduC,KAAK/C,MAAMQ,cAAc,oBAC3BF,UAAY,uBAGhC,MACJ,IAAK,OACDqE,EAAQrE,UAAY,0BACpBP,2BAAiBgD,KAAK/C,MAAO+C,MAC7B,MACJ,IAAK,UACDnY,YAAW,WACPsa,wBAAc,U,gDAMjB/B,EAAUgC,GAAuC,WAA5BN,EAA4B,uDAAnB,KAAMO,EAAa,uDAAN,KAepD,GAbArC,KAAKa,YAAcwB,GAAQrC,KAAKE,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAEgT,SAAW2J,KAE1D0B,IAAWhc,QAAM0a,YAAYG,OAAO1c,MAAsB,SAAdme,IAC3CpC,KAAKa,YAAcb,KAAKE,MAAM,IAGlCF,KAAKoC,UAAYA,EACjBpC,KAAK8B,OAASA,GAAU9B,KAAK8B,OAE1B9B,KAAKsC,cACJtC,KAAKa,YAAc,CAAEpK,OAAQ,IAG7BuJ,KAAKe,WAmBT,GAjBAf,KAAKe,WAAWpC,UAAYqB,KAAKa,YAAYV,MAC7CH,KAAKsB,kBAAkB/D,UAAYyC,KAAKa,YAAYT,SAEpDJ,KAAKiB,cAAclU,SAAQ,SAACwU,EAAGlY,GAI3B,GAFAkY,EAAGtD,UAAU1R,OAAO,UAEjBlD,EAAQ,IAAM,EAAKwX,YAAYpK,OAAQ,CACtC8K,EAAGtD,UAAUlU,IAAI,UACjB,IAAI,IAAI5H,EAAI,EAAGA,EAAIkH,EAAOlH,IACtB,EAAK8e,cAAc9e,GAAG8b,UAAUlU,IAAI,iBAKhDiW,KAAKuC,eAAevC,KAAKE,MAAMxT,MAAK,SAAAqS,GAAI,OAAIA,EAAKtI,SAAW,EAAKoK,YAAYpK,WAE9C,IAA5BuJ,KAAKa,YAAYpK,OAChBuJ,KAAKgB,oBAAoB/C,UAAU1R,OAAO,sBAC1CyT,KAAKoB,WAAWnD,UAAU1R,OAAO,kBACjCyT,KAAKmB,sBAAsBlD,UAAUlU,IAAI,kBACzCiW,KAAKkB,wBAAwBjD,UAAUlU,IAAI,wBAC3CiW,KAAKqB,oBAAoBpD,UAAUlU,IAAI,4BACpC,CACHiW,KAAKgB,oBAAoB/C,UAAUlU,IAAI,sBACvCiW,KAAKoB,WAAWnD,UAAUlU,IAAI,kBAC9BiW,KAAKkB,wBAAwBjD,UAAU1R,OAAO,wBAC9CyT,KAAKqB,oBAAoBpD,UAAU1R,OAAO,wBAC1CyT,KAAKqB,oBAAoBmB,QAAQ/L,OAASuJ,KAAKa,YAAYpK,OAC3DuJ,KAAKmB,sBAAsBlD,UAAU1R,OAAO,kBAC5C,IAAMkW,EAAyBzC,KAAKa,YAAYD,SACVZ,KAAKE,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAE2M,cAAgB,EAAKyQ,YAAYD,YACxDZ,KAAKE,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAEgT,SAAY,EAAKoK,YAAYpK,OAAS,KAG/D,IAAjCuJ,KAAKwB,iBAAiB/K,OACrBuJ,KAAKmB,sBAAsB5D,UAAYyC,KAAK8B,SAAWhc,QAAM0a,YAAYG,OAAO1c,KAC1E+b,KAAKE,MAAM,GAAG9P,YACd4P,KAAKE,MAAM,GAAG9P,YAEpB4P,KAAKmB,sBAAsB5D,UAAYkF,EAAuBrS,e,wCAKjEsS,EAAiB/Z,GACtBmW,oBAAUnW,GAAUqX,KAAK7C,YAAauF,EAAtC5D,O,eAIK6D,EAAqB,SAArBA,mBAAqB5D,GAE9B,IAAMlU,EAAQ,IAAIkV,EAAYhB,GAE9BlU,EAAM+X,aAAa7D,EAAM,QAczBlU,EAAMwW,oBAAoB9C,iBAAiB,SAZd,SAAvBsE,qBAAuBrE,GACzB3T,EAAMyX,YAAqE,IAAvDQ,SAASjY,EAAMwW,oBAAoBmB,QAAQ/L,QAC5D5L,EAAMyX,YACLzX,EAAMwW,oBAAoB0B,aAAa,eAAe,SAEtDlY,EAAMwW,oBAAoB2B,gBAAgB,gBAE9C,IAAMjE,EAAOlU,EAAMqV,MAAMxT,MAAK,SAAAqS,GAAI,OAAIA,EAAK3O,cAAgBvF,EAAM2W,iBAAiBpB,YAC/ErB,GAAMlU,EAAM+X,aAAa7D,EAAKtI,OAAQ,QACzC5L,EAAMoV,UAAUtd,KAAM,CAAEsgB,QAASpY,EAAMwW,oBAAqB6B,QAASL,0BAGC,GAgB1EhY,EAAMqW,wBAAwB3C,iBAAiB,SAdd,SAA3B4E,yBAA2B3E,GAE7B,IAAIoC,EAGAA,EADD/V,EAAM2W,kBAAsD,IAAlC3W,EAAM2W,iBAAiB/K,OACrC5L,EAAMiX,SAAWhc,QAAM0a,YAAYG,OAAO1c,KAAO,EAAI,EAErD4G,EAAM2W,iBAAiB/K,OAAS,EAG/C5L,EAAM+X,aAAahC,EAAU,WAAY/V,EAAMiX,QAC/CjX,EAAMoV,UAAUtd,KAAM,CAAEsgB,QAASpY,EAAMqW,wBAAyBgC,QAASC,8BAGK,GAElFtY,EAAMuY,4BAA8B,SAAA/O,GAChCgP,EAAsBtW,SAAQ,SAAAuW,GAAQ,OAAIA,EAASjP,MACnDgP,EAAsBE,QAIxBF,EAAwB,GAEjBG,EAAuB,SAAvBA,qBAAuBF,GAChCD,EAAsBE,MACtBF,EAAsB1gB,KAAK2gB,K,oECtP/B1f,EAAOD,QAFI,i7B,wECDX,gRAMaqe,EAAiB,SAAjBA,eAAkB/E,EAAOC,GAElC,IAAMvU,EAASuU,EAAYC,YAErBC,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAYkG,IAEU,UAA5B9a,EAAOkC,MAAMwU,OAAOra,MACc,SAA9B2D,EAAOkC,MAAMC,eACZnC,EAAOkC,MAAMC,aAAe,OAC5BoS,EAAY0B,UAAUjW,IAE1BuU,EAAY2B,SAAS,SAGzB,IAOI6E,EAPEzH,EAASgB,EAAMQ,cAAc,eAC7BxB,EAAOsB,UAAY,GAEzBG,yBAAe,GAAKN,EAASO,QAAS1B,GAEtCoB,SAASI,cAAc,wCAAwCF,WAAa,6FAI5E,IAAMmC,EAAyC,YAA9B/W,EAAOkC,MAAMwU,OAAOsE,MAAsB,OAAS,QAEhEC,EAAS,QAEPC,EAAoB5H,EAAOwB,cAAc,kBACzCoG,EAAkBC,QAOxBD,EAAkBtF,iBAAiB,YALF,SAA3BwF,yBAA2BC,GAC7BH,EAAkBI,oBAAoB,WAAYF,0BAClDL,EAAkBQ,2BAAiBL,EAAmBD,EAAQ,sCAAuC,OAKzGC,EAAkBtF,iBAAiB,SAAS,SAAAyF,GACxCA,EAAEG,oBAGNN,EAAkBtF,iBAAiB,SAAS,SAAAyF,GACxCA,EAAEG,eAAe,cAAeH,EAAEI,YAGtC/G,SAASyD,eAAe,YAAYvC,iBAAiB,UAAU,SAAAyF,GAC3DA,EAAEG,iBAC6B,KAA5BN,EAAkBnf,OACjB2f,EAAWpI,EAAQtT,EAAQuU,EAAawG,MAI7C/a,EAAOM,gBACN4a,EAAkBtF,iBAAiB,YAAY,SAAAyF,GACzB3G,SAASI,cAAc,0CAEjC5V,YAAW,WACPwc,EAAWpI,EAAQtT,EAAQuU,EAAawG,MAE5CM,EAAEG,qBAKlB,IAAM5E,EAAWtD,EAAOwB,cAAc,uBAetC6B,wBAAcC,EAAUG,GAbD,SAAjB4E,eAAiB5E,GAEnBkE,EAAsB,SAAblE,EAAsB,QAAU,WAEzC,IAAM/M,EAAoB,SAAb+M,EAAsB,eAAiB,kBAC9CiE,EAAqB,SAAbjE,EAAsB,UAAY,aAEhD/W,EAAOkC,MAAMwU,OAAO1M,KAAOA,EAC3BhK,EAAOkC,MAAMwU,OAAOsE,MAAQA,EAE5BzG,EAAY0B,UAAUjW,OAMxB0b,EAAa,SAAbA,WAAcpI,EAAQtT,EAAQuU,EAAawG,GAC7C,IAAMa,EAAQtI,EAAOwB,cAAc,kBAC/B9U,EAAO6b,iBACPD,EAAM7f,MAAQ,GACd6f,EAAMT,SAEV,IAAM9e,EAAMuf,EAAM7f,MACZqJ,EAAKwW,EAAMtgB,KACjB0E,EAAOkC,MAAMwU,OAAOra,IAAMA,EAC1B2D,EAAOkC,MAAMwU,OAAOtR,GAAKA,EACb,KAAR/I,IACA2D,EAAOkC,MAAMC,aAAe,OAC5BoS,EAAY0B,UAAUjW,GACtBuU,EAAY2B,SAAS,QACrB5C,EAAOwB,cAAc,kBAAkB/Y,MAAQ,M,mECrGvDd,EAAOD,QAFI,qmE,+zBCOJ,IAAMoe,EAAiB,SAAjBA,eAAkB9E,EAAOC,GAElC,IAAMvU,EAASuU,EAAYC,YAE3BD,EAAY2B,SAAS,YAErB,IACI6E,EADAxE,EAAgBvW,EAAOkC,MAAMqU,cAG3B9B,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYkH,IAC3B,IAAMxI,EAASgB,EAAMQ,cAAc,eAKnC,GAJMxB,EAAOsB,UAAY,GAEzB5U,EAAOkC,MAAM6Z,OAAOC,iBAAmBhc,EAAOkC,MAAM6Z,OAAOC,kBAAoBhc,EAAO+b,OAAOC,iBAE1Fhc,EAAOkC,MAAM6Z,OAAOC,iBAAkB,CAErC,IAAMC,EAASjc,EAAOkC,MAAM6Z,OAAOC,iBAAiBtd,KAAI,SAAAwd,GAAK,OAAIA,EAAM5gB,QACjE0gB,EAAmB,GAAH,OAAMC,EAAO,GAAb,YAAmBA,EAAOA,EAAOviB,OAAS,IAC1DyiB,EAAqBnc,EAAOkC,MAAMka,YAExCrH,yBAAe,CAAEiH,mBAAkBI,YAAaD,GAAsB1H,EAASO,QAAS1B,GAG5F,IAEM+I,EAAwB/H,EAAMQ,cAAc,wBA3BA,iHA8BlD,iBAAwCe,GAAxC,sGAEIA,EAAMyG,kBACND,EAAsBzH,UAAY,qBAHtC,SAIwB2H,mBAASvc,GAAQ,GAJzC,OAIUwc,EAJV,OAKIxc,EAAOkC,MAAMC,aAAe,UAC5BnC,EAAOwc,MAAQA,EACfxc,EAAOkC,MAAMsU,gBAAkBgG,EAAMC,aACrCJ,EAAsBzH,UAbC,4BAevBL,EAAY0B,UAAUjW,GACtBuU,EAAY2B,SAAS,YAXzB,wDA9BkD,sBA4B5CmG,EAAsBzH,UAHD,4BAmB3ByH,EAAsBzG,iBAAiB,SA5CW,SA8BnC8G,yBA9BmC,6DA8ClD,IAAMC,EAAqBrI,EAAMQ,cAAc,eACzC6H,EAAmBC,YAAc5c,EAAOS,gBACJ,6DACA,uCACpCkc,EAAmBxB,QAkBzBwB,EAAmB/G,iBAAiB,YAdF,SAA5BiH,yBAA4BxB,GAC9BsB,EAAmBrB,oBAAoB,WAAYuB,0BAEnD9B,EAAkBQ,2BAAiBoB,EAAoB,SAAU,iCAAkC,YAavGA,EAAmB/G,iBAAiB,SAAS,SAAAyF,GACzCA,EAAEG,oBAGNmB,EAAmB/G,iBAAiB,SAAS,SAAAyF,GACzCA,EAAEG,eAAe,cAAeH,EAAEI,YAGtC/G,SAASyD,eAAe,gBAAgBvC,iBAAiB,UAAU,SAAAyF,GAC/DA,EAAEG,iBAC8B,KAA7BmB,EAAmB5gB,OAClB+gB,EAAa9c,EAAQ2c,EAAoBpG,EAAehC,MAI7DvU,EAAOM,gBACNqc,EAAmB/G,iBAAiB,YAAY,SAAAyF,GAC1B3G,SAASI,cAAc,qCAEjC5V,YAAW,WACP4d,EAAa9c,EAAQ2c,EAAoBpG,EAAehC,MAE5D8G,EAAEG,qBAKlB,IAAIuB,EAAQ/c,EAAOkC,MAAM8a,aACnBC,EAAW3I,EAAMQ,cAAc,aAC/BmI,EAASrI,UAAT,iCAA+CmI,EAA/C,OAENzI,EAAMQ,cAAc,uBAAuB/Y,MAAQghB,EAEpCzI,EAAMQ,cAAc,uBAU5Bc,iBAAiB,UARF,SAAhBsH,aAAgBrH,GAClBkH,EAAQlH,EAAMsH,OAAOphB,MACrBiE,EAAOkC,MAAM8a,aAAeD,EAC5BE,EAASrI,UAAT,iCAA+CmI,EAA/C,OAEAxI,EAAY0B,UAAUjW,MAK1BuU,EAAYmE,oBAAoB9C,iBAAiB,SAAS,SAAAC,GACnDkF,GACCA,EAAgBqC,aAGxB,IAAMxG,EAAWtD,EAAOwB,cAAc,0BAqBhCiC,EAAwC,WAA7B/W,EAAOkC,MAAM6Z,OAAO/R,KAAoB,OAAS,QAElE2M,wBAAcC,EAAUG,GArBD,SAAjB4E,eAAiB5E,GAEnB,IAAM/W,EAASuU,EAAYC,YAErB6I,EAAcrd,EAAOkC,MAAM6Z,OAAO/R,KAGpChK,EAAOkC,MAAM6Z,OAAO/R,KADR,UAAb+M,EAC4B,WAEA,SAG/BxC,EAAY0B,UAAUjW,GAEnBA,EAAOkC,MAAM6Z,OAAO/R,OAASqT,GAC5B9I,EAAY2B,SAAS,aAQ7B,IAAMkG,EAAc1H,SAASI,cAAc,8BACrCsH,EAAYxG,iBAAiB,UAAU,SAAAyF,GACrC,IAAMrb,EAASuU,EAAYC,YACrBxU,EAAOkC,MAAMka,YAAcjC,SAASiC,EAAYrgB,OACtDwY,EAAY0B,UAAUjW,OAI5B8c,EAAe,SAAfA,aAAgB9c,EAAQ2c,EAAoBpG,EAAehC,GAE7D,IAAI+I,EAAeX,EAAmB5gB,MAClCwhB,EAAaZ,EAAmBrhB,KAEpC0E,EAAOkC,MAAMC,aAAe,UAC5BnC,EAAOkC,MAAMsa,MAAMlhB,KAAOgiB,EAC1Btd,EAAOkC,MAAMsU,gBAAkB8G,EAE/Btd,EAAOkC,MAAMC,aAAe,UAC5BnC,EAAOkC,MAAMsU,gBAAkB8G,EAgB/B,OAFAE,6BAAmBD,GAZF,SAAXzG,SAAW2G,GACb,GAAGA,GAAkBA,EAAe/jB,OAAS,EAAG,CAC5C,IAAMgkB,EAAMD,EAAe,GAAGE,SAASne,SAASke,MAC1CE,EAAOH,EAAe,GAAGE,SAASne,SAASqe,MACjD7d,EAAOkC,MAAM4b,YAAc,CAAEJ,MAAKE,QAElCjB,EAAmB5gB,MAAQ,GAE3BwY,EAAY0B,UAAUjW,GACtBuU,EAAY2B,SAAS,gBAKtBK,I,iFCxLXtb,EAAOD,QAFI,yoB,qFCDX,yRAMake,EAA6B,SAA7BA,2BAA6B3E,GAEvBA,EAAYD,MAAMQ,cAAc,4BAClCF,UAAY,yBAEzB,IAAMqE,EAAU,CACZ,CACIjR,KAAM,yBACN5C,GAAIjI,QAAM0a,YAAYC,SAASxc,MAEnC,CACI0M,KAAM,gCACN5C,GAAIjI,QAAM0a,YAAYE,KAAKzc,MAE/B,CACI0M,KAAM,4BACN5C,GAAIjI,QAAM0a,YAAYG,OAAO1c,OAI/BmZ,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYmJ,IAC3B,IAAMzK,EAASiB,EAAYD,MAAMQ,cAAc,eACzCxB,EAAOsB,UAAY,GAEzB,IAAM5U,EAASuU,EAAYC,YAE3BO,yBAAe,CAAEkE,WAAWxE,EAASO,QAAS1B,GAE9C,IAAM4G,EAAuB,SAAvBA,qBAAuBrE,GAEzB,IAAMsD,EAAStD,EAAMC,cAAc+D,QAAQV,OAErC6E,EADOzJ,EAAYgD,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAEgT,SAAWyG,EAAYsE,iBAAiB/K,UACzD8J,UAAU7T,MAAK,SAAAqS,GAAI,OAAIA,EAAKhR,KAAO+T,KAAQ/C,KAC/DqB,EAAWlD,EAAYgD,MAAMxT,MAAK,SAAAjJ,GAAC,OAAIA,EAAE2M,cAAgBuW,KAE/DzJ,EAAYoF,aAAc,EAC1BpF,EAAY0F,aAAa1F,EAAYsE,iBAAiB/K,OAAS,EAAG,OAAQqL,EAAQ1B,GAClFlD,EAAY+C,UAAY,GACxB/C,EAAY+C,UAAUtd,KAAM,CAAEsgB,QAAS/F,EAAYmE,oBAAqB6B,QAASL,wBAG/DxF,SAASQ,iBAAiB,kCAElC9Q,SAAQ,SAAC+U,EAAQzY,GAC3ByY,EAAOvD,iBAAiB,QAASsE,GAAsB,MAG3D+D,yBAAeje,EAAQ0U,SAASI,cAAc,qCAAqC,SAAC9U,GAChFuU,EAAY0B,UAAUjW,MAG1B,IAAMke,EAAU3J,EAAYD,MAAMQ,cAAc,2BAE7CP,EAAYwE,MACXmF,EAAQ5I,UAAUlU,IAAI,oB,yEC1D9BnG,EAAOD,QAFI,oe,2yDCaJ,IAAMwe,EAAgB,SAAhBA,cAAgBjF,GAAe,IAEhCvU,EAA0BuU,EAA1BvU,OAAQsU,EAAkBC,EAAlBD,MAAO6E,EAAW5E,EAAX4E,OACf9Y,EAAgBP,QAAMC,WAAtBM,YAEFoU,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYuJ,IAE3B,IAAM7K,EAASgB,EAAMQ,cAAc,2BAEnCC,yBAAe,GAAKN,EAASO,QAAS1B,GAEtC,IAAM8K,EAAW1J,SAASI,cAAc,wBAEpCuJ,EAAQ,EAENC,EAAWC,aAAY,WAC3BF,EAAQA,IAAUre,EAAOkC,MAAMmJ,WAAW3R,OAAS,EAAI2kB,EACvDD,EAASxJ,UAAT,mBAAiC5U,EAAOkC,MAAMmJ,WAAWgT,GAAO9S,OAAhE,uBACA8S,MACC,KAEG3F,EAAsBpE,EAAMQ,cAAc,aAC1C0J,EAAgB9F,EAAoB5D,cAAc,KAClD0J,EAAclJ,UAAUlU,IAAI,iBAElC,IACMqd,EADOnK,EAAMQ,cAAc,8BACPA,cAAc,KAClC2J,EAAanJ,UAAUlU,IAAI,iBAEjC,IAAMsd,EAAsB,SAAtBA,oBAAsBhT,GAE1B,IAEE,GAAGA,GAAcA,EAAWK,OAAqC,IAA5BL,EAAWK,MAAMrS,OAElD,YADA0kB,EAASxJ,UAAY,wDAIzB+J,aAAaL,GAEb7J,EAASG,UAAYgK,IAErBR,EAASxJ,UAAY,GAErBlJ,EAAWmT,KAAOnT,EAAWxJ,MAAMmJ,WAAW3M,KAAI,SAAA2J,GAAK,OAAIA,EAAMkD,UAAQ9M,KAAK,MAE9EsW,yBAAe,CAAErJ,cAAc+I,EAASO,QAASoJ,GAEpC9J,EAAMQ,cAAc,WACtBQ,UAAU1R,OAAO,aAE5B1E,YAAW,WACTwZ,EAAoB9C,iBAAiB,SAAS,SAAAyF,GACxCnc,WAAU,2CAAE,gHAELc,EAAOkC,MAAMuP,QAFR,uBAIJ/F,EAAWK,MAAQL,EAAWK,MAAMlO,QAAO,SAAAT,GACvC,OAAO6H,WAAW7H,EAAK9B,KAAM0E,EAAOkC,MAAMuP,QAAQ/S,KAAI,SAAAgT,GAAE,OAAIA,EAAGpW,YAL/D,SAQEwjB,qBAAmBC,cAAc,CACnCC,YAAa7hB,QAAM8hB,YAAYC,0BAC/BC,YAAa,CACTC,cAAepf,EAAQmU,kBAAmBzI,KAX9C,OAgB4C,IAAjDyO,SAASzB,EAAoBmB,QAAQ/L,UACpCyG,EAAYkG,4BAA4B/O,GACxC3G,oBAAkBsa,cAlBd,6DAwBpB7H,EAAM5C,UAAY,yBAElB,IAAM0K,EAAchL,EAAMQ,cAAc,oBAClCwK,EAAY1J,iBAAiB,SAAS,SAAAyF,GACpC,IAAMkE,EAAyBjL,EAAMQ,cAAc,kCAC7CyK,EAAuBjK,UAAUlU,IAAI,QACrCme,EAAuBjK,UAAU1R,OAAO,kBACxC2b,EAAuB3K,UAAY,GACnC0K,EAAYhK,UAAUlU,IAAI,kBAEhCoe,+BAAqBxf,EAAQsU,EAAOiL,EAAwBhL,EAAa7I,EAAWK,OAKpF,IAAM0T,EAAyBnL,EAAMQ,cAAc,6BAC7C2K,EAAuBnK,UAAU1R,OAAO,kBACxC6b,EAAuB7J,iBAAiB,YAAY,SAAAyF,GAChD,IAAM/f,EAAO+f,EAAE8B,OAAOphB,MAItBiE,EAAOkC,MAAM5G,KAAOA,EACpBoQ,EAAWpQ,KAAQA,EACnBwjB,qBAAmBC,cAAe,CAAEC,YAAa7hB,QAAM8hB,YAAYS,kBAAmBP,YAAa,CAAEzT,aAAY1L,kBAKnIwe,EAAclJ,UAAU1R,OAAO,iBAC/B6a,EAAanJ,UAAU1R,OAAO,iBAE5B,MAAMyX,GACNnK,mBAASwN,oBAAqBrD,KAI9BsE,EAAU,4DAAG,kBAAMC,GAAN,iHAET1f,EAAU,CACZQ,MAAO,EACPC,gBAAgB,GAJL,SAOMme,qBAAmBC,cAAc,CAClDC,YAAa7hB,QAAM8hB,YAAYY,oBAC/BV,YAAa,CACTS,mBACAE,eAAgB5f,EAChBgC,MAAOqS,EAAYC,YAAYtS,SAZxB,OAOT4M,EAPS,QAgBTpD,EAAaoD,EAAOpD,YACTxJ,MAAQlC,EAAOkC,MAC1BwJ,EAAWqU,WAAY,EAE7BrB,EAAoBhT,GAEdsU,EAAkB,SAAlBA,gBAAkBxmB,GACxB,IAAIkB,EAAIlB,EAAI,GACRymB,EAAIzmB,EAAI,IACZ,OAAS,GAALkB,GAAe,IAALulB,EACHzmB,EAAI,KAEN,GAALkB,GAAe,IAALulB,EACHzmB,EAAI,KAEN,GAALkB,GAAe,IAALulB,EACHzmB,EAAI,KAERA,EAAI,MAKLsd,EAAW,SAAXA,SAAWoJ,GACV9B,EACCA,EAASxJ,UAAT,iBAA+BoL,EAAgBE,EAAQC,MAAvD,uBAA2ED,EAAQE,kBAEnF3c,EAAYqT,WAIpBrT,EAAc4c,+BAAqBvJ,GA/CpB,wDAAH,gBAAV6I,WAAU,sCAoDhB,OAFA3f,EAAOkC,MAAMoe,UAAYnH,EAElBA,GAEH,KAAKhc,QAAM0a,YAAYC,SAASxc,KAC5BqkB,EAAW,cAAD,iBACHtf,EAAY0D,MAAK,SAAA3I,GAAC,OAAIA,EAAEklB,YAAcnH,MADnC,IAEN7d,KAAM0E,EAAOkC,MAAMsa,MAAMlhB,KACzBujB,KAAM7e,EAAOkC,MAAMmJ,WAAW3M,KAAI,SAAAlF,GAAC,OAAIA,EAAE+R,UAAQ9M,KAAK,MACtDyD,MAAOlC,EAAOkC,MACdqe,SAAUvgB,EAAOugB,SACjBnb,GAAI/E,EAAY3G,OAAS,UAE7B,MAEJ,KAAKyD,QAAM0a,YAAYE,KAAKzc,KACxBqkB,EAAW,cAAD,iBACHtf,EAAY0D,MAAK,SAAA3I,GAAC,OAAIA,EAAEklB,YAAcnH,MADnC,IAEN7d,KAAM,GAAF,OAAK0E,EAAOkC,MAAMwU,OAAOra,IAAzB,mBACJwiB,KAAM7e,EAAOkC,MAAMmJ,WAAW3M,KAAI,SAAAlF,GAAC,OAAIA,EAAE+R,UAAQ9M,KAAK,MACtD4M,WAAYrL,EAAOkC,MAAMmJ,WACzBjG,GAAI/E,EAAY3G,OAAS,OAE7B,MAEJ,KAAKyD,QAAM0a,YAAYG,OAAO1c,MAEV,4DAAG,+HAEQwE,QAAMC,WAArB2L,EAFO,EAEPA,WAEJ8U,GAAqB,EAEtB9U,EAAWK,QACVyU,EAAqB9U,EAAWK,MAAMrN,KAAI,SAAAlF,GAAC,OAAIA,EAAE8B,QAAMmlB,OAAM,SAAAC,GAAG,OAAI1gB,EAAOkC,MAAMuP,QAAQ/S,KAAI,SAAA5D,GAAC,OAAIA,EAAEQ,QAAMqlB,SAASD,QAKpHF,EAZY,uBAaXZ,EAAmBlU,EAbR,SAcLoT,qBAAmBC,cAAc,CACnCC,YAAa7hB,QAAM8hB,YAAYC,0BAC/BC,YAAa,CACTC,cAAepf,EAAQmU,kBAAmByL,KAjBvC,8BAqBXA,EAAmB,cAAH,iBACTvf,EAAY0D,MAAK,SAAA3I,GAAC,OAAIA,EAAEklB,YAAcnH,MAD7B,IAEZ1H,QAASzR,EAAOkC,MAAMuP,QACtBrM,GAAI/E,EAAY3G,OAAS,MACzB4B,KAAM,kBACNslB,UAAU,EACVC,MAAO,GACP3S,MAAO,KA5BA,QAgCfyR,EAAWC,GAhCI,wDAAH,gBAAVkB,aAAU,mCAmChBA,GAKT,IAAMtJ,EAAQlD,EAAMQ,cAAc,oBAC5B0C,EAAM5C,UAAY,yC,0ECpP3B3Z,EAAOD,QAFI,g5B,oDCAX,IAAIga,EAAU,EAAQ,2EAEA,iBAAZA,IAAsBA,EAAU,CAAC,CAAC/Z,EAAOzB,EAAIwb,EAAS,MAOhE,IAAIiE,EAAU,CAAC,KAAM,EAErB,eAPI8H,EAQJ,gBAAqBzjB,GAER,EAAQ,+CAAR,CAAgE0X,EAASiE,GAEnFjE,EAAQgM,SAAQ/lB,EAAOD,QAAUga,EAAQgM,S,8CChB5C,IAAIhM,EAAU,EAAQ,qEAEA,iBAAZA,IAAsBA,EAAU,CAAC,CAAC/Z,EAAOzB,EAAIwb,EAAS,MAOhE,IAAIiE,EAAU,CAAC,KAAM,EAErB,eAPI8H,EAQJ,gBAAqBzjB,GAER,EAAQ,+CAAR,CAAgE0X,EAASiE,GAEnFjE,EAAQgM,SAAQ/lB,EAAOD,QAAUga,EAAQgM,S,gDChB5C,IAAIhM,EAAU,EAAQ,uEAEA,iBAAZA,IAAsBA,EAAU,CAAC,CAAC/Z,EAAOzB,EAAIwb,EAAS,MAOhE,IAAIiE,EAAU,CAAC,KAAM,EAErB,eAPI8H,EAQJ,gBAAqBzjB,GAER,EAAQ,+CAAR,CAAgE0X,EAASiE,GAEnFjE,EAAQgM,SAAQ/lB,EAAOD,QAAUga,EAAQgM,S,yDCd5C/lB,EAAOD,QAFI,4M,4DCDX,4GAGaqG,EAAgB,SAAhBA,cAAgBqK,GAEzB6H,MAAI0N,cAAcrM,UAAY,mBAC9BrB,MAAI2N,eAAetM,UAAY,mBAE/B1V,YAAW,WAAM,MAEkBY,QAAMC,WAA7BkD,EAFK,EAELA,OAAQ7C,EAFH,EAEGA,WACV+gB,EAAczM,SAASI,cAAc,2BAE3C,GAAG1U,EAAY,CAEX,IAAM2T,EAAgB3T,EAAWsF,QAAQ7H,QAAO,SAAAoF,GAAM,MAAoB,SAAhBA,EAAO+G,QAAiBtQ,OAElFynB,EAAYC,IAAMrN,EAClBoN,EAAYplB,MAAQkH,EAAOoQ,oBAAsB8N,EAAYplB,Y,yDCfzEd,EAAOD,QAFI,sW,6DCDX,uQAOaqmB,EAAuB,SAAvBA,uBAA6B,IAE9BrhB,EAAWF,QAAMC,WAAjBC,OAEFsT,EAASoB,SAASI,cAAc,8BAChCxB,EAAOsB,UAAY,GAEzB,IAAMH,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY0M,IAE3BvM,yBAAe,GAAKN,EAASO,QAAS1B,GAEtCoB,SAASI,cAAc,2CAA2CF,UAAY,sBAE9EqJ,yBAAeje,EAAQ0U,SAASI,cAAc,qCAAqC,SAAC9U,GAChFY,QAAQC,kBAAkBb,Q,sDCnBlC/E,EAAOD,QAFI,s/B,0DCDX,4TAOaumB,EAAc,SAAdA,YAAcxI,GAEvB,IAAMlZ,EAAOD,SAASC,OAEtB6U,SAASI,cAAc,8BAA8BF,UAAY,GAEjE,IAAMH,EAAWC,SAASC,cAAc,YAExC,GAAGoE,EAAM,CAELtE,EAASG,UAAY4M,IAErBzM,yBAAe,CAAE0M,MAAO1I,EAAK0I,OAAShN,EAASO,QAASN,SAASI,cAAc,+BAE/EJ,SAASI,cAAc,2CAA2CF,UAAY,oBAE9E,IAAM8M,EAAShN,SAASI,cAAc,oBAEtC5V,YAAW,WAEMwV,SAASI,cAAc,gBACzBc,iBAAiB,UAAU,SAAAyF,GAElCA,EAAEG,iBAEF,IAAMmG,EAASjN,SAASI,cAAc,kBAChC6M,EAAOvH,aAAa,WAAY,YAEpCva,EAAK+hB,UACJC,MAAK,WACJjhB,UAAQkhB,gBAAgB,MACxBH,EAAO/M,UAAY,UACnB1V,YAAW,WACPwiB,EAAOK,UACR,cAIZ,SAGA,CAEHtN,EAASG,UAAYoN,IAErBjN,yBAAe,GAAKN,EAASO,QAASN,SAASI,cAAc,+BAE7DJ,SAASI,cAAc,2CAA2CF,UAAY,mBAE9E,IAAM8M,EAAShN,SAASI,cAAc,oBAEtC5V,YAAW,WAEP,IAAMuiB,EAAQ/M,SAASI,cAAc,gBAC/B2M,EAAMtG,QAEZ,IAAM8G,EAAWvN,SAASI,cAAc,mBAE3BJ,SAASI,cAAc,eACzBc,iBAAiB,UAAU,SAAAyF,GAE9BA,EAAEG,iBAEF,IAAM0G,EAAQxN,SAASI,cAAc,iBAC/BoN,EAAM9H,aAAa,WAAY,YAErCva,EAAKsiB,2BAA2BV,EAAM1lB,MAAOkmB,EAASlmB,OACrD8lB,MAAK,SAACO,GACHxhB,UAAQkhB,gBAAgB,CACpBL,MAAOA,EAAM1lB,MACbkmB,SAAUA,EAASlmB,QAEvBmmB,EAAMtN,UAAY,UAClB1V,YAAW,WACPwiB,EAAOK,UACR,SATP,OAWQ,SAAAM,GACJ,IAAMC,EAAc5N,SAASI,cAAc,qBAClCwN,GAAaA,EAAYhN,UAAU1R,OAAO,kBAC1C0e,IAAaA,EAAYxN,cAAc,eAAeF,UAAYyN,EAAME,iBAI9F,OAKE/gB,EAAiB,SAAjBA,eAAiBuX,GAE1B,GAAGA,EAAM,CACL,IAAMyJ,EAAW9N,SAASI,cAAc,iBAC/B0N,GAAUA,EAASlN,UAAU1R,OAAO,sBAC1C,CACH,IAAM0e,EAAc5N,SAASI,cAAc,qBAClCwN,GAAaA,EAAYhN,UAAU1R,OAAO,kBACnD,IAAM6e,EAAY/N,SAASI,cAAc,kBAChC2N,GAAWA,EAAUnN,UAAU1R,OAAO,qB,uDCtGvD3I,EAAOD,QAFI,2kB,gECEXC,EAAOD,QAFI,2lB,oECEXC,EAAOD,QAFI,utC,iECEXC,EAAOD,QAFI,o9B,wiCCkBX,IAAM0nB,EAAuB,GAEhBC,EAAyB,SAAzBA,uBAAyBhI,GAClC+H,EAAqB9H,MACrB8H,EAAqB1oB,KAAK2gB,IAGjBrZ,EAAmB,SAAnBA,iBAAmBoK,GAAc,IAMtC4H,EANsC,EAEdxT,QAAMC,WAA1BC,EAFkC,EAElCA,OAAQE,EAF0B,EAE1BA,QAEVuU,EAAWC,SAASC,cAAc,YAIrC3U,EAAOM,gBACNmU,EAASG,UAAYgO,KACrBtP,EAASoB,SAASI,cAAc,kCACzBF,UAAY,GACnBG,yBAAe,GAAKN,EAASO,QAAS1B,KAEtCmB,EAASG,UAAYiO,KACrBvP,EAASoB,SAASI,cAAc,kCACzBF,UAAY,GACnBG,yBAAe,GAAKN,EAASO,QAAS1B,GACtCmB,EAASG,UAAYkO,KACrBxP,EAASoB,SAASI,cAAc,mCACzBF,UAAY,GACnBG,yBAAe,GAAKN,EAASO,QAAS1B,IAG1C,IAAMyP,EAAYrO,SAASQ,iBAAiB,uBAE5C6N,EAAS3e,SAAQ,SAAA+Q,GAEbA,EAAKS,iBAAiB,QAAtB,iB,oRAAA,0BAA+B,iBAAMC,GAAN,6GAEjBmN,EAAcnN,EAAMC,cAFH,EAIQhW,QAAMC,WAA7B2L,EAJe,EAIfA,WAJe,EAIH1L,OAEdijB,EAAkB,SAAlBA,gBAAkBD,GACpBA,EAAY1N,UAAUlU,IAAI,eAC1BlC,YAAW,WACP8jB,EAAY1N,UAAU1R,OAAO,iBAC9B,MAVgB,KAehBzG,QAAM+lB,WAAWC,YAAYH,EAAY5d,IAfzB,cAgBdjI,QAAM+lB,WAAWE,eAhBH,SAsBdjmB,QAAM+lB,WAAWG,SAtBH,SA0BdlmB,QAAM+lB,WAAWI,cA1BH,UAqCdnmB,QAAM+lB,WAAWK,SArCH,UA6CdpmB,QAAM+lB,WAAWM,MA7CH,UAgDdrmB,QAAM+lB,WAAWO,MAhDH,UAmDdtmB,QAAM+lB,WAAWQ,SAnDH,0BAiBMze,WAAW,cAAe+d,EAAY1N,YAEvD0N,EAAY1N,UAAUlU,IAAI,eAnBf,mCAuBf6hB,EAAgBD,GAChBW,4BAxBe,oCA2BfjB,EAAqBte,SAAQ,SAAAuW,GAAQ,OAAIA,QACnCiJ,EAAiBlP,SAASI,cAAc,0BAC3B8O,EAAetO,UAAU1R,OAAO,eACnDof,EAAY1N,UAAUlU,IAAI,eAC1BD,eAAa6C,UAAU,UAAUI,SAAQ,SAAAP,GAAG,OAAI1C,eAAayC,OAAOC,MA/BrD,UAgCAib,qBAAmBC,cAAc,CAAEC,YAAa7hB,QAAM8hB,YAAY4E,eAhClE,sBAiCfC,0BACAvQ,MAAI2N,eAAetM,UAAY,mBAC/BrB,MAAIwQ,oBAAoBnP,UAAY,GAnCrB,oCAsCfqO,EAAgBD,GAtCD,EAuCMljB,QAAMC,WAAnBsC,EAvCO,EAuCPA,SACFsG,EAAgB+C,EAAWrJ,SAC3BA,EAASxE,QAAO,SAAAmQ,GAAU,OAAI/I,WAAW+I,EAAW3F,MAAOqD,EAAWrJ,aACtEA,EACN2hB,oBAAkBrb,YAAYA,GA3Cf,oCA8Cfsa,EAAgBD,GA9CD,oCAiDfzB,sBAAYzhB,QAAMC,WAAWgZ,MAjDd,6BAoDfsI,iCApDe,yFAA/B,2DA2DgB,SAAd4C,YAAejkB,EAAQE,GAEzB,IAAGF,EAAOM,gBAA2C,IAAzBN,EAAO0L,WAAWtG,IAAalF,EAAQgkB,mBAKnE,GAAGhkB,EAAQS,gBAEP,GAAGX,EAAOM,eAAgB,CACtB,IAAM8E,EAAKjI,QAAM+lB,WAAWI,cAAchoB,KACtC6Z,EAAOT,SAASyD,eAAe/S,GAC7B+e,GAAiB/kB,gBAAcglB,sBAElChf,IAAOjI,QAAM+lB,WAAWE,eAAe9nB,MAAS8J,IAAOjI,QAAM+lB,WAAWI,cAAchoB,MAAQ6oB,IAC7FhP,EAAKG,UAAUlU,IAAI,qBAI3B2hB,EAAS3e,SAAQ,SAAA+Q,GAAI,OAAIA,EAAKG,UAAU1R,OAAO,uBAhB/Cmf,EAAS3e,SAAQ,SAAA+Q,GAAI,OAAIA,EAAKG,UAAU1R,OAAO,kBAoBvDqgB,CAAYjkB,EAAQE,IAGXqB,EAAqB,SAArBA,mBAAqBwX,M,sDCxIlC9d,EAAOD,QAFI,6Z,+RCMJ,IAAM6G,EAAc,SAAdA,YAAcoI,GAAS,MAEoCnK,QAAMC,WAA7CC,GAFG,EAExBuJ,QAFwB,EAEfmC,WAFe,EAEH1L,QAAQiD,EAFL,EAEKA,OAFL,EAEa6L,OAFb,EAEqB1O,YAErD6J,EAAMhO,KAAO+D,EAAO/D,KAEhBgH,KAEDgH,EAAMoa,QAAUphB,EAAO0Q,iBACtB/S,UAAQ0jB,mBAAmBra,M,yDCbnChP,EAAOD,QAFI,uiC,6DCDX,wVAUa2oB,EAAkB,SAAlBA,kBAEXjP,SAASI,cAAc,8BAA8BF,UAAY,GAE/D,IAAMH,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAY2P,IAErB7P,SAASI,cAAc,2CAA2CF,UAAY,sBAR7C,IAUzB5U,EAAWF,QAAMC,WAAjBC,OAEFwkB,EAAQxkB,EAAOykB,aAAa,IAE5BC,EAAY1kB,EAAO0kB,UAEzB3P,yBAAe,CAAEyP,QAAOE,aAAajQ,EAASO,QAASN,SAASI,cAAc,+BAE9E,IAAM6P,EAAgBjQ,SAASI,cAAc,uBACvC8P,EAAclQ,SAASI,cAAc,qBACrC+P,EAAgBnQ,SAASI,cAAc,uBACvCgQ,EAAWpQ,SAASI,cAAc,kBAExCJ,SAASI,cAAc,2BAA2BQ,UAAU1R,OAAO,gBAEnEkhB,EAASlQ,UAAY,+BACK4P,EADK,IAAVA,EAAA,wBAIrBG,EAAc/O,iBAAiB,SAAS,WACpC+O,EAAc3O,UAAY,kBAC1B9W,YAAW,WACPI,YAAUC,QACVolB,EAAc3O,UAAY,gBAC1B5W,gBAAc2lB,+BACd7lB,YAAW,WACPA,YAAW,WACPpC,OAAO0C,SAASC,QAAO,KACxB,OACJ,OACJ,QAGPmlB,EAAYhP,iBAAiB,SAAS,WAClCgP,EAAYhQ,UAAY,iBACxB1V,YAAW,WACP,IAAMslB,EAAQK,EAAc9oB,MAC5BiE,EAAOykB,aAAuB,IAARD,EACtB5jB,UAAQC,kBAAkBb,GAC1B4kB,EAAYhQ,UAAY,YACxBkQ,EAASlQ,UAAY,2BACK4P,EADK,MAAVA,EAAA,0BAGtB,QAGPvG,yBAAeje,EAAQ0U,SAASI,cAAc,qCAAqC,SAAC9U,GAChFY,UAAQC,kBAAkBb,Q,yiCCjElC,IAeMyV,EAAW,SAAXA,SAAYD,EAAMmC,GACpB,IAAInC,EAAM,OAAO,EACjB,IAAMwP,EAAa,mBAAKxP,EAAKF,WAC7B,OAAOrQ,WAAW0S,EAAWqN,IAapBxP,EAAO,CAChByP,KAhCS,SAAPA,KAAQzP,GACNA,GACPA,EAAKF,UAAUlU,IAAI,eA8BV8jB,KA3BG,SAAPA,KAAQ1P,GACNA,GACPA,EAAKF,UAAU1R,OAAO,eAyBPuhB,OAtBD,SAATA,OAAU3P,GACRA,GACPA,EAAKF,UAAU6P,OAAO,eAoBC1P,WAAU2P,YAXd,SAAdA,YAAe5P,EAAMmC,GACpBlC,EAASD,EAAMmC,IACdnC,EAAKF,UAAUlR,SAAQ,SAAAhJ,GAChBA,IAAMuc,GACLnC,EAAKF,UAAU1R,OAAOxI,S,kEC3BtC,qDAEA,IAKIiqB,EAFEC,EAAS,gBA+CFlmB,EAAgB,CACzBmmB,0BA5C8B,SAA5BA,4BACF,IAAIC,GAAe,EAOnB,OANI9Q,SAAS2Q,OAAOI,QATL,cAS2B,GACxCJ,EAAS,GAAH,OAVO,aAUP,mBAA2BC,GACjC5Q,SAAS2Q,OAASA,GAEhBG,GAAe,EAEZA,GAqCPpB,mBAXuB,SAArBA,qBACF,OAAkC,OAA3BsB,EA1CQ,eAqDfX,6BARiC,SAA/BA,+BACJM,EAAS,GAAH,OA9CW,aA8CX,wDAAgEC,GACtE5Q,SAAS2Q,OAASA,GAOhB3lB,qBApCyB,SAAvBA,qBAAuBimB,GACrBjR,SAAS2Q,OAAOI,QAlBH,gBAkB2B,GAC1CJ,EAAS,GAAH,OAnBS,eAmBT,YAAsBM,EAAtB,aAA+BL,GACrC5Q,SAAS2Q,OAASA,GAEhBO,EAAeD,IAgCnBtmB,uBA5B2B,SAAzBA,yBACF,IAAMwmB,EAAcH,EA3BH,gBA6BjB,IAAIG,EAAa,OAAO,EAExB,IAAMC,EAAW9V,KAAK+V,IAAI,IAAIpmB,KAAS,IAAIA,KAAKkmB,IAE1CG,EADWhW,KAAKiW,KAAKH,EAAW,OA/BpB,EAoClB,OAHGE,GACCJ,EAAejmB,QAEZqmB,IAoBLN,EAAa,SAAbA,WAAapqB,GAGlB,IAFA,IAAI4qB,EAAS5qB,EAAO,IAChB6qB,EAAKzR,SAAS2Q,OAAOe,MAAM,KACvB5sB,EAAE,EAAEA,EAAI2sB,EAAGzsB,OAAOF,IAAK,CAE9B,IADA,IAAI4B,EAAI+qB,EAAG3sB,GACS,KAAb4B,EAAEirB,OAAO,IAASjrB,EAAIA,EAAEkrB,UAAU,EAAElrB,EAAE1B,QAC7C,GAA0B,IAAtB0B,EAAEqqB,QAAQS,GAAe,OAAO9qB,EAAEkrB,UAAUJ,EAAOxsB,OAAO0B,EAAE1B,QAEjE,OAAO,MAGFksB,EAAiB,SAAjBA,eAAiBD,GACnB,IACMY,EADc7R,SAAS2Q,OAAOmB,QAAQ,mDAAoD,MAC9D,GAAH,OAtEd,eAsEc,YAAsBb,EAAtB,KAC/BN,EAAS,GAAH,OAAMkB,EAAN,aAAsBjB,GAC5B5Q,SAAS2Q,OAASA,I,oEC3EtB,ouCAqBMoB,EAAY,CACd,CAAEnrB,KAAM,2BAA4BkJ,KAAMkiB,wCAC1C,CAAEprB,KAAM,2BAA4BkJ,KAAMmiB,mCAC1C,CAAErrB,KAAM,aAAckJ,KAAMoiB,mBAE5B,CAAEtrB,KAAM,eAAgBkJ,KAAMqiB,cAC9B,CAAEvrB,KAAM,sBAAuBkJ,KAAMsiB,qBACrC,CAAExrB,KAAM,sBAAuBkJ,KAAMsiB,qBACrC,CAAExrB,KAAM,yBAA0BkJ,KAAMsiB,qBACxC,CAAExrB,KAAM,UAAWkJ,KAAMuiB,iBACzB,CAAEzrB,KAAM,UAAWkJ,KAAMwiB,iBACzB,CAAE1rB,KAAM,UAAWkJ,KAAMsiB,qBACzB,CAAExrB,KAAM,aAAckJ,KAAMyiB,mBAC5B,CAAE3rB,KAAM,SAAUkJ,KAAMsiB,qBACxB,CAAExrB,KAAM,gBAAiBkJ,KAAMsiB,qBAC/B,CAAExrB,KAAM,aAAckJ,KAAM0iB,mBAC5B,CAAE5rB,KAAM,iBAAkBkJ,KAAM2iB,sBAChC,CAAE7rB,KAAM,gBAAiBkJ,KAAM4iB,sBAC/B,CAAE9rB,KAAM,gBAAiBkJ,KAAM6iB,sBAC/B,CAAE/rB,KAAM,eAAgBkJ,KAAMsiB,qBAC9B,CAAExrB,KAAM,eAAgBkJ,KAAM8iB,4BAC9B,CAAEhsB,KAAM,iBAAkBkJ,KAAMyiB,mBAChC,CAAE3rB,KAAM,qBAAsBkJ,KAAMyiB,mBACpC,CAAE3rB,KAAM,qBAAsBkJ,KAAMsiB,qBAEpC,CAAExrB,KAAM,0BAA2BkJ,KAAM+iB,+BACzC,CAAEjsB,KAAM,wBAAyBkJ,KAAM+iB,+BAGvC,CAAEjsB,KAAM,WAAYkJ,KAAMyiB,mBAC1B,CAAE3rB,KAAM,gBAAiBkJ,KAAMgjB,sBAG/B,CAAElsB,KAAM,uBAAwBkJ,KAAMijB,4BAEtC,CAAEnsB,KAAM,sCAAuCkJ,KAAMkjB,2BAG5CjjB,EAAa,SAAbA,WAAanJ,GACtB,IAAMqsB,EAAQlB,EAAU1iB,MAAK,SAAAS,GAAI,OAAIA,EAAKlJ,OAASA,KAEnD,OADaqsB,EAAQA,EAAMnjB,KAAO,O,kpBCvD/B,IAAM+W,EAAmB,SAAnBA,iBAAoBK,EAAO5R,EAAM2N,EAAWiQ,GAAO,qGAI5D,iBAAkC5f,GAAlC,+GACwB6f,4BAAkB7f,EAAM,SADhD,cACU8f,EADV,yBAEWA,EAAMC,QAAQrpB,KAAI,SAAAqa,GACrB,MAAO,CAAEiP,MAAOjP,EAAKkP,mBAAoBlsB,MAAOgd,EAAK3T,GAAI8iB,MAAOnP,EAAK5D,KAAM7Z,KAAMyd,EAAKzd,UAH9F,uDAJ4D,iIA4B5D,kBAAqC0M,GAArC,gHAC2B6f,4BAAkB7f,EAAM,YADnD,cACUmgB,EADV,yBAEWA,EAASJ,QAAQrpB,KAAI,SAAA8d,GACxB,MAAO,CAAEwL,MAAOxL,EAAMhF,MAAOzb,MAAOygB,EAAMpX,QAHlD,wDA5B4D,sBAiE5D,OA9BwBgjB,IAAa,CACjCxM,MAAOA,EACPyM,MAAO,eAASrgB,EAAMsgB,GAClB,OAAOte,GACH,IAAK,SAvC2C,SAI7Cue,mBAJ6C,qDAwC5CA,CAAmBvgB,GAAM6Z,MAAK,SAAAiG,GAC1BQ,EAAOR,MAEX,MACJ,IAAK,UA1BjB,SAASU,oBAAoBxgB,EAAMsgB,GAC/B,IAAIxR,EACJA,EAAW,kBAAA2R,GACPH,EAAOG,EAAY/pB,KAAI,SAAAgqB,GACnB,MAAO,CAAEV,MAAOU,EAAWjhB,YAAa1L,MAAO2sB,EAAWC,eAGlEC,6BAAmB5gB,EAAM8O,GAoBb0R,CAAoBxgB,EAAMsgB,GAC1B,MACJ,IAAK,YA/C2C,SA4B7CO,sBA5B6C,wDAgD5CA,CAAsB7gB,GAAM6Z,MAAK,SAAAsG,GACzBG,EAAOH,QAM3BW,SAAU,kBAAS1rB,GACfwe,EAAM7f,MAAQqB,EAAK4qB,MACnBpM,EAAMtgB,KAAO8B,EAAKrB,OAEtB4b,UAAWA,EACXiQ,GAAIA,EACJmB,UA3De,EA4DfC,eAAgB,Q,qWC/DjB,IAAMhnB,EAAgB,iB,oRAAA,0BAAG,iBAAMinB,GAAN,4GAEtBjpB,EAASkpB,gBAAMD,GAEfjN,EAAmBrd,QAAMwqB,oBAAoB,IAAIxpB,KAAQ,GAE/DK,EAAO+b,OAAS,CAAEC,oBAClBhc,EAAOkC,MAAM6Z,OAAOC,iBAAmBA,EACvChc,EAAOkC,MAAM6Z,OAAO/R,KAAOhK,EAAOkC,MAAM6Z,OAAO/R,MAAQ,WAEvDhK,EAAO0L,WAAWtG,GAAKpF,EAAO0L,WAAWtG,IAAM,EAC/CpF,EAAOkC,MAAMqU,cAAgB,GAC7BvW,EAAOkC,MAAMsa,MAAMxS,KAAO,GAZE,mBAgBCof,wBAAcppB,GAhBf,SAgBlBqpB,EAhBkB,SAmBd7pB,EAAW6pB,EAAWC,KAAX,UAAqBD,EAAWC,KAAhC,aAAyCD,EAAWE,cAAiBF,EACtFrpB,EAAOqpB,WAAa7pB,EACpBQ,EAAOkC,MAAMC,aAAe,UAC5BnC,EAAOkC,MAAMsU,gBAAkBhX,EAC/BQ,EAAOkC,MAAMsa,MAAMlhB,KAAOkE,EAC1BQ,EAAOkC,MAAM4b,YAAc,CACvBJ,IAAK2L,EAAWG,SAChB5L,KAAMyL,EAAWI,aAIrBzpB,EAAOkC,MAAMqU,cAAgB,QAC7BvW,EAAOkC,MAAMC,aAAe,QAC5BnC,EAAOkC,MAAMsa,MAAQ,CAAEpX,GAAI,MAAO9J,KAAM,UAhCpB,kDAoCxB0E,EAAOkC,MAAMqU,cAAgB,QAC7BvW,EAAOkC,MAAMC,aAAe,QAC5BnC,EAAOkC,MAAMsa,MAAQ,CAAEpX,GAAI,MAAO9J,KAAM,SAtChB,iCAyCrB0E,GAzCqB,gEAAH,gBAAhBgC,iBAAgB,uC,4uCCEtB,IAAM0nB,EAAe,SAAfA,aAAgB1f,EAAM2f,EAAM7S,EAAU9W,GAE/C,OAAOgK,GACH,IAAK,QACL,IAAK,OACD,OAAO4f,EAAoBD,EAAM7S,EAAU9W,GAC/C,IAAK,QACD6pB,EAAiBF,EAAM7S,EAAU9W,GACjC,MACJ,IAAK,QACD8pB,EAAkBH,EAAM7S,EAAU9W,GAClC,MACJ,IAAK,QACD+pB,EAAkBJ,EAAM7S,EAAU9W,GAClC,MACJ,IAAK,cACDgqB,EAAmBL,EAAM7S,EAAU9W,KAKlCiqB,EAA0B,SAA1BA,wBAA0BC,GAQnC,OAPaA,EAASC,QAAT,gJAEsFD,EAASE,QAF/F,iLAKqFF,EAASG,QAAUH,EAASI,UALjH,gCAUXC,EAA8B,SAA9BA,4BAA8BL,GAChC,IAAMM,EAAe9V,SAASI,cAAcoV,EAAS3Q,YAAc7E,SAASI,cAAc,oBACvF0V,IACGA,EAAa5V,UAAYqV,EAAwBC,KAI9CO,EAAwB,SAAxBA,sBAAyBC,EAAKzgB,EAAO0gB,GAE9CD,EAAIhT,UAAW,EACfgT,EAAIE,MAAMC,OAAS,UAEnBH,EAAI9U,iBAAiB,SAAS,SAAAC,GAC1B6U,EAAIhT,UAAW,EACf5a,OAAO6hB,aAAagM,GACpBxpB,eAAagD,aACb2mB,EAAU7gB,OAIZ+f,EAAqB,SAArBA,mBAAsBL,EAAM7S,EAAU9W,GAExC,IAAMiK,EAAQ8gB,mBAASpB,GAEjBnF,EAAQva,EAAMkgB,QAAUnqB,EAAOykB,aAAezkB,EAAOykB,aAAezkB,EAAOgrB,cAEjF7pB,eAAagD,aAEb,IAAM8mB,EAAmB/rB,YAAW,WAChC4rB,EAAU7gB,KACXua,GAEA1N,EACCA,EAAS7M,EAAOghB,GAEhBR,EAAsB/V,SAASI,cAAc,2BAA4B7K,EAAOghB,GAMpFV,EAA4B,CAAEJ,QAASlgB,EAAMkgB,QAASC,QAHxC,UAGiDE,UAF/C,eAKdV,EAAsB,SAAtBA,oBAAuBsB,EAAQpU,EAAU9W,GAAW,IAE9CmrB,EAAwFD,EAAxFC,OAAQ3sB,EAAgF0sB,EAAhF1sB,SAAU6rB,EAAsEa,EAAtEb,OAAgBrW,GAAsDkX,EAA9D/N,OAA8D+N,EAAtDlX,aAAa7J,EAAyC+gB,EAAzC/gB,OAAQihB,EAAiCF,EAAjCE,MAAOZ,EAA0BU,EAA1BV,aAAc3rB,EAAYqsB,EAAZrsB,QAC9E8qB,EAAO,cAAH,eAAKwB,UAAW3sB,GAAhB,IAA0B6rB,SAAQlgB,SAAQihB,QAAOZ,eAAc3rB,YAEnEoL,EAAQ8gB,mBAASpB,GAEJA,EAAKyB,OAASzB,EAAKyB,MAAM1xB,OAAS,EAAKiwB,EAAKyB,MAAM,GAAKzB,EAAK/b,SAG5D,UAAhB3D,EAAM5B,OACS4B,EAAMkE,MAIL,YAAhBlE,EAAM5B,OACS4B,EAAMwH,QAGL,SAAhBxH,EAAM5B,OACS4B,EAAM2D,SAIL,WAAhB3D,EAAM5B,OACS4B,EAAMzL,SAIxB,IAGM+a,EAAYzc,OAAOyD,WAAW,uBAAuBC,QAAU,mBAAqB,mBAE1F+pB,EAA4B,CAAEJ,QAASlgB,EAAMkgB,QAASC,QALxC,UAKiDE,UAJ/C,YAI2D/Q,YAAW8Q,OAAQpgB,EAAMzL,WAEpGyL,EAAM+J,YAAcA,EAEpB,IAAMwQ,EAAQva,EAAMkgB,QAAUnqB,EAAOykB,aAAezkB,EAAOykB,aAAezkB,EAAOgrB,cAEjF7pB,eAAagD,aAEb,IAAM8mB,EAAmB/rB,YAAW,WAChC4rB,EAAU7gB,KACXua,GAIH,OAFG1N,GAAUA,EAAS7M,EAAOghB,GAEtB,CAAEhhB,QAAOghB,qBAGdpB,EAAmB,SAAnBA,iBAAoBF,EAAM7S,EAAU9W,GAEtC,IAAMiK,EAAQ8gB,mBAASpB,GAEjBnF,EAAQva,EAAMkgB,QAAUnqB,EAAOykB,aAAezkB,EAAOykB,aAAezkB,EAAOgrB,cAEjF7pB,eAAagD,aAEb,IAAM8mB,EAAmB/rB,YAAW,WAChC4rB,EAAU7gB,KACXua,GAEH1N,EAAS7M,EAAOghB,EAAkBjrB,IAGhC8pB,EAAoB,SAApBA,kBAAqBH,EAAM7S,EAAU9W,GAAW,IAE1C+L,EAAiB4d,EAAjB5d,MAAO1D,EAAUshB,EAAVthB,MAETgjB,EAAmB,SAAnBA,iBAAmBhQ,GAErBA,EAAEG,iBAEF,IAAM2B,EAAS9B,EAAE8B,OAEjB,IAAG3H,OAAKC,SAAS0H,EAAQ,YAAzB,CAEA,IAAMmO,EAAanO,EACbkN,EAASiB,EAAWtV,UAAUuV,OAC9BC,EAAcF,EAAWzR,QAAQ2R,YACjClwB,EAAOgwB,EAAWzR,QAAQve,KAC1BmwB,EAAatO,EAAOtD,QAAQ4R,WAElC9B,EAAKthB,MAAQ,OACbshB,EAAK8B,WAAaA,EAClB9B,EAAKnrB,SAAW6J,EAAM7J,SACtBmrB,EAAKU,OAAU/uB,GAAiB,KAATA,EAAe,CAAE2S,KAAMoc,EAAQ/uB,QAAS+uB,EAE/D,IAAMpgB,EAAQ8gB,mBAAS,cAAD,iBAAKpB,GAAL,IAAW+B,cAAevR,SAASqR,GAAc3sB,QAAS,MAuBhF,GArBAse,EAAO7H,UAAUlU,IAAI6I,EAAM0hB,QAE3B5f,EAAM3H,SAAQ,SAAAwnB,GACV,IAAMC,EAAcD,EAAM9W,cAAc,UAClCgX,EAAmB3R,SAAS0R,EAAYhS,QAAQ2R,aAChDO,EAAkBF,EAAYhS,QAAQve,MAAQ,GAEpC,KAAhBuwB,EACM5hB,EAAMpL,QAAQ7E,KAAK6xB,EAAY7V,WAC/B/L,EAAMpL,QAAQ7E,KAAK,CACjBiU,KAAM4d,EAAY7V,UAClB1a,KAAMywB,IAGXD,IAAqB7hB,EAAMuhB,YAC1BI,EAAMtW,UAAUlU,IAAI,gBACd0qB,IAAqB7hB,EAAMyhB,eACnCE,EAAMtW,UAAUlU,IAAI,iBAIvB0V,EACCA,EAAS7M,OACN,EACe,SAAZ+hB,UAAa/hB,GAEf,IAAMua,EAAQva,EAAMkgB,QAAUnqB,EAAOykB,aAAezkB,EAAOykB,aAAezkB,EAAOgrB,cAE3EC,EAAmB/rB,YAAW,WAChCiC,eAAagD,aACb2mB,EAAU7gB,KACXua,GAEHiG,EAAsB/V,SAASI,cAAc,2BAA4B7K,EAAOghB,GAG7D,kBAAhB1mB,OAAOjJ,OACNoZ,SAASI,cAAc,yBAAyBF,UAAYxX,KAAKgQ,SAASjF,OAC1EuM,SAASI,cAAc,qBAAqBQ,UAAUlU,IAAI,SAGlE4qB,CAAU/hB,GAMdsgB,EAA4B,CAAEJ,QAASlgB,EAAMkgB,QAASC,QAHxC,UAGiDE,UAF/C,cAIhBve,EAAM3H,SAAQ,SAAAhH,GAAI,OAAIA,EAAKkY,UAAUlU,IAAI,iBAG7C2K,EAAM3H,SAAQ,SAAA6nB,GACVA,EAASrW,iBAAiB,QAASyV,MAGvCvuB,OAAO8Y,iBAAiB,WAAW,SAAAyF,GACpB,UAAVA,EAAEhf,KACHgvB,EAAiBhQ,KAElB,CAAE6Q,MAAM,KAGTnC,EAAoB,SAApBA,kBAAqBJ,EAAM7S,EAAU9W,GAAW,IAE1C+L,EAAiB4d,EAAjB5d,MAAO1D,EAAUshB,EAAVthB,MAEf0D,EAAM3H,SAAQ,SAAA+nB,GACVA,EAAKvW,iBAAiB,SAAS,SAAAC,GAE3B,IAAMuW,EAAMvW,EAAMsH,OACZkN,EAAS+B,EAAIvS,QAAQwQ,OAE3B,GAAIA,EAAJ,CAEAV,EAAKthB,MAAQ,OACbshB,EAAKnrB,SAAW6J,EAAM/M,KACtBquB,EAAKU,OAASA,EACd,IAAMpgB,EAAQ8gB,mBAASpB,GAEvBwC,EAAKvB,MAAM/sB,OAAS,iBAEpBuuB,EAAIC,WAAWzB,MAAM/sB,OAAS,iBAE9BkO,EAAM3H,SAAQ,SAAA+nB,GACVA,EAAKvB,MAAM/sB,OAAS,gBACpBsuB,EAAKvB,MAAM0B,QAAU,GAClBH,EAAKtS,QAAQwQ,OAAOkB,OAAOle,gBAAkBhF,EAAM/M,KAAKiwB,OAAOle,gBAC9D8e,EAAKvB,MAAM/sB,OAAS,iBACpBsuB,EAAKvB,MAAM0B,QAAU,MAI7B,IAAM9H,EAAQva,EAAMkgB,QAAUnqB,EAAOykB,aAAezkB,EAAOykB,aAAezkB,EAAOgrB,cAEjF7pB,eAAagD,aAEb,IAAM8mB,EAAmB/rB,YAAW,WAChC4rB,EAAU7gB,KACXua,GAEA1N,GAAUA,EAAS7M,EAAOghB,WAK5BH,EAAY,SAAZA,UAAY7gB,GAAS,IAEtByB,EAAe5L,QAAMC,WAArB2L,WAERzB,EAAMsiB,aAAe7gB,EAAWtG,GAEhCxE,UAAQ4rB,iBAAiBviB,K,gEC9R7B,8LAEawiB,EAAY,SAAZA,UAAYzkB,GACrB,OAAOA,EAAKiG,KAAOjG,EAAKiG,KAAKZ,cAAgBrF,EAAKqF,cAAcmZ,QAAQ,KAAK,KAGpEkG,EAA0B,SAA1BA,wBAA2BluB,EAAU6rB,GAK9C,OAFiBplB,UAAUA,UAAWA,sBAE/B0nB,CAASF,EAAUjuB,GAAWiuB,EAAUpC,KAqCtCU,EAAW,SAAXA,SAAWpB,GAEpB,IAAM1f,EAAQhF,QAAQ0kB,GAKtB,OAHA1f,EAAMkgB,QAAUlgB,EAAMlM,MATG,SAAvB6uB,qBAAuB3iB,GAEzB,OAD+BhF,UAAUA,UAAWA,sBAC7C4nB,CAAuB5iB,EAAMogB,OAAQpgB,EAAMzL,UAOpBouB,CAAqB3iB,GAtC/B,SAAlB6iB,gBAAkB7iB,GAEpB,IAAI8iB,EAEJ,GAAG9iB,EAAMyhB,cACL,OAAOvR,SAASlQ,EAAMyhB,iBAAmBzhB,EAAMuhB,YAWnD,OARAvhB,EAAMogB,OAASpgB,EAAMogB,OAAOkB,OAE5BwB,EAAYL,EAAwBziB,EAAMzL,SAAUyL,EAAMogB,QAMnDpgB,EAAM5B,OACT,IAAK,aAED,GADA4B,EAAMmhB,MAAQnhB,EAAMmhB,MAAM1sB,KAAI,SAAApD,GAAI,OAAIA,EAAK+R,iBACxCpD,EAAMmhB,OAASnhB,EAAMmhB,MAAM1xB,OAAS,EAAG,CACtC,IAAMszB,EAAuB/nB,WAAWgF,EAAMogB,OAAQpgB,EAAMmhB,QACxD2B,GAAaC,IAAsB/iB,EAAMgjB,qBAAsB,GACnEF,EAAYA,GAAaC,GAIrC,OAAOD,EAYqDD,CAAgB7iB,GAC5EA,EAAM0hB,OAAU1hB,EAAMkgB,QAAU,eAAiB,aAE1ClgB,I,moCClDX,IAkFaijB,EAAe,CACxBC,SAnFa,SAAXA,SAAYtO,GAAwC,IAAlCuO,EAAkC,wDAEhD/qB,EAAWvC,QAAMC,WAAWsC,SAE5B0J,EAAQ1J,EAASxE,QAAO,SAAAmQ,GAAU,OAAI/I,WAAW+I,EAAW3F,MAAOwW,MAQzE,OAJAuO,EACsBrhB,EACAA,EAAMlO,QAAO,SAAAT,GAAI,MAAuB,SAAnBA,EAAKiwB,cAE3BxvB,QAAO,SAAAT,GAAI,OAAI6H,WAAW7H,EAAKiL,MAAOwW,OAwE3DyO,YArEgB,SAAdA,YAAcvhB,GAEhB,IAAIwhB,EAAW,mBAAK,IAAIpa,IAAIpH,EAAMrN,KAAI,SAAAtB,GAAI,OAAIA,EAAKowB,YAOnD,OANID,EAAWA,EAAS7uB,KAAI,SAAA8uB,GACpB,MAAO,CACHlyB,KAAMkyB,EACNnP,MAAOtS,EAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAKowB,QAAUA,KAAQ9zB,YAgE/D+zB,aA1DiB,SAAfA,aAAgBprB,EAAU2H,EAAM0B,GAElC,IAAMK,EAAQL,EAAWwC,MACf7L,EAASxE,QAAO,SAAAmQ,GAAU,OAAI/I,WAAW+I,EAAW5I,GAAIsG,EAAWwC,UACnE7L,EAIJxE,EAAS,CACTwN,WAHO,mBAAK,IAAI8H,IAAIpH,EAAMrN,KAAI,SAAAsP,GAAU,OAAIA,EAAW3F,WAIvD8Q,OAAQ,CACF9c,IAAK,IACLN,MAAO,oBAIb2xB,EAAY,CACdhtB,MAAO,EACPitB,YAAY,EACZ5hB,QACAsS,MAAOtS,EAAMrS,OACbmE,SACAmM,OACA4jB,UAAW,CACPvJ,MAAO,EACP+F,QAAS,EACTE,UAAW,EACXyC,UAAW,KACXc,YAAa,KACb9d,OAAQ,GACR+d,OAAQ,GACRC,MAAO,IAEX1d,SAAUtE,EAAMrS,OAChBwU,MAAOxC,EAAWwC,MAClB8f,4BAA6B,GAC7BC,6BAA8B,GAC9BC,SAAWxiB,EAAWtG,IAe1B,OAZAsoB,EAAU7vB,OAAOghB,KAAOhhB,EAAOwN,WAAW3M,KAAI,SAAA2J,GAK1C,MAJoB,CAChB/M,KAAM+M,EACNgW,MAAOtS,EAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAKiL,QAAUA,KAAO3O,WAK1Dg0B,EAAU7vB,OAAOghB,KAAO6O,EAAU7vB,OAAOghB,KAAKhhB,QAAO,SAAAwK,GAAK,OAAIA,EAAMgW,MAAQ,KAE5Ezd,UAAQutB,qBAAqBT,GAEtBA,K,2ECjFXzyB,EAAOD,QAFI,28F,6ECDX,8HAiCaozB,EAAiB,CAC1BC,cA9BkB,SAAhBA,cAAiBX,EAAWY,GAE9BZ,EAAUa,WAAab,EAAUa,YAActpB,OAAO,EAAGqpB,GAEzDZ,EAAUlvB,SAAW8vB,EAAe1zB,OAAO,EAAE,GAAG,GAEhD,IAAImR,EAAQuiB,EAAezwB,QAAO,SAAAT,GAAI,OAAIA,EAAKowB,SAAWE,EAAUlvB,SAASgvB,UAEvEgB,EAAYziB,EAAQA,EAAMrS,OAAS,EAGrC80B,GAFkB,GAGCvpB,OAHD,EAGyBupB,EAAYd,EAAUa,WAAW1wB,QAAO,SAAA6T,GAAE,OAAKzM,WAAWyM,EAAGzD,KAAMlC,EAAMrN,KAAI,SAAAlF,GAAC,OAAIA,EAAEyU,UAAUyD,EAAGzD,OAASyf,EAAUlvB,SAASyP,SACvJ7J,SAAQ,SAAAhH,GAAI,OAAI2O,EAAM/R,KAAKoD,MAGhD,IAAIyB,EAAUoG,OAAO,EAAG8G,GAUxB,OATIlN,EAAQ7E,KAAK0zB,EAAUlvB,UAEvBK,GADAA,EAAUF,QAAM+O,aAAa7O,IACXH,KAAI,SAACtB,EAAMsD,GACzB,MAAO,CACHuN,KAAM7Q,EAAK6Q,KACXvN,e,6ECvBhBzF,EAAOD,QAFI,u8D,2ECEXC,EAAOD,QAFI,66I,0ECDX,kKAKMyzB,EAAiB,SAAjBA,eAAkB1B,EAAW9e,GAC/B,OAAO8e,EAAS,6UAE6K9e,EAF7K,qBAMdygB,EAAqB,SAArBA,mBAAsBhB,EAAWiB,GAEnC,IAAM5iB,EAAQ2hB,EAAUxf,MAAQwf,EAAU3hB,MAAMlO,QAAO,SAAAT,GAAI,OAAI6H,WAAW7H,EAAKgI,GAAIsoB,EAAUxf,UAAUwf,EAAU3hB,MAEjH4iB,EAAcvqB,SAAQ,SAAAwqB,GACtBA,EAAYha,UAAY7I,EAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAKowB,SAAWoB,EAAY/U,QAAQve,QAAM5B,WAIrFm1B,EAAsB,SAAtBA,oBAAuBnB,EAAWoB,EAAe1B,GAEnD,IAAMrhB,EAAQ2hB,EAAUxf,MAAQwf,EAAU3hB,MAAMlO,QAAO,SAAAT,GAAI,OAAI6H,WAAW7H,EAAKgI,GAAIsoB,EAAUxf,UAAUwf,EAAU3hB,MAQjH,OANA+iB,EAAc1qB,SAAQ,SAAA2qB,GAClBA,EAAWna,UAAYwY,EACjBrhB,EAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAKiL,QAAU0mB,EAAWlV,QAAQxR,SAAO3O,OAC9DqS,EAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAKiL,QAAU0mB,EAAWlV,QAAQxR,QAAUjL,EAAKiwB,aAAW3zB,UAGpF0zB,EACDrhB,EACAA,EAAMlO,QAAO,SAAAT,GAAI,OAAKA,EAAKiwB,cAgKxB2B,EAAc,CACvBC,kBA9JsB,SAApBA,kBAAqBvB,EAAW9R,EAAOsT,EAAUC,EAAgBL,GAAiD,IAAlC1B,EAAkC,wDAEpHsB,EAAmBhB,EAAWyB,GAC9B,IAAMjhB,EAAQ2gB,EAAoBnB,EAAWoB,EAAe1B,GAE5DM,EAAUrP,MAAQnQ,EAAMxU,OAExBw1B,EAAS9qB,SAAQ,SAAAlE,GACbA,EAAQ0U,UAAY8Y,EAAUrP,SAGlCzC,EAAM7f,MAAQ2xB,EAAUrP,MACxBqP,EAAUrd,SAAW8J,SAASyB,EAAM7f,QAmJpCqzB,cAnEkB,SAAhBA,cAAiB7qB,EAAQ8qB,EAAO5B,EAAc6B,GAAqB,IAE7DjtB,EAAiCgtB,EAAjChtB,SAAUktB,EAAuBF,EAAvBE,QAAS3d,EAAcyd,EAAdzd,UAErBsT,EAAO,iBAEPwI,EAAYD,IAEZ+B,EAAe,SAAfA,aAAenU,GACjBiU,EAAiBG,kBAAkB/B,EAAU3hB,OAC1C2hB,EAAUgC,gBACT9d,EAAU0D,UAAU1R,OAAOshB,GAC3BqK,EAAQja,UAAUlU,IAAI8jB,IAEtBqK,EAAQja,UAAU1R,OAAOshB,IAI3ByK,EAAc,SAAdA,YAActU,GAChBiU,EAAiBM,iBAAiBlC,EAAUgC,iBAG1CG,EAAqB,SAArBA,qBAEFnC,EAAUO,6BAA+BP,EAAUO,8BAAgC,GAEhFP,EAAUO,6BAA6Bv0B,OAAS,IAC/C2I,EAASuT,iBAAiB,QAAS4Z,EAAc,CAAEtD,MAAM,IACzDwB,EAAUO,6BAA6Bj0B,KAAK,aAI9C81B,EAAoB,SAApBA,oBAEFpC,EAAUM,4BAA8BN,EAAUM,6BAA+B,GAE9EN,EAAUM,4BAA4Bt0B,OAAS,IAC9C61B,EAAQ3Z,iBAAiB,QAAS+Z,EAAa,CAAEzD,MAAM,IAAQ,GAC/DwB,EAAUM,4BAA4Bh0B,KAAK,aAInD,OAAOuK,GACH,KAAKpH,QAAM4yB,cAAcC,QACrBT,EAAQja,UAAUlU,IAAI8jB,GACtB7iB,EAASiT,UAAU1R,OAAOshB,GAC1B2K,IACJ,MAEA,KAAK1yB,QAAM4yB,cAAcE,UACrBV,EAAQja,UAAU1R,OAAOshB,GACzBqK,EAAQ3a,UAAY,eACpBib,IACAC,IACJ,MAEA,KAAK3yB,QAAM4yB,cAAcxM,SACrBgM,EAAQja,UAAU1R,OAAOshB,GACzBqK,EAAQ3a,UAAY,eACpBhD,EAAU0D,UAAUlU,IAAI8jB,GACxB4K,MAQRI,oBAjJwB,SAAtBA,oBAAuBxC,EAAWrD,EAAQ8F,GAE5C,IAAMpD,EAAY1C,IAAWqD,EAAUlvB,SAASyP,KAEhDyf,EAAUlvB,SAAS6rB,OAASA,EAE5BqD,EAAUE,UAAUvJ,QAEjB0I,GACCW,EAAUE,UAAUxD,UACpBsD,EAAUE,UAAUb,WAAY,EAChCW,EAAUE,UAAUC,aAAc,EAClCH,EAAUE,UAAUE,OAAO9zB,KAAK0zB,EAAUlvB,YAE1CkvB,EAAUE,UAAUtD,YACpBoD,EAAUE,UAAUb,WAAY,EAChCW,EAAUE,UAAUC,aAAc,EAClCH,EAAUE,UAAUG,MAAM/zB,KAAK0zB,EAAUlvB,WAG7C2xB,EAAiBvb,UAAY6Z,EAAe1B,EAAWW,EAAUlvB,SAASyP,KAAKZ,gBA8H/E+iB,eA3HmB,SAAjBA,eAAkB1C,EAAW2C,EAAgBF,EAAkBxF,EAAO2F,GAExE,GAAoC,MAAhC5C,EAAU7vB,OAAOsb,OAAO9c,IAAa,CAErC,IAAMk0B,EAAW,UAIXC,EAFO9C,EAAUlvB,SAASyP,KAEDmY,MAAM,KAAK1nB,KAAI,SAAA2rB,GAE1C,IAAIoG,EAAapG,EAKjB,OAFIoG,GADAA,GADAA,EAAaA,EAAWjK,QAAQ+J,EAAU,KAClBhF,QACAle,iBAK1B0f,EAAY9nB,WAAWorB,EAAet0B,MAAMwvB,OAAOle,cAAemjB,GAExE9C,EAAUE,UAAUvJ,QAEhB0I,GACAW,EAAUE,UAAUxD,UACpBsD,EAAUE,UAAUE,OAAO9zB,KAAK0zB,EAAUlvB,YAG1CkvB,EAAUE,UAAUtD,YACpBoD,EAAUE,UAAUG,MAAM/zB,KAAK0zB,EAAUlvB,WAG7C2xB,EAAiBvb,UAAY6Z,EAAe1B,EAAWW,EAAUlvB,SAASyP,KAAKZ,eAE/Esd,EAAQzrB,YAAW,WACfoxB,EAAqBvO,UACtBjiB,QAAMC,WAAWC,OAAOykB,aAAe,KAG9C,OAAOkG,GAsFP+F,cAnFkB,SAAhBA,cAAgBC,GAElB,IAAMlc,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY+b,EAE3B,IAAMrc,EAAQI,SAASI,cAAc,kBAE/BxB,EAASgB,EAAMQ,cAAc,kBAGnC,OAFMxB,EAAOsB,UAAY,GAElB,CAAEH,WAAUH,QAAOhB,a,6yCC1G9B,IAAMsd,EAAU,SAAVA,QAAWxa,EAAMsX,GAEnB,IAEMpZ,EAAQI,SAASI,cAAc,kBAE/Bua,EAAQ,CACVhtB,SAAUiS,EAAMQ,cAAc,wBAC9Bya,QAASjb,EAAMQ,cAAc,0BAC7BlD,UAAW0C,EAAMQ,cAAc,6BAGnCka,cAAYI,cAAchZ,EAAMiZ,GAVX,SAAf5B,eAAe,OAAMC,IAU0B4B,IAGnDC,EAAO,4DAAG,kBAAMG,GAAN,8JAEOrhB,IAFP,OAENwiB,EAFM,SAIwB7B,cAAY0B,cAAcI,KAAtDrc,EAJI,EAIJA,SAJI,EAIMH,MAAOhB,EAJb,EAIaA,OAEzBsd,EAAQzzB,QAAM4yB,cAAcC,QAAS,CAAEjkB,MAAO8kB,EAAK9kB,MAAOiiB,4BAA6B,GAAIC,6BAA8B,KAEnHliB,EAAwB8kB,EAAxB9kB,MAAO/B,EAAiB6mB,EAAjB7mB,KAAMnM,EAAWgzB,EAAXhzB,OAEbkzB,EAAiB,SAAjBA,iBACFnwB,UAAQowB,qBAAqB9D,eAAaO,aAAa3tB,QAAMC,WAAWsC,SAAUlF,QAAM8zB,cAAcC,WAAY,KAClHtB,EAAiBlC,EAAUgC,iBAG3B9qB,EAAQ9E,QAAMC,WAAW2tB,WAAaR,eAAaO,aAAa1hB,EAAOlO,EAAQmM,IAE/E0jB,GADAA,EAAYzoB,QAAQL,IACE+oB,WAAaoD,IAAmBrD,GAC5CgC,eAAiBA,IAAkB,EAC7ChC,EAAUM,4BAA8B,GACxCN,EAAUO,6BAA+B,GAE7CrtB,UAAQowB,qBAAqBtD,GAEvBzU,EAAU,CACZ,CAAE5c,IAAK,EAAGN,MAAO,mBACjB,CAAEM,IAAK,EAAGN,MAAO,eAKfwxB,EAAWL,eAAaI,YAAYvhB,GAE1CgJ,yBAAe,CAAE2Y,YAAWzU,UAASsU,YAAY9Y,EAASO,QAAS1B,GAE7D4b,EAAWxa,SAASQ,iBAAiB,wBACrCia,EAAiBza,SAASQ,iBAAiB,wCAC3C4Z,EAAgBpa,SAASQ,iBAAiB,kCAE1C0G,EAAQlH,SAASI,cAAc,yBACzBc,iBAAiB,SAAS,SAAAyF,GAC9BqS,EAAUrd,SAAW8J,SAASkB,EAAE8B,OAAOphB,UAEzCmD,YAAW,WACT0c,EAAMT,UACL,KAETuS,EAAUrd,SAAW8J,SAASyB,EAAM7f,OAE9Bo1B,EAAc,SAAdA,YAAeC,EAAK5b,GACtB,OAAG4b,EAAIrtB,MAAK,SAAAsX,GAAC,OAAIA,IAAM7F,KACZ4b,EAAIvzB,QAAO,SAAA6S,GAAW,OAAIA,IAAgB8E,MAEjD4b,EAAIp3B,KAAKwb,GACF4b,IAITC,EAAgB,SAAhBA,gBAAgB,OAAM3D,EAAU7vB,OAAOwN,YAEhCqJ,SAASQ,iBAAiB,0BAC5B9Q,SAAQ,SAAAiE,GAET,IAAMipB,EAASjpB,EAAMyM,cAAc,SAE/B7P,WAAWoD,EAAMwR,QAAQve,KAAMoyB,EAAU7vB,OAAOwN,aAChDimB,EAAOvP,QAGX1Z,EAAMuN,iBAAiB,SAAvB,4DAAiC,iBAAMyF,GAAN,iGACzBkW,EAAgBlW,EAAE8B,OAAO/X,GACzBosB,EAAcL,EAAYE,IAAyCE,GACzE7D,EAAU7vB,OAAOwN,WAAammB,EAC9B9D,EAAU3hB,MAAQmhB,eAAaC,SAASqE,GACxCxC,cAAYC,kBAAkBvB,EAAW9R,EAAOsT,EAAUC,EAAgBL,EAAe2C,KAL1D,sDAAjC,0DASNrE,IAAwBM,EAAUQ,SAEhCuD,EAA2B,SAA3BA,2BAA2B,OAAMrE,GAEvC4B,cAAYC,kBAAkBvB,EAAW9R,EAAOsT,EAAUC,EAAgBL,EAAe2C,MAEnFC,EAAqBhd,SAASI,cAAc,0BACzBF,UAA0C,IAA9B8Y,EAAUE,UAAUvJ,MAAc,qBAAuB,6BACxFqN,EAAmB9b,iBAAiB,SAAS,SAAAyF,GAC3CzJ,EAAU8b,KACT,CAAExB,MAAM,IAEXyF,EAAmBjd,SAASQ,iBAAiB,sCAEnB,MAAhCwY,EAAU7vB,OAAOsb,OAAO9c,IACpBs1B,EAAiB,GAAG5P,QACpB4P,EAAiB,GAAG5P,QAExB4P,EAAiBxX,SAASuT,EAAU7vB,OAAOsb,OAAO9c,MAAMiZ,UAAUlU,IAAI,UAEtEuwB,EAAiB,GAAG/b,iBAAiB,SAAS,SAAAyF,GAC5CA,EAAEG,iBACEhG,OAAKC,SAAS4F,EAAE8B,OAAQ,YAC1B9B,EAAE8B,OAAO7H,UAAUlU,IAAI,UACvBssB,EAAU7vB,OAAOsb,OAAS,CACtB9c,IAAKgf,EAAE8B,OAAOtD,QAAQxd,IACtBN,MAAOsf,EAAE8B,OAAOtD,QAAQ9d,OAE5B41B,EAAiB,GAAGrc,UAAU1R,OAAO,cAIzC+tB,EAAiB,GAAG/b,iBAAiB,SAAS,SAAAyF,GAC5CA,EAAEG,iBACEhG,OAAKC,SAAS4F,EAAE8B,OAAQ,YAC1B9B,EAAE8B,OAAO7H,UAAUlU,IAAI,UACvBssB,EAAU7vB,OAAOsb,OAAS,CACtB9c,IAAKgf,EAAE8B,OAAOtD,QAAQxd,IACtBN,MAAOsf,EAAE8B,OAAOtD,QAAQ9d,OAE5B41B,EAAiB,GAAGrc,UAAU1R,OAAO,cAInC+qB,EAAgBja,SAASQ,iBAAiB,iCAE7CwY,EAAU7vB,OAAO0vB,UAEhBoB,EAAcvqB,SAAQ,SAAAopB,GACdvoB,WAAWuoB,EAAO3T,QAAQxd,IAAKqxB,EAAU7vB,OAAO0vB,WAChDC,EAAOzL,WAKnB4M,EAAcvqB,SAAQ,SAAAopB,GAClBA,EAAO5X,iBAAiB,SAAS,SAAAyF,GACjCnc,WAAU,2CAAC,2HAEC0yB,GADAA,EAAkBC,MAAMC,KAAKnD,GAAe9wB,QAAO,SAAAk0B,GAAC,OAAIvc,OAAKC,SAASsc,EAAG,cACvCrzB,KAAI,SAAAqzB,GAAC,OAAIA,EAAElY,QAAQxd,OACzDqxB,EAAU7vB,OAAO0vB,SAAWqE,EAHzB,SAIqB1E,eAAaC,SAASO,EAAU7vB,OAAOwN,YAJ5D,OAIHqiB,EAAU3hB,MAJP,OAKH2hB,EAAU3hB,MAAQ2hB,EAAU3hB,MAAMlO,QAAO,SAAAT,GAAI,OAAI6H,WAAW7H,EAAKowB,OAAQoE,MACzE5C,cAAYC,kBAAkBvB,EAAW9R,EAAOsT,EAAUC,EAAgBL,EAAe2C,KANtF,+DAWTpE,EAAY3Y,SAASI,cAAc,6BACzBc,iBAAiB,SAA3B,4DAAqC,kBAAMyF,GAAN,6FACnC+R,EAAwB/R,EAAE8B,OAAO6U,QACjCtE,EAAU7vB,OAAOuvB,sBAAwBA,EAFN,KAGjBM,EAAU3hB,MAHO,qCAGQmhB,eAAaC,SAASO,EAAU7vB,OAAOwN,WAAY+hB,GAH3D,0BAGnCM,EAAU3hB,MAHyB,KAInCijB,cAAYC,kBAAkBvB,EAAW9R,EAAOsT,EAAUC,EAAgBL,EAAe2C,KAJtD,uDAArC,uDAOHrE,GAAuBC,EAAUtL,QAEtBrN,SAASI,cAAc,wBACzBc,iBAAiB,SAAS,SAAAyF,GAC9B0V,OA9JI,wDAAH,gBAAPxB,QAAO,sCAkKP3d,EAAY,SAAZA,UAAYhN,GAEd,IAAI8oB,EAEJ,GAAI9oB,EAAJ,EACK8oB,EAAYzoB,QAAQL,IAEfqpB,6BAA+B,GAEzC2C,EAAQzzB,QAAM4yB,cAAcE,UAAWvC,GAThB,IAanB/C,EAbmB,EAWaqE,cAAY0B,cAAcuB,KAAtDxd,EAXe,EAWfA,SAAUH,EAXK,EAWLA,MAAOhB,EAXF,EAWEA,OAIzB,GAAGoa,EAAUrd,SAAWqd,EAAUE,UAAUvJ,MAAO,CAE/C,IAAIxlB,EAAUuvB,iBAAeC,cAAcX,EAAW/uB,QAAM+O,aAAaggB,EAAU3hB,QAEnFgJ,yBAAe,CAAEvW,SAAUkvB,EAAUlvB,SAC7BK,UAASwlB,MAAOqJ,EAAUE,UAAUvJ,MAAQ,EAC5ChG,MAAOqP,EAAUrd,SACjB+Z,QAASsD,EAAUE,UAAUxD,QAC7B8H,SAAUxE,EAAUE,UAAUvJ,OACnC5P,EAASO,QAAS1B,GAELoB,SAASQ,iBAAiB,qBAC5B9Q,SAAQ,SAAAnB,GACZA,EAAOqS,UAAUlU,IAAI,kBAClB6B,EAAOmC,KAAOsoB,EAAU7vB,OAAOsb,OAAO9c,KAAK4G,EAAOqS,UAAU1R,OAAO,qBAGhF,IAAMusB,EAAmBzb,SAASI,cAAc,0BAE1CmE,EAAU4Y,MAAMC,KAAKpd,SAASQ,iBAAiB,gCAC/C+D,EAAQ7U,SAAQ,SAAA+U,GACdA,EAAOvD,iBAAiB,SAAS,SAAAyF,GAC7B,IAEMgP,EAFShP,EAAE8B,OACGrI,cAAc,QAAQF,UAE1Coa,cAAYkB,oBAAoBxC,EAAWrD,EAAQ8F,GACnDG,EAAqB5Y,UAAW,EAC7BgW,EAAUE,UAAUC,aACnB1U,EAAO7D,UAAUlU,IAAI,cAEzB6X,EAAQ7U,SAAQ,SAAA+U,GACTA,EAAO/T,KAAOsoB,EAAUlvB,SAASyP,MAChCkL,EAAO7D,UAAUlU,IAAI,mBAG7BupB,EAAQzrB,YAAW,WACfoxB,EAAqBvO,UACtBjiB,QAAMC,WAAWC,OAAOykB,gBAC5B,CAAEyH,MAAM,OAEbhtB,YAAW,WACT+Z,EAAQ,GAAGnE,cAAc,UAAUqG,UAClC,KAET,IAAMgX,EAA0B7d,EAAMQ,cAAc,6BAC9Cub,EAAiB/b,EAAMQ,cAAc,mCAER,MAAhC4Y,EAAU7vB,OAAOsb,OAAO9c,MACvB81B,EAAwB7c,UAAU1R,OAAO,kBACzCysB,EAAelV,SAGnB,IAAMmV,EAAuB5b,SAASI,cAAc,+BAC9Cwb,EAAqB1a,iBAAiB,SAAS,SAAAyF,GAC7CiV,EAAqBlW,aAAa,YAAY,GAC9CsT,EAAU3hB,MAAQ2hB,EAAU3hB,MAAMlO,QAAO,SAAAT,GAAI,OAAIA,EAAK6Q,OAASyf,EAAUlvB,SAASyP,QAClF9M,eAAaC,IAAIgxB,EAAoB,YAAa,SAClDxxB,UAAQowB,qBAAqBtD,GAC7B/O,aAAagM,KACZ,CAAEuB,MAAM,IAEjB,IAAImG,GAAQ,EA0BZ,GAxBAhC,EAAeza,iBAAiB,WAAW,SAAAC,GAClB,GAAjBA,EAAM4F,SAAgB4W,IACtBA,GAAQ,EACR1H,EAAQqE,cAAYoB,eAAe1C,EAAW2C,EAAgBF,EAAkBxF,EAAO2F,GACvFA,EAAqB5Y,UAAW,MAIxC2Y,EAAeza,iBAAiB,YAAY,SAAAC,GACnB,IAAjBA,EAAM4F,SAAiB4W,IACvBA,GAAQ,EACR1H,EAAQqE,cAAYoB,eAAe1C,EAAW2C,EAAgBF,EAAkBxF,EAAO2F,GACvFA,EAAqB5Y,UAAW,MAIxC2Y,EAAeza,iBAAiB,QAAQ,SAAAyF,GACjCgX,GAAShX,EAAE8B,OAAOphB,MAAMrC,OAAS,IAChC24B,GAAQ,EACR1H,EAAQqE,cAAYoB,eAAe1C,EAAW2C,EAAgBF,EAAkBxF,EAAO2F,GACvFA,EAAqB5Y,UAAW,OAIpCgW,EAAUlvB,SAASyP,KAAKmY,MAAM,KAAK1sB,OAAS,GAA8C,IAAzCg0B,EAAUlvB,SAASyP,KAAKwX,QAAQ,OAA+C,MAAhCiI,EAAU7vB,OAAOsb,OAAO9c,IAC3GiY,EAAMQ,cAAc,uBACtBQ,UAAU1R,OAAO,aAIhC4F,EAAQkkB,GAGZ,IAAM4E,EAAShe,EAAMQ,cAAc,6BAChCwd,GACGA,EAAO1c,iBAAiB,SAAS,SAAAyF,GAC/B7R,EAAQkkB,KACP,CAAExB,MAAM,MAIfqG,EAAmB,SAAnBA,iBAAoBlwB,EAAU6L,GAEhC,IAAIA,GAA0B,IAAjBA,EAAMxU,OAAc,OAAO2I,EAExC,IAAMsG,EAAc,GAOpB,OALAuF,EAAM9J,SAAQ,SAAA6J,GACV,IAAMD,EAAa3L,EAAS0B,MAAK,SAAAyuB,GAAG,OAAIA,EAAIptB,KAAO6I,KACnDtF,EAAY3O,KAAKgU,MAGdrF,EAAY9K,QAAO,SAAAoQ,GAAI,OAAIA,MAGhCtF,EAAW,4DAAG,kBAAMuF,GAAN,0GAEoB8gB,cAAY0B,cAAc+B,KAAtDhe,EAFQ,EAERA,SAFQ,EAEEH,MAAOhB,EAFT,EAESA,OAEnBoa,EAAY5tB,QAAMC,WAAW2tB,WAAaR,eAAaO,aAAavf,EAAO/Q,QAAM8zB,cAAcC,WAAY,CAAExlB,WAAY,KAE/HklB,EAAQzzB,QAAM4yB,cAAcxM,SAAUmK,GAEtCpa,EAAOsB,UAAY,GAEbvS,EAAWkwB,EAAiBrkB,EAAOwf,EAAUxf,OAEnD6G,yBAAe,CAAE1S,YAAYoS,EAASO,QAAS1B,GAZ/B,uDAAH,gBAAX3K,YAAW,sCAeX0F,EAAI,4DAAG,iIAELwQ,EAAO,IACP6T,EAAiB/4B,OAAO6D,KAAK6N,cAAY3M,KAAI,SAAArC,GAAG,OAAIA,EAAIgR,kBACzCrT,KAAK,UACpB04B,EAAetuB,SAAQ,SAAAiE,GACnBwW,EAAK7kB,KAAKqO,MANT,EASavI,QAAMC,WAApB2tB,EATC,EASDA,UATC,KAWKA,EAAU3hB,MAXf,sCAW8BmhB,eAAaC,SAAStO,GAXpD,kCAWH9S,EAXG,KAaH8kB,EAAO,CACT9kB,QACA/B,KAAM7M,QAAM8zB,cAAcC,WAC1BrzB,OAAQ,CACJwN,WAAYwT,IAjBX,kBAoBFgS,GApBE,wDAAH,gBAAJxiB,OAAI,mCAuBJ7E,EAAU,SAAVA,QAAUkkB,GAAa,MAEWsB,cAAY0B,cAAciC,KAAtDle,EAFiB,EAEjBA,SAAUH,EAFO,EAEPA,MAAOhB,EAFA,EAEAA,OAEnBwa,EAASJ,EAAUE,UAAUE,OAC7BA,EAAO1pB,SAAQ,SAACwuB,EAAMp5B,GACpBo5B,EAAKlyB,MAAQlH,EACbo5B,EAAKC,KAAOD,EAAKC,MAAQ,GACzBD,EAAKE,cAAgBF,EAAKC,KAAKn5B,OAAS,EAAI,GAAK,oBAEzD,IAAMq0B,EAAQL,EAAUE,UAAUG,MAC5BA,EAAM3pB,SAAQ,SAAC2uB,EAAMv5B,GACnBu5B,EAAKryB,MAAQlH,EACbu5B,EAAKF,KAAOE,EAAKF,MAAQ,GACzBE,EAAKD,cAAgBC,EAAKF,KAAKn5B,OAAS,EAAI,GAAK,oBAGzDqb,yBAAe,CAAE9K,MAAOyjB,EAAUE,UAAWE,SAAQC,SAAStZ,EAASO,QAAS1B,GAEhF,IAAMzU,EAAUyV,EAAMY,iBAAiB,4BAC1BZ,EAAMY,iBAAiB,2BAE/B9Q,SAAQ,SAAA4uB,GACTA,EAAIpd,iBAAiB,SAAS,SAAAyF,GAC1B,IAAMrR,EAAOqR,EAAE8B,OAAO/X,GACtBvG,EAAQuF,SAAQ,SAAApI,GACZA,EAAE6d,QAAQ7P,OAASA,EACbhO,EAAEsZ,UAAU1R,OAAO,kBACnB5H,EAAEsZ,UAAUlU,IAAI,2BAKlC,IAAM6xB,EAAc3e,EAAMQ,cAAc,kDAClCoe,EAAe5e,EAAMQ,cAAc,0BACnCqe,EAAiB7e,EAAMQ,cAAc,oCAE3C4Y,EAAUC,WAAaD,EAAUrd,WAAaqd,EAAUE,UAAUvJ,MAE/DqJ,EAAUC,YACTsF,EAAYre,UAAY,kFACxBse,EAAa5d,UAAUlU,IAAI,oCAC3B8xB,EAAate,UAAb,qBAAuC8Y,EAAUE,UAAUxD,QAA3D,mBAA6EsD,EAAUE,UAAUvJ,MAAjG,KACGqJ,EAAUE,UAAUtD,UAAY,GAC/B2I,EAAYre,UAAZ,uFACAue,EAAeve,UAAf,wBACAue,EAAevd,iBAAiB,SAAS,SAAAyF,GACrC,IAAM+X,EAAoBlG,eAAaO,aAAaC,EAAUE,UAAUG,MAAO5wB,QAAM8zB,cAAcC,WAAY,IAC/GkB,EAAmBgB,KACpB,CAAElH,MAAM,MAEXiH,EAAe7d,UAAUlU,IAAI,kBAC7B+xB,EAAevd,iBAAiB,SAAS,SAAAyF,GACrCzJ,EAAU8b,KACX,CAAExB,MAAM,OAGf+G,EAAYre,UAAZ,kCAAmD8Y,EAAUE,UAAUvJ,MAAvE,eAAmFqJ,EAAUrd,SAA7F,sBACA8iB,EAAevd,iBAAiB,SAAS,SAAAyF,GACrCzJ,EAAU8b,KACX,CAAExB,MAAM,MAINlI,EAAoB,CAC7BuL,UACA3d,YACAgf,UACAviB,KAAM6e,eAAaO,aACnB9kB,eAGEinB,EAAmB,SAAnBA,iBAAmBF,GACrB1L,EAAkBuL,QAAQG,IAGxB0C,EAAqB,SAArBA,mBAAqB1E,GACvB1J,EAAkBpS,UAAU8b,IAO1B4B,EAAmB,CACrBM,mBACAwC,qBACA3C,kBAPsB,SAApBA,kBAAoBptB,GACtB2hB,EAAkBrb,YAAYtG,M,8EChclC,4LAMailB,GANb,yFAMwC,SAA3BA,yBAA2B+L,GAEpC,IAAM3nB,EAAazG,QAAQnF,QAAMC,WAAW2L,YACtCA,EAAWhK,SAAW2xB,EAAYj2B,KAClCsO,EAAWhK,SAAWgK,EAAWhK,UAAYgK,EAAWK,MAAML,EAAWM,WAE/E,IAAMsnB,EAAkBD,EAAYj2B,MAC1Bi2B,EAAYt0B,UAAUhB,MAAM0Q,WAAa4kB,EAAYt0B,UAAUhB,MAAM0Q,WAAW/U,OAAS,EACzF,EAEV,GAAG45B,EAAkB,QAIjBC,8BAAoB7nB,M,muCCdrB,IAAMub,EAAkB,SAAlBA,gBAAkBoM,GAE3B,IAAM3nB,EAAazG,QAAQnF,QAAMC,WAAW2L,YAE5CA,EAAWhK,SAAW2xB,EAAYj2B,KAE/Bi2B,EAAYt0B,WAAas0B,EAAYt0B,UAAUhB,OAA8C,eAArCs1B,EAAYt0B,UAAUhB,MAAMzC,MACnFoQ,EAAWK,MAAX,6BAAwBsnB,EAAYt0B,UAAUhB,MAAM0Q,YAApD,CAAgE/C,EAAWhK,WAC3E6lB,sCAA4B7b,EAAY2nB,IAExCvM,4BAAkBpb,EAAY2nB,K,mECbtCp4B,EAAOD,QAFI,itC,uECDX,0NAKaqsB,EAAqB,SAArBA,mBAAqB3b,GAE9B,IAAMtO,EAAOsO,EAAWhK,SAFoB,EAGL5B,QAAMC,WAArCK,EAHoC,EAGpCA,WAAoBJ,GAHgB,EAGxBiD,OAHwB,EAGhBjD,QAItBmL,EAFqB/K,EAAWsF,QAAQ3B,MAAK,SAAAd,GAAM,MAAoB,yBAAhBA,EAAO3H,QAAiC6P,UAEhEqoB,WAAW90B,KAAI,SAAAmF,GAChD,IAAI4vB,EAAS5vB,EAAIunB,MAAMrnB,MAAK,SAAAxH,GAAC,OAAIA,EAAEgkB,WAAavgB,EAAOugB,YAEvD,MAAO,CACHkL,YAFJgI,EAASA,GAAU5vB,EAAIunB,MAAMrnB,MAAK,SAAAxH,GAAC,MAAmB,OAAfA,EAAEgkB,aAElB5S,gBAAkB,GACrC+lB,QAAS7vB,EAAI6vB,SAAW,GACxBC,KAAM9vB,EAAI8vB,MAAQ,GAClBC,IAAKH,EAAOG,KAAO,GACnBC,OAAQJ,EAAOG,KAAO,MACtBf,KAAMY,EAAOZ,MAAQ,GACrBiB,QAASL,EAAOZ,MAAQ,UAI1Bpe,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAYmf,IAErB,IAAMzgB,EAASC,MAAIC,UACnBF,EAAOsB,UAAY,GAEnB,IAAMof,EAAU,CACZC,KAAM,WACN72B,KAAMA,EACN+N,UAAWA,GAGf4J,yBAAeif,EAASvf,EAASO,QAAS1B,GAE1CoB,SAASQ,iBAAiB,iBAAiB9Q,SAAQ,SAAA8vB,GAAC,OAAIA,EAAEtJ,MAAMuJ,QAAU,Y,uFCzC9E,qUAOaxN,EAAkC,SAAlCA,gCAAkCjb,GAAc,IAEjD1L,EAAWF,QAAMC,WAAjBC,OAgBK0L,EAAWhK,UAIxB0yB,uCAlBiB,SAAXtd,SAAWud,GAEb,IAAM5f,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAY0f,IAErB,IAAMhhB,EAASC,MAAIghB,SACnBjhB,EAAOsB,UAAY,GAEnBG,yBAAe,CAACsf,UAAS5f,EAASO,QAAS1B,GAE3CkhB,6BAAmB9f,SAASQ,iBAAiB,qBAAsB,KAAMxJ,EAAY1L,Q,iFCtB7F,mKAuBayC,EAAqB,CAC9BC,aArBiB,SAAfA,eAEF,IAAM4R,EAAQI,SAASI,cAAc,gBACtBR,EAAMQ,cAAc,oBACtBc,iBAAiB,SAAS,SAAAyF,GACd/G,EAAMQ,cAAc,kBACtBF,UAAT,sN,+DCNlB3Z,EAAOD,QAFI,krF,u5BCUJ,IAAMy5B,EAAyB,SAAzBA,uBAA0B/oB,EAAYsoB,GAE/C,IAAMvf,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY8f,IAHgC,IAKnD10B,EAAWF,QAAMC,WAAjBC,OAEFsU,EAAQtU,EAAOS,gBAAkBiU,SAASI,cAAc,gBAAkBJ,SAE1EpB,EAAStT,EAAOS,gBACA6T,EAAMQ,cAAc,kBACpBvB,MAAIC,UACpBF,EAAOsB,UAAY,GAEVN,EAAMQ,cAAc,wBACtBF,UAAYlJ,EAAWpQ,KAEpC04B,EAAQrc,UAAYqc,EAAQrc,WAAa,GACzCqc,EAAQW,gBAAkBX,EAAQW,iBAAmB,GAErDX,EAAQY,UAAYZ,EAAQY,WAAa,GACzCZ,EAAQa,iBAAmBb,EAAQa,kBAAoB,GAEvD9f,yBAAeif,EAASvf,EAASO,QAAS1B,GAE1C,IAAMwhB,EAAexgB,EAAMQ,cAAc,uBAEtCggB,IAECA,EAAalgB,UAAY,WACzBkgB,EAAalf,iBAAiB,SAAS,SAAAyF,GAErC,IAAM0Z,EAAmBzgB,EAAMQ,cAAc,0BAEnB,SAApBkgB,oBAEFC,6BAAmBvpB,EAAWtG,GAAI2vB,GAElC,IAAI1W,EAAQ,GAEU,SAAhB6W,cAAiBC,EAAWC,GAC9BC,EAAgBF,GAChBL,EAAalgB,UAAYyJ,EAAQ,GAAM,EAAI,WAAa,OACxDA,IACA+W,EAAU9f,UAAU1R,OAAO,iBAC3BkxB,EAAalf,iBAAiB,SAAS,SAAAyF,GACnC6Z,cAAcE,EAAWD,KAC1B,CAAEjJ,MAAM,IAGfgJ,CAAcI,EAAmBP,GAGrCC,KAEC,CAAE9I,MAAM,IAEX4I,EAAa3Z,SAGjBoa,EAA2Bv1B,GAE3B,IAAMs1B,EAAoBhhB,EAAMQ,cAAc,2BACxC0gB,EAAWlhB,EAAMQ,cAAc,2BAC/B2gB,EAAeD,EAAS1gB,cAAc,iBAEtC1X,EAAOsO,EAAWhK,UAAYgK,EAAWK,MAAMioB,EAAQppB,MAAMoB,WAE7DqpB,EAAkB,SAAlBA,gBAAmB9b,EAAWmc,GAEhCnc,EAAUjE,UAAUlU,IAAI,iBACxBmY,EAAUjE,UAAU1R,OAAO,gBAExB8xB,IACCA,EAAKpgB,UAAUlU,IAAI,iBACnBs0B,EAAKpgB,UAAU1R,OAAO,kBAIxB+xB,EAAe,SAAfA,aAAgBpc,EAAWqc,GAE7Brc,EAAUjE,UAAU1R,OAAO,iBAG3B,IAAM8xB,EAAOphB,EAAMQ,cAAc8gB,GAC3BzgB,EAAOugB,EAAK5gB,cAAc,iBAGhC,OAFMK,EAAKG,UAAU1R,OAAO,iBAErB,CAAE8xB,OAAMvgB,SA8CnB,OA3CAsgB,EAAa7f,iBAAiB,QAA9B,4DAAuC,kBAAMC,GAAN,2GAE7BggB,EAAmBvhB,EAAMQ,cAAc,yBACvCghB,EAAiBxhB,EAAMQ,cAAc,uBAErCihB,EAL6B,4DAKT,8GAEtBlP,qBAAWnb,EAAY,WAAYtO,EAAMy4B,GAAkB,GAE3D32B,YAAW,WAEPm2B,EAAgBC,EAAmBE,GAFtB,MAIoCG,EAAaE,EAAkB,oBAAlEhuB,EAJD,EAIL6tB,KAJK,EAIcvgB,KAEfS,iBAAiB,QAA7B,4DAAsC,iBAAMC,GAAN,iGAElCzY,EAAK0T,OACCqW,6BAAmB,WAAY/pB,EAAK44B,SAAUF,EAAgB14B,EAAKi3B,OAAOtwB,MAAK,SAAAvK,GAAC,OAAIA,EAAEy8B,WAAW74B,EAAKi3B,OAAOtwB,MAAK,SAAAvK,GAAC,OAAIA,EAAEy8B,WAASC,IAAM94B,EAAKi3B,OAAO,GAAG6B,KACvJhP,0BAAgBxb,EAAY,WAAYtO,EAAM04B,GAAgB,GAEpET,EAAgBQ,EAAkBhuB,GANA,EAQWzK,EAAK0T,OAC5C6kB,EAAaG,EAAgB,sBAC7BH,EAAaG,EAAgB,kBAFrBK,EARoB,EAQ1BT,KAR0B,EAQTvgB,KAIfS,iBAAiB,SAAS,SAAAC,GAChCwf,EAAgBS,EAAgBK,GAChCR,EAAaL,EAAmB,oBAdF,sDAAtC,yDAkBD,KA5BmB,uDALS,gBAK7BS,oBAL6B,4CAoC7BA,IApC6B,uDAAvC,uDAuCAK,qBAAWh5B,EAAKgQ,SAAUkH,GAEFA,EAAMQ,cAAc,0BAK1CygB,EAA6B,SAA7BA,2BAA6Bv1B,GAE/B,IAAGA,EAAOS,gBAAV,CAEA,IAAMm0B,EAAYlgB,SAASI,cAAc,sBACnCtW,EAAWkW,SAASI,cAAc,qBAExCtW,EAAS8W,UAAUlU,IAAI,QAEvB,IACI5H,EAAI,EAEJ8kB,EAAWC,aAAY,WAChB/kB,EAAI,GACHgF,EAAS8W,UAAUlU,IAAI,QACvBwzB,EAAUtf,UAAU1R,OAAO,UAE3BpF,EAAS8W,UAAU1R,OAAO,QAC1BgxB,EAAUtf,UAAUlU,IAAI,WAE5B5H,GAXS,IAYW68B,cAAc/X,KACvC,Q,yECvKPrjB,EAAOD,QAFI,20B,6ECDX,yKAIaijB,EAAiB,SAAjBA,eAAkBje,EAAQsT,EAAQqH,GAE3C,IAAM+J,EAAY1kB,EAAO0kB,UAEnBjQ,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY0hB,IAE3BhjB,EAAOsB,UAAY,GAEnBG,yBAAe,CAAE2P,aAAajQ,EAASO,QAAS1B,GAEhD,IAAMijB,EAAmB7hB,SAASI,cAAc,qBAC1CyhB,EAAiB3hB,UAAjB,2BAAiD8P,EAAU3gB,MAAK,SAAA7I,GAAC,OAAIA,EAAEs7B,OAASx2B,EAAOugB,YAAUjlB,KAAjG,OAEN,IAAMm7B,EAAmB/hB,SAASI,cAAc,qBAC1C2hB,EAAiB7hB,UAAY8P,EAAU3gB,MAAK,SAAA7I,GAAC,OAAIA,EAAEs7B,OAASx2B,EAAOugB,YAAUjlB,KAEnFoZ,SAASQ,iBAAiB,kBAAkB9Q,SAAQ,SAAAmc,GAChDA,EAAS3K,iBAAiB,SAAS,SAAAC,GAC/B7V,EAAOugB,SAAWmE,EAAU3gB,MAAK,SAAA7I,GAAC,OAAIA,EAAEs7B,OAAS3gB,EAAMsH,OAAO/X,MAAIoxB,KAClE,IAAMl7B,EAAOopB,EAAU3gB,MAAK,SAAA7I,GAAC,OAAIA,EAAEs7B,OAAS3gB,EAAMsH,OAAO/X,MAAI9J,KAC7Di7B,EAAiB3hB,UAAjB,2BAAiDtZ,EAAjD,MACAm7B,EAAiB7hB,UAAYtZ,EAC7Bqf,EAAS3a,W,2ECxBrB/E,EAAOD,QAFI,0vB,0pCCIJ,IAAM07B,EAAY,SAAZA,UAAahrB,EAAY1L,GAElC,IAAI22B,EAAeC,EAAgBlrB,GAE7BL,EAAaK,EAAWxJ,MACJwJ,EAAWxJ,MAAMmJ,WACjBK,EAAWL,YAAX,mBAA8B,IAAI8H,IAAIzH,EAAWK,MAAMrN,KAAI,SAAAlF,GAAC,OAAIA,EAAEkX,iBAEtF6P,EAAWvgB,EAAO0kB,UAAU3gB,MAAK,SAAA7I,GAAC,OAAIA,EAAEs7B,OAASx2B,EAAOugB,YAAUjlB,KAElEmZ,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYiiB,IAE3B,IAAM5a,EAASvQ,EAAWxJ,MAAQwJ,EAAWxJ,MAAM6Z,OAAOC,iBAAiBtd,KAAI,SAAAwd,GAAK,OAAIA,EAAM5gB,QAAQ,GAChG0gB,EAAmBC,EAAOviB,OAAS,EAAhB,UAAuBuiB,EAAO,GAA9B,YAAoCA,EAAOA,EAAOviB,OAAS,IAAO,GACrFqiB,EAA2B,IAAlBE,EAAOviB,QAEwB,aAA5BgS,EAAWxJ,MAAM6Z,OADjB,sDACA,wCAEqCC,EAFrC,KAId8a,EAAiBC,EAAkB1rB,EAAYsrB,GAE/CK,EAActrB,EAAWurB,OAAS,GAEhCztB,EAAU,CACZmtB,eACAtrB,aACAmM,MAAO9L,EAAWpQ,KAClBilB,WACAvE,mBACAD,SACA+a,iBACAE,eAGJzjB,MAAIC,UAAUoB,UAAY,GAE1BG,yBAAevL,EAASiL,EAASO,QAASzB,MAAIC,WAE9CtU,YAAW,WAAM,MACuBg4B,EAAoBP,EAAcjrB,EAAYorB,EAAgBzrB,GAA/FsrB,EADU,EACVA,aAAcG,EADJ,EACIA,iBAClB,KAEH53B,YAAW,WAAM,MACuBg4B,EAAoBP,EAAcjrB,EAAYorB,EAAgBzrB,GAA/FsrB,EADU,EACVA,aAAcG,EADJ,EACIA,iBAClB,OAGDI,EAAsB,SAAtBA,oBAAuBP,EAAcjrB,EAAYorB,EAAgBzrB,GAKnE,MAJqB,OAAjBsrB,IACAA,EAAeC,EAAgBlrB,GAC/BgJ,SAASI,cAAc,uBAAuBF,UAAYkiB,EAAiBC,EAAkB1rB,EAAYsrB,IAEtG,CAAEA,eAAcG,mBAGrBC,EAAoB,SAApBA,kBAAqB1rB,EAAYsrB,GACnC,OAA6B,IAAtBtrB,EAAW3R,OAAX,UACEi9B,EADF,uBAC6BtrB,EAAW3R,OADxC,qBAEEi9B,EAFF,uBAE6BtrB,EAAW3R,OAFxC,WAKLk9B,EAAkB,SAAlBA,gBAAkBlrB,GACpB,IAAI2S,EAAS3S,EAAWyrB,WAAazrB,EAAWyrB,UAAUz9B,OAAS,EAC7DgS,EAAWyrB,UAAUz9B,OACrBgS,EAAWK,MAAQL,EAAWK,MAAMrS,OAAS,EACnD,OAAiB,IAAV2kB,EAAc,KAAOA,I,0hCCnEzB,IAAM+Y,EAAoB,SAApBA,kBAAoB1rB,GAAc,MAES5L,QAAMC,WAAlDC,EAFmC,EAEnCA,OAAQq3B,EAF2B,EAE3BA,YAAyBvoB,EAFE,EAEdpD,YAE7BA,EAAa,cAAH,iBAAQA,GAAR,IAAoBK,MAAO+C,EAAO/C,SAEjC6U,SAAW0W,qBAAW5rB,EAAY2rB,GAAe,GAAI9jB,MAAIC,WAAakjB,oBAAUhrB,EAAY1L,K,yDCR3G/E,EAAOD,QAFI,0tD,6DCDX,0QASayG,GATb,8CAS0B,SAAbA,WAAcvB,GAAuC,IAA9Bq3B,EAA8B,wDAE9Dp2B,eAAayC,OAAOzC,eAAa2C,UAAU,eAE3C,IAAMsgB,EAAqBhlB,gBAAcmmB,4BAEzC,KAAGrlB,EAAQQ,MAAQ,IAAMR,EAAQS,eAAjC,CAN8D,MAQ7Cb,QAAMC,WAAjBC,EARwD,EAQxDA,QAEHA,EAAOS,iBAAmB82B,IACzBzT,0BAOD9jB,EAAOM,iBAAmB8jB,GACzBN,8B,wECzBR7oB,EAAOD,QAFI,wjB,4ECDX,wXAYau4B,EAAsB,SAAtBA,oBAAsB7nB,GAE/B,IAAMtO,EAAOsO,EAAWhK,SAEpBtE,GAEJo6B,EAAwBp6B,IAGtBo6B,EAA0B,SAA1BA,wBAA0Bp6B,GAAQ,MAEG0C,QAAMC,WAArCC,EAF4B,EAE5BA,OAAQ0L,EAFoB,EAEpBA,WAAYzI,EAFQ,EAERA,OAI5B,KAFiBA,EAAO+I,YAAc/I,EAAOw0B,iBAAmB/iB,SAASI,cAAc,cAEvF,CAEA,IAIIuf,EAAQtoB,EAFN2rB,EAAkBhsB,EAAWisB,UAAYjsB,EAAWK,MAI1D,GAAI9G,WAAWhC,EAAOqB,QAAQ,GAAGhJ,KANjB,CAAE,gBAAiB,SAAU,eAMI,CAC7C,IAAM6M,EAASuvB,EAAgB75B,QAAO,SAAArE,GAAC,OAAIA,EAAE2O,OAAO7M,KAAK+R,gBAAkBjQ,EAAKgQ,SAASjF,OAAOkF,iBAEhGtB,GADAsoB,EAASpvB,OAAO,EAAGtG,QAAM+O,aAAakqB,EAAwBzvB,EAAQnI,EAAQ63B,gBAAcC,iBAC7Ep5B,KAAI,SAAAq5B,GAAK,OAAIL,EAAgB3zB,MAAK,SAAA3G,GAAI,OAAIA,EAAK9B,OAASy8B,EAAMC,oBAE7E3D,EAASpvB,OAAO,EAAGtG,QAAM+O,aAAazI,QAAQ7H,EAAKi3B,UACnDA,EAAS4D,gCAAsB,CAAE38B,KAAM8B,EAAK9B,KAAM48B,WAAY96B,EAAK86B,WAAY7D,UAAUr0B,EAAQ63B,gBAAcC,cAC/G/rB,EAAQ,CAAC3O,GAGbi3B,EAASA,EAAO31B,KAAI,SAAAq5B,GAChB,OAAOI,qBAAWJ,EAAOF,gBAAcO,aAAcp4B,MAGzDq4B,EAAyB,CAAEtsB,MAAOA,GAASsoB,EAAQj3B,KAGjDi7B,EAA2B,SAA3BA,yBAA4B3sB,EAAY2oB,EAAQj3B,GAAS,MAEhC0C,QAAMC,WAAzBkD,EAFmD,EAEnDA,OAAQjD,EAF2C,EAE3CA,OAEVs4B,EAAoB,CAAE,kBAAmB,gBAI/C,GAFar1B,EAAOqB,QAAQP,MAAK,SAAAQ,GAAM,OAAIU,WAAWV,EAAOjJ,KAAMg9B,MAEnE,CAEA,IAAM7jB,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAY0f,IAErB,IAAMhhB,EAASC,MAAIghB,SACbjhB,EAAOsB,UAAY,GAEzB2jB,kBAAQ,iDAAkDlE,EAAO31B,KAAI,SAAAlF,GAAC,OAAIA,EAAEg/B,WAE5EzjB,yBAAe,CAAEsf,UAAU5f,EAASO,QAAS1B,GAE7CkhB,6BAAmB9f,SAASQ,iBAAiB,qBAAsB9X,EAAMsO,EAAY1L,KAGnF43B,EAA0B,SAA1BA,wBAA2BzvB,EAAQnI,EAAQy4B,GAE7C,IAAIC,EAMJ,IAJAA,EAAazzB,UAAUkD,EAAOzJ,KAAI,SAAAlF,GAC9B,MAAO,CAAE66B,OAAQ76B,EAAE66B,OAAQj3B,KAAM,CAAE9B,KAAM9B,EAAE8B,KAAM48B,WAAY1+B,EAAE4xB,MAAM,GAAGzd,eAAgBA,eAAgBnU,EAAE4xB,MAAM,GAAGzd,eAAgByd,MAAO5xB,EAAE4xB,aAGjI1xB,OAAS,EAAG,CAEvB,IAAIi/B,EAAOD,EAAWh6B,KAAI,SAAAq5B,GACtB,IAAM36B,EAAO+K,EAAOpE,MAAK,SAAAvK,GAAC,OAAIA,EAAE8B,OAASy8B,EAAM36B,KAAK9B,QACpD,MAAO,CACH+4B,OAAQj3B,EAAKi3B,OACbj3B,KAAM,CACF9B,KAAM8B,EAAK9B,KACX48B,WAAY96B,EAAKguB,MAAM,GAAGzd,eAC1BA,eAAgBvQ,EAAKguB,MAAM,GAAGzd,eAC9Byd,MAAOhuB,EAAKguB,WAILnmB,UAAU0zB,GACZv0B,SAAQ,SAAAw0B,GACjBA,EAAYvE,OAAOjwB,SAAQ,SAAA2zB,GACvBW,EAAW1+B,KAAK,CAAEq6B,OAAQuE,EAAYvE,OAAQj3B,KAAMw7B,EAAYx7B,aAKxEs7B,EAAWh6B,KAAI,SAAAq5B,GAAK,OAAIA,EAAM36B,QAEhCgH,SAAQ,SAAA5K,GACV,IAAMw+B,EAAWx+B,EAAE8B,KACnB9B,EAAE66B,OAASlsB,EAAOpE,MAAK,SAAAvK,GAAC,OAAIA,EAAE8B,OAAS08B,KAAU3D,UAGrD,IAAMwE,EAAe,GAoBfC,EAAe,GASrB,OAPAJ,EAAWt0B,SAAQ,SAAC2zB,EAAOr3B,GACvB,IAAIq4B,EArBe,SAAjBC,eAAkBjB,EAAOr3B,EAAOm4B,GAClC,IAAII,EAAclB,EAAM1D,OAAOtwB,MAAK,SAAAvK,GAAC,OAAIA,EAAEy8B,WAI3C,OAHGgD,IACCA,EAAch0B,WAAWg0B,EAAYzhB,MAAOqhB,EAAan6B,KAAI,SAAAlF,GAAC,OAAIA,EAAEge,UAAU,KAAOyhB,GAEtFA,IAKCA,EAAclB,EAAM1D,OAAO3zB,MACRuE,WAAWg0B,EAAYzhB,MAAOqhB,EAAan6B,KAAI,SAAAlF,GAAC,OAAIA,EAAEge,WALzEqhB,EAAa7+B,KAAKi/B,GACXA,QAIP,EAUcD,CAAejB,EAAOr3B,EAAOm4B,GAC5CE,GACCD,EAAa9+B,KAAKk/B,+BAAqBH,EAAar4B,EAAOq3B,EAAM36B,KAAM4C,EAAQy4B,OAIhFK,I,uEC9IX,8QAMaK,EAAqB,SAArBA,mBAAsBC,EAASC,EAAchC,EAAaptB,EAAOjK,GAE1E6a,gCAAqB,SAAAnP,GAEjB,IAAM4H,EAASoB,SAASI,cAAc,8BAChCL,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY0kB,IAE3B,IAAMxqB,EAASyqB,yBAAuBC,sBAAsB9tB,EAAY2tB,EAAchC,EAAaptB,EAAOjK,GACpG8O,EAAO2qB,eAAiB,iBACxB3qB,EAAO4qB,mBAAqB,GAElCN,EAAQp/B,KAAK8U,GAEbA,EAAOqG,KAAOrG,EAAOqG,MAAQ,uEAE7BJ,yBAAe,CAAEjG,UAAU2F,EAASO,QAAS1B,GAE7C,IAAMkE,EAAQ9C,SAASI,cAAT,2CAA2DhG,EAAO1J,GAAlE,OACdm0B,yBAAuBI,0BAA0BniB,EAAO4hB,GAExD,IAAMQ,EAAallB,SAASI,cAAT,0CAA0DhG,EAAO1J,GAAjE,OACnBm0B,yBAAuBM,qBAAqBD,EAAYR,GAExD,IAAMU,EAAUplB,SAASI,cAAT,kDAAkEhG,EAAO1J,GAAzE,OAEb00B,IACDA,EAAQxkB,UAAU1R,OAAO,aACzB21B,yBAAuBQ,yBAAyBD,EAASV,EAASp5B,GAAQ,IAG5E,IAAMg6B,EAAoBtlB,SAASI,cAAT,kDAAkEhG,EAAO1J,GAAzE,OACvB40B,GACDA,EAAkB1kB,UAAUlU,IAAI,kBASlCsT,SAASI,cAAc,wBAAwBmlB,SANzB,CACpBC,KAAM,EACNC,IAAK,IACLC,SAAU,gB,iEC1CpBn/B,EAAOD,QAFI,ohB,0fCMJ,IAAMq/B,EAAmB,SAAnBA,iBAAmB3uB,IAEtB,iB,oRAAA,0BAAG,gIAEU5L,QAAMC,WAAjBC,EAFC,EAEDA,QAEFyU,EAAWC,SAASC,cAAc,aACzBC,UAAY0lB,IAErBhmB,EAAQI,SAASI,cAAc,gBAC/BxB,EAASgB,EAAMQ,cAAc,mBACtBF,UAAY,GAEzBG,yBAAe,CAAErJ,cAAc+I,EAASO,QAAS1B,GAElCgB,EAAMQ,cAAc,wBACtBF,UAAY,eAEnB2K,EAAyBjL,EAAMQ,cAAc,mCACtBF,UAAY,GAEnCL,EAAc,CAChB0B,UAAW,mBAAAjW,GACXY,UAAQC,kBAAkBb,KAI9Bwf,+BAAqBxf,EAAQsU,EAAOiL,EAAwBhL,EAAa7I,EAAWK,OAzB3E,uDAAH,gBAAJsC,OAAI,mCA4BVA,K,g+BCzBA,IAAMmrB,EAAwB,SAAxBA,sBAAyB9tB,EAAY2rB,EAAaptB,EAAOjK,GAE7D,IAAM6e,EAAOnT,EAAWL,WAAaK,EAAWL,WAAW3M,KAAI,SAAA2J,GAAK,OAAIA,EAAMkD,UAAQ9M,KAAK,MAAQ,GAWnG,OATAiN,EAAWmT,KAAOA,EAClBnT,EAAWkV,YAAWlV,EAAWmV,OAAU5b,UAAUyG,EAAWmV,QAChEnV,EAAW6uB,mBAAqB7uB,EAAWkV,SAAW,GAAK,iBAC3DlV,EAAW8uB,WAAaC,eAAaC,cAAcrD,GAAe,GAAI3rB,GACtEA,EAAWivB,YAAc,cAEzBjvB,EAAWkvB,cAAgBlvB,EAAWwC,OAAS2jB,MAAMgJ,QAAQnvB,EAAWwC,QAAUxC,EAAWwC,MAAMxU,OAAS,EAAI,GAAK,iBACrHgS,EAAWovB,0BAA4B,GAEhCpvB,GASHqvB,EAAmB,SAAnBA,iBAAoB1f,EAAG+d,GAE3B,IAAMjkB,EAAOkG,EAAEvF,cACTklB,EAAgBxlB,OAAKC,SAASN,EAAM,0BACpC8lB,EAAgBzlB,OAAKC,SAASN,EAAM,0BACpC+lB,EAAM/lB,EAAKE,cAAcA,cACzB6Y,EAAW/T,SAAShF,EAAK0E,QAAQqU,UACjCpf,EAASsqB,EAAQr1B,MAAK,SAAA7I,GAAC,OAAIA,EAAEkK,KAAO8oB,KACpC3U,EAAY7E,SAASI,cAAT,mDAAmEoZ,EAAnE,OACZiN,EAAczmB,SAASI,cAAT,2BAA2CoZ,IACzD0L,EAAallB,SAASI,cAAT,0CAA0DoZ,EAA1D,OAEfkN,EAASJ,EAAgB79B,QAAMk+B,UAAUC,aAAeL,EAAgB99B,QAAMk+B,UAAUE,oBAAsBp+B,QAAMk+B,UAAUG,QAClI1c,qBAAmB2c,iBAAiBL,GAEpCM,EAAkCxN,GAElC,IAAMyN,IAA2BR,EAC3BS,EAAsBpmB,OAAKC,SAAS0lB,EAAa,QAEjDU,EAAmBnnB,SAASI,cAAT,iDAAiEoZ,EAAjE,OACnB4N,GAAiB3mB,EAAK0E,QAAQkiB,oBAQpC,MAAO,CAAE5mB,OAAMrG,SAAQlK,MANT,CACZo3B,qBAAsBL,EACtBM,kBAAmBN,GAA0BC,EAC7CM,gBAAiBP,IAA2BC,GAAuBE,GAGvCX,cAAa5hB,YAAWsiB,mBAAkBjC,aAAYsB,MAAKF,kBAoHrFU,EAAoC,SAApCA,kCAAoCS,GAErBtK,MAAMC,KAAKpd,SAASQ,iBAAiB,2CAE7C9Q,SAAQ,SAAA01B,GAEjB,IAAMsC,EAAkBjiB,SAAS2f,EAAQjgB,QAAQqU,UAE9CkO,IAAoBD,IAErBrC,EAAQ/X,QAEOrN,SAASI,cAAT,wDAAwEsnB,EAAxE,OACF9mB,UAAU1R,OAAO,mCAK9By4B,EAAyB,4DAAG,kBAAMlnB,EAAMrG,EAAQyK,GAApB,qGAEhCsY,MAAMC,KAAK3c,EAAKE,cAAcinB,UAAUl4B,SAAQ,SAAAm4B,GAAK,OAAIA,EAAM1iB,QAAQoS,UAAW,MAE/EpnB,GAAcA,EAAWvJ,OAAS6B,QAAMk+B,UAAUC,aAAahgC,KAJlC,0DAMDwE,QAAMC,WAA7B8E,EANwB,EAMxBA,WANwB,EAMZ7E,OANY,SAQ1B8e,qBAAmBC,cAAc,CACrCC,YAAa7hB,QAAM8hB,YAAYud,oBAC/Brd,YAAa,CAAErQ,SAAQyK,eAVO,OAahCkjB,0BAAwBC,cAAc5tB,EAAO1J,IAbb,uDAAH,gBAAzBi3B,0BAAyB,0CAgBlB9C,EAAyB,CACpCC,wBACAmD,uBA3L6B,SAAzBA,uBAA0Bt8B,EAAag3B,EAAaptB,EAAOjK,GAC/D,OAAOK,EAAY3B,KAAI,SAAAgN,GACrB,OAAO8tB,EAAsB9tB,EAAY2rB,OA0L3C0C,yBAtJ+B,SAA3BA,yBAA4B5kB,EAAMikB,EAASp5B,EAAQ2Z,GAEvD,OAAOxE,EAAKS,iBAAiB,QAAtB,4DAA+B,iBAAMyF,GAAN,wHAE0D0f,EAAiB1f,EAAG+d,GAA1GjkB,EAF4B,EAE5BA,KAAMrG,EAFsB,EAEtBA,OAAQlK,EAFc,EAEdA,MAAOu2B,EAFO,EAEPA,YAAa5hB,EAFN,EAEMA,UAAWsiB,EAFjB,EAEiBA,iBAAkBX,EAFnC,EAEmCA,IAAKF,EAFxC,EAEwCA,cAEtE4B,EAAe,SAAfA,aAAex/B,GACnB,OAAGA,EAAKvD,eAAe,aACduD,EAAKy/B,UAMhB/tB,EAAO/C,MAAQ+C,EAAO/C,MAAMlO,QAAO,SAAAT,GAAI,OAAIw/B,EAAax/B,OAErD4C,EAAOS,gBAd0B,oBAgBPiU,SAASQ,iBAAiB,8CAC5B9Q,SAAQ,SAAA+Q,GAAI,OAAIA,EAAKE,cAAcC,UAAU1R,OAAO,uBAE1EuR,EAAK0E,QAAQkiB,sBACd5mB,EAAKG,UAAUlU,IAAI,oBACHsT,SAASI,cAAT,kDAAkEK,EAAK0E,QAAQqU,SAA/E,OACFtZ,UAAR,uDAAoE9F,EAAO1J,GAA3E,YAKLR,EAAMo3B,oBA3ByB,kCA4B1BK,EAA0BlnB,EAAMrG,EAAQyK,GA5Bd,QA+B/BI,GACDyd,4BAAkBtoB,GAClBguB,EAAiB3nB,EAAKE,cAAcA,cAAcA,cAAcinB,SAAS,GAAGA,SAAS,GAAGA,SAAS,GAC9FtB,GACEp2B,EAAMs3B,kBACPY,EAAeloB,UAAf,yDAA6E9F,EAAO1J,GAApF,YAIA41B,IACCp2B,EAAMs3B,gBACP/mB,EAAKP,UAAL,yDAAmE9F,EAAO1J,GAA1E,UACSR,EAAMq3B,oBACf9mB,EAAKP,UAAL,uDAAiE9F,EAAO1J,GAAxE,YAKHR,EAAMq3B,oBACPd,EAAY7lB,UAAU1R,OAAO,QACzBo3B,IACF7lB,EAAKP,UAAL,uDAAiE9F,EAAO1J,GAAxE,YAGDR,EAAMs3B,kBACPf,EAAY7lB,UAAUlU,IAAI,QAC1By6B,EAAiBjnB,UAAY6lB,eAAaC,cAAc56B,QAAMC,WAAWs3B,aAAe,GAAIvoB,IAzD5D,YA6DjC9O,EAAOM,eA7D0B,qBA+D/BsE,EAAMo3B,oBA/DyB,kCAgE1BK,EAA0BlnB,EAAMrG,EAAQyK,GAhEd,QAmElC6d,4BAAkBtoB,GAElBgQ,qBAAmBC,cAAc,CAC/BC,YAAa7hB,QAAM8hB,YAAYud,oBAC/Brd,YAAa,CAAErQ,SAAQyK,UAAWhG,MAAIC,UAAUsB,cAAc,+CAvE9B,QA2EpComB,EAAI5lB,UAAUlU,IAAI,+BA3EkB,uDAA/B,wDAqJPy4B,qBA/D2B,SAAvBA,qBAAuBD,GAE3BA,EAAWhkB,iBAAiB,QAA5B,4DAAqC,kBAAMyF,GAAN,gGAEnCyD,qBAAmB2c,iBAAiBt+B,QAAMk+B,UAAU0B,qBAEnCnD,EAAW/f,QAAQqU,SAJD,EAYhBpuB,QAAMC,WAZU,EAY3B+O,OAERgQ,qBAAmBC,cAAc,CAC/BC,YAAa7hB,QAAM8hB,YAAY+d,uBAC/B7d,YAAa,CACX/Z,GAAIw0B,EAAW/f,QAAQqU,YAjBQ,uDAArC,wDA8DAyL,0BAvEgC,SAA5BA,0BAA6BniB,EAAO4hB,GACtC5hB,EAAM5B,iBAAiB,SAAS,SAAAyF,GAC1B,IAAMvM,EAASsqB,EAAQr1B,MAAK,SAAA+K,GAAM,OAAIA,EAAO1J,KAAO+U,SAAS3C,EAAMqC,QAAQqU,aAC3EmM,2BAAiBvrB,OAqEzB4sB,sC,wECxNFzgC,EAAOD,QAFI,sf,4ECDX,0IAEaiiC,EAAyB,SAAzBA,uBAAyB3pB,GAElC,IAAM4pB,EAASxoB,SAASC,cAAc,OAChCuoB,EAAOtoB,UAAYuoB,IAEzB,IAAMC,EAAU1oB,SAASI,cAAc,4BAE9BJ,SAASI,cAAc,gBACzBuoB,aAAaH,EAAQE,K,oFCVhC,mEAgCaX,EAA0B,CACrCC,cAZoB,SAAhBA,cAAgBxO,GACpBhvB,YAAW,WACT,IAEMi7B,EAFgBmD,WAAWC,iBAAiB7oB,SAAS8oB,iBAAiBC,iBAAiB,WAAWjX,QAAQ,KAAM,KAvBnG,SAAjBkX,eAAiBxP,GAQnB,IANA,IAAIyP,EAAWjpB,SAASQ,iBAAiB,6CACrCkoB,EAAUO,EAAS,GACnBj9B,EAAQ,EAENk9B,EAAS,GAETR,GACJ18B,IACGyZ,SAASijB,EAAQvjB,QAAQqU,YAAcA,GACxC0P,EAAO5jC,KAAKojC,GACZA,EAAUO,EAASj9B,IAEnB08B,EAAU,KAId,OAAOQ,EAAOlkC,OAMDgkC,CAAexP,GAGtB2P,EAASnpB,SAASI,cAAc,4BACnC+oB,IAAQA,EAAOC,UAAY3D,S,iECzBlCl/B,EAAOD,QAFI,sI,w1CCYJ,IAAM8oB,EAAgB,SAAhBA,gBAAsB,MAE0ChkB,QAAMC,WAAzEC,EAFyB,EAEzBA,OAAQK,EAFiB,EAEjBA,YAAsBg5B,EAFL,EAEJD,QAAuB/B,EAFnB,EAEmBA,YAAaptB,EAFhC,EAEgCA,MAEzDwK,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYmpB,IAE3B,IAAI3E,EAAUG,yBAAuBoD,uBAAuBt8B,EAAYxC,QAAO,SAAA6N,GAAU,YAA6BpO,IAAxBoO,EAAWmxB,UAA0BnxB,EAAWmxB,YAAYxF,EAAaptB,EAAOjK,GAC1Ko5B,EAAUA,EAAQ4E,MAAK,SAAS9J,EAAEnC,GAC5B,IAAMkM,EAAM/J,EAAE93B,OAAS83B,EAAE93B,OAAO8hC,QAAU,EAE5C,OADcnM,EAAE31B,OAAS21B,EAAE31B,OAAO8hC,QAAU,GAC/BD,KAGrB,IAAI3qB,EAAStT,EAAOM,eAAiBiT,MAAIC,UAAYD,MAAIghB,SACrDjhB,EAAOsB,UAAY,GAEvBG,yBAAe,GAAIN,EAASO,QAAS1B,GAEnC8lB,EAAQh1B,SAAQ,SAAA0K,GAAM,OAAIqvB,uBAAarvB,MAEvCmuB,iCAAuB3pB,GAEOA,EAAOwB,cAAc,4BACvBc,iBAAiB,SAAS,SAAAyF,GAC1CrB,6BAAmB,GACnBuf,yBAAuBmC,kCAAkC,MAGhDhnB,SAASQ,iBAAiB,oBAC5B9Q,SAAQ,SAAAoT,GAAK,OAAI+hB,yBAAuBI,0BAA0BniB,EAAO4hB,MAE5F,IAAMgF,EAAqB1pB,SAASQ,iBAAiB,2BAC/CkpB,EAAmBh6B,SAAQ,SAAAi6B,GAAO,OAAI9E,yBAAuBQ,yBAAyBsE,EAASjF,EAASp5B,GAAQ,MACtHs+B,EAAsBF,GAEtB,IAAMG,EAAW7pB,SAASQ,iBAAiB,2BACrCqpB,EAASn6B,SAAQ,SAAA01B,GAAO,OAAIP,yBAAuBQ,yBAAyBD,EAASV,EAASp5B,GAAQ,MAC5Gs+B,EAAsBC,GAEtB,IAAMC,EAAU9pB,SAASQ,iBAAiB,mBACpCspB,EAAQp6B,SAAQ,SAAAw1B,GAAU,OAAIL,yBAAuBM,qBAAqBD,MAChF0E,EAAsBE,GAEtBt/B,YAAW,WAEL,IAAIgP,EAAQwG,SAASQ,iBAAiB,yBAClChH,EAAM9J,SAAQ,SAAA6J,GACZ,IAAIwwB,EAAkBxwB,EAAK6G,cAAc,UACzC2pB,EAAgB7oB,iBAAiB,SAAS,SAAAyF,GACpC,IAAMvM,EAASsqB,EAAQr1B,MAAK,SAAA+K,GAAM,OAAIA,EAAO1J,KAAO+U,SAASskB,EAAgB5kB,QAAQqU,aACrF,GAAGpf,EAAOZ,MAAO,KACH7L,EAAavC,QAAMC,WAAnBsC,SACRnD,YAAW,WAAM,IACHwuB,EAAc5tB,QAAMC,WAApB2tB,UACLA,GAAaA,EAAUQ,WAAapf,EAAO1J,GACxC4e,oBAAkBpS,UAAU8b,GAE5B1J,oBAAkBpS,UAAlB,+BAAiCoS,oBAAkB3V,KAAKhM,EAAUlF,QAAM8zB,cAAcC,WAAYpiB,IAAlG,IAA2G4gB,gBAAgB,OAErI,YAIpB4O,EAAsBpwB,KAE1B,KAEFirB,6BAAmBC,EAASC,EAAchC,EAAaptB,EAAOjK,IAG9Ds+B,EAAwB,SAAxBA,sBAAwBlF,GACxBA,EAAQh1B,SAAQ,SAAA0K,GAAM,OAAIA,EAAO8G,iBAAiB,SAAS,SAAAyF,GAExC3G,SAASQ,iBAAiB,iCAC5B9Q,SAAQ,SAAA82B,GAAG,OAAIA,EAAI5lB,UAAU1R,OAAO,iCAC/C,IAAMs3B,EAAMxmB,SAASI,cAAT,wDAAwEhG,EAAO+K,QAAQqU,SAAvF,OACRgN,GACEA,EAAI5lB,UAAUlU,IAAI,sC,4DCxFpCnG,EAAOD,QAFI,wpH,gECDX,sLAKamjC,EAAe,SAAfA,aAAgBrvB,GAAW,MAEEhP,QAAMC,WAAlCC,EAF0B,EAE1BA,OAAQo5B,EAFkB,EAElBA,QAASn2B,EAFS,EAETA,OAEnBwR,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY0kB,IAE3BxqB,EAAO2qB,eAAiB3qB,EAAO8R,SAAW,GAAK,iBAC/C9R,EAAO4qB,mBAAqB5qB,EAAO8R,SAAW,iBAAmB,GAEjE,IAAM8d,EAActF,EAAQr1B,MAAK,SAAA46B,GAAK,OAAIA,EAAMjzB,WAAWtG,KAAO0J,EAAO1J,MAWzE,GATA0J,EAAO8vB,WAAaF,GAAe1+B,EAAO0L,WAAWtG,KAAO0J,EAAO1J,GACnE0J,EAAOqG,KAAOrG,EAAOqG,MAAQ,uEAE7BJ,yBAAe,CAAEjG,UAAU2F,EAASO,QAASN,SAASI,cAAc,yBAEjE4pB,GACGG,EAAaH,EAAYz7B,OAAQy7B,EAAYhzB,WAAY,KAAM1L,GAGlEA,EAAO0L,WAAWtG,KAAO0J,EAAO1J,GAAI,CAEjC,IAAM81B,EAAMxmB,SAASI,cAAT,wDAAwEhG,EAAO1J,GAA/E,OACH81B,GAAKA,EAAI5lB,UAAUlU,IAAI,8BAE7BpB,EAAOS,iBACJvB,YAAW,WACL,IAAM06B,EAAasB,EAAIpmB,cAAc,sBAClC8kB,GAAYA,EAAW7X,WAKnC9e,GAAUA,EAAO0Q,iBACdkrB,EAAa57B,EAAQ6L,EAAQ,gBAAiB9O,KAK1D6+B,EAAe,SAAfA,aAAgB57B,EAAQ6L,EAAQ6I,EAAW3X,GAC3C,IAAMmhB,EAAczM,SAASI,cAAc,2BACrC/Y,EAAUkH,EAAOoQ,mBAAqBpQ,EAAOoQ,mBAAqB8N,EAAcA,EAAYplB,MAAQ,EACpGu2B,EAAS,qCAAH,OAAyCv2B,EAAzC,kBAAyDkH,EAAO0Q,gBAAhE,iBACGe,SAASI,cAAT,qCAAqDhG,EAAO1J,GAA5D,OACFwP,UAAY0d,EAEH5d,SAASI,cAAT,0CAA0DhG,EAAO1J,GAAjE,OACF4Q,UAAY,gB,iFCrDtC,0DAAO,IAAMwR,EAAqB,SAArBA,mBAAqB9b,GAKhBgJ,SAASQ,iBAAiB,0B,oECF5Cja,EAAOD,QAFI,+Q,uxCCOJ,IAAM0sB,EAAyB,SAAzBA,uBAAyBhc,GAAc,MAEb5L,QAAMC,WAAjCC,EAFwC,EAExCA,OAAQ8O,EAFgC,EAEhCA,OAAQ7L,EAFwB,EAExBA,OAElB7F,EAAOsO,EAAWhK,UAAYgK,EAAWK,MAAML,EAAWM,WAE1D4B,EAAW3K,EAAO+P,SAAS1X,MAAQ2H,EAAO+P,SAAS3K,MACnDusB,EAAY3xB,EAAO+P,SAAS4hB,UAC5BC,EAAmB5xB,EAAO+P,SAASxU,SAEnC8U,EAASmhB,iCAAuB/oB,EAAY,CAAEiC,eAAgBvQ,EAAKuQ,eAAgBC,WAAUpP,SAAU,GAAID,KAAM,GAAI0P,KAAM,GAAI0J,UAAW,GAAIgd,gBAAiB,GAAI/pB,WAAOtN,EAAWs3B,YAAWC,qBAEhMpgB,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYkqB,IAE3B,IAAIjgC,EAAUF,QAAM+O,aAAN,6BAAwBzK,EAAO+P,SAASnU,SAAxC,CAAiDoE,EAAO+P,SAASqX,UAE/ExrB,EAAUA,EAAQH,KAAI,SAAC2rB,EAAQ3pB,GAC3B,MAAO,CACHuN,KAAMoc,EACN3pB,YAIRqU,yBAAe,CAAElW,WAAW4V,EAASO,QAAS1B,GAE9CoB,SAASI,cAAc,0BAA0BQ,UAAUlU,IAAI,kBAC/DsT,SAASI,cAAc,0BAA0BQ,UAAU1R,OAAO,kBAElE,IAAMm7B,EAASrqB,SAASQ,iBAAiB,0BACnC7M,EAAQ,CAAE/M,KAAM8B,EAAKgQ,SAASjF,OAAQyF,SAAUxQ,EAAK9B,KAAMkD,SAAUyE,EAAO+P,SAASqX,OAAOpc,MAE5F0b,EAAO,CAAEwB,OAAQ/tB,EAAKgI,GAAI2G,MAAOgzB,EAAQ12B,QAAOuF,SAAUxQ,EAAK9B,KACjEyY,cAAejF,EAAOiF,cAAepG,eAAgBvQ,EAAKuQ,eAC1DqG,YAAalF,EAAOkF,YAAa7J,OAAQlH,EAAOkH,OAAQ60B,KAAM,GAC9DxT,YAAa3sB,EAAQogC,WAAU,SAAA/K,GAAC,OAAIA,EAAEjmB,OAAShL,EAAO+P,SAASqX,UAASxrB,UACxE2rB,aAAcqK,EAAkBD,aAEpClL,uBAAa,QAASC,EAAM,KAAM3pB,K,+GC3CtC/E,EAAOD,QAFI,ikB,k3FCeX,IAAIkkC,EAA4B,GAC5BC,EAAwB,GAEfC,EAAqB,SAArBA,mBAAqBzkB,GAC9BwkB,EAAsBnlC,KAAK2gB,IAGlB0kB,EAAyB,SAAzBA,uBAAyB1kB,GAClCukB,EAA0BllC,KAAK2gB,IAGtB2kB,EAA4B,SAA5BA,0BAA6B5zB,EAAY6zB,EAAmBC,GAA8C,IAA5BC,EAA4B,wDAE/GC,EAAgBH,GAAqB,EAF0E,EAIjFz/B,QAAMC,WAAhCC,EAJ2G,EAI3GA,OAAQiK,EAJmG,EAInGA,MAAO6E,EAJ4F,EAI5FA,OAEjB1R,EAAO6H,QAAQyG,EAAWhK,UAEhC,GAAItE,EAAJ,CAEA,IAAMqX,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY0f,IAE3B,IAAMhhB,EAASC,MAAIghB,SACbjhB,EAAOsB,UAAY,GAEzB,IAAM+qB,EAAoB,4DAAG,kIAENH,EAFM,qCAEoBpvB,uBAAa1E,GAFjC,0BAEnBk0B,EAFmB,KAInBvL,EAAS11B,QAAM+O,aAAakyB,GAAYlhC,KAAI,SAACtB,EAAMsD,GAErD,IAAIg4B,EAAa+G,EACP9gC,QAAM+O,aAAatQ,EAAKi3B,QACxBj3B,EAAKi3B,OAAOx2B,QAAO,SAAArE,GAAC,OAAIA,EAAEy8B,WAASv8B,OAAS,EAAI0D,EAAKi3B,OAAOx2B,QAAO,SAAArE,GAAC,OAAIA,EAAEy8B,WAAWt3B,QAAM+O,aAAatQ,EAAKi3B,QAQvH,OALGqE,EAAWh/B,OAASgmC,IACnBhH,EAAa,GAAH,0BAAQA,GAAR,mBAAuBzzB,OAAOy6B,EAAehH,EAAWh/B,OAAQiF,QAAM+O,aAAatQ,EAAKi3B,QAAQx2B,QAAO,SAAArE,GAAC,OAAKA,EAAEy8B,eAItHyC,EAAWh6B,KAAI,SAACq5B,EAAO8H,GAC1B,GAAGA,EAAaH,EAAe,CAC3B,GAAG3H,EAAM7B,IACL,oCAASx1B,MAAOA,EAAQm/B,GAAe9H,GAAvC,IAA8CS,OAAQL,qBAAWJ,EAAOF,gBAAciI,gBAAiB9/B,GAAQw4B,OAAQR,SAAU56B,EAAK9B,OAEtIokC,QAGT7hC,QAAO,SAAAk6B,GAAK,OAAIA,QACpBgI,OAEHzsB,EAAOsB,UAAY,GAEnB2jB,kBAAQ,6CAA8ClE,EAAO31B,KAAI,SAAAlF,GAAC,OAAIA,EAAEg/B,WAExEzjB,yBAAe,CAAEsf,UAAU5f,EAASO,QAAS1B,GAE7CpU,YAAW,WACPggC,EAA0B96B,SAAQ,SAACuW,EAAUja,GAC5B,IAAVA,GACCia,EAAS0Z,QAGlB,KAEGvd,EAAW,SAAXA,SAAY7M,EAAOghB,GACrBkU,EAAsB/6B,SAAQ,SAAAuW,GAAQ,OAAIA,EAAS1Q,EAAOghB,QAGxD+U,EAAatrB,SAASQ,iBAAiB,kBAElC9Q,SAAQ,SAAA2zB,GACfA,EAAMniB,iBAAiB,QAAvB,4DAAgC,iBAAMC,GAAN,sHAEtBoqB,EAAgBpqB,EAAMsH,OACtB+iB,EAAeD,EAAcpmB,QAAQme,SAHf,SAIDj3B,YAAU6N,iBAAiBsxB,GAJ1B,cAItBC,EAJsB,OAMtB3hC,EAAWpB,EAAK9B,KAChB+uB,EAAS8V,EAAa7kC,KAEtBuD,EAAU,GAEhBmhC,EAAW57B,SAAQ,SAAA+nB,GACfttB,EAAQ7E,KAAK,CAAE+B,MAAOowB,EAAKtS,QAAQme,SAAU9B,IAAKiC,qBAAW,CAAEjC,IAAI/J,EAAKtS,QAAQqc,MAAOkK,QACpFjU,EAAKtS,QAAQme,WAAa56B,EAAK9B,MAC9B6wB,EAAK7W,UAAUlU,IAAI,iBAdC,UAkBDL,YAAU6N,iBAAiBpQ,GAlB1B,eAkBtB6hC,EAlBsB,iBAmBHt/B,YAAU6N,iBAAiBpQ,GAnBxB,QAmBtB8hC,EAnBsB,cAqBtB3W,EArBsB,+BAqBV1f,GArBU,IAqBHkhB,OAAQ/tB,EAAKgI,GAClC5G,WAAU6rB,SAAQzc,SAAUxQ,EAAK9B,KACjCyY,cAAejF,EAAOiF,cAAeC,YAAalF,EAAOkF,YACzD7J,OAAQ,EAAGgL,KAAMorB,oBAAUnjC,EAAKgQ,SAAU/B,cAC1CsC,eAAgB6yB,iBAAeC,kBAAkBJ,EAAcrgC,GAC/D0gC,qBAAsBF,iBAAeC,kBAAkBH,EAAYtgC,GACnEnB,UACA2rB,aAAcxqB,EAAOM,eAAiB,sBAAwB,2BAGlDorB,cAEhBhC,uBAAa,cAAeC,EAAM7S,EAAU9W,GAjChB,uDAAhC,0DAhDqB,wDAAH,gBAApB2/B,uBAAoB,mCAsF1BA,O,kHC9HJ1kC,EAAOD,QAFI,we,wxBCcJ,IAAMusB,EAA8B,SAA9BA,4BAA+B7b,EAAY2nB,GAAgB,MAEzCvzB,QAAMC,WAFmC,EAE5DC,OAF4D,EAEpDiD,OAEhByjB,+CAAqChb,K,yGChBzCzQ,EAAOD,QAFI,2d,6GCDX,qVAOa2lC,EAAyB,SAAzBA,uBAAyBj1B,GAAc,IAExCzI,EAAWnD,QAAMC,WAAjBkD,OAEFwR,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYgsB,IAE3B,IAAMttB,EAASC,MAAIghB,SACXjhB,EAAOsB,UAAY,GAE3BG,yBAAe,CAAExX,OAAQ0F,EAAO1F,QAAUkX,EAASO,QAAS1B,GAE5D,IAAMutB,EAAansB,SAASQ,iBAAiB,iBAC7C2rB,EAAWz8B,SAAQ,SAAA+nB,GACZA,EAAKrX,cAAc,OAAOgsB,IAAIrb,QAAQ,QAAU,GACnDob,EAAWz8B,SAAQ,SAAA+nB,GAAI,OAAIA,EAAK7W,UAAUlU,IAAI,aAI/C6B,EAAO0P,eAAejZ,OAAS,GAC9BmnC,EAAWz8B,SAAQ,SAAA+nB,GAAI,OAAIA,EAAK7W,UAAUlU,IAAI,eAGlDy/B,EAAWz8B,SAAQ,SAAA+nB,GAAI,OAAI5Z,oBAAkBwuB,mBAAmB5U,EAAMlpB,EAAO0P,eAAgBkuB,Q,omECrBjG,IAAMG,EAAyB,GAKzBC,EAA0B,GA4D1BC,EAAe,GAEfpqB,EAAW,SAAXA,SAAY7M,EAAOghB,GACrB,IAAMkW,EAAoBzsB,SAASI,cAAc,2BAC3CqsB,EAAkBzpB,UAAW,EACnCwpB,EAAaj3B,MAAQA,EACrBi3B,EAAajW,iBAAmBA,EAEhCkW,EAAkBvrB,iBAAiB,SAAS,WACxC9Y,OAAO6hB,aAAauiB,EAAajW,kBACjCH,oBAAUoW,EAAaj3B,WAoClBsI,EAAoB,CAC7BC,iBAtGqB,SAAnBA,iBAAoB4uB,EAAcC,GAEpC,IAGI,IAFA,IAAI5uB,EAAqB1U,EADzB,gDAGU1B,EAHV,KAGeilC,EAHf,KAKIF,EAAa1iC,KAAI,SAAA1C,GACVA,EAAEqR,gBAAkB1O,QAAM4iC,YAAYllC,GAAKgR,gBAC1CoF,EAAsB6uB,EAAIvlC,MAAM2C,KAAI,SAAA8iC,GAAC,OAAIA,EAAEn0B,iBAC3CtP,EAAQ/B,OALpB,MAAuBrC,OAAO8nC,QAAQJ,GAAtC,eAAoD,IAUpD,MAAO,CAAE5uB,sBAAqB1U,SAChC,MAAOsd,GAEP,OADAnK,mBAASsB,iBAAkB6I,GACpB,CAAE5I,oBAAqB,GAAI1U,MAAO,MAqF3C2U,YAhFa,iB,oRAAA,0BAAG,iBAAO3U,EAAO0U,EAAqBivB,GAAnC,4GAEVr/B,EAAWvC,QAAMC,WAAWsC,SAFlB,SAIGtB,YAAU4gC,oBAAoBt/B,EAAUq/B,EAAU3jC,GAJrD,WAIZR,EAJY,QAKL6G,SAAQ,SAAApI,GAGX,OAFAA,EAAEiS,KAAOjS,EAAEiS,KAAKZ,cACbrR,EAAE4lC,MAAK5lC,EAAE4lC,IAAM5lC,EAAE4lC,IAAIv0B,eACjBrR,KAGXyW,EAXY,yCAWgB,CAAElV,OAAQ,KAAMoV,eAAgB,OAXhD,cAeZkvB,GAFAA,EAAYlkC,gBAAcmkC,uBAAuBvkC,EAAOmB,KAAI,SAAA1C,GAAC,OAAIA,EAAEiS,QAAOwE,EAAoB/Y,SAExEmE,QAAO,SAAAkkC,GACzB,OAAQpkC,gBAAckvB,uBAAuBkV,EAAUtvB,MAGvDE,EAAiBpV,EAAOM,QAAO,SAAA7B,GAAC,OAAIiJ,WAAWjJ,EAAEiS,KAAMwE,MAE3DovB,EAAYljC,QAAM+O,aAAN,6BAAwBzI,OAAO,EAAG48B,IAAlC,CAA8CpvB,KAE1DlV,EAASskC,EAAUnjC,KAAI,SAAAqjC,GACnB,OAAOA,EAASrjC,KAAI,SAAAuP,GAAI,OAAI1Q,EAAOwG,MAAK,SAAAhG,GAAK,OAAIA,EAAMkQ,OAASA,WAGxE+yB,EAAuB58B,SAAQ,SAAAuW,GAAQ,OAAIA,EAASpd,EAAQoV,MA3B5C,kBA6BT,CAAEpV,SAAQoV,mBA7BD,uDAAH,gBAAXD,YAAW,0CAiFbsvB,cAjHkB,SAAhBA,cAAgBrnB,GAClBqmB,EAAuBhnC,KAAK2gB,IAiH5BsnB,eA7GmB,SAAjBA,eAAiBtnB,GACnBsmB,EAAwBjnC,KAAK2gB,IA6G7BomB,mBArCuB,SAArBA,mBAAsB5U,EAAMxZ,EAAgBuvB,GAAU,MAEjBpiC,QAAMC,WAArCC,EAFgD,EAEhDA,OAAQ8O,EAFwC,EAExCA,OAEV1R,EAJkD,EAEhCsO,WAEAhK,SAExByqB,EAAKvW,iBAAiB,SAAS,SAAAyF,GAE3B,IAAM8Q,EAAO9Q,EAAEvF,cACTvY,EAASs0B,MAAMC,KAAK3F,EAAKjX,iBAAiB,QAAQxW,KAAI,SAAA1C,GAAC,OAAIA,EAAE6d,QAAQ5L,QAErEpP,EADSgzB,MAAMC,KAAKoQ,GAAOxjC,KAAI,SAAA1C,GAAC,OAAIA,EAAE8Y,cAAc,OAAO+E,WAC1Cnb,KAAI,SAAAlF,GAAO,MAAO,CAAEuC,MAAOvC,EAAEyU,KAAMioB,IAAK18B,EAAE08B,QAC3DvM,EAAO,CACTxf,OAAQ,EACRyD,SAAUxQ,EAAK9B,KACfyC,OAAO,EACPS,SAAUmU,EAAejU,KAAI,SAAAX,GAAK,OAAIA,EAAMkQ,QAC5Coc,OAAQ9sB,EACRwW,cAAejF,EAAOiF,cACtBC,YAAalF,EAAOkF,YACpBnV,UACA2rB,aAAc,mBAElBd,uBAAa,cAAeC,EAAM7S,EAAU9W,GAE5CkiC,EAAM99B,SAAQ,SAAA+nB,GACNxuB,gBAAckvB,uBAAuBgF,MAAMC,KAAK3F,EAAKjX,iBAAiB,QAAQxW,KAAI,SAAA0tB,GAAG,OAAIA,EAAIvS,QAAQ5L,QAAO0E,EAAejU,KAAI,SAAAX,GAAK,OAAIA,EAAMkQ,UAC9Ike,EAAKjX,iBAAiB,OAAO9Q,SAAQ,SAAAgoB,GAAG,OAAIA,EAAI9W,UAAUlU,IAAI,0B,4GChH9EnG,EAAOD,QAFI,+V,umBCOJ,IAAMysB,EAA2B,SAA3BA,yBAA2B/b,IAE1B,iB,oRAAA,0BAAG,4HAE8B5L,QAAMC,WAArCkD,EAFC,EAEDA,OAAQyI,EAFP,EAEOA,WAFP,EAEmB1L,OAEX0U,SAASC,cAAc,YACzBC,UAAYutB,IAErB/kC,EAAOsO,EAAWhK,SACP,kBACXnD,EATG,6BAS0BI,QAAMyjC,cAAcn/B,EAAOlF,QAE/C02B,iCAAuB/oB,EAAY,CAAEiC,eAAgBvQ,EAAKuQ,eAAgBC,SAAUxQ,EAAK9B,KAAMkD,SAH7F,kBAGuGD,OAAM0P,KAAM,KAEpI6Y,4BAAkBpb,EAAY,KAAM,CAAEnO,OAAQ0F,EAAO1F,OAAQoV,eAAgB1P,EAAO0P,eAAgBvV,OAAMoB,SALzF,kBAKmGD,SAb3G,sDAAH,gBAAJ8P,OAAI,mCA6BVA,K,wECpCJpT,EAAOD,QAFI,uU,2ECEXC,EAAOD,QAFI,4X,kpECmBJ,IAAM8rB,EAAoB,SAApBA,kBAAqBpb,EAAYd,EAAOimB,GAEjD,IAAI,MAE+C/wB,QAAMC,WAA7CC,EAFR,EAEQA,OAAQ8O,EAFhB,EAEgBA,OAAQ7L,EAFxB,EAEwBA,OAAQ4B,EAFhC,EAEgCA,WAEhC,GAAGE,oBAAkBs9B,eAAex9B,EAAY7E,GAAW,OAE3D,IAM2BsiC,EANrBllC,EAAOsO,EAAWhK,UAAYgK,EAAWK,MAAML,EAAWM,WAE1D3D,EAAQ0F,qBAAW3Q,EAAKgQ,SAAU/B,cAElC9G,EAASqG,GAAQA,EAAMrG,QAA8BtB,EAAOqB,QAAQ,GAI1Eg+B,EAAkBtiC,EAAOugB,SAEf,4DAAG,mLAEHgiB,EAAS,SAATA,OAAUlY,EAAQxrB,EAASE,GAE7B,IAAM4O,EAAkB5O,QAA0CzB,IAA7ByB,EAAU4O,eAAgC5O,EAAU4O,eAAiBvQ,EAAKuQ,eACzGC,EAAY7O,QAAoCzB,IAAvByB,EAAU6O,SAA0B7O,EAAU6O,SAAWxQ,EAAK9B,KACvFkD,EAAYO,GAAaA,EAAUP,SAAYO,EAAUP,SAAW,iBACpEgkC,EAAcxiC,EAAOS,gBAAkB,2BAA6B,2BACpElC,EAAQQ,QAAgCzB,IAAnByB,EAAUR,KAAsBQ,EAAUR,KAAOikC,EACtEv0B,EAAQlP,QAAgCzB,IAAnByB,EAAUkP,KAAsBlP,EAAUkP,KAAO,GACtE0J,EAAa5Y,QAAqCzB,IAAxByB,EAAU4Y,UAA2B5Y,EAAU4Y,UAAY,GACrFgd,EAAmB51B,QAA2CzB,IAA9ByB,EAAU41B,gBAAiC51B,EAAU41B,gBAAkB,GACvGqK,EAAQjgC,QAAgCzB,IAAnByB,EAAUigC,KAAsBjgC,EAAUigC,KAAO,KAEtE1rB,EAASmhB,iCAAuB/oB,EAAY,CAAEiC,iBAAgBC,WAAUpP,WAAUD,OAAM0P,OAAM0J,YAAWgd,kBAAiB/pB,UAE1H6J,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAYyV,EAAO+B,IAAMqW,IAAyB3D,IAEjEjgC,EAAQuF,SAAQ,SAACimB,EAAQ3pB,GACrB2pB,EAAO3pB,MAAQA,EACf2pB,EAAO/uB,KAAO+uB,EAAO/uB,MAAQ,GAC7B+uB,EAAOe,MAAQf,EAAOe,MAAQf,EAAOe,MAAM3sB,KAAK,MAAQ,MAG5DsW,yBAAe,CAAElW,WAAW4V,EAASO,QAAS1B,GAE9C,IAAMyrB,EAASrqB,SAASQ,iBAAiB,0BAEtCnW,EAAU2jC,WAAW3D,EAAO36B,SAAQ,SAAAwnB,GAAK,OAAIA,EAAMtW,UAAUlU,IAAI,eAEpE,IAAMiH,EAAQ,CAAE/M,KAAM8B,EAAKgQ,SAASjF,OAAQyF,SAAUxQ,EAAK9B,KAAMkD,SAAU6rB,EAAOpc,MAE5E0b,EAAO,CACTwB,OAAQ/tB,EAAKgI,GACb2G,MAAOgzB,EACP12B,QAAOuF,SACPxQ,EAAK9B,KACLyY,cAAejF,EAAOiF,cACtBC,YAAalF,EAAOkF,YACpB7J,OAAQlH,EAAOkH,OACf60B,OACAxT,YAAa3sB,EAAQogC,WAAU,SAAA/K,GAAC,OAAIA,EAAEjmB,OAASoc,EAAOpc,QACtDuc,aAAchsB,GAGlBkrB,uBAAa,QAASC,EAAM,KAAM3pB,IAGnB,wBAAhBuE,EAAOjJ,MAAgC,4DAEN,iIAItBqnC,EAJsB,4DAIN,mHAElBtY,EAAS,CAAEpc,KAAM7Q,EAAK9B,MAFJ,SAGF8U,uBAAa1E,EAAY,GAHvB,OAGlB7M,EAHkB,OAIlBA,EAAUoG,OAAO,EAAGpG,GAAShB,QAAO,SAAA/C,GAAC,OAAIA,EAAEQ,KAAK+R,gBAAkBjQ,EAAK9B,KAAK+R,iBAAe3O,KAAI,SAAA5D,GAAC,OAAIA,EAAEQ,SACtGuD,EAAUoG,OAAO,EAAGpG,IACZ7E,KAAKoD,EAAK9B,MAClBuD,EAAUA,EAAQH,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAC5Cr1B,EAAUF,QAAM+O,aAAa7O,GAE7BN,EAAOyB,EAAOS,gBAAkB,sBAAwB,sBAVtC,uDAJM,gBAItBkiC,gBAJsB,4CAiBtBA,IAjBsB,OAmB5BJ,EAAQlY,EAAQxrB,EAAS,CAAE+O,SAAU,aAAcpP,SAAU,yBAA2BD,OAAMmkC,WAAW,IAnB7E,uDAFM,gBAEhCE,0BAFgC,kCAwBtCA,GAGe,wBAAhBr+B,EAAOjJ,MAAgC,4DAEJ,iIAIxBqnC,EAJwB,4DAIR,qHAElBtY,EAAS,CAAEpc,KAAM7Q,EAAKuQ,gBAFJ,SAGFyC,uBAAa1E,EAAY,GAHvB,OAIlB7M,GADAA,EAHkB,QAIAH,KAAI,SAAAw1B,GAAC,OAAIsM,iBAAeC,kBAAkBvM,EAAGl0B,GAAQ,EAAO,iBAAkBsiC,MAChGzjC,EAAUoG,OAAO,EAAGpG,EAAQhB,QAAO,SAAAq2B,GAAC,OAAIA,IAAM92B,EAAKuQ,mBAEnD9O,GADAA,EAAUF,QAAM+O,aAAN,CAAoBtQ,EAAKuQ,gBAAzB,0BAA4C9O,MACpCH,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAE5C31B,EAAOyB,EAAOS,gBAAkB,sBAAwB,sBATtC,uDAJQ,gBAIxBkiC,gBAJwB,4CAgBxBA,IAhBwB,OAkB9BJ,EAAOlY,EAAQxrB,EAAS,CAAE8O,eAAgB,cAAenP,SAAU,0BAA2BD,SAlBhE,uDAFI,gBAEhCskC,4BAFgC,kCAuBtCA,GAGe,2BAAhBt+B,EAAOjJ,MAAmC,4DAEf,iIAIhBqnC,EAJgB,4DAIA,qHAElBtY,EAAS,CAAEpc,KAAM7Q,EAAK0lC,SAFJ,SAGF1yB,uBAAa1E,EAAY,GAHvB,OAIlB7M,GADAA,EAHkB,QAIAH,KAAI,SAAAw1B,GAAC,OAAIA,EAAE4O,WAC7BjkC,EAAUoG,OAAO,EAAGpG,EAAQhB,QAAO,SAAAq2B,GAAC,OAAIA,IAAM92B,EAAK0lC,YAEnDjkC,GADAA,EAAUF,QAAM+O,aAAN,CAAoBtQ,EAAK0lC,SAAzB,0BAAqCjkC,MAC7BH,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAE5C31B,EAAOyB,EAAOS,gBAAkB,sBAAwB,sBATtC,uDAJA,gBAIhBkiC,gBAJgB,4CAgBhBA,IAhBgB,OAkBtBJ,EAAOlY,EAAQxrB,EAAS,CAAE8O,eAAgBvQ,EAAKuQ,eAAgBnP,SAAU,0BAA2BD,SAlB9E,uDAFe,gBAEnCwkC,oBAFmC,kCAuBzCA,GAGe,kBAAhBx+B,EAAOjJ,KAhID,wBAkIC0nC,EAASrkC,QAAMskC,aAAa,GAE5Bj5B,EAAkB,IAAXg5B,EAAe,iBAAmB,UAEhChjC,EAAOM,eAAhBwN,EAAiC,EAtIlC,UAwIkB/M,YAAUmiC,yBAAyB76B,EAAM4rB,KAAM5rB,EAAMtM,MAAOqB,EAAK0T,OAAQ9Q,GAxI3F,QAwICmjC,EAxID,OAyIC9Y,EAAS,CAAEpc,KAAM7Q,EAAK+K,OAAO6B,GAAO1O,KAAM8B,EAAK+K,OAAO7M,OAAU,CAAE0O,KAAM,CAAEiE,KAAM,WAAF,OAAajE,IAAS1O,KAAM8B,EAAK+K,OAAO7M,MACtH8nC,EAAsBn+B,OAAO6I,EAAO,EAAG7I,OAAO6I,EAAQnP,QAAM+O,aAAay1B,KAAYtlC,QAAO,SAAAwlC,GAAC,OAAIA,EAAE/nC,KAAK+R,gBAAkBjQ,EAAKgQ,SAASjF,OAAOkF,iBAEjJe,GADAA,EAAeg1B,EAAoBvlC,QAAO,SAAAwlC,GAAC,OAAIA,EAAEr5B,SAAqB1M,IAAZ+lC,EAAEr5B,IAAmC,KAAZq5B,EAAEr5B,MAActL,KAAI,SAAA2kC,GAAO,MAAO,CAAEr5B,KAAMq5B,EAAEr5B,GAAO1O,KAAM+nC,EAAE/nC,KAAM8vB,MAAOiY,EAAEjY,WACjI1sB,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,EAAElqB,KAAM1O,KAAM44B,EAAE54B,KAAM8vB,MAAO8I,EAAE9I,UACrFvsB,EAAUF,QAAM+O,aAAN,CAAoB2c,GAApB,0BAA+Bjc,KAEvC7P,EAAOyB,EAAOS,gBAAkB,kCAAoC,4BAE1E8hC,EAAOlY,EAAQxrB,EAAS,CAAEL,SAAU,uBAAwBD,OAAMygC,KAAM5hC,EAAKgQ,SAASjF,SAjJjF,WAoJU,YAAhB5D,EAAOjJ,OAEAgoC,EAAUrgC,EAAOqgC,QAAQC,MAAM9kC,KAAK,MAC3BuB,EAAOM,eAAhBwN,EAAiC,EAInCM,GADAA,GADAA,EAAenJ,OAAO6I,EAAO,EAAGnP,QAAM+O,aAAahF,aAAW7K,QAAO,SAAAwd,GAAC,OAAKpW,WAAWoW,EAAEkoB,MAAOD,OACnE5kC,KAAI,SAAA2c,GAAC,OAAIA,EAAEmoB,GAAG/kC,KAAK,UACnBC,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAGtD7J,EAAS,CAAEpc,KADXoc,GADAA,EAAS3hB,WAAS3E,MAAK,SAAAsX,GAAC,OAAIA,EAAEkoB,MAAM9kC,KAAK,MAAMglC,gBAAkBH,EAAQG,kBACvDpZ,EAAOrqB,EAAOugB,UAAU,GAAK+iB,GAG7CzkC,EAAUF,QAAM+O,aAAN,CAAoB2c,GAApB,0BAA+Bjc,KAE5CpO,EAAOS,gBACN8hC,EAAOlY,EAAQxrB,EAAS,CAAEL,SAAUyE,EAAOqgC,QAAQC,MAAM9kC,KAAK,MAAOF,KAAM,2BAE3EgkC,EAAOlY,EAAQxrB,EAAS,CAAEL,SAAU,mBAAoBD,KAAM,GAAIoP,eAAgB,GAAIC,SAAU,GAAIK,KAAMhL,EAAOqgC,QAAQC,MAAM9kC,KAAK,SAIzH,eAAhB8F,EAAOjJ,MACNinC,EAAO,CAAEt0B,KAAMrD,EAAMpM,UAAYoM,EAAM/L,QAAQH,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAAQtpB,EAAM7L,WAGxE,WAAhBwF,EAAOjJ,KA7KD,wBA+KW0E,EAAOM,eAAjBojC,EAAkC,CAAC,EAAE,GA/KtC,UAiLgB3iC,YAAUmiC,yBAAyB76B,EAAM4rB,KAAM5rB,EAAMtM,MAAOqB,EAAK0T,OAAQ9Q,GAjLzF,QAiLDmjC,EAjLC,OAkLDh7B,EAAS/K,EAAKgQ,SAASjF,OACvBw7B,EAAgB1+B,OAAOy+B,EAAQ,GAAIz+B,OAAOy+B,EAAQ,GAAI/kC,QAAM+O,aAAay1B,IAAWtlC,QAAO,SAAAsK,GAAM,OAAIA,EAAO7M,KAAK+R,gBAAkBjQ,EAAKgQ,SAASjF,OAAOkF,kBACxJu2B,EAA0BD,EAAcjlC,KAAI,SAAAyJ,GAAM,OAAIA,EAAO7M,QAC7DuoC,EAA2BF,EAAcjlC,KAAI,SAAAolC,GAAE,OAAIA,EAAG1Y,MAAM,MAI1D4X,EAASrkC,QAAMskC,aAAa,GAzL7B,KA2LED,EA3LF,OA4LI,IA5LJ,QAmMI,IAnMJ,gCA6LG3Y,EAAS,CAAEpc,KAAM7Q,EAAK+K,OAAOwF,gBAC7Bk2B,EAA2BA,EAAyBnlC,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAC9Er1B,EAAUF,QAAM+O,aAAN,CAAoB2c,GAApB,0BAA+BwZ,UAC3BvmC,IAAX+sB,GAAsB1nB,QAAQC,IAAI,oDAAqDxF,EAAK9B,MAC/FinC,EAAOlY,EAAQxrB,EAAS,CAAEL,SAAU,sBAjMvC,oCAoMG6rB,EAAS,CAAEpc,KAAM9F,GACjBy7B,EAA0BA,EAAwBllC,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAC5Er1B,EAAUF,QAAM+O,aAAN,CAAoB2c,GAApB,0BAA+BuZ,UAC3BtmC,IAAX+sB,GAAsB1nB,QAAQC,IAAI,oDAAqDxF,EAAK9B,MAC/FinC,EAAOlY,EAAQxrB,EAAS,CAAEL,SAAU,oBAAqBkkC,WAAW,IAxMvE,6BA6MU,mBAAhBn+B,EAAOjJ,OAENinC,EAAO,CAAEt0B,KAAMrD,EAAMpM,UAAYoM,EAAM/L,QAAQH,KAAI,SAAAw1B,GAAO,MAAO,CAAEjmB,KAAMimB,MAAQtpB,EAAM7L,WAEpF6L,EAAM7L,UAAUhB,OAAwC,SAA/B6M,EAAM7L,UAAUhB,MAAMzC,MAAiB,4DAEpC,mIAEbgY,EAASoB,SAASI,cAAc,sBACzBF,UAAY,IAEnBH,EAAWC,SAASC,cAAc,aACzBC,UAAYmvB,IAErBC,EAAOp5B,EAAM7L,UAAUhB,MAAMhC,MAAM,GARtB,SAUDgF,YAAUkjC,YAAYD,GAVrB,OAUbE,EAVa,OAYnBnvB,yBAAe,CAAEmvB,MAAK1sB,MAAOpa,EAAK9B,MAAQmZ,EAASO,QAAS1B,IAEtD4pB,EAASxoB,SAASI,cAAc,2BACzBQ,UAAU1R,OAAO,kBACxBs5B,EAAO5nB,UAAUlU,IAAI,yBAEXsT,SAASI,cAAc,yBACzBQ,UAAUlU,IAAI,yCAnBT,wDAFoC,gBAErD+iC,iBAFqD,kCAwB3DA,IAIO,uBAAhBlhC,EAAO3H,OAIEiC,EAAiDszB,EAAjDtzB,OAAQoV,EAAyCke,EAAzCle,eAAgBvV,EAAyByzB,EAAzBzzB,KAAMoB,EAAmBqyB,EAAnBryB,SAAUD,EAASsyB,EAATtyB,KAE1CM,EAAUoG,UAAU1H,GACpB8sB,EAAS1X,EAAe,GAE9B4vB,EAAOlY,EAAQxrB,EAAS,CAAE+O,SAAUxQ,EAAK9B,KAAMkD,WAAUD,OAAMmkC,WAAW,KAtPrE,wDAAH,gBAAJr0B,OAAI,kCA2PVA,GAEF,MAAMgN,GACJ1Y,QAAQ0f,MAAM,yDAA0DhH,M,2GCjShFpgB,EAAOD,QAFI,kF,0lDCcJ,IAAM0rB,EAAuC,SAAvCA,qCAAuChb,GAAc,MAEpB5L,QAAMC,WAAxCC,EAFsD,EAEtDA,OAAQ8O,EAF8C,EAE9CA,OAAQ7L,EAFsC,EAEtCA,OAAQgH,EAF8B,EAE9BA,MAE1B7M,EAAO6H,QAAQyG,EAAWhK,UAEhC,GAAItE,EAAJ,CAEA,IAAMiR,EAAI,iB,oRAAA,0BAAG,yIAEH+1B,EAAoB,SAApBA,kBAAoB/P,GAMtB,OALoB11B,QAAM0lC,QAAQhQ,EAAO31B,KAAI,SAAAq5B,GACzC,IAAM1D,EAAsD,IAA7C0D,EAAMuM,KAAKzmC,QAAO,SAAArE,GAAC,OAAIA,EAAEy8B,WAASv8B,OAAeuL,OAAO,EAAGtG,QAAM+O,aAAaqqB,EAAMuM,OAASvM,EAAMuM,KAAKzmC,QAAO,SAAArE,GAAC,OAAIA,EAAEy8B,WAC/H74B,EAAO,CAAE9B,KAAMy8B,EAAMC,SAAU3D,UACrC,OAAO4D,gCAAsB76B,EAAM4C,EAAQ63B,gBAAciI,sBANxD,SAWW1vB,uBAAa1E,GAXxB,OAWHK,EAXG,OAaLsoB,EAAStoB,EAAMrN,KAAI,SAACtB,EAAMsD,GAC1B,MAAO,CAAEA,MAAOA,EAAQ,EAAG4jC,KAAMlnC,EAAKi3B,OAAQ2D,SAAU56B,EAAK9B,SAGjE+4B,EAAS+P,EAAkB/P,GAEvB71B,EAAWwB,EAAOukC,gBAAkB,wBAA0B,uBAE9DjxB,EAASmhB,iCAAuB/oB,EAAY,CAAEiC,eAAgBvQ,EAAKuQ,eAAgBC,SAAUxQ,EAAK9B,KAAMkD,WAAUD,KAAM,iCAAkC0P,KAAM,MACzJ2G,UAAY,IAEjBH,EAAWC,SAASC,cAAc,aACzBC,UAAY4vB,IAE3BzvB,yBAAe,GAAIN,EAASO,QAAS1B,GAErCA,EAASoB,SAASI,cAAc,kCAEhC2vB,sBAAY,CAAEzkC,SAAQq0B,OAAQ11B,QAAM+O,aAAa2mB,GAAS/gB,SAAQoxB,WAAY,oBAExEvD,EAAoBzsB,SAASI,cAAc,2BAC3C6vB,EAAa,GAEb9lC,EAAU,GAEhBw1B,EAAOjwB,SAAQ,SAAA2zB,GACXl5B,EAAQ7E,KAAK,CAAE+B,MAAOg8B,EAAMC,SAAU9B,IAAKiC,qBAAW,CAAEjC,IAAI6B,EAAM7B,MAAOkK,WAG7E1rB,SAASQ,iBAAiB,mDAAmD9Q,SAAQ,SAAAgoB,GAEjFA,EAAIxW,iBAAiB,SAAS,SAAAC,GAE1B,IACMqqB,EADQrqB,EAAMsH,OACOtD,QAAQme,SAC7Bx5B,EAAWpB,EAAK9B,KAChB+uB,EAAS6V,GAAgB,YACzBnT,EAAY1C,IAAW7rB,EACVkW,SAASC,cAAc,QACzBC,UAAYmY,EACf,gEACA,gEAEd,IAAMpD,EAAO,cAAH,iBAAQ1f,GAAR,IAAekhB,OAAQ/tB,EAAKgI,GAClC5G,WAAU6rB,SAAQzc,SAAUxQ,EAAK9B,KACjCyY,cAAejF,EAAOiF,cAAeC,YAAalF,EAAOkF,YACzD7J,OAAQlH,EAAOkH,OACftL,UACA2rB,aAAcxqB,EAAOM,eAAiB,sBAAwB,wBAC9DqN,eAAgB6yB,iBAAeC,kBAAkBrjC,EAAM4C,KAc3D0pB,uBAAa,cAAeC,GAXX,SAAX7S,SAAY7M,EAAOghB,GAIrB,GAHA0Z,EAAW16B,MAAQA,EACnB06B,EAAW1Z,iBAAmBA,EAC9BkW,EAAkBzpB,UAAW,GACzBzN,EAAMkgB,QACN,KAAMya,EAAY74B,EAAMhI,MAAK,SAAA3G,GAAI,OAAIA,EAAK9B,OAAS2O,EAAMogB,UAClCmW,iBAAeC,kBAAkBmE,EAAW5kC,IACpCiK,EAAMogB,UAIDrqB,SAIpDmhC,EAAkBvrB,iBAAiB,SAAS,SAAAC,GAEpC5L,EAAMkgB,SAMNrtB,OAAO6hB,aAAagmB,EAAW1Z,kBAC/BH,oBAAU6Z,EAAW16B,QANrB/K,YAAW,WACPpC,OAAO6hB,aAAagmB,EAAW1Z,kBAC/BH,oBAAU6Z,EAAW16B,aArFxB,uDAAH,gBAAJoE,OAAI,mCA+FV,IACEA,IACA,MAAMgN,GACNnK,mBAAS,4CAA6CmK,O,oECzH5D,kIAGa2L,EAAgB,SAAhBA,cAAgBzd,GAEHzJ,QAAMC,WAApB2L,WAERoY,4B,qoECHG,IAAM+gB,EAAkB,SAAlBA,gBAAmBt7B,EAASuF,EAAQg2B,EAAYC,GAEvD,IAAIx7B,EAAS,MAAO,CAAEu7B,GAEtB,IAAME,EAAoB//B,WAAW6/B,EAAWl3B,SAAUrE,EAAQmK,OAAOhV,KAAI,SAAA5D,GAAC,OAAIA,EAAE8S,aAgBpF,OAZGkB,EAAOm2B,YACKD,GAEoB,IAArBF,EAAWzgB,MADX9a,EAAQmK,OACR,6BAEUnK,EAAQmK,QAFlB,CAE0BoxB,IAEzBE,EACDz7B,EAAQmK,OADU,6BAEdnK,EAAQmK,QAFM,CAEEoxB,KAiB3BI,EAAsB,CAC/BL,kBACAM,eAbmB,SAAjBA,eAAkBC,GAQlB,OAPAA,EAAOA,EAAK1mC,KAAI,SAAC9C,EAAGpC,GAKd,OAJW,cAAH,iBACCoC,GADD,IACIwJ,GAAI,GAAF,OAAK5L,GAAL,OAASmF,QAAM4iC,YAAY3lC,EAAEgS,WAAapP,SAAU5C,EAAE4C,SAASyP,KAAOrS,EAAE4C,SAASyP,KAAOrS,EAAE4C,SAC5FK,QAASjD,EAAEiD,QAAQH,KAAI,SAAAw1B,GAAO,OAYtD,SAASmR,UAAUnR,EAAGt4B,GAEhB,IAAM0pC,EAAqB,WAAb,QAAOpR,GAEfn4B,EAAQupC,EAAQpR,EAAEn4B,OAASm4B,EAAEjmB,KAAOimB,EACpCqR,EAAWD,KAAWpR,EAAEgC,IACxBA,EAAMoP,EAAQpR,EAAEgC,IAAM,GACtB13B,EAAW5C,EAAE4C,SAASyP,MAAQrS,EAAE4C,SAChCgnC,EACgB,KAAVzpC,GACS4C,QAAM8mC,iBAAiB1pC,KAAW4C,QAAM8mC,iBAAiBjnC,GAGxEknC,GAAiBF,GAAU7mC,QAAM8mC,iBAAiB1pC,KAAW4C,QAAM8mC,iBAAiB7pC,EAAEyuB,QACtF/uB,EAAOgqC,GAAQpR,EAAE54B,MAAa,GAUpC,MARe,CACTS,QACAm6B,MACAqP,WACAC,SACAE,gBACApqC,QAlCiD+pC,CAAUnR,EAAGt4B,c,6EC5B1EX,EAAOD,QAFI,mI,0ECEXC,EAAOD,QAFI,koD,sECEXC,EAAOD,QAFI,yjD,gtFCYJ,IAAMi6B,EAAqB,SAArBA,mBAAsB/G,EAAU6G,IAE1B,SAAP1mB,OAAa,MAEsCvO,QAAMC,WAAjDq5B,EAFK,EAELA,QAAgB0L,EAFX,EAEI76B,MAAmBpF,EAFvB,EAEuBA,WAFvB,EAI8Cu0B,EAAQ1/B,OAAS,GAC5D0/B,EAAQr1B,MAAK,SAAA7I,GAAC,OAAIA,EAAEwQ,WAAWtG,KAAO+U,SAAS+T,MAC3CkL,EAAQr1B,MAAK,SAAA7I,GAAC,OAAIA,EAAEwQ,WAAWtG,KAAO+U,SAAS+T,MAErDpuB,QAAMC,WAJZ2L,EAJK,EAILA,WAAYnC,EAJP,EAIOA,QAASvJ,EAJhB,EAIgBA,OAAe+kC,EAJ/B,EAIwB96B,MAM7B6E,EAAWhP,QAAMC,WAAjB+O,OAER,IAAG/J,oBAAkBs9B,eAAex9B,EAAY7E,GAAhD,CAEA,IAAMyU,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY+wB,IAE3B,IAAMryB,EAAStT,EAAOS,gBACRs0B,GAAoBrgB,SAASI,cAAc,+BAC3CvB,MAAIC,UACZF,EAAOsB,UAAY,GAEzBG,yBAAe,CAAErJ,aAAYoD,UAAU2F,EAASO,QAAS1B,GAEzD,IAAMsyB,EAAclxB,SAASQ,iBAAiB,qBAU9C,GARAhW,YAAW,WACT0mC,EAAY,GAAGzqB,UACd,KAEA4Z,GACG6Q,EAAYxhC,SAAQ,SAAAyhC,GAAI,OAAIA,EAAKvwB,UAAUlU,IAAI,oBAG5B,YAAtB0N,EAAOg3B,WACiBpxB,SAASI,cAAc,uBACzBF,UAAY,GAGrC,IAAIlB,EAASwxB,sBAAoBL,gBAAgBt7B,EAASuF,EAAQg2B,EAAYC,GAAYgB,UACtFryB,EAAOtP,SAAQ,SAAAtJ,GAAC,OAAIkrC,EAAsBtyB,EAAQ5Y,EAAGkF,MAEzD,IAAMimC,EAAoB,4DAAG,iBAAM5qB,GAAN,yFACzBA,EAAEG,iBACFsD,qBAAmBC,cAAc,CAC3BC,YAAa7hB,QAAM8hB,YAAYinB,WAC/B/mB,YAAa,CACX/Z,GAAI8oB,EACJpf,OAAQ,cAAF,iBAAOA,GAAP,IAAem2B,aAAa,OANjB,sDAAH,gBAApBgB,qBAAoB,sCAWpBE,EAAe,4DAAG,kBAAMtwB,GAAN,0GACZ9Q,oBAAkBqhC,cADN,uDAAH,gBAAfD,gBAAe,sCAIlBr3B,EAAOu3B,iBACJT,EAAYxhC,SAAQ,SAAAkiC,GACdA,EAAW1xB,UAAY,mBACvB0xB,EAAW1wB,iBAAiB,QAASuwB,EAAiB,CAAEja,MAAM,OAGpE0Z,EAAYxhC,SAAQ,SAAAkiC,GACdA,EAAW1wB,iBAAiB,QAASqwB,EAAsB,CAAE/Z,MAAM,OAI/EpvB,OAAO8Y,iBAAiB,WAAW,SAAAyF,GACpB,UAAVA,EAAEhf,KACH4pC,EAAqB5qB,KAEtB,CAAE6Q,MAAM,KAGjB7d,IAGA23B,EAAwB,SAAxBA,sBAAyBtyB,EAAQ5Y,EAAGkF,GAEpC,IAAMyU,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY2xB,IAE3B,IAAMjzB,EAASoB,SAASI,cAAc,0BAEtC,GAAe,IAAZha,EAAEupB,MAIC,OAHA/Q,EAAOsB,UAAY,GACnBH,EAASG,UAAY4xB,SACrBzxB,yBAAe,GAAKN,EAASO,QAAS1B,GAG5C,IAAI8xB,EAAO,GAAH,0BAAQtqC,EAAEgzB,QAAV,mBAAqBhzB,EAAEizB,QAC3BqX,EAAOF,sBAAoBC,eAAeC,GAE9C,IAAMz3B,EAAiB7S,EAAE6S,gBAAkB6yB,iBAAeC,kBAAkB3lC,EAAE8S,SAAU5N,GAIxF,GAFA+U,yBAAe,CAAEpH,iBAAgBC,SAAU9S,EAAE8S,SAAUw3B,OAAMn7B,MAAO,GAAF,OAAKnP,EAAEsvB,QAAP,YAAkBtvB,EAAEupB,QAAW5P,EAASO,QAAS1B,GAEhHI,EAAOha,OAAS,EAAG,CAChB,IAAM+sC,EAAkBnzB,EAAOwB,cAAc,oBAC1C2xB,IACGA,EAAgB7xB,UAAY,O,oECpH9C,2KAIamS,EAAgB,SAAhBA,cAAgBxd,GAEzBpI,eAAayC,OAAOzC,eAAa2C,UAAU,kBAFP,IAI5B4H,EAAe5L,QAAMC,WAArB2L,WAERupB,6BAAmBvpB,EAAWtG,M,iFCVlC,wIAGawhB,EAAkB,SAAlBA,gBAAmBlb,GAAe,IAIrCnH,EAFazE,QAAMC,WAAjBkD,OAEcqB,QAAQzG,QAAO,SAAA6oC,GAAE,MAAgB,eAAZA,EAAGprC,QAAuB,GAC/D8B,EAAOsO,EAAWhK,SAExB,GAAI6C,EAAJ,CAEAnH,EAAKquB,WAAaruB,EAAKuQ,eAEvB,IAAMg5B,EAAqB,SAAjBpiC,EAAO8D,MAAmBjL,EAAK9B,KACR,eAAjBiJ,EAAO8D,MACDjL,EAAKuQ,eACLvQ,EAAKgQ,SAAS7I,EAAO8D,OAErC7J,EAAW,CAAEoP,SAAUxQ,EAAK9B,KAAMmW,QAASrU,EAAKgQ,SAASqE,QAAStD,MAAO/Q,EAAKgQ,SAASe,MAAO9F,MAAO9D,EAAO8D,MAAO7J,SAAUmoC,EAAGp7B,OAAQnO,EAAKuQ,gBAEnJi5B,sBAAYriC,EAAQ/F,M,wEClBxBvD,EAAOD,QAFI,yrB,4ECDX,gWAUaosB,EAAqB,SAArBA,mBAAsB1b,GAE/B,IAAMtO,EAAOsO,EAAWhK,SAFsB,EAIP5B,QAAMC,WAArCkD,EAJsC,EAItCA,OAAQjD,EAJ8B,EAI9BA,OAAQI,EAJsB,EAItBA,WAElBmE,EAAStB,EAAOqB,QAAQzG,QAAO,SAAA6oC,GAAE,MAAgB,kBAAZA,EAAGprC,QAA0B,GAExE,GAAIiJ,EAAJ,CAEA,IAAI/F,EAAU2P,EAAOsD,EAASo1B,EAAYl5B,EAAgBC,EAAUk5B,EAMpE,OAJAn5B,EAAiBvQ,EAAKuQ,eACtBC,EAAWxQ,EAAK9B,KAChBwrC,EAAc,0BAEPviC,EAAOyF,MACV,IAAK,sBACDxL,EAAWpB,EAAKgQ,SAASe,MACzBA,EAAQ,MACRsD,EAAUrU,EAAKgQ,SAASqE,QACxB7D,EAAW,OAAH,OAAUxQ,EAAKgQ,SAASqE,SAChCo1B,EAAa,QACbC,EAAc,oBACd,MACJ,IAAK,wBACDtoC,EAAWpB,EAAKgQ,SAASqE,QACzBtD,EAAQ/Q,EAAKgQ,SAASe,MACtBsD,EAAU,MACV7D,EAAW,GAAH,OAAMxQ,EAAKgQ,SAASe,MAApB,QACR04B,EAAa,UACbC,EAAc,sBAItB,IAAMxzB,EAASmhB,iCAAuB/oB,EAAY,CAAEiC,iBAAgBC,WAAUpP,SAAUsoC,EAAavoC,KAAM,2BAA4B0P,KAAM,KAEvIwG,EAAWC,SAASC,cAAc,YAExCF,EAASG,UAAYmyB,IAErB,IAAMC,EAAehnC,EAAOM,eAAiB,EAAI,EAG3C2mC,EAAav7B,EAAWK,MAAMrN,KAAI,SAAAtB,GACpC,OAAOypC,GACH,IAAK,QACD,OAAOzpC,EAAKgQ,SAASe,MACzB,IAAK,UACD,OAAO/Q,EAAKgQ,SAASqE,QACzB,QACI,OAAOrU,EAAK9B,SAGlBq9B,EAAO1zB,OAAO+hC,EAAcroC,QAAM+O,aAAau5B,GAAYppC,OAAOc,QAAMuoC,YAAYrpC,QAAO,SAAAspC,GAAS,OAAIA,IAAc/pC,EAAKgQ,SAASy5B,OAAchpC,QAAO,SAAAT,GAAI,YAAaE,IAATF,KACvKu7B,EAAK3+B,KAAKoD,EAAKgQ,SAASy5B,IAExB,IAAIhoC,EAAUF,QAAM+O,aAAairB,GAEjC95B,EAAUA,EAAQH,KAAI,SAAC2rB,EAAQ3pB,GAC7B,MAAO,CACLA,QACA3E,MAAOsuB,MAIXtV,yBAAe,CAAE5G,QAAOsD,UAAS5S,WAAW4V,EAASO,QAAS1B,GAE9DpU,YAAW,WACKwV,SAASQ,iBAAiB,gBAAgB,GAC5CiG,UACZ,KAEF,IAAMlR,EAAQ,CAAEkhB,OAAQ/tB,EAAKgI,GAAIwI,SAAUxQ,EAAK9B,KAAMkD,SAAUpB,EAAKgQ,SAASy5B,GAAapiB,aAAczkB,EAAOykB,aAAczQ,YAAa5T,EAAWsF,QAAQhM,OAAQyQ,OAAQlH,EAAOkH,QAE/K2M,EAAW,SAAXA,SAAY7M,EAAOghB,EAAkBjrB,GAEvC,IAAMonC,EAAcn9B,EAAMkgB,QAAU,qBAAuB,mBAErDkd,EAAap9B,EAAMkgB,QAAN,kHAIbD,EAAWjgB,EAAMkgB,QAAN,sBAEjBzV,SAASI,cAAc,oBAAoBF,UAA3C,sBAAsEwyB,EAAtE,mBAA2FC,EAA3F,wBAAsHnd,EAAtH,gBAEAxV,SAASQ,iBAAiB,eAAe9Q,SAAQ,SAAAkjC,GAC1CA,EAAMtxB,YAAc/L,EAAMogB,SACzBpgB,EAAMkgB,QACAmd,EAAMjyB,cAAcC,UAAUlU,IAAI,gBAClCkmC,EAAMjyB,cAAcC,UAAUlU,IAAI,eAEzCkmC,EAAMtxB,YAAc/L,EAAMzL,UACzB8oC,EAAMjyB,cAAcC,UAAUlU,IAAI,mBAI1CqpB,gCAAsB/V,SAASI,cAAc,2BAA4B7K,EAAOghB,IAGpFvW,SAASQ,iBAAiB,mBAAmB9Q,SAAQ,SAAAimB,GACjDA,EAAOzU,iBAAiB,SAAS,SAAAyF,GAC/BA,EAAEG,iBACF,IACM6O,EADShP,EAAE8B,OACKnH,UACnBxX,IAAapB,EAAKgQ,SAASqE,QAC1BiD,SAASI,cAAc,YAAYkB,UAAYqU,EAE/C3V,SAASI,cAAc,UAAUkB,UAAYqU,EAEjDpgB,EAAMogB,OAASA,EACfpgB,EAAMpL,QAAUA,EAChBoL,EAAMugB,aAAesc,EACrBpd,uBAAa,QAASzf,EAAO6M,EAAU9W,Y,+ECzHjD/E,EAAOD,QAFI,0O,sECEXC,EAAOD,QAFI,iuB,o9CCYJ,IAAM4rC,EAAc,SAAdA,YAAeriC,EAAQ/F,GAAa,IAMzCmP,EAAgBC,EAAUk5B,EANe,EAEMhnC,QAAMC,WAAjDK,EAFqC,EAErCA,WAAYsL,EAFyB,EAEzBA,WAAY1L,EAFa,EAEbA,OAAQiD,EAFK,EAELA,OAElC7F,EAAOsO,EAAWhK,SAMxB,OAFAolC,EAAc,0BAEPtoC,EAAS6J,OACZ,IAAK,QACDsF,EAAiBvQ,EAAKuQ,eACtBC,EAAWA,EAAW,OAAH,OAAUpP,EAASiT,SACtCq1B,EAAc,uBACd,MACJ,IAAK,UACDn5B,EAAiBvQ,EAAKuQ,eACtBC,EAAWA,EAAW,GAAH,OAAMpP,EAAS2P,MAAf,QACnB24B,EAAc,yBACd,MACJ,IAAK,OACDn5B,EAAiBvQ,EAAKuQ,eACtBC,EAAWA,EAAW,UACtBk5B,EAAc,wBACd,MACJ,IAAK,aACDn5B,EAAiB,UACjBC,EAAWxQ,EAAK9B,KAChBwrC,EAAc,wBAItB,IAAMvoC,EAAOyB,EAAOS,gBAAkB,6BAA+B,+BAE/D6S,EAASmhB,iCAAuB/oB,EAAY,CAAEiC,iBAAgBC,WAAUpP,SAAUsoC,EAAavoC,OAAM0P,KAAM,KAE3GwG,EAAWC,SAASC,cAAc,YAClCF,EAASG,UAAY5U,EAAOS,gBAAkB8mC,IAAoBC,IAExEzyB,yBAAe,GAAKN,EAASO,QAAS1B,GAEtC,IAAMm0B,EAAW/yB,SAASI,cAAc,iBAClC4yB,EAAUhzB,SAASI,cAAc,gBAEvC,OAAOtW,EAAS6J,OACZ,IAAK,QACDo/B,EAASrtB,aAAa,cAAe,oBACrCstB,EAAQ9yB,UAAR,cAA2BpW,EAASiT,SACpC,MACJ,IAAK,UACDg2B,EAASrtB,aAAa,cAAe,sBACrCstB,EAAQ9yB,UAAR,UAAuBjW,QAAMC,gBAAgBJ,EAAS2P,OAAtD,QACA,MACJ,IAAK,OACDs5B,EAASrtB,aAAa,cAAe,oBACrCstB,EAAQ9yB,UAAR,UACA,MACJ,IAAK,aACD6yB,EAASrtB,aAAa,cAAe,qBACrCstB,EAAQ9yB,UAAR,QAIR,IAAM+vB,EAAa,GAEbgD,EAAYjzB,SAASI,cAAc,oBAEnCgC,EAAW,SAAXA,SAAY7M,EAAOghB,GACrB0Z,EAAW1Z,iBAAmBA,EAC9B0Z,EAAW16B,MAAQA,IA+BpBjK,EAAOS,iBACNknC,EAAU/xB,iBAAiB,SA7BL,SAApBgyB,kBAAoBvsB,GACtBA,EAAEG,iBACF,IAAM6O,EAAS3V,SAASI,cAAc,iBAAiB/Y,MACjDkO,EAAQ,CACVkhB,OAAQ/tB,EAAKgI,GAAI5G,WAAU6rB,SAAQlN,OAAQ9B,EAAE8B,OAC7CnJ,YAAa5T,EAAWsF,QAAQhM,OAAQyQ,OAAQlH,EAAOkH,OACvDihB,MAAOhuB,EAAKyqC,gBAAiBrd,aAAcsc,EAC3CjoC,QAAS,CAACL,EAASA,SAAU6rB,IAEjCX,uBAAa,OAAQzf,EAAO6M,EAAU9W,GACnC2nC,IAAWA,EAAUjwB,UAAW,GACnChD,SAASI,cAAc,2BAA2B4C,UAAW,EAC1DgwB,IAASA,EAAQ9yB,UAA+B,eAAnBpW,EAAS6J,MAAyBjL,EAAKuQ,eAAiBvQ,EAAK9B,QAiBtC,CAAE4wB,MAAM,IAGhElsB,EAAOM,eAAgBwnC,EAAe1qC,EAAM4C,GAC1C+nC,EAAgB3qC,EAAM4C,EAAQxB,GAEnCkW,SAASI,cAAc,2BAA2Bc,iBAAiB,SAAS,SAAAyF,GACxEve,OAAO6hB,aAAagmB,EAAW1Z,kBAC/BH,oBAAU6Z,EAAW16B,SACtB,CAAEiiB,MAAM,IAERlsB,EAAOM,kBAGcoU,SAASI,cAAc,yBACzBQ,UAAUlU,IAAI,kBACbsT,SAASI,cAAc,2BACzBQ,UAAUlU,IAAI,oBAIjC0mC,EAAiB,SAAjBA,eAAkB1qC,EAAM4C,GAE1B,IAAMq0B,EAAS4D,gCAAsB76B,EAAM4C,EAAQ63B,gBAAcmQ,YAE3D10B,EAASoB,SAASI,cAAc,kCAEtC2vB,sBAAY,CAAEzkC,SAAQq0B,SAAQ/gB,YAG5By0B,EAAkB,SAAlBA,gBAAmB3qC,EAAM4C,EAAQxB,GAEnC,IAEIm6B,EAFAtO,EAAS7rB,EAASA,EAAS6J,OAI/B,OAAO7J,EAAS6J,OACZ,IAAK,aACDswB,EAAOv7B,EAAKuQ,eAAeN,cAC3Bgd,EAAS7rB,EAAS+M,OAClB,MACJ,IAAK,QACDotB,EAAOv7B,EAAKgQ,SAASe,MAAMd,cAC3B,MACJ,IAAK,UACDsrB,EAAOv7B,EAAKgQ,SAASqE,QAAQpE,cAC7B,MACJ,IAAK,WACL,IAAK,OACDsrB,EAAOv7B,EAAK9B,KAAK+R,cACjBgd,EAAS7rB,EAASoP,SAI1B,IAAIq6B,EAAe,GAEnBtpC,QAAM+O,aAAamkB,MAAMC,KAAK6G,IAAOv0B,SAAS,SAAC8jC,EAAQxnC,GACrC,MAAXwnC,IAAgBA,EAAS,UAC5BD,GAAgB,aAAJ,OAAiBvnC,EAAjB,2BAAyCwnC,EAAzC,cAGhBxzB,SAASI,cAAc,oBAAoBF,UAAYqzB,EAEvD,IAAMrsB,EAAQlH,SAASI,cAAc,iBAE/BqzB,EAAU,GAEVC,EAAe,SAAfA,aAAeF,GACjB,IAAInsC,EAAQ2Y,SAASI,cAAc,iBAAiB/Y,MAChDssC,EAAexW,MAAMC,KAAKpd,SAASQ,iBAAiB,kBACpDozB,EAAgBzW,MAAMC,KAAK/1B,GAC3BwsC,EAAcF,EAAatkC,MAAK,SAAAujC,GAAK,OAAIA,EAAMtxB,UAAUuV,SAAW+c,EAAcA,EAAc5uC,OAAO,GAAG6xB,UAC1Gid,EAAaN,GAAUK,EAC3B,GAAGxsC,EAAMrC,OAAS,EAAE,CAChB,IAAI+uC,EAAe1sC,EAAM2sC,YAAYF,EAAW5zB,WAC5C+zB,EAAW,GACXR,EAAUtW,MAAMC,KAAK/1B,GACzBosC,EAAQvtC,OAAO6tC,EAAa,GAC5BN,EAAQ/jC,SAAQ,SAAA8jC,GAAM,OAAIS,GAAYT,KACtCtsB,EAAM7f,MAAQ4sC,EAElB,IAAIC,EAAgB/W,MAAMC,KAAKpd,SAASQ,iBAAiB,aACrD0zB,EAAcxkC,SAAQ,SAAA2tB,GAAC,OAAIA,EAAEzc,UAAU1R,OAAO,cAC9CglC,EAAcxkC,SAAQ,SAAA2tB,GAAC,OAAIA,EAAEzc,UAAUlU,IAAI,aAC5ConC,IACDA,EAAWlzB,UAAU1R,OAAO,UAC5BukC,EAAQ/jC,SAAQ,SAAAlJ,GACZ,GAAGA,EAAEkK,KAAOojC,EAAWpjC,GAAI,CACvB,IAAMyjC,EAAcV,EAAQ1iB,QAAQvqB,GACjC2tC,GAAe,GACdV,EAAQvtC,OAAOiuC,EAAY,SAMvCC,EAASp0B,SAASQ,iBAAiB,UAEzC4zB,EAAO1kC,SAAQ,SAAAkjC,GACXA,EAAM1xB,iBAAiB,SAAS,SAAAyF,GAC9BA,EAAEG,iBACF,IAAM0sB,EAAS7sB,EAAE8B,OACd+qB,EAAO5yB,UAAUyzB,SAAS,UACzBX,EAAaF,IAEbA,EAAO5yB,UAAUlU,IAAI,UACrB+mC,EAAQnuC,KAAKkuC,GACW,WAArBA,EAAOtzB,UACNgH,EAAM7f,OAAS,IAEf6f,EAAM7f,OAASmsC,EAAOtzB,WAE3BgH,EAAM7f,QAAUsuB,EAAOhd,eACtBy7B,EAAO1kC,SAAQ,SAAAkjC,GAAK,OAAIA,EAAMhyB,UAAUlU,IAAI,oBAKtDsT,SAASI,cAAc,qBAAqBc,iBAAiB,SAAS,SAAAyF,GACpEA,EAAEG,iBACF4sB,OAGF,IAAMY,EAAct0B,SAASI,cAAc,uBACrCk0B,EAAYpzB,iBAAiB,SAAS,SAAAyF,GACpCA,EAAEG,iBACeI,EAAMqtB,aAAa,aAEhCD,EAAYp0B,UAAY,iBACxBgH,EAAMvB,gBAAgB,YACtBuB,EAAMT,UAEN6tB,EAAYp0B,UAAY,kBACxBgH,EAAMxB,aAAa,WAAY,gBAI3Clb,YAAW,WACT8pC,EAAY7tB,UACX,KAEH,IAEI+tB,EAFEC,EAAa,mBAAKL,GAClBrH,EAAU,GAGhB7lB,EAAMhG,iBAAiB,SAAS,SAAAyF,GAE5B,GADAA,EAAEG,iBACEH,EAAEniB,KAAN,CACA,IAAIkwC,EAAQ/tB,EAAEniB,KAAKmU,cACnB+7B,EAAkB,MAAVA,EAAgB,SAAWA,EACnC3H,EAAQznC,KAAKovC,IACbF,EAAgBC,EAAWplC,MAAK,SAAAujC,GAAK,OAAIA,EAAM1yB,YAAcw0B,OAC3CF,EAAc5zB,UAAUlU,IAAI,UAC3Cwa,EAAM7f,QAAUsuB,EAAOhd,eACtB87B,EAAW/kC,SAAQ,SAAAkjC,GAAK,OAAIA,EAAMhyB,UAAUlU,IAAI,kBAIxDwa,EAAMhG,iBAAiB,SAAS,SAAAyF,GAE5B,GADAA,EAAEG,iBACe,IAAdH,EAAEI,QAAe,CAClB,IAAM2tB,EAAQ3H,EAAQ7mB,OACtBsuB,EAAgBC,EAAWplC,MAAK,SAAAujC,GAAK,OAAIA,EAAM1yB,YAAcw0B,OAC3CF,EAAc5zB,UAAU1R,OAAO,gB,2DCtR3D,8JAIalC,EAAW,SAAXA,SAAWuB,GAAU,MAE8BnD,QAAMC,WAE5D8wB,EAAO,CAAE5tB,SAAQ/C,QAJO,EAEtBA,QAEwBE,WAJF,EAEbA,WAE2BJ,OAJd,EAEDA,OAEuB8O,OAJtB,EAEOA,OAEuBpD,WAJ9B,EAEeA,YAI1C29B,eAAaC,WAAWnsC,QAAMsa,SAAS8xB,UAAW1Y,IACjDwY,eAAaG,aAAarsC,QAAMsa,SAAS8xB,UAAW,CAAEtmC,a,6DCX9D,gKAIarB,EAAa,SAAbA,WAAa1B,GAAW,MAE0BJ,QAAMC,WAAzDkD,EAFyB,EAEzBA,OAAQ7C,EAFiB,EAEjBA,WAAYJ,EAFK,EAELA,OAEtB6wB,EAAO,CAAE5tB,SAAQ/C,UAASE,aAAYJ,SAAQ8O,OAJnB,EAEGA,OAEwBpD,WAJ3B,EAEWA,YAM5C,GAFmB29B,eAAaC,WAAWnsC,QAAMsa,SAASgyB,YAAa5Y,GAExD,CACX,IAAMjvB,EAAaxB,EAAWsF,QAAQxF,EAAQQ,OAC9C2oC,eAAaG,aAAarsC,QAAMsa,SAASgyB,YAAa,CAAExmC,OAAQrB,EAAY5B,c,6DCdpF,wSASa2B,EAAa,SAAbA,WAAazB,GAAW,MAEcJ,QAAMC,WAA7CkD,EAFyB,EAEzBA,OAAQjD,EAFiB,EAEjBA,OAAQ8O,EAFS,EAETA,OAAQpD,EAFC,EAEDA,WAE1BmlB,EAAO,CAAE5tB,SAAQ/C,UAASF,SAAQ8O,SAAQpD,cAEhD,GAAG29B,eAAaC,WAAWnsC,QAAMsa,SAASiyB,YAAa7Y,GAAO,CAE1D,IAAM8Y,EAAS3pC,EAAOM,eAAiBoL,EAAWk+B,mBAAqBl+B,EAAWm+B,oBAC5EzpC,EAAa6E,QAAQsB,cAAYxC,MAAK,SAAA+lC,GAAI,OAAIA,EAAK1kC,KAAOukC,GAAUG,EAAK/jC,WAAa/F,EAAOM,mBAInG,GAFAuwB,EAAKzwB,WAAaA,EAEfipC,eAAaC,WAAWnsC,QAAMsa,SAASyuB,WAAYrV,GAAO,CAIzD,IAAMkZ,EAAYp6B,gBAAcC,iBAAiBxP,EAAYJ,EAAQiF,QAAQyG,GAAazG,QAAQ6J,IAAS+S,MAAK,SAAAmoB,GAC5G,GAAIA,EACJ,MAAO,CAAE5pC,WAAY4pC,EAAM91B,kBAAmBxI,WAAYs+B,EAAM71B,kBAAmBrF,OAAQk7B,EAAM51B,kBAGrG,GAAiB,OAAd21B,EAAoB,OAEvBV,eAAaG,aAAarsC,QAAMsa,SAASiyB,YAAa,CAAEK,kB,+DCjCpE,uOAwDaV,EAAe,CACxBC,WApDe,SAAbA,WAAclzB,EAAMya,GAAS,IAEvB5tB,EAA4D4tB,EAA5D5tB,OAAQ/C,EAAoD2wB,EAApD3wB,QAASE,EAA2CywB,EAA3CzwB,WAAYJ,EAA+B6wB,EAA/B7wB,OAAQ8O,EAAuB+hB,EAAvB/hB,OAAQpD,EAAemlB,EAAfnlB,WAEjDg2B,GAAW,EAEf,OAAOtrB,GACH,KAAKjZ,QAAMsa,SAAS8xB,UAChB7H,EAAWz+B,IAAWA,EAAO2H,MAC7B,MACJ,KAAKzN,QAAMsa,SAASgyB,YAEZ/H,GADDxhC,EAAQS,kBAGP+gC,EAAWthC,GAAcA,EAAWsF,UACyB,OAAtCtF,EAAWsF,QAAQxF,EAAQQ,QAEtD,MACJ,KAAKvD,QAAMsa,SAASiyB,YAChBhI,EAAiB1hC,EAAO0L,WAAWtG,GAAK,IAAMlF,EAAQS,gBACrCX,EAAO0L,WAAWtG,GAAK,GAAKpF,EAAO0L,WAAWtG,KAAOsG,EAAWtG,GACjF,MACJ,KAAKjI,QAAMsa,SAASyuB,WAChBxE,EAA6B,IAAlBxhC,EAAQQ,OAAeoO,EAAOm2B,aAAev5B,EAAWK,OAASL,EAAWK,MAAMrS,OAAS,EAI9G,OAAOgoC,GA0BP8H,aAvBiB,SAAfA,aAAgBpzB,EAAMya,GAAS,IAEzB5tB,EAA8B4tB,EAA9B5tB,OAAQjD,EAAsB6wB,EAAtB7wB,OAAQ+pC,EAAclZ,EAAdkZ,UAExB,OAAO3zB,GACH,KAAKjZ,QAAMsa,SAAS8xB,UAChB3oC,UAAQqpC,cAAchnC,EAAO+I,WAC7B,MACJ,KAAK7O,QAAMsa,SAASgyB,YAChB7oC,UAAQspC,gBAAgBjnC,GACxB9B,eAAakD,QAAQpB,EAAQjD,GAC7B8e,qBAAmBC,cAAc,CAC7BC,YAAa7hB,QAAM8hB,YAAYkrB,uBAEnC,MACJ,KAAKhtC,QAAMsa,SAASiyB,YAChB9oC,UAAQwpC,gBAAgBL","file":"app.bundle.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([\"./src/index.js\",\"vendors~admin~app~wiki\",\"vendors~admin~app~dan\",\"vendors~admin~app\",\"vendors~app\",\"admin~app~utils~wiki\",\"admin~app\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"/* iPhone 5, ?? */\\n\\n@media (max-width: 320px) and (max-height: 568px) {\\n    .imageSlider .active.carousel-item {\\n        display: flex;\\n        align-items: center;\\n        justify-content: center;\\n    }\\n}\\n\\n@media (min-width: 320px) {\\n}\\n@media (min-width: 414px) {\\n    .test-card-question .question-question {\\n        font-size: 1.2rem;\\n    }\\n    .rights-link, .rights-attribution {\\n        grid-template-columns: 4rem auto 4rem;\\n    }\\n}\\n\\n/* iPHONE 6,7,8 */\\n\\n@media (max-width:375px) and (min-height:667px) {\\n    .autocomplete {\\n        height: 8rem !important;\\n    }\\n}\\n\\n/* Galaxy S5 */\\n\\n@media (min-width:360px) {\\n    .names-container .vernacular-name {\\n        max-width: 13.5rem;\\n    }\\n}\\n\\n/* @media (min-width:414px) {\\n    .youtube-icon, .accordion-icon {\\n        font-size: 1.4rem;\\n    }\\n    .species-table .youtube-icon, .accordion-icon {\\n        font-size: 1.2rem;\\n    }\\n} */\\n\\n/* iPHONE 6,7,8 PLUS, iPHONE X, GALAXY S9/S9+ */\\n\\n/* @media  (max-width:414px) and (min-height:736px),\\n        (max-width:375px) and (min-height:812px),\\n        (max-width:360px) and (min-height:740px) {\\n            body {\\n                font-size: 1em;\\n            }\\n} */\\n\\n@media (max-height:568px) {\\n    .test-card .help-txt {\\n        display: none;\\n    }\\n}\\n\\n@media (min-height: 667px) {\\n    .quick-fire .quick-fire-branches .btn-secondary, .quick-fire .quick-fire-branches .btn-secondary:not(:disabled):not(.disabled).active {\\n        font-size: .9rem;\\n        padding: .5rem;\\n    }\\n}\\n\\n@media (min-width: 576px) {\\n}\\n\\n@media (min-width: 600px) {\\n    .test-card-question .question-question {\\n        font-size: 1.4rem;\\n    }\\n    .modal-subheader {\\n        font-size: 1.2em;\\n    }\\n    .table-header th:nth-child(1) {\\n        min-width: 105px;\\n    }\\n    \\n    .master.table-row td:nth-child(1) {\\n        width: 105px;\\n    }\\n    \\n    .table-row img {\\n        width: 98px;\\n        height: 69px;\\n    }\\n}\\n\\n/* NEXUS 6 */\\n\\n@media (width: 412px) and (max-height: 732px) {\\n    .youtube-icon {\\n        font-size: 1.5rem !important;\\n    }\\n}\\n\\n/* NEXUS 7 */\\n\\n@media (width: 600px) and (max-height: 960px) {\\n    \\n    .block {\\n        font-size: 1.3rem;\\n    }    \\n    .test-card-question .question-statement, .test-card-question .question-provider-question {\\n        font-size: 1rem;\\n    }\\n    body {\\n        font-size: 1.2em;\\n    }\\n    .snapdragon-intro > div {\\n        font-size: 1.2rem;\\n    }\\n    .youtube-icon {\\n        font-size: 1.8rem !important;\\n    }\\n    .lesson-name, .lesson-name .underline-link {\\n        font-size: 1rem;\\n    }\\n}\\n\\n@media (min-height:812px) {\\n}\\n\\n@media (max-width: 768px) {\\n    .landscape {\\n        display: none !important;\\n    }\\n    .portrait-grid {\\n        display: grid;        \\n    }\\n}\\n\\n@media (min-height: 640px) {   \\n    .modal-title {\\n        line-height: 1.5;\\n    } \\n}\\n\\n@media (min-width: 768px) {\\n\\n  h1 {\\n    font-size: 1.6rem;\\n  }\\n\\n  h2 {\\n    font-size: 1.3rem;\\n  }\\n\\n  h3 {\\n    font-size: 1rem;\\n  }\\n\\n  .modal h1 {\\n    font-size: 1.2rem;\\n  }\\n\\n  h2 {\\n    font-size: 1rem;\\n  }\\n\\n  h3 {\\n    font-size: .8rem;\\n  }\\n\\n    .quick-fire .quick-fire-branches .btn-secondary, .quick-fire .quick-fire-branches .btn-secondary:not(:disabled):not(.disabled).active {\\n        font-size: .9rem;\\n        padding: .5rem;\\n    }\\n\\n    .quick-fire-branches span {\\n        font-size: .6rem;\\n    }\\n    \\n    .autocomplete-options-container{\\n        top: calc(\\n            var(--vhRunningBlock, 7.5vh) + \\n            5px +\\n            var(--vhStandardBlock, 10vh) +\\n            var(--vhStandardBlock, 10vh)\\n            + .25rem\\n        ) !important;\\n    }\\n\\n    .species-search .icon {\\n        font-size: 5.5rem;\\n        height: calc(var(--vhStandardBlock, 30vh) * 2);\\n    }\\n\\n    .autocomplete-options-container.autocomplete {\\n        height: 15rem !important;\\n    }\\n\\n    .squares {\\n        height: calc( (var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - var(--vhDoubleStandardBlock,20vh));\\n    }\\n\\n    .imageSlider .carousel-item {\\n        height: var(--vhSmallImageCarousel);\\n        min-height: var(--vhSmallImageCarousel);\\n    }\\n\\n    .score-summary-row {\\n        display: flex;\\n    }\\n\\n    #imageModal .imageSlider .carousel-item, #imageComparisonModal .imageSlider .carousel-item {        \\n        height: calc( (var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - 300px ); /* see below (hack) */\\n    }\\n\\n    .image-description {\\n        padding: 1rem 4rem;\\n        margin-top: -300px; /* see above (hack) */\\n        color: black; /* to compensate for layer above (hack) */\\n    }\\n\\n    .imageSlider .carousel-control-next, .imageSlider .carousel-control-prev {\\n        top: 15%;\\n        top: calc(\\n            (var(--vh, 1vh) * 75 * .5) -\\n            (var(--vh, 1vh) * 7.5) -\\n            .5rem\\n            - 100px /* see above (hack) */\\n        );\\n    }\\n\\n    .modal-image .carousel-inner > div:nth-child(1) {\\n        height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - var(--vhRunningBlock));\\n    }\\n\\n    .carousel-indicators {\\n        position: absolute;\\n        left: .5rem;\\n        right: .5rem;\\n        padding: .5rem;\\n        text-align: left;\\n        margin-left: 4rem !important;\\n        margin-right: 4rem !important;\\n    }\\n\\n    .carousel-indicators li {\\n        margin-bottom: 0;\\n    }\\n\\n    .test-card-question .question-statement, .test-card-question .question-provider-question {\\n        font-size: .9rem;\\n    }\\n\\n    .species-picker-actions ul {\\n        column-count: 2;\\n    }  \\n\\n    .guide-header-container > div:nth-child(2) {\\n        flex-direction: row;\\n    }\\n\\n    .iconic-taxa-categories svg {\\n        width: 2rem;\\n        height: 2rem;\\n    }\\n\\n    .iconic-taxa-categories-selected svg {\\n        width: 1rem;\\n        height: 1rem;\\n    }\\n\\n    .iconic-taxa-categories i {\\n        font-size: 1.5rem;\\n    }\\n\\n    .inat.snap-switch .inat-entry {\\n        display: flex;\\n        align-items: center;\\n        margin: 0 0 0 1rem;\\n    }\\n\\n    .inat.snap-switch input[type=\\\"text\\\"] {\\n        margin: 0 .5rem 0 0;\\n        color: var(--snap-text-medium-dark);\\n        padding: 0 .1rem;\\n    }\\n\\n    .modal-guide-wrapper .location.snap-switch {\\n        width: 100%;\\n        margin-top: 2rem;\\n    }\\n\\n    .location-option.place > button {\\n        margin-left: .25rem;\\n    }\\n\\n    #inat-place::placeholder {\\n        color: var(--gray);\\n        font-size: 1rem;\\n    }\\n\\n    .inat.snap-switch .inat-entry, .inat.snap-switch input[type=\\\"text\\\"] {\\n        width: 12rem;\\n        width: fit-content;\\n        padding: 0 .25rem;\\n    }  \\n\\n    .range-slider {\\n        display: flex;\\n        align-items: center;\\n        justify-content: space-between;\\n    }\\n\\n    .range-slider > span:nth-child(2) {\\n        width: fit-content;\\n        border: .05rem solid var(--snap-border-lightest);\\n        padding: .5rem;\\n    }\\n\\n    .range-limits {\\n        display: initial;\\n    }\\n\\n    .inat-location-elsewhere {\\n        display: grid;\\n        grid-template-columns: 1fr .25rem 1fr;\\n    }\\n\\n    .location-filter-options {\\n      padding: 2rem;\\n      grid-template-columns: 1fr 1fr;\\n    }\\n    \\n    .traits-names-txt {\\n        display: grid;\\n        grid-template-columns: 1fr 1fr;\\n        padding: 1rem;\\n        border-bottom: 1px solid var(--snap-border-lightest);\\n    }\\n\\n    .iconic-icon {\\n        font-size: 2rem;\\n    }\\n\\n    .question-container .mushroom-icon-header svg {\\n        width: 1.8rem;\\n        height: 1.8rem;\\n        fill: var(--snap-iconic-icon-header);\\n    }\\n\\n    .species-header {\\n        text-align: right;\\n    }\\n\\n    .test-card-question .help-txt {\\n        margin: 1rem .5rem;\\n        font-family: serif;\\n        font-weight: bold;\\n        letter-spacing: .05rem;\\n    }\\n\\n    div.text-entry {\\n        margin: 1rem 0;\\n        padding: 0.5rem;\\n    }\\n\\n    .text-entry input {\\n        width: 75%;\\n        padding: 0.5rem;\\n        border: 0.05rem solid var(--snap-border-light);\\n    }\\n\\n    .video {\\n        top: -2px;\\n    }\\n\\n    .table-row {\\n        font-size: .8rem;\\n    }\\n\\n    .table-row td:nth-child(3) {\\n        display: flex;\\n        flex-direction: column;\\n        align-items: flex-start;\\n        justify-content: center;\\n    }\\n\\n    .species-list .scrollable {\\n        bottom: 0;\\n        top: 0;      \\n    }\\n        \\n    .right-grid .header, .right-grid .footer {\\n        justify-content: flex-start;\\n        padding-right: 1rem;\\n    }\\n\\n    .right-grid .footer > ul, .left-grid .footer > ul {\\n        max-width: 50%;\\n        text-transform: none;\\n        justify-content: space-between;\\n    }\\n\\n    .snapdragon-intro > div:nth-child(1) {\\n        margin: 0rem 2.4rem 0 2.4rem !important;\\n    }\\n\\n    .snapdragon-intro {\\n        height: initial;  \\n        padding: 2rem;\\n    }\\n\\n    .lesson-icon {\\n        width: 80px;\\n        height: 80px;\\n        object-fit: none;\\n    }\\n\\n    .lesson-list-carousel-item {\\n        align-items: center;\\n        display: grid;\\n        grid-template-columns: 1fr 3fr 1fr;\\n    }\\n\\n    .lesson-list-carousel-item > div:nth-child(3) {\\n        justify-content: center;\\n        margin: 0;\\n    }\\n\\n    .lesson-list-carousel-item > div:nth-child(3) > div {\\n        display: flex;\\n    }\\n\\n    body {\\n        max-width: 1200px;\\n    }\\n\\n    .left-grid {\\n        width: 458px;\\n        grid-area: left;\\n    }\\n\\n    .right-grid {\\n        width: 742px;\\n        grid-area: right;\\n    }\\n\\n    .grid {\\n        grid-template-columns: 1fr 1fr;\\n        grid-template-areas: \\\"right left\\\";\\n    }\\n\\n    .left-grid {\\n        display: grid;\\n    }  \\n\\n    .pool {\\n        max-width: 70%;\\n    }\\n\\n    .bird-song, .taxon-identification, .taxon-summary {\\n        margin: 1rem 4rem 0 4rem;\\n    }\\n\\n    .strips {\\n        cursor: pointer;\\n        width: initial;\\n        overflow-y: auto;\\n        padding: .5rem;\\n    }\\n\\n    .strip {\\n        min-width: initial;\\n        margin: .75rem .5rem .75rem 0;\\n        padding: .75rem;\\n    }\\n\\n    body {\\n        font-size: .9em;\\n    }\\n\\n    .home-scrolling-container .scrollable {\\n        position: relative; \\n        top: 0;\\n    }\\n\\n    .mixed-content-container {\\n        top: calc(\\n              var(--vhStandardBlock, 10vh)\\n            + var(--vhCalendar,11vh));\\n        height: calc(\\n              var(--vh, 1vh) * 100\\n            - var(--vhRunningBlocks,15vh)\\n            - var(--vhDoubleStandardBlock,20vh) \\n            - var(--vhCalendar,11vh) \\n            - 1.5rem);\\n      }\\n\\n      .modal-header {\\n          display: flex;\\n          align-items: center;\\n          justify-content: space-between;\\n      }\\n    \\n      iframe {\\n          width: 100%;\\n          border: 0;\\n      }\\n\\n      #badgeListModal .modal-dialog {\\n        width: 30vw;\\n        margin: calc( var(--vhRunningBlock) + var(--vhStandardBlock) + 5px + .5rem ) auto auto auto;\\n      }\\n\\n      #badgeListModal .modal-body {\\n        height: calc(var(--vhDoubleStandardBlock, 20vh) * 2);\\n      }\\n\\n      #wikiModal .modal-dialog {\\n        max-width: 900px;\\n        margin: auto;\\n      }\\n\\n      #wikiModal iframe {\\n          height: 100%;\\n      }\\n    \\n      #imageModal .modal-dialog {\\n        max-width: 600px;\\n        margin: auto;\\n      }\\n        \\n      #imageModal .modal-title span {\\n          display: flex;\\n          flex-direction: row;\\n      }\\n    \\n      #imageModal .modal-title span > span:nth-child(1) {\\n          margin: 0 .5rem 0 0;\\n      }\\n    \\n      #iNatWidgetModal .modal-dialog {\\n          max-width: 45vw;\\n      }\\n      \\n      #iNatWidgetModal .modal-header {\\n          display: inline;\\n      }\\n    \\n      #cardModal .feature-types {\\n          width: 100%;\\n          margin: 0;\\n      }\\n\\n      .info-details {\\n        padding: 1rem 4rem;\\n      }\\n\\n      .info.carousel.slide .carousel-item div dt, .info.carousel.slide .carousel-item div dd {\\n          padding: .5rem;\\n      }\\n\\n    .non-taxon.card img {\\n        height: 5.5rem;\\n        width: 5.5rem;\\n      }\\n\\n    .response-update {\\n        left: 0;\\n        right: 0;\\n        justify-content: flex-end;\\n    }\\n\\n    .strip:hover, .strip:focus, .strip:focus-within {\\n        box-shadow: 0 2px 8px transparent;\\n        border: 1px solid var(--snap-border-light);\\n    }\\n\\n    .strip:hover button, .strip:focus button, .strip:focus-within button {\\n      color: var(--snap-text-medium-dark);\\n    }\\n\\n    .strip {\\n        display: flex;\\n        flex-direction: column;\\n    }\\n\\n    .strip > div:nth-child(2) {\\n        margin-top: .5rem;\\n    }\\n\\n    .strip-single-line {\\n        padding: 1.5rem;\\n    }\\n\\n    .portrait, .portrait-grid {\\n        display: none !important;\\n    }  \\n\\n    .header > div:nth-child(2) {\\n        max-width: initial;\\n        text-transform: initial;\\n    }\\n\\n    .non-taxa {\\n        display: flex;\\n        flex-direction: column;\\n        align-items: flex-end;\\n    }\\n\\n    .non-taxa .btn-group {\\n        width: 12rem;\\n        flex-direction: column;\\n        margin: 0 .5rem;\\n    }\\n\\n    .non-taxa .btn.btn-secondary {\\n        height: 3rem;\\n        cursor: pointer !important;\\n    }\\n\\n    .non-taxon-card-wiki {\\n        margin: 0 .5rem 0 0;\\n    }\\n\\n    .modal-header-container {\\n        padding-bottom: 4px;\\n        border-bottom: 1px solid var(--snap-border-light);\\n    }\\n}\\n\\n@media (min-width: 1024px) {\\n\\n    .left-grid {\\n        width: 391px;\\n    }\\n\\n    .right-grid {\\n        width: 633px;\\n    }\\n\\n    .squares {\\n        padding-top: 2rem;\\n    }\\n\\n    .squares > div {\\n        width: 190px;\\n        height: 150px;\\n    }\\n\\n    .table-header th:nth-child(2), .table-row td:nth-child(2) {\\n        flex: 5;\\n    }\\n    \\n    .table-header th:nth-child(3), .table-row td:nth-child(3) {\\n        flex: 5;\\n        font-size: .8rem;\\n        line-height: 2;\\n        padding-left: 1rem;\\n    }\\n    \\n    .table-header th:nth-child(4), .table-row td:nth-child(4) {\\n        flex: 2;\\n    }\\n\\n    .table-header th:nth-child(3) span:nth-child(2):after {\\n        margin-left: .355rem;\\n    }\\n\\n    .table-header th:nth-child(3):after {\\n        display: none;\\n    }\\n\\n    .species-list .table-header th:nth-child(3) span:after {\\n        display: inline-block;\\n        width: 0;\\n        height: 0;\\n        margin-left: .255rem;\\n        vertical-align: middle;\\n        content: \\\"\\\";\\n        border-top: .3rem solid;\\n        border-right: .3rem solid transparent;\\n        border-bottom: 0;\\n        border-left: .3rem solid transparent;\\n        cursor: default;\\n    }\\n\\n    .species-list .table-header th:nth-child(4):after, .species-list .table-header th:nth-child(5):after {\\n        display: inline-block;\\n        width: 0;\\n        height: 0;\\n        margin-left: .255rem;\\n        vertical-align: middle;\\n        content: \\\"\\\";\\n        border-top: .3rem solid;\\n        border-right: .3rem solid transparent;\\n        border-bottom: 0;\\n        border-left: .3rem solid transparent;\\n        cursor: default;\\n    }\\n\\n    .table-header th:nth-child(3) {\\n        flex-direction: column;\\n        display: flex;\\n        align-items: start;\\n    }\\n\\n    .table-header th:nth-child(3) span {\\n        flex: 1;\\n        line-height: initial;\\n    }\\n\\n    .table-header th:nth-child(5), .table-row td:nth-child(5),\\n    .table-header th:nth-child(6), .table-row td:nth-child(6) {\\n        flex: 1;\\n        display: flex;\\n        align-items: center;\\n    }\\n\\n    .narrow-screen {\\n        display: none !important;\\n    }\\n\\n    .names-container .vernacular-name {\\n        max-width: none;\\n      }\\n}\\n\\n@media (max-width: 1024px) {    \\n    .wide-screen {\\n      display: none !important;\\n    }\\n}\\n\\n@media (min-width: 1112px) {\\n\\n    .left-grid, .tiles-container {\\n        width: 450px;\\n    }\\n\\n    .squares > div {\\n        height: calc( ((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - var(--vhDoubleStandardBlock,20vh)) / 3);\\n        width: 225px; \\n    }\\n\\n    .squares {\\n        padding-top: 1rem;\\n    }\\n    \\n    .squares > div img {\\n        padding: .5rem;\\n    }\\n\\n    .right-grid {\\n        width: 662px;\\n    }\\n}\\n\\n@media (min-width: 1200px) {\\n    \\n    .left-grid, .tiles-container {\\n        width: 458px;\\n    }\\n\\n    .right-grid {\\n        width: 742px;\\n    }\\n\\n    .squares > div {\\n        width: 229px;\\n    }\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"* {\\n  box-sizing: border-box;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\nhtml {\\n  height: var(--vhGrid, 100vh);\\n}\\n\\nbody {\\n  /* width: var(--vwGrid, 100vh);\\n  max-width: var(--vwGrid, 100vh); */\\n  height: var(--vhGrid, 100vh);\\n  /* font-size: .8em; */\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-family: 'Open Sans', sans-serif;\\n  color: var(--snap-text-dark);\\n  margin: auto;\\n  background-color: var(--snap-main-background);\\n}\\n\\nbutton {\\n  width: 100%;\\n  letter-spacing: .03rem;\\n}\\n\\nbutton[disabled] {\\n  opacity: .38; /* why  38%? google material design */\\n  pointer-events: none;\\n}\\n\\ninput[type=\\\"text\\\"] {\\n  padding: .5rem;\\n  width: 100%;\\n  border-color: var(--snap-border-lightest);\\n  border-style: solid;\\n}\\n\\nfigure {\\n  margin: .5rem 0 0;\\n}\\n\\na:hover {\\n  text-decoration: none;\\n}\\n\\nul {\\n  margin: 0;\\n  padding: 0;\\n}\\n\\nli {\\n  list-style-type: none;\\n  margin: 0 0 .5rem 0;\\n}\\n\\nprogress {\\n  margin: 0 !important;\\n  width: 100%;\\n  border: 0;\\n  background: var(--snap-progress-bg);\\n  max-height: 5px;\\n}\\n\\nprogress::-webkit-progress-bar {\\n  background-color: var(--snap-progress-bg);\\n}\\nprogress::-webkit-progress-value {\\n  background-color: var(--snap-text-black);\\n}\\nprogress::-moz-progress-bar {\\n  background-color: var(--snap-progress-bar);\\n}\\n\\n.progress-icon {\\n  color: var(--snap-progress-bar) !important;\\n  cursor: pointer;\\n}\\n\\n.no-progress {\\n  background-color: var(--snap-progress-bg);\\n}\\n\\n.inline-progress-container progress {\\n  width: 95px;\\n  height: 3px;\\n  left: 0;\\n  top: 2.5rem;\\n}\\n\\nhr {\\n  margin: 0;\\n}\\n\\n.font-size-small {\\n  font-size: .7rem;\\n}\\n\\n.desaturate {\\n  opacity: .6;\\n  filter: grayscale(80%);\\n}\\n\\n.no-progress {\\n  background-color: var(--snap-progress-bg);\\n}\\n\\n\\n\\n.btn-collection {\\n  background-color: var(--snap-portrait);\\n  color: var(--snap-text-dark);\\n}\\n\\n.btn-language {\\n  background-color: var(--snap-landscape);\\n  color: var(--snap-text-medium-dark);\\n}\\n\\n.btn.btn-non-taxa {\\n  width: 15rem;\\n  background-color: var(--snap-non-taxa);\\n  float: left;\\n}\\n\\n.non-taxa-definition {\\n  padding: 0 0.5rem;\\n}\\n\\n.icon::after\\n{\\n  display: inline-block;\\n  font-style: normal;\\n  font-variant: normal;\\n  text-rendering: auto;\\n  -webkit-font-smoothing: antialiased;\\n  font-family: \\\"Font Awesome 5 Free\\\";\\n}\\n\\n.icon.active::after {\\n  font-weight: 900;\\n  content: \\\"\\\\f00c\\\";\\n  padding: 0 0.5rem 0 0;\\n  margin: 0 0 0 -1.5rem;\\n  color: rgb(99, 127, 91);\\n}\\n\\n.icon.choice::after {\\n  font-weight: 900;\\n  content: \\\"\\\\f2e7\\\";\\n  padding: 0 0 0 0.25rem;\\n  color: rgb(99, 127, 91);\\n}\\n\\n.icon.edible::after {\\n  font-weight: 900;\\n  content: \\\"\\\\f2e7\\\";\\n  padding: 0 0 0 0.25rem;\\n  color: var(--snap-inactive);\\n}\\n\\n.icon.inedible::after {\\n  font-weight: 900;\\n  content: \\\"\\\\f056\\\";\\n  padding: 0 0 0 0.25rem;\\n  color: var(--snap-inactive);\\n}\\n\\n.icon.toxic::after {\\n  font-weight: 900;\\n  content: \\\"\\\\f071\\\";\\n  padding: 0 0 0 0.25rem;\\n  color: var(--snap-alert);\\n}\\n\\n.dropdown-menu {\\n  margin: 0.15rem 0 0 0;\\n  padding: 0;\\n  color: var(--snap-text-dark);\\n  border: .05rem solid var(--snap-border-light);\\n  left: inherit !important;\\n}\\n\\n.non-taxa .dropdown-menu {\\n  width: 15rem !important;\\n  background-color: var(--snap-dd-non-taxa-bg-intial);\\n}\\n\\n.non-taxa a.dropdown-item.active {\\n  background-color: var(--snap-dd-non-taxa-bg-active);\\n}\\n\\na.dropdown-item {\\n  color: var(--snap-text-medium-dark);\\n  padding: 0.5rem 0 0.5rem 1rem;\\n  cursor: pointer;\\n}\\n\\n.dropdown-menu.show {\\n  top: -.25rem !important;\\n}\\n\\n.non-taxa a.dropdown-item:hover {\\n  background-color: var(--snap-dd-non-taxa-bg-hover);\\n}\\n\\n.underline-external-link {\\n  color: var(--snap-link) !important;\\n  text-decoration: none;\\n  border-bottom: solid .05rem !important;\\n  color: inherit;\\n  cursor: pointer;\\n}\\n\\n.lesson-title {\\n  line-height: 1.6;\\n}\\n\\n.toUpperCase {\\n  text-transform: uppercase;\\n}\\n\\n.home, .settings, .nav-info, .list, .glossary, .email, .login, .email > a, .language {\\n  cursor: pointer;\\n  color: var(--snap-text-dark);\\n  font-size: 1.4rem;\\n}\\n\\na.icon:hover {\\n  color: var(--snap-text-light);\\n}\\n\\n.email span {\\n  font-size: .8rem;\\n}\\n\\n.glossary svg {\\n  vertical-align: middle;\\n}\\n\\n.grid-header {\\n  background-color: rgb(153, 172, 149);\\n  background-color: var(--snap-portrait);\\n  display: flex;\\n  align-items: center;\\n  color: var(--snap-text-dark);\\n  width: 100%;\\n  border-radius: 0.25rem 0.25rem 0 0;\\n  letter-spacing: 0.07rem;\\n  text-transform: uppercase;\\n}\\n\\n.grid-header > div {\\n  padding: 0 0.5rem;\\n}\\n\\n.hover-box {\\n  border: .05rem solid rgba(48, 94, 37,.8);\\n  padding: .25rem;\\n  margin: 0 0 0 -.25rem;\\n  border-radius: 0.25rem;\\n}\\n\\n.nav-icons .active-icon, .active-icon {\\n  color: white;\\n}\\n\\n.nav-icons .inactive-icon {\\n  color: var(--snap-inactive);\\n  cursor: not-allowed;\\n}\\n\\n.info-box .inactive-icon {\\n  display: none;\\n}\\n\\n.disabled-icon {\\n  cursor: initial;\\n  opacity: .38; /* why  38%? google material design */\\n  pointer-events: none;\\n}\\n\\n.scrollable.card {\\n  text-align: left;\\n}\\n\\n.score-summary-container {\\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh));\\n}\\n\\n.snapdragon-container {\\n  justify-content: flex-start;\\n  position: relative;\\n}\\n\\n.test-card-question.standard-block, .lesson-list-header.centred-block {\\n  border-bottom: .03rem solid var(--snap-border-medium);\\n}\\n\\n.home-container {\\n  position: relative;\\n  display: grid;\\n  grid-template-rows: var(--vhStandardBlock) auto;\\n}\\n\\n.feature-types {\\n  background-color: var(--snap-content-background);\\n}\\n\\n.species.card {\\n  margin: 0;\\n}\\n\\n.non-taxa {\\n  display: flex;\\n  justify-content: space-between;\\n  margin-top: 1rem;\\n}\\n\\n.non-taxa .btn-group {\\n  width: 100%;\\n  display: flex;\\n  align-items: center;\\n  flex-direction: column;\\n  margin: 0 .5rem;\\n  justify-content: space-evenly;\\n  background-color: var(--snap-landscape);\\n}\\n\\n.non-taxa .btn.btn-secondary {\\n  height: initial;\\n}\\n\\n.non-taxa .species-header {\\n  padding: 0 1.25rem 0 0;\\n}\\n\\n.non-taxon.card img {\\n  height: 4rem;\\n  width: 4rem;\\n}\\n\\n.non-taxon .btn.btn-secondary {\\n  width: 100%;\\n  background-color: var(--snap-landscape);\\n  border-radius: unset;\\n}\\n\\n.non-taxa-definition {\\n  display: flex;\\n  align-items: center;\\n  padding: 0 2rem;\\n}\\n\\n.non-taxon .definitions {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: space-evenly;\\n  height: 100%;\\n  text-align: left;\\n}\\n\\n.species.card-small {\\n  padding: 0.5rem;\\n}\\n\\n.card.radio-buttons-container {\\n  margin: 0 0 0.5rem 0;\\n}\\n\\n.binomial {\\n  font-style: italic;\\n  text-transform: initial;\\n}\\n\\n.lesson-plans .table-row.species-background:nth-child(n) {\\n  background-color: var(--snap-species-highlight-background);\\n}\\n\\n.lesson-plans .table-row.taxon-background:nth-child(n) {\\n  background-color: var(--snap-taxon-card-background);\\n}\\n\\n.snapdragon-options {\\n  padding: 0 .5rem;\\n}\\n\\n.grid {\\n  display: grid;\\n  grid-auto-flow: column;\\n  width: 100%;\\n  height: var(--vhGrid, 100vh);\\n  font-size: .8rem;\\n}\\n\\n.left-grid, .right-grid {\\n  display: grid;\\n  grid-template-columns: 100%;\\n  grid-auto-flow: column;\\n  grid-template-rows: var(--vhRunningBlock, 7.5vh) 5px auto var(--vhRunningBlock, 7.5vh);\\n}\\n\\n.left-body, .right-body {\\n  display: grid;\\n  grid-auto-flow: row;\\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh));  \\n  background-color: var(--snap-content-background);\\n}\\n\\n.header, .footer {\\n  display: flex;\\n  align-items: center;\\n  padding: 0 0.5rem;\\n  letter-spacing: 0.1rem;\\n  text-transform: uppercase;\\n  color: var(--snap-text-medium-dark);\\n}\\n\\n.header > div:nth-child(2) {\\n  max-width: 50%;\\n  font-size: .9rem;  \\n}\\n\\n.footer {\\n  bottom: 0;\\n}\\n\\n.left-grid .footer .nav-icons, .right-grid .footer .nav-icons {\\n  flex: auto;\\n  justify-content: space-evenly;\\n}\\n\\n.left-grid .footer .nav-icons li, .right-grid .footer .nav-icons li {\\n  margin: 0 !important;\\n}\\n\\n.footer-round, .footer-score span {\\n  color: var(--snap-text-medium-dark);\\n  padding: 0.75rem;\\n}\\n\\n.left-grid .header, .left-grid .footer {\\n  justify-content: flex-end;\\n  background-color: var(--snap-portrait);\\n}\\n\\n.right-grid .header, .right-grid .footer {\\n  justify-content: center;\\n  background-color: var(--snap-landscape);\\n}\\n\\n.header-text {\\n  color: var(--snap-text-dark-medium-dark);\\n}\\n\\n.scrollable {\\n  overflow-y: auto;\\n  -webkit-overflow-scrolling: touch;\\n  position: absolute;\\n  left: 0;\\n  right: 0;\\n  top: 0;\\n  bottom: 0;  \\n}\\n\\n/* .txt-specimen-species {\\n  margin: 0 0 0 1rem;\\n} */\\n\\n.answer {\\n  padding: 1rem;\\n  text-transform: capitalize;\\n  cursor: pointer;\\n}\\n\\n.answer button {\\n  width: 10rem;\\n}\\n\\n.squares {\\n  display: grid;\\n  grid-auto-flow: row;\\n  grid-template-columns: 1fr 1fr;\\n  grid-template-rows: 1fr 1fr 1fr;\\n}\\n\\n.tiles {\\n  display: grid;\\n  height: 50%;\\n  grid-auto-flow: column;\\n  grid-template-columns: 1fr 1fr;\\n  grid-template-rows: 1fr 1fr;\\n}\\n\\n.squares > div {\\n  display: grid;\\n  justify-self: center;\\n  height: 140px;\\n  width: 224px;\\n}\\n\\n.squares img, .tiles img {\\n  cursor: pointer;\\n  height: inherit;\\n  width: inherit;\\n  object-fit: cover;\\n}\\n\\n.traits.squares img {\\n  object-fit: scale-down;\\n}\\n\\n.traits.squares > div.multiple {\\n  grid-template-columns: 1fr 1fr;\\n  cursor: pointer;\\n  width: 80%;\\n}\\n\\n.square, .tile {\\n  border-radius: 0.2rem;\\n  cursor: pointer;\\n}\\n\\n.strips {\\n  display: grid;\\n  grid-template-columns: 1fr 1fr;\\n  cursor: pointer;\\n  height: calc( (var(--vh, 1vh) * 100) \\n    - var(--vhFixtures, 15vh) \\n    - var(--vhStandardBlock, 10vh)\\n    - var(--vhStandardBlock, 10vh)\\n    - var(--vhStandardBlock, 10vh)\\n    - var(--vhButtonBlock, 9vh)\\n    );\\n}\\n\\n.strip {\\n  background: #fff;\\n  border: 1px solid transparent;\\n  border-radius: 2px;\\n  box-shadow: 0 2px 8px rgba(0,0,0,.2);\\n  margin: .5rem .25rem;\\n  padding: .75rem;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.strip > div::first-letter {\\n  text-transform: capitalize;\\n}\\n\\n  .strip > * {\\n    pointer-events: none;\\n  }\\n\\n  .pointer-events-none {\\n    pointer-events: none !important;\\n  }\\n  \\n  .pointer-events-initial {\\n    pointer-events: initial !important;\\n  }\\n\\n.strips .strip.snap-success {\\n  background-color: var(--snap-success-medium);\\n  box-shadow: 0 2px 8px rgba(0,0,0,.8);\\n}\\n\\n.strips .strip.snap-alert {\\n  background-color: var(--snap-alert-medium);\\n  box-shadow: 0 2px 8px rgba(0,0,0,.8);\\n  border: none;\\n}\\n\\n.strip.snap-success > div.disabled {\\n  color: var(--gray-dark) !important;\\n}\\n\\n.strip div {\\n  text-align: center;\\n}\\n\\n.names-container .vernacular-name {\\n  max-width: 12rem;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  display: inline-block;\\n}\\n\\n.names-container.definition .vernacular-name {\\n  margin-top: 1.25rem;\\n}\\n\\n.align-left {\\n  text-align: left;\\n}\\n\\n.snapdragon.card {\\n  border: 0;\\n}\\n\\n.snapdragon.card.align-left {\\n  color: var(--snap-text-medium-dark);\\n  padding: 0.5rem;\\n}\\n\\n.snapdragon.card.align-left .feature-label {\\n  letter-spacing: 0.03rem;\\n  width: fit-content;\\n  display: inline-table;\\n}\\n\\n.taxon-highlight {\\n  background-color: var(--snap-taxon-card-background);\\n  padding: 0.5rem;\\n  margin: -0.5rem -0.5rem 0 -0.5rem;\\n  display: flex;\\n  justify-content: right;\\n}\\n\\n.taxon-highlight > div:nth-child(1) {\\n  flex: 1;\\n  align-self: center;\\n}\\n\\n.taxon-highlight > div:nth-child(2) {\\n  align-self: center;\\n}\\n\\n.taxon-highlight img {\\n  height: 5.5rem;\\n  width: 5.5rem;\\n  margin: 0 0 0 1rem;\\n  object-fit: cover;\\n}\\n\\n.latin-name {\\n  font-style: italic;\\n  font-family: serif;\\n  text-transform: initial;\\n}\\n\\n.common-name {\\n  font-style: normal;\\n  text-transform: capitalize;\\n}\\n\\n.taxon-header {\\n  display: flex;\\n  justify-content: center;\\n  flex-direction: column;\\n  text-align: left;\\n}\\n\\n.species-header img {\\n  filter: grayscale(80%);\\n  object-fit: scale-down;\\n  max-height: var(--vhStandardBlock, 10vh);\\n}\\n\\n.species-header > div:nth-child(1) {\\n  display: flex;\\n  flex-direction: column;\\n  padding: 0.25rem 1rem 0 0;\\n}\\n\\n.card-link-container {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.card-link-container i {\\n  font-size: 2rem;\\n  cursor: pointer;\\n  color: var(--snap-iconic-icon-header);\\n}\\n\\n.card-link-container i:hover {\\n  color: var(--snap-text-medium-light);\\n}\\n\\n.block-container {\\n  position: relative;\\n  justify-content: flex-start;\\n}\\n\\n.species-common-name {  \\n  text-transform: capitalize;\\n}\\n\\n.data-box-container {\\n  height: var(--vhCalendar, 11vh);\\n  display: grid;\\n  grid-template-columns: 2fr 2fr 3fr;\\n  grid-gap: .5rem;\\n  border-bottom: .03rem solid var(--snap-dd-non-taxa-bg-hover);\\n  font-size: .8rem;\\n}\\n\\n.mixed-content-container {\\n  top: calc(\\n      var(--vhStandardBlock, 10vh)\\n    + var(--vhSmallImageCarousel,23vh));\\n  height: calc(\\n        var(--vh, 1vh) * 100\\n      - var(--vhFixtures,15vh)\\n      - var(--vhSmallImageCarousel,23vh)\\n      - var(--vhDoubleStandardBlock,20vh)      \\n      - .5rem);\\n}\\n\\n.taxon.card-card .mixed-content-container {\\n  height: calc(\\n        var(--vh, 1vh) * 100\\n      - var(--vhFixtures,15vh)\\n      - var(--vhDoubleStandardBlock,20vh) \\n      - var(--vhCalendar)\\n      - 5px);\\n      padding: .5rem;\\n}\\n\\n.taxon.card-card .mixed-content-container .centred-block {\\n  flex-direction: column;\\n  height: 100%;\\n  align-items: flex-start;\\n  justify-content: space-evenly;\\n}\\n\\n.taxon.card-card .data-box-container {\\n  grid-template-columns: 1fr 2fr;\\n  padding: 0 .5rem;\\n}\\n\\n.inat-box .data-box {\\n  color: var(--snap-text-medium-light);\\n  height: 100%;\\n  border-left: 0;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  border-right: 1px solid var(--snap-border-lightest);\\n  font-size: .8rem\\n}\\n\\n.inat-box .data-box > div:nth-child(1), .inat-box .data-box > div:nth-child(2) {\\n  display: grid;\\n  grid-template-columns: 2fr 1fr;\\n  grid-gap: .25rem;\\n}\\n\\n.inat-box .data-box > div:nth-child(2) > div:nth-child(1) {\\n  padding: 0 0.5rem 0 0;\\n}\\n\\n.inat-box .data-box > div > div:nth-child(2) > div {\\n  text-align: center;\\n}\\n\\n.taxon-data > span:nth-child(1) {\\n  min-width: 50%;\\n}\\n\\n.data-box .taxon-data:nth-child(1) > span {\\n  text-transform: uppercase;\\n} \\n\\n.taxon-data {\\n  display: flex;\\n  flex-direction: row;\\n}\\n\\n.latin {\\n  font-style: italic;\\n  font-family: serif;\\n}\\n\\n.taxon-members {\\n  font-style: italic;\\n}\\n\\n.family-img {\\n  filter: grayscale(80%);\\n}\\n\\n.family-name {\\n  text-transform: uppercase;\\n}\\n\\n.history div {\\n  margin: 0 0 1rem 0;\\n}\\n\\n.clickable {\\n  cursor: pointer;\\n}\\n\\n.btn {\\n  font-size: inherit;\\n  padding: .5rem;\\n  border: none;\\n}\\n\\n.btn:hover {\\n  opacity: .8;  \\n}\\n\\n.btn.focus, .btn:focus {\\n  box-shadow: none;\\n}\\n\\nbtn:disabled {\\n  pointer-events: none;\\n}\\n\\n.btn-placeholder.btn {\\n  color: var(--snap-text-dark);\\n}\\n\\n.snap-btn {\\n  background-color: var(--snap-list-header-background);\\n  color: var(--snap-text-black);\\n  letter-spacing: .05rem;\\n  border: 1px solid var(--snap-portrait);\\n  padding: .25rem .75rem;\\n}\\n\\n.snap-btn:active {\\n  color: green !important;\\n}\\n\\n.snap-btn:focus:not(:focus-visible), .snap-icon-btn:focus:not(:focus-visible) {\\n  color: var(--snap-youtube-green) !important;\\n  outline: none;\\n  border: 1px solid var(--snap-youtube-green);\\n}\\n\\n.snap-icon-btn {\\n  color: var(--snap-text-dark);\\n  background-color: transparent;\\n  border: 1px solid transparent;\\n  padding: 0 .5rem;\\n}\\n\\n.snap-icon-btn:focus, .snap-icon-btn:hover {\\n  color: var(--snap-youtube-green);\\n  outline: none;\\n}\\n\\n.snap-link-btn, .snap-no-link-btn {\\n  color: var(--snap-text-dark);\\n  background-color: transparent;\\n  border: none;\\n  font-size: .7rem;\\n  width: intrinsic;           /* Safari/WebKit uses a non-standard name */\\n  width: -moz-max-content;    /* Firefox/Gecko */\\n  width: -webkit-max-content; /* Chrome */\\n}\\n\\n.snap-no-link-btn {\\n  pointer-events: none;\\n}\\n\\n.snap-action-btn {\\n  background-color: var(--snap-tertiary-background);\\n  color: var(--snap-text-light);\\n  letter-spacing: .05rem;\\n  border: 1px solid var(--snap-non-taxa) !important;\\n  padding: .5rem .75rem;\\n}\\n\\n.snap-action-btn:focus {\\n  outline: none;\\n  color: var(--snap-text-black);\\n}\\n\\n.snap-action-btn.snap-success {\\n  color: var(--snap-text-light) !important;\\n  background-color: var(--snap-success) !important;\\n  border: 0.05rem solid var(--snap-success);\\n}\\n\\n.snap-action-btn.snap-alert {\\n  color: var(--snap-text-light) !important;\\n  background-color: var(--snap-alert) !important;\\n  border: 0.05rem solid var(--snap-alert);\\n}\\n\\n.btn-tertiary {\\n  color: var(--snap-text-light);\\n  background-color: var(--snap-tertiary-background) !important;\\n  border: 1px solid var(--snap-border-light);\\n  cursor: pointer !important;\\n}\\n\\n.btn-tertiary:focus {\\n  outline: none;\\n  color: var(--snap-text-black);\\n}\\n\\n.dropdown-toggle::after {\\n  vertical-align: 0.2rem;\\n  margin-left: 0.2rem;\\n}\\n\\n.course-description {\\n  margin: 1rem 0;\\n}\\n\\n.course-description span {\\n  margin: 0 0 0.5rem 0;\\n}\\n\\n.course-description span:nth-child(1) {\\n  background-color: lightblue;\\n  padding: 0.25rem;\\n}\\n\\n.course-description .snap-alert {\\n  width: 50%;\\n}\\n\\n.species-count {\\n  vertical-align: super;\\n}\\n\\n.clear-lesson button {\\n  float: left;\\n}\\n\\n.collection span {\\n  padding: 0 0.5rem;\\n  cursor: pointer;\\n}\\n\\n.dropdown div {\\n  white-space: nowrap;\\n}\\n\\n.single-tile {\\n  display: flex;\\n  flex-direction: column;\\n  margin: 2rem 1rem;\\n}\\n\\n.image-border {\\n  text-align: center;\\n  margin: 0 0 2rem 0;\\n  border: .05rem solid;\\n  border-radius: .2rem;\\n  padding: 1rem;\\n}\\n\\n.blocks {\\n  flex: auto;\\n  flex-direction: column;\\n  padding: 2rem;\\n}\\n\\n.block {\\n  font-size: 1rem;\\n  display: inline-block;\\n  cursor: pointer;\\n  width: fit-content;\\n  background-color: var(--snap-block-light);\\n  color: var(--snap-text-dark);\\n  margin: 0 .5rem 0 0;\\n  padding: .25rem .5rem;\\n  letter-spacing: .1rem;\\n  border-radius: .2rem;\\n  border: .05rem solid var(--snap-text-dark);\\n}\\n\\n.pool .block {\\n  margin: 0 .5rem .5rem 0;\\n}\\n\\n.block + hr {\\n  margin: .5rem 0 0 0;\\n}\\n\\n.pool {\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n\\n.pool .block.active {\\n  color: var(--snap-text-light);\\n  background-color: rgb(128, 128, 128);\\n}\\n\\n.pool .block.correct {\\n  color: var(--snap-text-light);\\n  background-color: var(--snap-success);\\n}\\n\\nspan.correct {\\n  color: rgb(2, 107, 26);\\n}\\n\\n.block.snap-success, .block.snap-alert {\\n  color: var(--snap-text-light) !important;\\n  background-color: var(--snap-success) !important;\\n  border: none;\\n}\\n\\n.block.snap-alert {\\n  background-color: var(--snap-alert) !important;\\n}\\n\\n.snap-alert-fg {\\n  color: var(--snap-alert);\\n}\\n\\n.btn.snap-alert {\\n  padding: 0.175rem 0.75rem;\\n}\\n\\n.block.white {\\n  color: var(--snap-text-dark);\\n}\\n\\n.blocks button {\\n  margin: 2rem 0 0 0;\\n}\\n\\n.delay-slider {\\n  margin: 1rem 0;\\n}\\n\\n.delay-slider > div input {\\n  flex: auto;\\n  margin: 0 .5rem;\\n}\\n\\n.response-update {\\n  flex: initial;\\n  display: flex;\\n  flex-direction: row;\\n  position: absolute;\\n  bottom: 0.5rem;\\n  right: .5rem;\\n  left: .5rem;\\n}\\n\\n.action-update {\\n  width: 100%;\\n}\\n\\n.action-update button {\\n  width: 100%;\\n}\\n\\n.answer-container .icon-container {\\n  position: relative;\\n  display: inline-block;\\n}\\n\\n.answer-container .icon {\\n  font-size: 1.5rem;\\n  position: absolute;\\n  top: -0.9rem;\\n}\\n\\n.taxa svg {\\n  margin: 0 .25rem 0 0;\\n}\\n\\n.taxa .si-glyph-mushrooms svg {\\n  margin: 0;\\n}\\n\\n.species-answer {\\n  display: none;\\n}\\n\\n.species-question,\\n.species-answer,\\n.btn-placeholder {\\n  text-align: center;\\n  border: 1px solid var(--snap-border-light);\\n}\\n\\n.species-question.btn,\\n.btn-placeholder.btn {\\n  color: var(--snap-text-dark);\\n  background-color: var(--snap-block-light);\\n}\\n\\nbutton:disabled {\\n  cursor: initial !important;\\n}\\n\\n.species-answer {\\n  text-align: center;\\n  color: var(--snap-text-dark);\\n  background-color: var(--snap-block-light);\\n  border-left: 1px solid var(--snap-border-light);\\n  border-right: 1px solid var(--snap-border-light);\\n  border-bottom: 1px solid var(--snap-border-light);\\n}\\n\\n.answer-box-success .icon {\\n  color: var(--snap-success);\\n}\\n\\n.answer-box-alert .icon {\\n  color: var(--snap-alert);\\n}\\n\\n.species-card-images,\\n.non-taxon-card-images {\\n  /* height: initial; */\\n  display: grid;\\n  grid-template-columns: 1fr;\\n  cursor: pointer;\\n}\\n\\n.non-taxon-card-images {\\n  margin: 0;\\n}\\n\\n.trait.card li span:nth-child(1) {\\n  width: 25%;\\n  text-align: left;\\n}\\n\\n.trait.card li span:nth-child(2) {\\n  width: 75%;\\n  text-align: left;\\n}\\n\\n.toggle-content,\\n.toggle-content * {\\n  display: none;\\n}\\n\\n.toggle-content.is-visible,\\n.toggle-content.is-visible * {\\n  display: initial;\\n}\\n\\n.btn-secondary:not(:disabled):not(.disabled).active {\\n  background-color: var(--snap-text-light);\\n  color: var(--snap-text-dark);\\n}\\n\\n.non-taxon .btn-secondary:not(:disabled):not(.disabled).active {\\n  background-color: var(--snap-species-header-background);\\n}\\n\\n.rb.btn-group {\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n.rb.btn-group .btn.btn-secondary.active {\\n  color: var(--snap-success);\\n  background-color: inherit;\\n  border: none;\\n}\\n\\n.btn-secondary:not(:disabled):not(.disabled):active {\\n  color: var(--snap-text-medium-dark);\\n  background-color: initial;\\n  border: none;\\n}\\n\\n.rb.btn-group .btn:hover {\\n  color: rgb(100, 100, 100);\\n}\\n\\n.btn.btn-secondary.disabled.active {\\n  opacity: 1;\\n}\\n\\n.rb.btn-group label {\\n  margin: 0 0 .5rem 0;\\n}\\n\\n.rb.btn-group input[type=radio] {\\n  box-sizing: border-box;\\n  padding: 0;\\n  position: absolute;\\n  clip: rect(0,0,0,0);\\n  pointer-events: none;\\n}\\n\\n.btn.btn-secondary {\\n  color: var(--snap-text-medium-dark);\\n  background-color: var(--white);\\n  border: 0;\\n  width: fit-content;\\n  border: none;\\n}\\n\\n.btn.btn-secondary:hover {\\n  transition: none;\\n}\\n\\n.btn.btn-secondary.disabled .collectionName, .btn.btn-secondary.active .guideName {\\n  border: none;  \\n}\\n\\n.left-grid,\\n.species-card-wiki-entry,\\n.collection-preview,\\n.collection button,\\n.collections-skills {\\n  display: none;\\n}\\n\\n.species-table td .portrait input {\\n  height: 1.15rem;\\n  width: 1.15rem;\\n}\\n\\n.badge {\\n  vertical-align: text-top;\\n  cursor: pointer;\\n}\\n\\n.badge-light {\\n  color: inherit;\\n  background-color: transparent;\\n  margin: -0.25rem 0 0 0.25rem;\\n  padding: 0.4rem 0.4rem 0.3rem 0.4rem;\\n}\\n\\n.badge-list {\\n  height: 100%;\\n  padding: 1rem;\\n  background-color: var(--snap-snap-action-btn);\\n}\\n\\n.question-images {\\n  display: grid;\\n  height: 8rem;\\n  grid-template-columns: 1fr 1fr 1fr 1fr;\\n  grid-gap: 0.5rem;\\n}\\n\\n.layer-container {\\n  cursor: pointer;\\n  background-size: cover;\\n  background-position: center;\\n}\\n\\n.layer {\\n  height: 100%;\\n  width: 100%;\\n  color: rgb(101, 132, 37, 0);\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.layer > div {\\n  text-align: center;\\n}\\n\\n.feature-label {\\n  color: var(--snap-text-green);\\n}\\n\\n.lesson-option-headers {\\n    height: 2.5rem;\\n    display: flex;\\n    align-items: center;\\n    color: var(--snap-text-dark);\\n    letter-spacing: 0.03rem;\\n    padding: 0;\\n    width: fit-content;\\n}\\n\\n.faded {\\n  color: var(--snap-border-lightest);\\n}\\n\\n.compare-species-link {\\n  cursor: pointer;\\n}\\n\\n.imageSlider .carousel-inner {\\n  display: flex;\\n  flex-direction: column;\\n  background-color: rgba(211, 214, 173, 0.4);\\n}\\n\\n.imageSlider .carousel-inner > div {\\n  width: inherit;\\n}\\n\\n.imageSlider .carousel-control-next, .imageSlider .carousel-control-prev {\\n  top: 40%;\\n  height: 20%;\\n  width: 10%;\\n  background-color: rgba(211, 214, 173, 0.2);\\n  opacity: 0.5;\\n}\\n\\n.carousel-control-next button, .carousel-control-prev button {\\n  background-color: transparent !important;\\n  border: none !important;\\n}\\n\\n.carousel-control-next[disabled=\\\"disabled\\\"],\\n.carousel-control-prev[disabled=\\\"disabled\\\"] {\\n  pointer-events: none;\\n}\\n\\n.imageSlider .carousel.slide {\\n  background-color: var(--snap-text-dark-medium-dark);\\n}\\n\\n.imageSlider .carousel-inner > div:nth-child(1), .imageSlider .carousel-item {\\n  height: var(--vhExtraSmallImageCarousel);\\n  min-height: var(--vhExtraSmallImageCarousel);\\n}\\n\\n.species-card-images .carousel-item-next, .species-card-images .carousel-item-prev, .species-card-images .carousel-item.active {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.imageSlider .carousel-item-next, .imageSlider .carousel-item-prev, .imageSlider .carousel-item.active {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  pointer-events: all;\\n}\\n\\n.info-box .carousel-item-next, .info-box .carousel-item-prev, .info-box .carousel-item.active {\\n  display: grid;\\n}\\n\\n.carousel-item.active button {\\n  width: initial;\\n}\\n\\n.imageSlider .carousel-item > div {\\n  height: 90%;\\n  background-size: inherit;\\n  background-repeat: no-repeat;\\n  background-position: center;  \\n}\\n\\n#imageSlider_card-card .carousel-item > div, #imageSlider_card-card .carousel-item > div {\\n  pointer-events: none;\\n}\\n\\n.imageSlider .carousel-item > div.contain-image {\\n  background-size: contain;\\n}\\n\\n.imageSlider .carousel-control-next-icon,\\n.imageSlider .carousel-control-prev-icon {\\n  width: 1.5rem;\\n  height: 1.5rem;\\n  background-color: transparent;\\n  border: none;\\n}\\n\\n#imageSlider1 {\\n  flex: 1;\\n}\\n\\n#imageSlider2 {\\n  flex: 1;\\n}\\n\\n#imageSlider3 {\\n  flex: 1;\\n}\\n\\n.info-box .carousel.slide {\\n  float: right;\\n  width: 100%;\\n  background-color: var(--snap-species-header-background);\\n}\\n\\n.info.carousel.slide .carousel-item div dt, .info.carousel.slide .carousel-item div dd {\\n  padding: .25rem 0;\\n  text-align: center;\\n  margin: 0 15%;\\n  height: var(--vhHalfStandardBlock, 5vh);\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.info.carousel.slide .carousel-item div dt, .info.carousel.slide .carousel-item div dd {\\n  background-color: rgba(128, 128, 128, 0.3);\\n}\\n\\n.info.carousel.slide .carousel-item div dd {\\n  background-color: rgba(128, 128, 128, 0.1);\\n  text-transform: lowercase;\\n}\\n\\n.info.carousel-control .carousel-control-next-icon {\\n  color: black;\\n}\\n\\n.carousel-control-prev-icon {\\n  background-image: url(\\\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M5.25 0l-4 4 4 4 1.5-1.5-2.5-2.5 2.5-2.5-1.5-1.5z'/%3E%3C/svg%3E\\\");\\n}\\n\\n.carousel-control-next-icon {\\n  background-image: url(\\\"data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23000' viewBox='0 0 8 8'%3E%3Cpath d='M2.75 0l-1.5 1.5 2.5 2.5-2.5 2.5 1.5 1.5 4-4-4-4z'/%3E%3C/svg%3E\\\");\\n}\\n\\n.bird-song div:nth-child(2) {\\n  background-color: rgb(142, 160, 119);\\n}\\n\\n.bird-song-bg {\\n  background-color: var(--snap-collection-active);\\n}\\n\\n.bird-song-icon {\\n  color: rgba(0, 0, 0, 1);\\n  margin-left: -.5rem;\\n}\\n\\n.bird-song-icon-disabled {\\n  color: rgba(0, 0, 0, 0.2);\\n  pointer-events: none;\\n  margin-left: -.5rem;\\n}\\n\\niframe#birdsong {\\n  width: 1px;\\n  min-width: 260px;\\n}\\n\\n.rank {\\n  border-radius: 0.24rem;\\n  display: inline-block;\\n  vertical-align: text-top;\\n}\\n\\n.radio-buttons.disabled label {\\n  color: rgb(100,100,100);\\n}\\n\\n.visual-match .description div:empty,\\n.visual-match .description span:empty {\\n  display: none;\\n}\\n\\ndiv.hide-empty:empty,\\nspan.hide-empty:empty {\\n  display: none !important;\\n}\\n\\n.visual-match .description {\\n  background-color: rgb(200, 197, 172);\\n  display: flex;\\n  flex-direction: column;\\n  padding: 0.5rem;\\n}\\n\\n.visual-match .description span {\\n  flex: 1;\\n  padding: 0.5rem;\\n}\\n\\n.comparison-description {\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  padding: 0 0.5rem;\\n}\\n\\n.species-search .icon {\\n  font-size: 2.5rem;\\n  height: calc(var(--vhStandardBlock, 30vh) * 1.5);\\n  color: rgb(90, 147, 252);\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n}\\n\\n.species-search .icon i:not(.slow-spin) {\\n  color: var(--snap-active);\\n}\\n\\n.question-container .icon {\\n  color: rgb(90, 147, 252);\\n  font-size: 1.8rem;\\n}\\n\\n.slow-spin {\\n  -webkit-animation: fa-spin 6s infinite linear;\\n  animation: fa-spin 6s infinite linear;\\n}\\n\\na.collection-disabled {\\n  color: grey;\\n  pointer-events: none;\\n}\\n\\n.attribution-layer {\\n  color: var(--snap-text-light);\\n}\\n\\n.rights-attribution {\\n  display: grid;\\n  grid-template-columns: 2rem auto;\\n  height: var(--vhRunningBlock);\\n  background-color: rgb(166, 177, 155);\\n  font-size: .7rem;\\n}\\n\\n.rights-attribution .underline-link {\\n  color: white !important;\\n}\\n\\n.rights-link-copyright {\\n  display: flex;\\n  align-items: center;\\n  cursor: pointer;\\n  z-index: 25;\\n}\\n\\n.rights-link-copyright .underline-link {\\n  line-height: 1.5;\\n}\\n\\n.rights-link-copyright i {\\n  color: white;\\n  font-size: 1.1rem;\\n}\\n\\n.rights-link-copyright i.fas.fa-copyright {\\n  font-size: 1.3rem;\\n}\\n\\n.rights-link {\\n  height: var(--vhRunningBlock);\\n  grid-template-columns: 2rem auto 2rem;\\n  background-color: rgb(166, 177, 155);\\n  display: grid;\\n}\\n\\n.rights-link > div:nth-child(1), .rights-link > div:nth-child(3) {\\n  cursor: pointer;\\n}\\n\\n.rights-attribution > div > div:nth-child(1) {\\n  margin: 0 0.5rem 0 0;\\n}\\n\\n.rights-attribution > div > div:nth-child(2) {\\n  flex: 1;\\n}\\n\\n.rights-attribution span {\\n  vertical-align: baseline;\\n  margin: 0 0 0 0.25rem;\\n}\\n\\n.greek {\\n  vertical-align: super;\\n}\\n\\n.dropdown.collections {\\n  display: flex;\\n}\\n\\n.range-slider-control {\\n  display: flex;\\n  justify-content: space-between;\\n}\\n\\n.carousel-indicators {\\n  height: var(--vhRunningBlock);\\n  bottom: 0;\\n  margin: 0 !important;\\n  margin-left: 2.5rem !important;\\n  margin-right: 2.5rem !important;\\n  align-items: center;\\n}\\n\\n.carousel-indicators li {\\n  background-color: var(--snap-text-medium-dark);\\n  width: 1rem;\\n  height: 0.25rem;\\n  margin-bottom: 0;\\n}\\n\\n.carousel-indicators .active {\\n  background-color: white;\\n}\\n\\n.question-header {\\n  display: flex;\\n  background-color: var(--snap-species-header-background);\\n  color: var(--snap-dark);\\n  justify-content: center;\\n}\\n\\n.card-link {\\n  cursor: pointer;\\n  color: rgb(128, 121, 49);\\n}\\n\\n.calendar-container {\\n  display: flex;\\n  align-items: center;\\n  border-right: 1px solid var(--snap-border-lightest);\\n  justify-content: center;\\n}\\n\\n.calendar-box .row {\\n  display: grid;\\n  grid-auto-flow: row;\\n}\\n\\n.calendar-box .col {\\n  display: grid;\\n  grid-auto-flow: column;\\n}\\n\\n.calendar-box .col div {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 1.4rem;\\n  height: 1.4rem;\\n}\\n\\n.most-observations {\\n  color: var(--orange);\\n}\\n\\n.current-month {\\n  border: 0.05rem solid rgba(108, 117, 125,.8);\\n}\\n\\n.floating-card > span:nth-child(1) {\\n  background: #fff;\\n  border: none;\\n  border-radius: 2px;\\n  box-shadow: 0 2px 8px rgba(0,0,0,.2);\\n  display: inline-block;\\n  font-weight: 300;\\n  margin: .5rem;\\n  padding: .8rem 1.1rem;\\n}\\n\\n.home-container .snapdragon-header {\\n  text-transform: uppercase;\\n  color: var(--snap-text-medium-light);\\n  font-size: 1.6rem;\\n  letter-spacing: .25rem;\\n  border-bottom: 1px solid var(--snap-border-lightest);\\n}\\n\\n.home-container .snapdragon-header a, .home-container .snapdragon-header a:visited {\\n  color: var(--snap-text-medium-light);\\n}\\n\\n.home-container .snapdragon-tag, .home-container .summary-scores, .trait-card-summary-container .summary-scores {\\n  justify-content: center;\\n  font-style: italic;\\n  display: flex;\\n  color: var(--snap-link);\\n  letter-spacing: .03rem;\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n}\\n\\n.trait-card-summary-container .summary-scores {\\n  padding: 0 1rem;\\n}\\n\\n.home-guide .taxa {\\n  color: var(--snap-collection-active);\\n}\\n\\n.home-guide .taxa > span {\\n  margin-right: .25rem;\\n}\\n\\n.summary-scores .summary-progress {\\n  margin: 1rem 0 0 0;\\n  position: relative;\\n}\\n\\n.summary-scores .summary-progress span {\\n  margin: 0 0 0 .5rem;\\n}\\n\\n.summary-scores .summary-progress span.above {\\n  position: relative;\\n  bottom: .5rem;\\n}\\n\\n.summary-scores .summary-progress span.below {\\n  position: relative;\\n  top: .5rem;\\n}\\n\\n.summary-scores span {\\n  margin: 0 .25rem 0 0;\\n}\\n\\n.summary-scores span:nth-child(2) {\\n  vertical-align: super;\\n}\\n\\n.trait-line {\\n  margin-top: 2rem;\\n}\\n\\n.trait-line .small-icon {\\n  font-size: 1rem !important;\\n  margin: 0 !important;\\n}\\n\\n.trait-icon, .trait-icon > span {\\n  margin: 0 !important;\\n}\\n\\n.trait-icon svg g g {\\n  fill: var(--snap-link);\\n}\\n\\n.home-container .snapdragon-tag .inat-widget span:nth-child(1) {\\n  font-style: initial;\\n}\\n\\n.home-container .vernacular-language {\\n  font-size: 1rem;\\n}\\n\\n.delete-guide-link > span.active {\\n  color: var(--snap-alert) !important; \\n  pointer-events: initial;\\n}\\n\\n.delete-guide-link > span.disabled {\\n  color: var(--secondary) !important;\\n  pointer-events: none;\\n}\\n\\n.delete-guide-link input {\\n  cursor: pointer;\\n  width: 1rem;\\n  height: 1rem;\\n  vertical-align: text-bottom;\\n}\\n\\n.home-container .snapdragon-tag > div .underline-link {\\n  text-transform: initial;\\n}\\n\\n.home-container .snapdragon-tag > div .super-text {\\n  display: inline-block;\\n  margin: .5rem 0 0 .25rem;\\n  vertical-align: top;\\n  color: var(--secondary);\\n  font-style: italic;\\n}\\n\\n.snapdragon-create-guide {  \\n  position: absolute;\\n  bottom: 1rem;\\n  right: 1rem;\\n  color: var(--snap-link);\\n}\\n\\n.snapdragon-create-guide > div:nth-child(1) {\\n  letter-spacing: .05rem;\\n  text-transform: uppercase;\\n}\\n\\n.snapdragon-create-guide .for-text {\\n  vertical-align: middle;\\n}\\n\\n.snapdragon-create-guide .toggle-links {\\n  display: flex;\\n  justify-content: flex-end;\\n  margin: .5rem .25rem 0 0;\\n}\\n\\n.edit-guide-link, .save-guide-link, .margin-right {\\n  margin: 0 .5rem 0 0;\\n}\\n\\n.swap-in-card {\\n  display: initial;\\n}\\n\\n.swap-out-card {\\n  display: none !important;\\n}\\n\\n.no-pointer-events {\\n  pointer-events: none;\\n}\\n\\n.snapdragon-intro {\\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - var(--vhStandardBlock,20vh) - var(--vhRunningBlock));\\n  top: calc(var(--vhStandardBlock));  \\n}\\n\\n.snapdragon-intro > h3, .snapdragon-intro > h4, .snapdragon-intro > h5 {\\n  line-height: 2;\\n  font-size: 1rem;\\n  margin: 1.2rem 2.4rem 0 2.4rem !important;\\n}\\n\\n.snapdragon-intro .youtube-icon {\\n  font-size: 1rem;\\n}\\n\\n.lesson-list {\\n  position: relative;\\n  background-color: var(--snap-block-light);\\n}\\n\\n.lesson-list-header {\\n  padding: 0 !important;\\n  background-color: var(--snap-list-header-background);\\n  justify-content: space-between;\\n}\\n\\n.lesson-list-header > div:nth-child(1) {\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.lesson-list-header > div:nth-child(1) > div {\\n  color: var(--snap-text-medium-light);\\n  display: flex;\\n  align-items: center;\\n  width: 100%;\\n  justify-content: space-between;\\n  padding-right: 1rem;\\n}\\n\\n.lesson-list-header > div:nth-child(2) {  \\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  cursor: pointer;\\n}\\n\\n.lesson-list-header > div:nth-child(2) > div {  \\n  height: calc( var(--vh) * 5);\\n  width: calc( var(--vh) * 5);\\n}\\n\\n.lesson-list-header > div:nth-child(1) {\\n  padding-left: .5rem !important;\\n}\\n\\n.lesson-list-header > div[data-toggle-state=\\\"off\\\"]:nth-child(1) > div:nth-child(1) {\\n  display: none;\\n}\\n\\n.lesson-list-header > div[data-toggle-state=\\\"on\\\"]:nth-child(1) > div:nth-child(2) {\\n  display: none;\\n}\\n\\n.lesson-list-header i {\\n  font-size: 1rem;\\n  vertical-align: super;\\n  color: var(--snap-text-medium-light);\\n  cursor: pointer;\\n}\\n\\n.lesson-list-carousel-item {\\n  display: flex;\\n  margin: .25rem 0;\\n}\\n\\n.lesson-list-carousel-item > div:nth-child(3) {\\n  font-size: 1.3rem;\\n  cursor: pointer;\\n  align-items: center;\\n  display: flex;\\n  position: absolute;\\n  right: .5rem;\\n}\\n\\n.lesson-list-item {\\n  padding: 1rem .5rem;\\n  pointer-events: none;\\n}\\n\\n.lesson-review, .lesson-terms-review {\\n  pointer-events: initial;  \\n  line-height: 3;\\n}\\n\\n.lesson-review i {\\n  font-size: .9rem;\\n  color: var(--snap-collection);\\n}\\n\\n.lesson-review i.fa-sync, .lesson-list-item i.fa-sync {\\n  font-size: 1rem;\\n  color: var(--snap-active);\\n}\\n\\n.lesson-list > div > div:nth-child(1) {\\n  justify-content: space-between;\\n  /* top: 0; */\\n  /* z-index: 30;\\n  width: 100%; */\\n}\\n\\n.lesson-list div.lesson-list-carousel-item:nth-of-type(2n) {\\n  background-color: var(--snap-lesson-row-green);\\n}\\n\\n.lesson-list div.lesson-list-carousel-item:nth-of-type(2n+1) {\\n  background-color: var(--snap-lesson-row-green);\\n}\\n\\n.lesson-list .scrollable {\\n  width: 100%;  \\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh) - var(--vhStandardBlock, 10vh));\\n  flex-direction: column;\\n  top: var(--vhStandardBlock, 10vh);\\n  border-top: 1px solid var(--snap-border-lightest);\\n}\\n\\n.lesson-list .scrollable .btn input[type=radio] {\\n  position: absolute;\\n  clip: rect(0,0,0,0);\\n}\\n\\n.youtube-green-fg {\\n  color: var(--snap-youtube-green);\\n}\\n\\n.button-block {\\n  height: var(--vhButtonBlock, 9vh);\\n  margin: 0 !important;\\n}\\n\\n.running-block {\\n  height: var(--vhRunningBlock, 9vh);\\n}\\n\\n.calendar-block {\\n  height: var(--vhCalendar, 11vh);\\n}\\n\\n.modal-footer.double-centred-block {\\n  background-color: var(--snap-portrait);\\n  text-transform: uppercase;\\n  cursor: pointer;\\n}\\n\\n.video {\\n  position: sticky;\\n  position: -webkit-sticky; \\n  top: 0; \\n  margin: 0;\\n  padding: 0;\\n  padding-top: .4rem;\\n  border-top: 1px solid var(--snap-border-light);\\n  position: relative;\\n  height: 0;\\n  padding-top: 56.25%;\\n  width:100%;\\n}\\n\\n.video iframe {\\n  position: absolute;\\n  top: 0; left: 0;\\n  border: 0;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n.home-scrolling-container {\\n  position: relative;\\n}\\n\\n.home-scrolling-container .scrollable {\\n  top: calc( var(--vhScrollingTop));\\n}\\n\\n.form-check {\\n  pointer-events: initial !important;\\n  display: flex;\\n  align-items: center;\\n}\\n\\n.form-check-input {\\n  margin-top: 0;\\n}\\n\\n.lesson-list .btn-group label.form-check-label {\\n  background-color: initial;\\n  cursor: pointer;\\n}\\n\\n/* .lesson-review > div {\\n  font-size: .7em;\\n} */\\n\\n.main-header {\\n  font-size: 1.4rem;\\n  text-transform: uppercase;\\n  letter-spacing: .25rem;\\n}\\n\\n.fa, .fab, .fal, .far, .fas {\\n  line-height: 1.5;\\n}\\n\\n#insertParent {\\n  /* background-color: var(--snap-container-background);   */\\n  font-size: .8rem;\\n  padding: 1rem;\\n}\\n\\n.col-count-2 {\\n  column-count: 2;\\n}\\n\\n.col-count-3 {\\n  column-count: 3;\\n}\\n\\n#insertParent > div > div:nth-child(1) {\\n  font-style: italic;\\n  font-size: .9rem;\\n}\\n\\n.border-bottom {\\n  border-bottom: .03rem solid var(--snap-border-medium);\\n}\\n\\n/* .title {\\n  padding: 0 .5rem;\\n} */\\n\\n.lesson-companion {\\n  display: flex;\\n    align-items: center;\\n    justify-content: center;\\n    font-style: italic;\\n    font-size: 1.1em;\\n    height: var(--vhStandardBlock, 10vh);\\n}\\n\\n.score-summary {\\n  top: calc(var(--vhStandardBlock));\\n  padding: .5rem 1.5rem;\\n}\\n\\n.score-summary.scrollable.review-summary {\\n  bottom: 1rem;\\n}\\n\\n.continue-link {\\n  margin-top: .5rem;  \\n}\\n\\n.highlighted-for-review-row {\\n  background-color: var(--snap-content-background) !important;\\n  border-top: 1px solid var(--snap-btn-auxillary);\\n  border-right: 1px solid var(--snap-btn-auxillary);\\n  border-bottom: 1px solid var(--snap-btn-auxillary);\\n  border-left: 1px solid var(--snap-btn-auxillary);\\n}\\n\\n.score-summary-row {\\n  border-bottom: .3rem solid var(--snap-content-background);\\n  padding: 1rem 0;\\n}\\n\\n.score-summary-row-title {\\n  padding: .5rem 0 0 0;\\n}\\n\\n.score-summary-row.species {\\n  background-color: var(--snap-header-background);\\n  border: none;\\n  display: flex;\\n  width: 100%;\\n}\\n\\n.score-summary-row.header {\\n  cursor: pointer;\\n  background-color: initial;\\n  font-size: initial;\\n  letter-spacing: initial;\\n  background-color: var(--snap-row-background);\\n}\\n\\n.score-summary-row > div:nth-child(1), .score-summary-row > div:nth-child(3) {\\n  width: 5rem;\\n  min-width: 5rem;\\n}\\n\\n.score-summary-row > div:nth-child(1) i, .score-summary-row > div:nth-child(3) i {\\n  font-size: 1.2rem;\\n}\\n\\n.score-summary-row > div {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  flex-direction: column;\\n}\\n\\n.score-summary-row > div:nth-child(2) {\\n  flex: auto;\\n  align-items: flex-start;\\n  max-width: 100%;\\n}\\n\\n.score-summary-row.in-columns {\\n  flex-direction: column;\\n  padding: 0;\\n}\\n\\n.score-summary-row.in-columns > div {  \\n  display: flex;\\n  flex-direction: row;\\n  width: 100%;\\n}\\n\\n.score-summary-row.in-columns > div > div {\\n  padding: 1rem 0;\\n}\\n\\n.score-summary-row.in-columns > div > div:nth-child(1), .score-summary-row.in-columns > div > div:nth-child(3) {\\n  width: 6rem;\\n  display: flex;\\n  justify-content: center;\\n}\\n\\n.score-summary-row.in-columns > div > div:nth-child(2) {\\n  display: flex;\\n  align-items: center;\\n  justify-content: flex-start;\\n  width: 100%;\\n  border-bottom: .03rem solid var(--snap-dd-non-taxa-bg-hover);\\n}\\n\\n.score-summary-row.in-columns > div > div:nth-child(2) > div {\\n  font-size: .8rem;\\n}\\n\\n.score-summary-row.in-columns > div > div:nth-child(2) > div:nth-child(1) {\\n  padding: .5rem;\\n}\\n\\n.score-summary-row.in-columns div[data-is-true=\\\"true\\\"] > div:nth-child(2) {\\n  color: var(--snap-success);\\n}\\n\\n.score-summary-row.in-columns div[data-is-true=\\\"true\\\"] > div:nth-child(2) {\\n  border: solid 1px var(--snap-progress-bar);\\n  padding: .3rem;\\n  display: inline-block;\\n}\\n\\n.score-summary-row.in-columns div[data-is-wrong-answer=\\\"true\\\"] {\\n  color: var(--snap-alert); \\n}\\n\\nimg[data-has-image=\\\"false\\\"] {\\n  display: none;\\n}\\n\\n.score-summary-row > div:nth-child(1) i {\\n  display: none;\\n}\\n\\n.score-summary-row > div[data-is-true=\\\"true\\\"]:nth-child(1) i:nth-child(1) {\\n  display: initial;\\n  color: rgb(52, 105, 23,.5);\\n  font-size: .8rem;\\n  font-size: 1.5rem;\\n}\\n\\n.score-summary-row > div:nth-child(1)[data-is-true=\\\"false\\\"] i:nth-child(2) {\\n  display: initial;\\n  color: var(--snap-alert);\\n  color: rgba(183, 12, 21,.5);\\n  font-size: 1.5rem;\\n}\\n\\n.score-summary-row img {\\n  width: 98px;\\n  height: 68px;\\n}\\n\\n.score-summary-row.title > span {\\n  display: flex;\\n  justify-content: flex-end;\\n}\\n\\n.score-summary-footer {\\n  justify-content: flex-end;\\n  align-items: flex-start;\\n}\\n\\n.concealed {\\n  opacity: 0;\\n}\\n\\n.fa, .fab, .fal, .far, .fas {\\n  line-height: 1.5 !important;\\n}\\n\\n.autocomplete {\\n  height: 5rem !important;\\n  position: absolute !important;\\n}\\n\\n.login.icon > i:nth-child(2) {\\n  color: var(--snap-text-light);\\n}\\n\\n.login.icon[data-is-logged-in=\\\"true\\\"] > i:nth-child(1) {\\n  display: none;\\n}\\n\\n.login.icon[data-is-logged-in=\\\"false\\\"] > i:nth-child(2) {\\n  display: none;\\n}\\n\\n.quick-fire {\\n  position: relative;\\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh));\\n  display: flex;\\n  flex-direction: column;\\n}\\n\\n/* .quick-fire .score {\\n  bottom: 5rem;\\n  position: absolute;\\n} */\\n\\n.quick-fire .strips {\\n  height: initial;\\n}\\n\\ninput[type=\\\"number\\\"].big {\\n  width: 4rem;\\n  padding: .5rem;\\n}\\n\\ninput[type=\\\"number\\\"].medium {\\n  width: 3rem;\\n  padding: .25rem;\\n  font-size: .8rem;\\n}\\n\\n.quick-fire-taxa {\\n  column-count: 2;\\n}\\n\\n.quick-fire label, .quick-fire-taxa label {\\n  cursor: pointer;\\n}\\n\\n.quick-fire-taxa span, .quick-fire-branches span {\\n  font-size: .6rem;\\n  vertical-align: super;\\n  display: inline-block;\\n  padding: 0 .125rem;\\n  min-width: 1.5rem;\\n  text-align: left;\\n}\\n\\n.quick-fire-branches span {\\n  font-size: .6rem;\\n}\\n\\n.quick-fire .btn-group {\\n  display: flex;\\n  flex-wrap: wrap;\\n}\\n\\n.quick-fire .btn-group >.btn {\\n  background-color: var(--snap-snap-action-btn);\\n  margin: 0 0 .5rem 0;\\n  border-radius: .25rem !important;\\n  letter-spacing: .03rem;\\n  width: fit-content;\\n  width: max-content;\\n  cursor: pointer !important;  \\n}\\n\\n.quick-fire .btn-group >.btn.active {\\n  background-color: var(--snap-text-medium-dark-hover);\\n  color: var(--snap-text-light);\\n}\\n\\n.quick-fire .quick-fire-branches.btn-group >.btn {\\n  background-color: var(--snap-btn-filter-off);\\n  border: 1px solid var(--snap-border-lightest);\\n}\\n\\n.quick-fire .quick-fire-options .btn-secondary {\\n  border: 1px solid var(--snap-collection-active);\\n}\\n\\n.quick-fire .quick-fire-options .btn-secondary:not(:disabled):not(.disabled).active {\\n  color: var(--snap-text-light);\\n  background-color: var(--snap-tertiary-background);\\n  border: 1px solid var(--snap-border-light);\\n}\\n\\n.quick-fire .quick-fire-branches .btn-secondary {\\n  font-size: .7rem;\\n}\\n\\n.quick-fire .quick-fire-branches .btn-secondary:not(:disabled):not(.disabled).active {\\n  font-size: .7rem;\\n  background-color: var(--snap-btn-filter-on);\\n  color: var(--snap-text-dark-medium-dark);\\n  border: 1px solid var(--snap-border-light);\\n}\\n\\n.quick-fire .btn {  \\n  cursor: pointer !important;\\n}\\n\\n.quick-fire-text-entry > div{\\n  width: 100%;\\n}\\n\\n.quick-fire .custom-checkbox .custom-control-input:checked ~ .custom-control-label::before {\\n  background-color: var(--snap-btn-blue);\\n}\\n\\n.quick-fire-summary-row.card {\\n  background-color: var(--snap-row-background);\\n  text-align: left;\\n  cursor: pointer;\\n}\\n\\n.quick-fire-summary-row .card-header {\\n  border-bottom: 0;\\n}\\n\\n.quick-review-tabs span {\\n  pointer-events: none;\\n}\\n\\n.nav-link {\\n  color: var(--snap-text-medium-dark);\\n  letter-spacing: .03rem;\\n}\\n\\n.nav-pills .nav-link.active, .nav-pills .show>.nav-link {\\n  color: var(--snap-text-light);\\n  color: var(--snap-text-medium-dark);\\n  background-color: var(--snap-collection-light);\\n}\\n\\n.nav-pills .nav-item:nth-child(1) .nav-link.active, .nav-pills .nav-item:nth-child(1) .show>.nav-link {\\n  background-color: var(--snap-success-medium);\\n}\\n\\n.nav-pills .nav-item:nth-child(2) .nav-link.active, .nav-pills .nav-item:nth-child(2) .show>.nav-link {\\n  background-color: var(--snap-alert-medium);\\n}\\n\\n.nav-pills .nav-link {\\n  border-radius: 0;\\n  position: relative;\\n}\\n\\n.quick-fire .nav-link.active.show {\\n  display: block;\\n}\\n\\n.quick-fire .nav-item a:hover {\\n  color: var(--snap-text-medium-dark);\\n  background-color: var(--snap-btn-hover);\\n}\\n\\n.quick-fire .nav-item:nth-child(1) a:hover {\\n  background-color: var(--snap-success-light);\\n}\\n\\n.quick-fire .nav-item:nth-child(2) a:hover {\\n  background-color: var(--snap-alert-light);\\n}\\n\\n.quick-fire .accordions-container {\\n  height: calc(\\n     (var(--vh, 1vh) * 100) \\n    - var(--vhFixtures, 15vh)\\n    - var(--vhDoubleStandardBlock,20vh)\\n    - var(--vhStandardBlock,10vh) \\n    - 1rem\\n    );\\n    top: calc(\\n        var(--vhDoubleStandardBlock,20vh)\\n      + var(--vhStandardBlock,10vh) \\n    );\\n}\\n\\n.correct-answer-color {\\n  color: var(--snap-success); \\n}\\n\\n.incorrect-answer-color {\\n  color: var(--snap-alert);\\n}\\n\\n.low-relief-block {\\n  border: 1px solid var(--snap-success-light) !important;\\n  background-color: var(--snap-species-highlight-background);\\n}\\n\\n.horizontal-buttons {\\n  display: grid;\\n  grid-template-columns: 1fr 1fr 1fr;\\n  grid-gap: .5rem;\\n}\\n\\n.lesson-spinner {\\n  font-size: 5rem;\\n  height: calc((var(--vh, 1vh) * 100) - var(--vhFixtures, 15vh)); \\n}\\n\\n.image-slider-190 img {\\n  height: 190px;\\n  min-height: 190px;\\n}\\n\\n.lesson-icon{\\n  width: 98px;\\n  height: 68px;\\n  object-fit: none;\\n}\\n\\n.location-filter-options {\\n  padding: .5rem;\\n  grid-template-rows: 1fr 1fr;\\n  display: grid;\\n}\\n\\n.skip-link {\\n  position: absolute;\\n  top: -40px;\\n  left: 0;\\n  background: #000000;\\n  color: white;\\n  padding: 8px;\\n  z-index: 100;\\n}\\n\\n.skip-link:focus {\\n  top: 0;\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".species-table {\\n  border-right: 1px solid var(--snap-btn-auxillary);\\n  border-left: 1px solid var(--snap-btn-auxillary);\\n  border-bottom: 1px solid var(--snap-btn-auxillary);\\n}\\n\\n.species-table td:last-child {\\n  margin-right: .5rem;\\n}\\n\\n.table-header {\\n  cursor: pointer;\\n  display: flex;\\n  flex-direction: row;\\n  border: 0;\\n  height: var(--vhRunningBlock,7.5vh);\\n  z-index: 10;\\n  align-items: center;\\n  top: 0;\\n  background-color: var(--snap-btn-auxillary);\\n  color: var(--snap-text-light);\\n  font-size: 1.1em;\\n  letter-spacing: .01rem;\\n}\\n\\n.table-header th {\\n  cursor: pointer;\\n  font-weight: initial;\\n}\\n\\n.table-row {\\n    display: flex;\\n    flex-direction: row;\\n    height: var(--vhRow, 12.5vh);\\n    font-size: .9em;\\n  }\\n  \\n  .table-row-chevron {\\n    display: flex;\\n    justify-content: center;\\n    width: 100%;\\n  }\\n\\n  tr.master:nth-child(2n + 1) {\\n    background-color: var(--snap-content-background);\\n  }\\n \\n  .table-row img, table input {\\n    cursor: pointer;\\n  }\\n  \\n  .table-row img {\\n    width: 64px;\\n    height: 64px;\\n    object-fit: none;\\n    padding: .5rem;\\n  }\\n\\n  .table-row img:hover {\\n    opacity: .8;\\n  }\\n  \\n\\n  .table-row img:focus {\\n    border: 1px solid black;\\n  }\\n  \\n  .table-row .lp-level {\\n    padding: 0 0 0 0.5rem;\\n  }\\n\\n  .inserted-td {\\n    font-size: .9rem;\\n    white-space: normal;\\n    text-align: left;\\n    padding: .5rem;\\n  }\\n\\n  th {\\n    text-align: initial;\\n  }\\n\\n\\n  .table-header th:nth-child(1) {\\n    min-width: 80px;\\n  }\\n\\n  .species-list .table-header th:nth-child(2):after,\\n  .species-list .table-header th:nth-child(3):after {\\n    display: inline-block;\\n    width: 0;\\n    height: 0;\\n    margin-left: 0.255rem;\\n    vertical-align: middle;\\n    content: \\\"\\\";\\n    border-top: 0.3rem solid;\\n    border-right: 0.3rem solid transparent;\\n    border-bottom: 0;\\n    border-left: 0.3rem solid transparent;\\n    cursor: default;\\n  }\\n  \\n  .table-header th:nth-child(1) > span,\\n  .table-footer td:nth-child(1) > span {\\n    height: 1px;\\n    display: flex;\\n    align-items: center;\\n    justify-content: center;\\n  }\\n  \\n  .table-header th:nth-child(2) {\\n    flex: 3;\\n    align-items: flex-start;\\n  }\\n  \\n  .master.table-row td:nth-child(1) {\\n    width: 80px;\\n    display: flex;\\n    align-items: center;\\n  }\\n\\n  .species-description > td:nth-child(1) {\\n    width: 100%;\\n  }\\n\\n  .table-row td:nth-child(2) {\\n    flex: 3;\\n    display: flex;\\n    align-items: flex-start;\\n    flex-direction: column;\\n    justify-content: center;\\n  }\\n\\n  .table-header th:nth-child(3),\\n  .table-row td:nth-child(3),\\n  .table-header th:nth-child(4),\\n  .table-row td:nth-child(4) {\\n    flex: 1;\\n    display: flex;\\n    align-items: center;\\n  }\\n\\n  .table-header th:nth-child(5), .table-row td:nth-child(5) {\\n    flex: 1;\\n    display: flex;\\n    align-items: center;\\n  }\\n\\n  .table-header th:nth-child(6), .table-row td:nth-child(6) {\\n      flex: 1;\\n      display: flex;\\n      align-items: center;\\n  }\\n\\n  .hide-column {\\n    flex: 0 !important;\\n    display: none !important;\\n  }\\n\\n .species-table .mushroom-icon svg {\\n  width: 1rem;\\n  height: 1rem;\\n  margin-top: .3rem;\\n }\\n\\ndiv.species-description {\\n  background-color: var(--snap-species-highlight-background);\\n  border-top: .5px solid var(--snap-youtube-green);\\n  border-bottom: .5px solid var(--snap-youtube-green);\\n  padding: 1rem;\\n  color: rgba(0, 0, 0, .85);\\n  height: initial;\\n}\\n\\n.species-description > td {\\n  width: 100%;\\n}\\n\\n.youtube-icon, .accordion-icon {\\n  font-size: 1.8rem;\\n  cursor: pointer;\\n}\\n\\ntable .youtube-icon, .accordion-icon {\\n  font-size: 1.2rem;\\n}\\n\\n.species-container {\\n  position: relative;\\n  width: 100%;\\n}\\n\\n.lesson-list-action-icons {\\n  right: .5rem;\\n  bottom: 1.5rem;\\n}\\n \\n.species-table .underline-link {\\n    text-transform: initial;\\n    display: initial;\\n}  \\n\\n.btn-current-lesson-begin {\\n  width: calc(var(--vwGrid) - 1rem);\\n  margin: .5rem;\\n}\", \"\"]);\n// Exports\nmodule.exports = exports;\n","import { utils } from 'utils/utils';\nimport { traitsHandler } from 'ui/helpers/traits-handler';\n\nexport const getTraitsForTests = (enums, item, alreadyTestedTraits = []) => {\n\n    if(item.traits === undefined || (Object.keys(item.traits).length === 0 && item.traits.constructor === Object)) return {};\n\n    const excludedTraits = [ ...traitsHandler.getTraitsToExclude(), ...alreadyTestedTraits, 'lookalikes', 'relationships' ].filter(et => et);\n\n    const trait = traitsHandler.getRandomTrait(item.traits, excludedTraits);\n\n    if((Object.keys(trait).length === 0 && trait.constructor === Object)) return {};\n \n    let { traitsPool, help } = \n        trait.unit \n            ? traitsHandler.getTraitsPoolForUnits(trait)\n            : trait.role\n                ? traitsHandler.getTraitsPoolForRoles(trait)\n                : traitsHandler.getTraitsPool(trait, enums);\n\n    const question = trait.unit\n                        ? trait.value.join('-')\n                        : trait.value.join(',');\n                           \n    trait.value = trait.value.map(t => utils.capitaliseFirst(t));\n\n    const answers = traitsHandler.getSetOfTraitAnswers(traitsPool, trait);        \n\n    help = help || trait.key;\n\n    const overrides = { question: 'Match the trait', help, trait };\n\n    return { question, answers, overrides, typedItemTraits: item.traits };\n};  ","export default \"img/powered_by_google_on_white_hdpi.png\";","import \"babel-polyfill\";\n\nimport 'bootstrap/js/dist/carousel';\nimport 'bootstrap/js/dist/modal';\nimport 'bootstrap/js/dist/dropdown';\nimport 'bootstrap/js/dist/collapse';\n\nimport 'ui/css/snapdragon-colours.css';\nimport 'ui/css/snapdragon.css';\nimport 'ui/css/common.css';\nimport 'ui/css/snapdragon-media.css'; \nimport 'ui/css/species-list.css';\n\nimport { utils } from 'utils/utils';\nimport { store, persistor } from 'redux/store';\nimport { nextLesson } from 'ui/setup/next-lesson';\nimport { nextLayout } from 'ui/setup/next-layout';\nimport { nextItem } from 'ui/setup/next-item';\nimport { renderHeaders } from 'ui/fixtures/headers';\nimport { renderScore } from 'ui/fixtures/score';\nimport { renderHome } from 'ui/screens/home/home';\nimport { renderNavigation, renderLoginChanges } from 'ui/fixtures/navigation';\nimport { subscription } from 'redux/subscriptions';\nimport { actions } from 'redux/actions/action-creators';\nimport { traitValuesHandler } from 'api/traits/trait-types';\nimport { initialiseConfig } from 'ui/helpers/location-helper';\nimport { firestore } from 'api/firebase/firestore';\nimport { renderLoggedIn } from 'ui/fixtures/login';\nimport { cookieHandler } from 'ui/helpers/cookie-handler';\nimport { lessonModalHandler } from 'ui/screens/cards/test-card-modal-handler';\nimport { handleWindowResize, loadModalHTML } from 'media-helper';\n\nconst onLoadHandler = () => {\n\n    setTimeout( async () => {\n\n      handleWindowResize();      \n\n      const purgeData = cookieHandler.hasUserBeenAwayTooLong();\n\n      if(purgeData) {\n          persistor.purge();\n          window.location.reload(true);\n      } else {\n        const lastVisitedCookie = cookieHandler.setLastVisitedCookie(Date());\n      }\n\n      let lessonPlan;\n\n      try {\n\n          const auth = firebase.auth();\n\n          const email = 'danhartleybcn@gmail.com';\n          const password = 'sarcarsnap1929';\n\n          // auth.signInWithEmailAndPassword(email, password).then((cred) => {\n          //     console.log('login credentials: ', cred);\n          // });\n\n          const { config, counter: currentCounter, lessonPlan: statePlans, collections } = store.getState();\n\n          lessonPlan = statePlans;\n\n          config.isPortraitMode = window.matchMedia(\"(max-width: 767px)\").matches;\n          config.isLandscapeMode = !config.isPortraitMode;\n\n          const counter = currentCounter ? { ...currentCounter } : { index: null, isLessonPaused: true };\n\n          actions.boundUpdateConfig(config);\n          actions.boundStopStartLesson(counter);\n\n          if(collections && collections.length === 0) {\n              const cloudCollections = await firestore.getCollections();\n              actions.boundUpdateCollections(cloudCollections);\n          }\n\n          subscription.add(renderHeaders, 'collection', 'flow');\n          renderNavigation();\n          subscription.add(renderNavigation, 'collection', 'flow');\n          renderLoginChanges();\n          subscription.add(renderLoginChanges, 'user', 'flow');\n          subscription.add(renderLoggedIn, 'user', 'flow');\n\n          subscription.add(renderHome, 'counter', 'flow'); // avoid adding as listener on page refresh\n                  \n          subscription.add(nextItem, 'layout', 'flow');\n          subscription.add(nextLesson, 'counter', 'flow');\n          subscription.add(nextLayout, 'counter', 'flow');\n          subscription.add(renderScore, 'score', 'flow');\n          subscription.add(traitValuesHandler, 'config', 'localisation');\n\n          const updateConfig = async () => {\n              const initialisedConfig = await initialiseConfig(config);\n              actions.boundUpdateConfig(initialisedConfig);\n          };\n\n          if(!config.guide.locationType) {\n              updateConfig();\n          }\n\n          let glossary = await firestore.getDefinitionsByTaxa(['common', 'plantae', 'aves', 'fungi', 'insecta']);\n              glossary = utils.sortAlphabeticallyBy(glossary, 'term');\n          actions.boundCreateGlossary(glossary);\n\n          loadModalHTML();\n          lessonModalHandler.onCloseModal();\n\n      }\n      catch(e) {\n          console.log('home page error: ', e)\n          // persistor.purge();\n          // window.location.reload(true);        \n      }\n    });\n};\n\nonLoadHandler();","export const observeStore = (store, select, onChange, domain, layout) => {\n    let currentState = null;\n    let hasStateSignificantlyChanged = false;\n\n    function handleChange() {      \n      let nextState = select(store.getState());\n\n      // let hasStateSignificantlyChanged = false;\n          hasStateSignificantlyChanged = nextState !== currentState;\n\n          if(currentState && Object.is(currentState.index,0)) {            \n            let areEqual = true;\n                areEqual = areEqual && Object.is(nextState.index, currentState.index);\n                areEqual = areEqual && Object.is(nextState.isLessonPaused, currentState.isLessonPaused);\n            hasStateSignificantlyChanged = !areEqual;\n          }\n\n      if(currentState && nextState) {\n        switch(layout) {\n          case 'screen-species-card':\n          case 'screen-taxon-card':\n          case 'screen-non-taxon-card':\n          case 'species-vernaculars':\n          case 'mixed-specimen-images':\n          case 'mixed-specimen-question':\n          case 'screen-common-to-latin':\n          case 'screen-genus-completion':\n          case 'screen-latin-to-common':\n          case 'media-match':\n            hasStateSignificantlyChanged = (nextState.nextItem && nextState.nextItem.name) !== (currentState.nextItem && currentState.nextItem.name);\n            break;\n        }\n      }\n\n      if(hasStateSignificantlyChanged) {\n        currentState = nextState;\n        onChange(currentState);\n      }\n    }\n  \n    handleChange.domain = domain;\n    handleChange.calledBy = onChange.name;\n    let unsubscribe = store.subscribe(handleChange);\n    if(hasStateSignificantlyChanged) {\n      handleChange();\n    }\n    return { unsubscribe, name: onChange.name };\n  };","import * as R from 'ramda';\n\nimport { lessonStateHelper } from 'ui/screens/lists/lesson-state-helper';\nimport { store } from 'redux/store';\nimport { observeStore } from 'redux/observe-store';\nimport { funcByName } from 'ui/helpers/function-lookups';\n\nlet subscriptions = [];\n\nconst add = (subscription, domain, role, layout) => {\n\n    const select = store => store[domain];\n    const onChange = subscription;    \n\n    const sub = observeStore(store, select, onChange, domain, layout);\n\n    const existingSub = getByName(sub.name);\n\n    if(existingSub) return;\n\n    subscriptions.push({ ...sub, role});\n    return sub;\n};\n\nconst remove = subscription => {\n\n    if(subscription) {\n\n        subscription.unsubscribe();\n        subscriptions = subscriptions.filter(sub => sub.name !== subscription.name);\n    }\n    return subscriptions;\n};\n\nconst removeByName = name => {\n    const subscription = getByName(name);\n    if(subscription) {\n        return remove(subscription);\n    }\n};\n\nconst getByName = name => {\n    return subscriptions.find(sub => sub.name === name);\n};\n\nconst getByRole = role => {\n    return subscriptions.filter(sub => sub.role === role);\n};\n\nconst getAll = () => {\n    return subscriptions;\n};\n\nconst removeSubs = () => {\n\n    let screens = getByRole('screen');\n\n    screens.forEach(sub => subscription.remove(sub));\n};\n\nconst checkRequired = (state, layout) => {\n\n    const { userAction, config } = state;\n\n    let isRequired = true, isReviewingLesson = true;\n\n    isReviewingLesson = lessonStateHelper.getIsReviewingLesson(userAction, config, isReviewingLesson); \n        \n    const reviewLayouts = [\n        'screen-species-card',\n        'screen-taxon-card',\n        'screen-non-taxon-card',\n        'species-vernaculars',\n        'mixed-specimen-images',\n        'mixed-specimen-question',\n        'screen-common-to-latin',\n        'screen-genus-completion',\n        'screen-latin-to-common',\n        'media-match'\n    ];\n\n    isRequired = isReviewingLesson ? true : !R.contains(layout.name, reviewLayouts);\n\n    return isRequired;\n};\n\nconst addSubs = (layout, config) => {\n\n    if(!layout) return;\n    \n    layout.screens.forEach( (screen, index) => {\n\n        const func = funcByName(screen.name);\n\n        const isSubscriptionRequired = checkRequired(store.getState(), layout);\n\n        if(func && isSubscriptionRequired) {\n            if(config.isPortraitMode) {\n                if(index === 1 || screen.name === 'summary') subscription.add(func, screen.domain, 'screen', layout ? layout.name : '');\n            } else {\n                subscription.add(func, screen.domain, 'screen', layout ? layout.name : '');\n            }                           \n        } else {\n            subscription.remove(subscription.getByName('nextItem'));\n            subscription.remove(subscription.getByName('traitValuesHandler'));\n        }\n    });\n};\n\n\n\nexport const subscription = {\n    add,\n    remove,\n    removeByName,\n    getByName,\n    getByRole,\n    getAll,\n    removeSubs,\n    addSubs\n};\n\n","import * as R from 'ramda';\n\nimport { layouts as L } from 'snapdragon-config/screen-layouts';\n\nimport { landscapeCustom } from 'snapdragon-config/plans/landscape/landscape-custom';\nimport { landscapeCustom2 } from 'snapdragon-config/plans/landscape/landscape-custom';\nimport { landscapeFungi, landscapeLichens } from 'snapdragon-config/plans/landscape/landscape-fungi';\n\nimport { landscapeStatic, landscapeStaticTaxonGroup, landscapeStaticProviderQuestionsOnly } from 'snapdragon-config/plans/landscape/landscape-static';\nimport { portraitStatic, portraitStaticTaxonGroup } from 'snapdragon-config/plans/portrait/portrait-static';\n\nconst landscapeBirds = { ...R.clone(landscapeStatic), id: 5 };\n      if(landscapeBirds.levels[0].bonusLayouts) landscapeBirds.levels[0].bonusLayouts[0].types.push('song');\n\nconst portraitBirds = { ...R.clone(portraitStatic), id: 105 };\n      portraitBirds.levels[0].layouts.push(L.mediaMatch); \n\nconst portraitFungi = { ...R.clone(landscapeFungi), id: 103, portrait: true };\n      portraitFungi.levels[0].bonusLayouts = [ { ...L.traitPropertyMatch, types: [ 'definition' ] } ];\n\nconst portraitLichens = { ...R.clone(landscapeLichens), id: 104, portrait: true };\nconst portraitCustom = { ...R.clone(landscapeCustom), id: 101, portrait: true };\nconst portraitCustom2 = { ...R.clone(landscapeCustom2), id: 102, portrait: true };\n\nexport const lessonPlans = [\n\n    landscapeCustom,\n    landscapeCustom2,\n    landscapeStatic,\n    landscapeStaticTaxonGroup,\n    landscapeStaticProviderQuestionsOnly,\n    landscapeFungi,    \n    landscapeLichens,\n    landscapeBirds,\n    \n    portraitCustom,\n    portraitCustom2,\n    portraitStatic,\n    portraitStaticTaxonGroup,    \n    portraitFungi,    \n    portraitLichens,\n    portraitBirds,\n    \n];","import { layouts as L } from 'snapdragon-config/screen-layouts';\n\nexport const landscapeCustom = {\n    id: 1,\n    name:'Lesson 1',\n    portrait: false,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, \n                        L.latinToCommonMatch, \n                        L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.speciesGenusEntry,\n                        L.familyMatch , L.familyStripsMatch\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'definition' ] } ]\n        }\n    ]\n};\n\nexport const landscapeCustom2 = {\n    id: 2,\n    name:'Lesson 2',\n    portrait: false,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, \n                        L.familyMatch , L.familyStripsMatch\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'definition' ] } ]\n        }\n    ]\n};","import * as R from 'ramda';\n\nimport { layouts as L } from 'snapdragon-config/screen-layouts';\n\nexport const landscapeFungi = {\n    id: 3,\n    name:'Lesson 3',\n    portrait: false,\n    default: false,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, \n                        L.latinToCommonMatch, L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.propertyTrait(L.mixedTraitImages, ['capShape']),\n                        L.propertyTrait(L.mixedTraitImages, ['gillAttachment']),\n                        L.speciesGenusEntry\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'lookalikes', 'definition' ] } ]\n        },\n    ]\n};\n\nexport const landscapeLichens = { ...R.clone(landscapeFungi), id: 4 };\nlandscapeLichens.levels[0] = { \n    id: 1,\n    name:'Level 1',\n    description: 'Species recognition',\n    layouts: [                          \n        L.mixedSpecimenImages\n    ],\n    // bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'definition' ] } ]\n    // reviewLayouts: [ L.multiSpecimenCommonMatch, L.mixedSpecimensRight ]\n};","import { layouts as L } from 'snapdragon-config/screen-layouts';\n\nexport const landscapeStatic = {\n    id: 10,\n    name:'Lesson 1',\n    portrait: false,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, \n                        L.latinToCommonMatch, \n                        L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.propertyTrait(L.mixedTraitImages, ['capShape', 'gillAttachment', 'leafShape', 'leafDivision', 'inflorescence', 'leafMargin']),\n                        L.speciesGenusEntry,\n                        L.familyMatch , L.familyStripsMatch\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'lookalikes', 'definition' ] } ]\n        }\n    ]\n};\n\nexport const landscapeStaticTaxonGroup = {\n    id: 11,\n    name:'Lesson 11',\n    portrait: false,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages,\n                        L.speciesIdentificationMatch,\n                        L.latinToCommonMatch, L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, \n                        L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.speciesGenusEntry,\n                    ],\n            // bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'lookalikes', 'definition' ] } ]\n        }\n    ]\n};\n\nexport const landscapeStaticProviderQuestionsOnly = {\n    id: 12,\n    name:'Lesson 12',\n    portrait: false,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [],\n            bonusLayouts: []\n        }\n    ]\n};","import { layouts as L } from 'snapdragon-config/screen-layouts';\n\nexport const portraitStatic = {\n    id: 110,\n    name:'Lesson 110',\n    portrait: true,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, \n                        L.latinToCommonMatch, \n                        L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.propertyTrait(L.mixedTraitImages, ['capShape', 'gillAttachment', 'leafShape', 'leafDivision', 'inflorescence', 'leafMargin']),\n                        L.speciesGenusEntry,\n                        L.familyMatch , L.familyStripsMatch\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'definition' ] } ]\n        }\n    ]\n};\n\nexport const portraitStaticTaxonGroup = {\n    id: 111,\n    name:'Lesson 111',\n    portrait: true,\n    default: true,\n    levels: [\n        {   id: 1,\n            name:'Level 1',\n            layouts: [                          \n                        L.mixedSpecimenImages, L.latinToCommonMatch, L.commonEntry,\n                        L.commonToLatinMatch,\n                        L.textCompleteGenus, L.genusEntry,                        \n                        L.textCompleteSpecies, L.speciesEntry,\n                        L.speciesGenusEntry\n                    ],\n            bonusLayouts: [ { ...L.traitPropertyMatch, types: [ 'lookalikes', 'definition' ] } ]\n        }\n    ]\n};\n","import * as R from 'ramda';\n\nimport { panels } from 'snapdragon-config/screen-panels';\n\nconst { \n    specimenImages, speciesCard, vernaculars, scientifics, text, \n    leaf, leafName, \n    family, familyStrips, taxon, nonTaxon, textComplete, cultivar, cultivarCard, \n    epithets, definitions, \n    specimenCommonMatch, specimenLatinMatch,\n    definitionCard, \n    traitProperty, symbioticProperty\n    , lookalikeProperty\n    , traitImages,\n    nonTaxonSpecimenTiles,\n    mixedSpecimenQuestions,\n    mixedSpecimensLeft,\n    mixedSpecimensRight,\n    history, summary, \n    birdsong, mediaPlayers,\n    mixedTraitLeft,\n    mixedTraitRight,\n    providerHorizontalStripQuestions,\n    speciesIdentification } = panels;\n\nconst mixedSpeciesMatch = {\n    name: 'screen-mixed-species-match',\n    type: 'test',\n    score: 1,\n    kind: 'VMC',\n    points: 3,\n    given: 'Given species name',    \n    requirement: 'Select species image',\n    screens: [\n        { ...specimenImages },\n        { ...mixedSpecimenQuestions }\n    ]\n};\n\nconst speciesRevision = {\n    name: 'screen-species-card',\n    type: 'revision',\n    score: 0,\n    kind: 'S',\n    points: 0,\n    given: 'Given species summary',\n    requirement: 'Study species',\n    screens: [\n        { ...specimenImages },\n        { ...speciesCard }\n    ]\n};\n\nconst taxonRevision = {\n    name: 'screen-taxon-card',\n    type:'revision',\n    score: 0,\n    kind: 'F',\n    points: 0,\n    given: 'Study',\n    requirement: 'Family summary',\n    screens: [\n        { ...specimenImages },\n        { ...taxon }\n    ]\n};\n\nconst nonTaxonRevision = {\n    name: 'screen-non-taxon-card',\n    type:'revision',\n    score: 0,\n    kind: 'GR',\n    points: 0,\n    given: 'Group summary',\n    requirement: 'Study',\n    screens: [\n        { ...nonTaxonSpecimenTiles },\n        { ...nonTaxon }\n    ]\n};\n\nconst definitionRevision = {\n    name: 'screen-definition-card',\n    type:'revision',\n    score: 0,\n    kind: 'G',\n    points: 0,\n    given: 'Given glossary',\n    requirement: 'Study definitions',\n    screens: [\n        { ...specimenImages },\n        { ...definitionCard }\n    ]\n};\n\nconst latinToCommonMatch = {\n    name: 'screen-latin-to-common',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Given latin name',\n    requirement: 'Select common name',\n    screens: [\n        { ...specimenImages },\n        { ...vernaculars }\n    ]\n};\n\nconst commonToLatinMatch = {\n    name: 'screen-common-to-latin',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Given common name',\n    requirement: 'Select latin name',\n    screens: [\n        { ...specimenImages },\n        { ...scientifics }\n    ]\n};\n\nconst speciesIdentificationMatch = {\n    name: 'screen-species-identification',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Given species name',\n    requirement: 'Select identification',\n    screens: [\n        { ...specimenImages },\n        { ...speciesIdentification }\n    ]\n};\n\nconst textCompleteGenus = {\n    name: 'screen-genus-completion',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Given species name',\n    requirement: 'Select genus name',\n    screens: [\n        { ...specimenImages },\n        { ...textComplete, type: 'text-complete-genus'  }\n    ]\n};\n\nconst multiSpecimenCommonMatch = {\n    name: 'screen-specimens-common-match',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'VMC',\n    given: 'Given specimenImages images',\n    requirement: 'Select common name',\n    screens: [\n        { ...specimenImages },\n        { ...specimenCommonMatch }\n    ]\n};\n\nconst multiSpecimenLatinMatch = {\n    name: 'screen-specimens-latin-match',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'VMC',\n    given: 'Given specimenImages images',\n    requirement: 'Select latin name',\n    screens: [\n        { ...specimenImages },\n        { ...specimenLatinMatch }\n    ]\n};\n\nconst traitPropertyMatch = {\n    name: 'trait-property-match',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    bonus: true,\n    given: 'Given traitImages images',\n    requirement: 'Select trait value',\n    screens: [\n        { ...traitImages },\n        { ...traitProperty }\n    ]\n};\n\nconst lookalikePropertyMatch = {\n    name: 'lookalike-property-match',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    bonus: true,\n    given: 'Given traitImages images',\n    requirement: 'Select trait value',\n    screens: [\n        { ...traitImages },\n        { ...lookalikeProperty }\n    ]\n};\n\nconst symbioticPropertyMatch = {\n    name: 'symbiotic-property-match',\n    type:'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Given specimenImages images',\n    requirement: 'Select symbiotic match',\n    screens: [\n        { ...specimenImages },\n        { ...symbioticProperty }\n    ]\n};\n\nconst familyMatch = {\n    name: 'screen-species-to-family',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'MC',\n    given: 'Species name',\n    requirement: 'List families',\n    screens: [\n        { ...specimenImages },\n        { ...family }\n    ]\n};\n\nconst cultivarMatch = {\n    name: 'screen-cultivar-to-species',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'MC',\n    given: 'Cultivar name',\n    requirement: 'List species',\n    screens: [\n        { ...specimenImages },\n        { ...cultivar }\n    ]\n};\n\nconst familyStripsMatch = {\n    name: 'screen-family-to-description',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'MC',\n    given: 'Family description',\n    requirement: 'List families',\n    screens: [\n        { ...specimenImages },\n        { ...familyStrips }\n    ]\n};\n\nconst genusEntry = {\n    name: 'screen-genus-entry',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'T',\n    given: 'Given species name',\n    requirement: 'Enter genus name',\n    screens: [\n        { ...specimenImages },\n        { ...text, taxon: 'genus'}\n    ]\n};\n\nconst speciesEntry = {\n    name: 'screen-species-entry',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'T',\n    given: 'Given genus name',\n    requirement: 'Enter species name',\n    screens: [\n        { ...specimenImages },\n        { ...text, taxon: 'species'}\n    ]\n};\n\nconst speciesGenusEntry = {\n    name: 'screen-binomial-entry',\n    type:'test',\n    score: 1,\n    points: 4,\n    kind: 'T',\n    given: 'Given common name',\n    requirement: 'Enter latin name',\n    screens: [\n        { ...specimenImages },\n        { ...text, taxon: 'name'}\n    ]\n};\n\nconst leafEntry = {\n    type:'test',\n    score: 1,\n    points: 3,\n    kind: 'T',\n    screens: [\n        { ...leaf },\n        { ...leafName }\n        // { ...leafName, template: 'js-text-entry-template' }\n    ]\n};\n\nconst textCompleteSpecies = {\n    name: 'screen-species-completion',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'MC',\n    given: 'Given genus name',\n    requirement: 'Select species name',\n    screens: [\n        { ...specimenImages },\n        { ...textComplete, type: 'text-complete-species' }\n    ]\n};\n\nconst commonEntry = {\n    name: 'screen-common-entry',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'T',\n    given: 'Species latin name',\n    requirement: 'Enter common name',\n    screens: [\n        { ...specimenImages },\n        { ...text, taxon: 'vernacular'  }\n        // { ...text, template: 'js-vernacular-entry-template', taxon: 'vernacular', headers: { long: 'Enter the common name', short: 'Enter the common name'}}\n    ]\n};\n\nconst latinEpithets = {\n    name: 'screen-epithets',\n    type: 'test',\n    score: 1,\n    points: 1,\n    kind: 'MC',\n    given: 'Epithet',\n    requirement: 'List epithet definitions',\n    screens: [\n        { ...specimenImages },\n        { ...epithets }\n    ]\n};\n\nconst glossaryTerms = {\n    name: 'screen-definitions',\n    type: 'test',\n    score: 1,\n    points: 1,\n    kind: 'T',\n    given: 'Given glossary term',\n    requirement: 'Select definition',\n    screens: [\n        { ...specimenImages },\n        { ...definitions }\n    ]\n};\n\nconst cultivars = {\n    name: 'screen-cultivars',\n    type: 'test',\n    score: 1,\n    points: 1,\n    kind: 'T',\n    given: 'List of cultivars',\n    requirement: 'List of species',\n    screens: [\n        { ...specimenImages },\n        { ...cultivarCard },\n        { ...cultivar }\n    ]\n};\n\nconst mixedSpecimenImages = {\n  name: 'mixed-specimen-images',\n  type:'test',\n  score: 1,\n  points: 2,\n  kind: 'T',\n  given: 'Specimen images',\n  requirement: 'Select species image',\n  screens: [\n      { ...mixedSpecimensLeft },\n      { ...mixedSpecimensRight }\n  ]\n};\n\nconst mediaMatch = {\n    name: 'media-match',\n    type:'test',\n    score: 1,\n    points: 2,\n    kind: 'T',\n    given: 'Species song',\n    requirement: 'Select species',\n    screens: [\n        { ...specimenImages },\n        // { ...mediaPlayers },\n        { ...birdsong }\n    ]\n};\n\nconst mixedTraitImages = {\n    name: 'mixed-trait-images',\n    type:'test',\n    kind: 'T',\n    score: 1,\n    points: 2,\n    given: 'Trait images',\n    requirement: 'Select trait image',\n    screens: [\n        { ...mixedTraitLeft },\n        { ...mixedTraitRight }\n    ]\n  };  \n\nconst providerHorizontalStrip = {\n    name: 'provider-horizontal-strip',\n    type: 'test',\n    score: 1,\n    screens: [\n        { ...specimenImages },\n        { ...providerHorizontalStripQuestions }\n    ]\n};\n\nconst propertyTrait = (traitPropertyMatch, traits) => {\n    const layout = R.clone(traitPropertyMatch);\n    layout.screens[0].traits = traits;\n    layout.screens[1].traits = traits;\n    return layout;\n};\n\nexport const layouts = {\n  mixedSpeciesMatch,\n  speciesRevision,\n  taxonRevision,\n  nonTaxonRevision,\n  definitionRevision,\n  \n  latinToCommonMatch,\n  commonToLatinMatch,\n  textCompleteGenus,\n  multiSpecimenCommonMatch,\n  multiSpecimenLatinMatch,\n  traitPropertyMatch,\n  lookalikePropertyMatch,\n  symbioticPropertyMatch,\n  familyMatch,\n  cultivarMatch,\n  familyStripsMatch,\n  genusEntry,\n  speciesEntry,\n  speciesGenusEntry,\n  textCompleteSpecies,\n  commonEntry,\n  leafEntry,\n  glossaryTerms,\n  latinEpithets,\n  cultivars,\n  mixedSpecimenImages,\n  history,\n  summary,\n  mediaMatch,\n  mixedTraitImages,\n  providerHorizontalStrip,\n  speciesIdentificationMatch,\n  propertyTrait\n}","const specimenImages = {\n    name: 'specimen-images',\n    domain: 'collection',\n  };\n  \nconst traitImages = {\n    name: 'trait-images',\n    domain: 'bonusLayout',\n  };\n  \n  const history = { \n    name: 'history', \n    domain: 'history'\n  };\n  \n  const speciesCard = {\n    name: 'species-card',\n    domain: 'collection',\n  };\n  \n  const definitionCard = {\n    name: 'definition-card',\n    domain: 'collection'\n  };\n  \n  const scientifics = {\n    name: 'species-scientifics',\n    domain: 'collection',\n    taxon: 'name'\n  };\n\n  const birdsong = {\n    name: 'birdsong',\n    domain: 'bonusLayout',\n  }\n\n  const mediaPlayers = {\n    name: 'media-players',\n    domain: 'collection',    \n  }\n  \n  const vernaculars = {\n    name: 'species-vernaculars',\n    domain: 'collection',\n    taxon: 'name'\n  };\n  \n  const text = {\n    name: 'text-entry',\n    domain: 'collection'\n  };\n  \n  const textComplete = {\n    name: 'text-complete',\n    domain: 'collection',\n    question: 'Complete the latin name',\n  };\n  \n  const summary = { \n    name: 'summary', \n    domain: 'history' \n  };\n  \n  const mixedSpecimenQuestions = {\n    name: 'mixed-specimen-questions',\n    domain: 'collection'\n  };\n\n  const leaf = {\n    name: 'leaf-image',\n    domain: 'collection'\n  };\n  \n  const leafName = {\n    name: 'leaf-text',\n    domain: 'collection'\n  };\n  \n  const epithets = {\n    name: 'epithet',\n    domain: 'collection'\n  };\n  \n  const definitions = {\n    name: 'definition',\n    domain: 'bonusLayout'\n  };\n  \n  const family = {\n    name: 'family',\n    domain: 'collection'\n  };\n  \n  const familyStrips = {\n    name: 'family-strips',\n    domain: 'collection'\n  };\n  \n  const taxon = {\n    name: 'taxon-card',\n    domain: 'collection'\n  };\n  \n  const nonTaxon = {\n    name: 'non-taxon-card',\n    domain: 'collection'\n  };\n  \n  const nonTaxonSpecimenTiles = {\n    name: 'non-taxon-specimen-tiles',\n    domain: 'collection'\n  };\n  \n  const cultivarCard = {\n    name: 'cultivar-card',\n    domain: 'collection'\n  };\n  \n  const cultivar = {\n    name: 'cultivar-match',\n    domain: 'collection'\n  };\n\n  const specimenCommonMatch = {\n    name: 'visual-match',\n    domain: 'collection',\n    type: 'vernacular'\n  };\n  \n  const specimenLatinMatch = {\n    name: 'visual-match',\n    domain: 'collection',\n    type: 'binomial'\n  };\n  \n  const traitProperty = {\n    name: 'trait-property',\n    domain: 'bonusLayout'\n  };\n  \n  const lookalikeProperty = {\n    name: 'lookalike-property',\n    domain: 'bonusLayout'\n  };\n  \n  const symbioticProperty = {\n    name: 'symbiotic-property',\n    domain: 'collection'\n  };\n\n  const mixedSpecimensLeft = {\n    name: 'mixed-specimen-images',\n    domain: 'collection'\n  };\n\n  const mixedSpecimensRight = {\n    name: 'mixed-specimen-question',\n    domain: 'collection'\n  };\n  \n  const mixedTraitLeft = {\n    name: 'mixed-trait-images',\n    domain: 'collection'\n  };\n\n  const mixedTraitRight = {\n    name: 'mixed-trait-question',\n    domain: 'collection'\n  };\n\n  const providerHorizontalStripQuestions = {\n    name: 'provider-horizontal-strip-questions',\n    domain: 'collection'\n  };\n\n    \n  const speciesIdentification = {\n    name: 'species-identification',\n    domain: 'collection',\n    taxon: 'name'\n  };\n\n  \n  export const panels = {\n    specimenImages,\n    history,\n  \n    speciesCard,\n    definitionCard,\n    scientifics,\n    vernaculars,\n    text,\n    summary,\n\n    leaf,\n    leafName,\n  \n    epithets,\n    definitions,\n    family,\n    familyStrips,\n    \n    taxon,\n    nonTaxon,\n    nonTaxonSpecimenTiles,\n    textComplete,\n    cultivarCard,\n    cultivar,\n  \n    specimenCommonMatch,\n    specimenLatinMatch,\n    traitProperty,\n    lookalikeProperty,\n    symbioticProperty,\n    \n    mixedSpecimenQuestions,\n\n    mixedSpecimensLeft,\n    mixedSpecimensRight,\n\n    birdsong,\n    mediaPlayers,\n    traitImages,\n\n    mixedTraitLeft,\n    mixedTraitRight,\n    providerHorizontalStripQuestions,\n    speciesIdentification\n  };","const all = [\n    {\n      id: 'fungi',\n      common: 'Fungi & Lichens'\n    },\n    {\n      id: 'amphibia',\n      common: 'Amphibians'\n    },\n    {\n      id: 'mammalia',\n      common: 'Mammals'\n    },\n    {\n      id: 'plantae',\n      common: 'Plants'\n    },\n    {\n      id: 'lepidoptera',\n      common: 'Butterflies & Moths'\n    },\n    {\n      id: 'insecta',\n      common: 'Insects'\n    },\n    {\n      id: 'aves',\n      common: 'Birds'\n    },\n    {\n      id: 'reptilia',\n      common: 'Reptiles'\n    }\n];\n\nexport const iconicTaxa = {\n    all\n}","import * as R from 'ramda';\n\nimport { getTraitTests } from 'snapdragon-engine/bonus/tests/trait-test';\nimport { getBirdsongTests } from 'snapdragon-engine/bonus/tests/birdsong-test';\nimport { getLookalikeTests } from 'snapdragon-engine/bonus/tests/lookalike-test';\nimport { getDefinitionTests } from 'snapdragon-engine/bonus/tests/definition-test';\n\nconst getTests = async (collection, itemIndices, bonusLayouts, lessonName, levelName) => {\n\n    const itemsInThisRound = collection.items.map((item, index) => {\n        if(R.contains(index, itemIndices)) {\n            return { ...item, itemIndex: index }\n        } else return null;        \n    }).filter(item => item);\n\n    const addLayoutToTest = traitTests => {\n        const lessonReadyTests = traitTests.map(traitTest => {             \n            traitTest.itemIndex = traitTest.item ? traitTest.item.itemIndex : 0; \n            traitTest = { ...traitTest, ...layout, lessonName, levelName };            \n            return traitTest;\n        });\n        return lessonReadyTests;\n    };\n\n    const getTraitTypeTests = itemsInThisRound => {\n        return new Promise(resolve => resolve(getTraitTests(itemsInThisRound)));\n    };\n\n    const getTraitTypeBirdsongTests = (itemsInThisRound, collection) => {\n        return new Promise(resolve => resolve(getBirdsongTests(itemsInThisRound, collection)));\n    };\n\n    const getTraitTypeLookalikeTests = itemsInThisRound => {\n        return getLookalikeTests(itemsInThisRound);     \n    };\n\n    const getDefinitionTypeTests = itemsInThisRound => {\n        return getDefinitionTests(itemsInThisRound);\n    };\n\n    let traitTests = [], birdsongTests = [], lookalikeTests = [], definitionTests = [];\n\n    let layout = bonusLayouts.find(layout => layout.name === \"trait-property-match\");\n\n    if(layout) {\n\n        if(layout.types) {\n\n            const getResolvedPromises = async () => {\n            const promises = await layout.types.map(async type => {\n                switch(type) {\n                    case 'traits':\n                        return getTraitTypeTests(itemsInThisRound);\n                    case 'song':\n                        return getTraitTypeBirdsongTests(itemsInThisRound, collection);\n                    case 'lookalikes':\n                        return getTraitTypeLookalikeTests(itemsInThisRound);\n                    case 'definition':                        \n                        return getDefinitionTypeTests(itemsInThisRound);\n                }\n            });\n\n            const testGroups = await Promise.all(promises);\n\n            const tests = testGroups.map(group => {\n                group = group.filter(g => g.question);\n                return addLayoutToTest(group);\n            });\n\n            return tests;\n        };\n\n        traitTests = await getResolvedPromises();\n\n        } else {\n            traitTests = getTraitTypeTests(itemsInThisRound);\n            birdsongTests = getTraitTypeBirdsongTests(itemsInThisRound, collection);            \n            lookalikeTests = getTraitTypeLookalikeTests(itemsInThisRound);\n            definitionTests = getDefinitionTypeTests(itemsInThisRound);\n        }\n    }\n\n    return R.flatten(traitTests);\n};\n\nexport const bonusHandler = {\n    getTests\n};","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\n\nexport const getBirdsongTests = (itemsInThisRound, collection) => {\n\n    if(itemsInThisRound === undefined) return [];\n\n    const tests = itemsInThisRound.map(item => {\n        \n        if(item.taxonomy.class && item.taxonomy.class.toLowerCase() !== 'aves') return [];\n        \n        const { question, answers, overrides } = getBirdsongTest(item, itemsInThisRound, collection);\n\n        if(!question) return {};\n\n        return {\n            item,\n            question,\n            answers,\n            overrides\n        }\n    });\n\n    return tests;\n}\n\nconst getBirdsongTest = (item, itemsInThisRound, collection) => {\n\n    if(!item.traits || Object.keys(item.traits).length === 0) return;\n\n    const name = 'song';\n    const birdsong = { name, ...item.traits[name] };\n    \n    // require other birds, which may not be in this collection\n\n    let birds = R.take(3, collection.items.filter(bird => bird.name.toLowerCase() !== item.name.toLowerCase()));\n        birds.push(item);\n\n    const birdNames = utils.shuffleArray(birds.map(bird => bird.name));\n\n    const question = item.name;\n    const answers = birdNames;\n    const overrides = { question: 'Match the birdsong', vernacularName: 'Common name', binomial: 'Latin name', trait: birdsong };\n\n    return { question, answers, overrides };\n};","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { firestore } from 'api/firebase/firestore';\nimport { matchTaxon, iconicTaxa } from 'api/snapdragon/iconic-taxa';\n\nexport const getDefinitionTests = itemsInThisRound => {\n    \n    if(itemsInThisRound === undefined) return [];\n\n    const tests = itemsInThisRound.map(item => {\n\n        return getDefinitionTest(item);\n\n    });\n\n    return tests;\n};\n\nconst getDefinitionTest = async item => {\n\n    const { config, collection, glossary } = store.getState();\n\n    const number = config.isPortraitMode ? 4 : 4;\n\n    const taxon = matchTaxon(item.taxonomy, iconicTaxa).value;\n\n    let definitions = glossary.filter(definition => R.contains(definition.taxon, [ taxon, 'common' ]));\n\n    definitions = utils.shuffleArray(definitions);\n\n    const term = item.terms \n                    ? utils.shuffleArray(item.terms)[0] \n                    : item.genus\n                        ? item.genus.terms\n                            ? item.genus.terms[collection.itemIndex] \n                                ? item.genus.terms[collection.itemIndex] \n                                    : item.family\n                                    ? item.family.terms\n                                        ? utils.shuffleArray(item.family.terms)[0]\n                                        : null\n                                    : null\n                            : null\n                        : null;\n                    \n\n    const definition = !!term \n        ? definitions.find(definition => definition.term.toLowerCase() === term.toLowerCase())\n        : definitions[0];\n\n    const alternatives = R.take(number-1, R.take(number, utils.shuffleArray(definitions)).filter(d => d.term.toLowerCase() !== definition.term.toLowerCase())).map(d => utils.capitaliseFirst(d.definition));\n    \n    const question = definition.definition;\n    const answers = utils.shuffleArray([question, ...alternatives]);\n    const help = config.isLandscapeMode ? 'Select the correct answer' : 'Select correct answer';\n\n    return { question, answers, overrides : { question: definition.term, help, binomial: item.name, vernacularName: item.vernacularName } };\n};","import { firestore } from 'api/firebase/firestore';\n\nexport const getLookalikeTests = async itemsInThisRound => {\n\n    const init = async () => {\n\n        if(itemsInThisRound === undefined) return new Promise(resolve => resolve([]));\n\n        return Promise.all(itemsInThisRound.map(async item => {\n            \n            const { question, answers, overrides } = await getLookalikeTest(item);\n\n            if(!question) return new Promise(resolve => resolve({}));\n\n            return {\n                item,\n                question,\n                answers,\n                overrides\n            }\n        }));\n    }\n\n    const tests = await init();\n\n    return tests;\n}\n\nexport const getItemLookalikes = async item => {\n\n    if(!item.traits || Object.keys(item.traits).length === 0) return {};\n\n    const lookaliketraits = item.traits['lookalikes'];\n\n    if(!lookaliketraits) return new Promise(resolve => resolve([]));\n\n    let lookalikes = lookaliketraits.map(trait => trait.lookalike.name);\n\n    if(lookalikes.length === 0) return {};\n\n    // check current collection first?\n\n    const getLookalikes = async () => {\n        return Promise.all(lookalikes.map(async name => {\n            return await firestore.getSpeciesByName(name);\n        })\n    )};\n    \n    lookalikes = await getLookalikes();\n    lookalikes = lookalikes.filter(lookalike => lookalike);\n\n    return lookalikes;\n};\n\nconst getLookalikeTest = item => {\n\n    const init = async () => {\n\n        const lookalikes = await getItemLookalikes(item);\n\n        const question = lookalikes.length > 0 ? item.name : null;\n        const answers = [ question, ...lookalikes.map(item => item.name) ];\n\n\n        return { question, answers, overrides : { question: 'Avoid look-alikes', help: '(Pick one correct image)', binomial: 'Latin name', vernacularName: 'Common name', trait: { name: 'lookalikes', lookalikes } } };\n    };\n\n    return init();\n};\n","import { store } from 'redux/store';\nimport { getTraitsForTests } from 'api/traits/traits-for-tests';\n\nexport const getTraitTests = itemsInThisRound => {\n\n    if(itemsInThisRound === undefined) return [];\n\n    const tests = itemsInThisRound.map(item => {\n\n        const { enums } = store.getState();\n\n        const { question, answers, overrides } = getTraitsForTests(enums, item);\n\n        if(!question) return {};\n\n        return {\n            item,\n            question,\n            answers,\n            overrides\n        }\n    });\n\n    return tests;\n};","export const getNextRoundLayouts = (lessonPlan, config, lesson) => {\n\n    // All layouts are currently activated because the lesson edit function is not in use.\n\n    lesson.activeLevelCount = lessonPlan.levels.filter(level => level.layouts.length > 0).length;\n\n    const getCurrentLevelFromLessonPlan = (lessonPlan, levelId) => {\n        return lessonPlan.levels.find(level => level.id === levelId);\n    }\n    \n    const getLayouts = (currentLevel, mode) => {    \n        switch(mode) {\n            case 'learn':\n                currentLevel.bonusLayouts = currentLevel.bonusLayouts || [];\n                return [ ...currentLevel.layouts.filter(l => l), ...currentLevel.bonusLayouts ];\n            case 'review':\n                return currentLevel.reviewLayouts || [];\n            default:\n                return currentLevel.layouts;\n        }\n    };\n\n    const goToNextLevelThatHasLayouts = (lessonPlan, levelId) => {\n\n        let layouts = [], lessonName = '', levelName = '';        \n        \n        const iterateOverLevelsCheckingForAvailableLayouts = (intialValue, levelId) => {\n            \n            let increment = intialValue;\n\n            if(layouts.length > 0) return;\n\n            const level = lessonPlan.levels.find(level => level.id === levelId + increment);\n\n            if(!level) return;\n            \n            lesson.level = level;\n\n            lesson.level = level;\n            lessonName = lesson.name;\n            levelName = lesson.level.name; // sometimes returns null (when at final level, looking for next?)\n            layouts = getLayouts(getCurrentLevelFromLessonPlan(lessonPlan, levelId + increment), config.mode);\n\n            increment++;\n\n            iterateOverLevelsCheckingForAvailableLayouts(increment, levelId);\n        }     \n        \n        iterateOverLevelsCheckingForAvailableLayouts(0, levelId);\n\n        return { lessonName, levelName, layouts };\n    }\n\n    let levelId = lesson.level.id;\n\n    if(lesson.isLevelComplete) {\n        levelId++;\n        lesson.level = lessonPlan.levels.find(level => level.id === levelId);\n    }\n\n    const { layouts } = goToNextLevelThatHasLayouts(lessonPlan, levelId);\n\n    return layouts;\n};","import { createNextRound } from 'snapdragon-engine/round-planner';\nimport { layouts } from 'snapdragon-config/screen-layouts';\nimport { getNextRoundLayouts } from 'snapdragon-engine/lesson-plan-handler';\n\nconst { summary, history } = layouts;\n\nconst createLessonPlan = async (lessonPlan, config, collection, lesson) => {\n\n    lesson.moduleSize = lesson.moduleSize || collection.moduleSize || config.moduleSize;\n    lesson.currentRound = lesson.currentRound || 1;\n\n    let rounds = collection.items.length / lesson.moduleSize;            \n        rounds = collection.items.length % lesson.moduleSize === 0 ? rounds : rounds === 1 ? 1 : Math.floor(rounds) + 1;\n\n    lesson = lesson.level === undefined \n            ? { ...lesson, ...lessonPlan, level: { id: 1 }, rounds } \n            : lesson;\n\n    const nextRoundLayoutTemplates = getNextRoundLayouts(lessonPlan, config, lesson);\n\n    if(lesson.level === undefined) {\n        return new Promise(resolve => resolve(null));\n    }\n\n    return await createNextRound(\n        lessonPlan,\n        nextRoundLayoutTemplates, \n        [ summary, history ],\n        collection,\n        lesson\n    );        \n};\n\nexport const lessonPlanner = {\n    createLessonPlan\n}","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { findRankByIconicTaxon } from 'api/snapdragon/iconic-taxa';\nimport { firestore } from 'api/firebase/firestore';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nexport const getPoolItems = async (collection, poolSize = 5) => {\n  \n  try {\n    \n    const item = collection.nextItem;\n\n    if(collection.behaviour === 'static') {\n      const otherItems = collection.items.filter(i => i.name !== item.name);\n      if(otherItems && otherItems.length > 0) {\n        return getItemsFromCollection(otherItems, item, poolSize);\n      }\n    }\n\n    const rank = findRankByIconicTaxon(item.taxonomy, item.iconicTaxon);\n\n    let taxonicMatches = await firestore.getSpeciesByIconicTaxon(item);\n\n    if(item.iconicTaxon.toLowerCase() === 'fungi') {\n        const isLichen = item.lichen;\n        taxonicMatches = isLichen ? taxonicMatches.filter(item => item.lichen) : taxonicMatches.filter(item => !item.lichen);\n    }\n\n    const speciesPool = utils.shuffleArray(taxonicMatches.filter(ci => ci.name.toLowerCase() !== item.name.toLowerCase()));\n\n    // temporary exceptions because there are so few (6 and 3) members of these taxa\n\n    const isException = item.iconicTaxon.toLowerCase() === 'reptilia' || item.iconicTaxon.toLowerCase() === 'amphibia';\n    \n    if(!speciesPool) {\n      getPoolItems(collection);\n    }\n\n    // if not enough, only get the additional necessary number (but duplicates???)\n\n    else if(speciesPool.length < poolSize && !isException) {\n      getPoolItems(collection);\n    } \n    else {\n\n      const items = R.take(poolSize, speciesPool);\n      \n      items.push(item);\n    \n      return await items;\n    }\n  } catch(e) {\n    logError('renderMixedSpecimenImagesAndQuestion init', e);\n  }\n};\n\n  const getItemsFromCollection = (otherItems, item, poolSize) => {\n    const items = R.take(poolSize, utils.shuffleArray(otherItems));\n    return utils.shuffleArray([ ...items, item]);\n  };","import * as R from 'ramda';\n\nimport { firestore } from 'api/firebase/firestore';\n\nconst getItemLayouts = async itemQuestions => {\n    if(!itemQuestions.questionIds) return new Promise(resolve => resolve(null));\n    return Promise.all(itemQuestions.questionIds.map(async id => await firestore.getQuestionById(id, itemQuestions.name)));\n};\n\nconst getLayouts = async (collection, roundItemNames) => {\n\n    if(collection.species) {\n    \n        const species = collection.species.filter(sp => R.contains(sp.name, roundItemNames));\n        const speciesQuestions = species.filter(sp => sp.questions);\n\n        if(speciesQuestions.length > 0) {\n            return Promise.all(speciesQuestions.map(sq => sq.questions));\n        }\n\n        const itemsQuestions = collection.items.filter(i => R.contains(i.name, roundItemNames)).map(i => { return { name: i.name, questionIds: i.questionIds }});\n        \n        if(itemsQuestions) {\n            const promises = itemsQuestions.map(async (itemQuestions) => {\n                if(itemQuestions.questionIds) return await getItemLayouts(itemQuestions);\n            });\n            return await Promise.all(promises);\n        } else {\n            return new Promise(resolve => resolve(null));\n        }\n    } else {\n        return [];\n    }\n}\n\nexport const providerHandler = {\n    getLayouts\n};","const getRoundItems = (currentRound, moduleSize, items) => {\n\n    const start = (currentRound - 1) * moduleSize;\n    const end = start + moduleSize;\n    return items.slice(start, end);\n}\n\nexport const roundHandler = {\n    getRoundItems\n};","import * as R from 'ramda';\n\nimport { DOM } from 'ui/dom';\nimport { utils } from 'utils/utils';\n\nimport { roundHandler } from \"snapdragon-engine/round-plan-handler\";\nimport { bonusHandler } from 'snapdragon-engine/bonus/bonus-test-handler';\nimport { providerHandler } from 'snapdragon-engine/provider/provider-test-handler';\nimport { mixedTraitHandler } from 'ui/screens/multichoice/landscape/mixed-trait/mixed-trait-handler';\n\nimport { layouts as L } from 'snapdragon-config/screen-layouts';\n\nexport const createNextRound = (lessonPlan, nextRoundLayoutTemplates, progressScreens, collection, lesson) => {\n\n    const init = async () => {\n    \n        lessonPlan.layouts = [];\n\n        const moduleSize = lesson.moduleSize;\n        const lessonName = lesson.name;\n        const levelName = lesson.level.name;\n        const itemsCountToDate = (lesson.currentRound - 1) * moduleSize;\n        const itemsLeft = collection.items.length - itemsCountToDate;\n\n        const layoutsToAdd = moduleSize > itemsLeft ? itemsLeft : moduleSize;\n        const roundItemNames = roundHandler.getRoundItems(lesson.currentRound, moduleSize, collection.items.map(i => i.name));\n\n        nextRoundLayoutTemplates.forEach( async (layout, index) => {\n            let itemIndex = 0;\n            do {\n                if(layout.name === 'mixed-trait-images') {\n                    \n                    const item = collection.items.find(i => i.name === roundItemNames[itemIndex]);\n\n                    const { requiredTraitValues, trait } = mixedTraitHandler.getMatchingTrait(utils.shuffleArray(layout.screens[1].traits), item.traits);\n\n                    if(!trait) return;\n\n                    const { traits, requiredTraits } = await mixedTraitHandler.fetchTraits(trait, requiredTraitValues, collection.glossary);\n\n                    if(!requiredTraits || !traits) return;\n\n                    layout.trait = trait;\n                    layout.traits = traits;\n                    layout.requiredTraits = requiredTraits;\n\n                    const traitsToIgnore = [ 'n/a', 'none' ];\n                    const addLayout = !!requiredTraits.find(t => !R.contains(t.term.toLowerCase(), traitsToIgnore));\n\n                    if(addLayout) {\n                        lessonPlan.layouts.push({...layout, lessonName, levelName, speciesName: roundItemNames[itemIndex] });\n                    }\n        \n                } else {\n                    lessonPlan.layouts.push({...layout, lessonName, levelName, speciesName: roundItemNames[itemIndex] });\n                }\n\n                itemIndex++;\n                \n            } while (itemIndex < layoutsToAdd);\n        });\n\n        if(lesson.level.id === 1) {\n            let providerQuestions = await providerHandler.getLayouts(collection, roundItemNames);\n                providerQuestions = R.flatten(providerQuestions).filter(layout => layout);\n\n            let providerLayouts = providerQuestions.map(provider => {\n                return { ...L.providerHorizontalStrip, lessonName:\"Lesson 1\", levelName:\"Level 1\", speciesName: provider.name || provider.taxon, provider };\n            });\n\n            if(providerLayouts) {\n                lessonPlan.layouts = [ ...lessonPlan.layouts, ...providerLayouts ];\n            }\n        }\n\n        const bonusLayouts = lessonPlan.layouts.filter(layout => layout.bonus);\n\n        let lessonLayouts = lessonPlan.layouts.filter(layout => !layout.bonus).map((layout, i) => {\n            layout.itemIndex = layout.itemIndex === undefined ? utils.calcItemIndex(itemsCountToDate, layoutsToAdd, i) : layout.itemIndex;\n            return { ...layout };\n        });\n\n        const itemIndices = [ ...new Set(lessonPlan.layouts.map(layout => layout.itemIndex).filter(i => i !== undefined)) ];\n        \n        lessonPlan.layouts = lessonLayouts;\n\n        if(lesson.level.id === 1) {\n\n            if(bonusLayouts) {\n                const bonusTests = await bonusHandler.getTests(collection, itemIndices, bonusLayouts, lessonName, levelName);\n                lessonPlan.layouts = [ ...lessonPlan.layouts, ...bonusTests ];\n            }\n        }\n\n        lessonLayouts = lessonPlan.layouts.map((layout, i) => {\n            layout.roundProgressIndex = i + 1;\n            return { ...layout };\n        });\n\n        const summaryLayout = lessonPlan.portrait \n            ? {\n                name: 'summary',\n                screens: [{ \n                    name: 'summary', \n                    domain: 'history', \n                    parent: DOM.rightBody\n                }],\n                lessonName,\n                levelName,\n                layoutIndex: lessonPlan.layouts.length,\n                itemIndex: 0\n            }\n            : {\n                name: 'summary',\n                screens: [...progressScreens],\n                lessonName,\n                levelName,\n                layoutIndex: lessonPlan.layouts.length,\n                itemIndex: 0\n            };\n\n        // lessonPlan.layouts.push(summaryLayout);\n\n        lessonPlan.layouts.push({\n            name: 'summary',\n            screens: [{ \n                name: 'summary', \n                domain: 'history', \n                parent: DOM.rightBody\n            }],\n            lessonName,\n            levelName,\n            layoutIndex: lessonPlan.layouts.length,\n            itemIndex: 0\n        });\n\n        const scores = lessonPlan.layouts.map(layout => layout.score || 0);\n        const roundScoreCount = scores.reduce((accumulator, currentValue) => accumulator + currentValue);\n\n        lessonPlan.layouts.map(layout => layout.roundScoreCount = roundScoreCount);\n\n        lesson.questionCount = lessonPlan.layouts.filter(layout => layout.type === 'test').length;\n        \n        lesson.layoutCount = lessonPlan.layouts.length;\n        lesson.layoutNames = lessonPlan.layouts.map(layout => layout.name);\n\n        return { updatedLessonPlan: lessonPlan, updatedCollection: collection, updatedLesson: lesson };\n    }\n\n    return init();\n};\n","// Module\nvar code = \"<div class=\\\"iconic-taxa-categories js-iconic-taxa-categories\\\">\\n    <div class=\\\"double-centred-block\\\" id=\\\"aves\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"birds\\\"><i class=\\\"fas fa-dove\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Birds</div></div>\\n    </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"amphibia\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"amphibians\\\"><i class=\\\"fas fa-frog\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Amphibians</div></div>\\n    </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"mammalia\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"mammals\\\"><i class=\\\"fas fa-paw\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Mammals</div></div>\\n    </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"insecta\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"insects\\\"><i class=\\\"fas fa-bug\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Insects</div></div>\\n    </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"fungi\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"fungi and lichens\\\"><svg-icon class=\\\"si-glyph-mushrooms\\\"><src href=\\\"./icons/si-glyph-mushrooms.svg\\\"/></svg></button>\\n        <div class=\\\"small-text\\\">Fungi & Lichens</div></div>\\n      </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"plantae\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"plants\\\"><i class=\\\"fas fa-leaf\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Plants</div></div>\\n    </div>    \\n    <div class=\\\"double-centred-block\\\" id=\\\"reptilia\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"reptiles\\\"><i class=\\\"far fa-registered\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div>Reptiles</div></div>\\n    </div>\\n    <div class=\\\"double-centred-block\\\" id=\\\"lepidoptera\\\"><div>\\n      <button class=\\\"snap-icon-btn\\\" aria-label=\\\"butterflies and moths\\\"><i class=\\\"fas fa-barcode\\\" aria-hidden=\\\"true\\\"></i></button>\\n      <div class=\\\"small-text\\\">Butterflies & Moths</div></div>\\n    </div>\\n</div>\\n<div class=\\\"hide-important guide-bottom-actions\\\">\\n    <span>Know what you want?</span>\\n    <span class=\\\"underline-link species-picker-link js-species-picker-link\\\">Species picker</span>\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { elem } from 'ui/helpers/class-behaviour';\nimport { iconicTaxa } from 'snapdragon-config/snapdragon-iconic-taxa';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport categoriesTemplate from 'ui/create-guide-modal/categories-template.html';\n\nexport const renderCategories = (modal, createGuide) => {\n\n    const config = createGuide.getConfig();\n          config.guide.iconicTaxa = config.guide.iconicTaxa || iconicTaxa.all;\n\n    const filterSelectedClass = 'iconic-taxa-selected';\n\n    const template = document.createElement('template');\n          template.innerHTML = categoriesTemplate;\n    \n    const parent = modal.querySelector('.js-actions');\n          parent.innerHTML = '';\n    \n    renderTemplate({}, template.content, parent);\n\n    const icons = parent.querySelectorAll('.js-iconic-taxa-categories > div > div:nth-child(1)');\n    \n    if(config.guide.iconicTaxa) {\n        icons.forEach(icon => {\n            const filterId = icon.parentElement.id;\n            if(R.contains(filterId, config.guide.iconicTaxa.map(taxon => taxon.id))) {\n                icon.classList.add(filterSelectedClass);\n            }\n        });\n    }\n\n    setTimeout(() => {\n        const fungiIcon = modal.querySelector('#fungi > div');\n        if(!fungiIcon) return;\n        if(elem.hasClass(fungiIcon, 'iconic-taxa-selected')) {\n            fungiIcon.querySelector('g g').classList.add('svg-icon-selected');\n        }   \n    },250);\n    \n    config.guide.hasChanged = false;\n\n    icons.forEach(category => {\n        category.addEventListener('click', event => {\n\n            config.guide.hasChanged = true;\n            \n            const filter = event.currentTarget;\n            const filterId = filter.parentElement.id;        \n            const commonName = filter.parentElement.innerText;              \n\n            if(config.guide.iconicTaxa.find(taxon => taxon.id === filterId)) {\n                \n                if(filterId === 'fungi') {\n                    filter.querySelector('g g').classList.remove('svg-icon-selected');                    \n                }\n                if(config.guide.iconicTaxa.length > 1) {\n                    filter.classList.remove(filterSelectedClass);\n                    config.guide.iconicTaxa = config.guide.iconicTaxa.filter(taxon => taxon.id !== filterId);\n                }\n\n            } else {\n\n                if(filterId === 'fungi') {\n                    filter.querySelector('g g').classList.add('svg-icon-selected');\n                }\n                filter.classList.add(filterSelectedClass);\n\n                config.guide.iconicTaxa.push(\n                    {\n                        id: filterId,\n                        common: commonName    \n                    }\n                )\n            }\n\n            createGuide.setConfig(config);\n            createGuide.saveStep('TAXA', config);            \n        });\n    });\n\n    createGuide.saveStep('TAXA');\n\n    document.querySelector('.js-right .js-arrow-wrapper').innerHTML = '<i class=\"far fa-arrow-alt-circle-right\"></i>';\n};","// Module\nvar code = \"<div class=\\\"{{ className }}\\\">\\n        <div class=\\\"actions js-actions\\\"></div>\\n        <div class=\\\"save-your-changes js-save-your-changes\\\"></div>\\n    </div>\\n<div class=\\\"chosen js-chosen\\\">\\n    <div class=\\\"prop-value-block\\\"><span></span><span class=\\\"selected-text\\\"></span></div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { returnTaxonIcon } from 'ui/helpers/icon-handler';\n\nexport const saveGuide = (config, step, update = true) => {\n\n    const chosen = document.querySelector('.js-chosen span:nth-child(2)');\n\n    const handleSaveEvent = () => {\n\n        switch(step) {\n\n            case 'SPECIES':\n\n            break;\n\n            case 'LOCATION':\n\n                const splitLocation = locationStr => {\n                    return locationStr;\n                };\n\n                if(config.guide.locationType) {\n                    chosen.innerHTML = config.guide.locationType === 'place'\n                        ? config.guide.locationPlace\n                        : config.isLandscapeMode\n                            ? config.guide.locationLongLat\n                            : splitLocation(config.guide.locationLongLat);\n                }\n                break;\n\n            case 'TAXA':\n\n                chosen.innerHTML = '';\n                let icons = '';\n                if(config.guide.iconicTaxa.length > 0) {\n                    config.guide.iconicTaxa.forEach(taxon => {\n                        const icon = returnTaxonIcon(taxon.id);\n                        icons += icon;\n                    })\n                    chosen.innerHTML = icons;\n                } else {\n                    chosen.innerHTML = 'All species';\n                }\n                break;\n\n            case 'INAT':\n                \n                if(config.guide.inatId.key) {\n                    chosen.innerHTML = config.guide.inatId.key || '';\n                } else {\n                    chosen.innerHTML = '';\n                }\n                break;\n        }\n    }\n\n    return handleSaveEvent;\n}","export const switchHandler = (idSwitch, startingPosition, callback) => {\n    \n    if(!idSwitch) return;\n    \n    const state = { position: startingPosition === 'left' ? 'right' : 'left' };\n\n    let switchControl = idSwitch.querySelector('div');\n    let leftText = idSwitch.parentElement.querySelector('.txt-left');\n    let rightText = idSwitch.parentElement.querySelector('.txt-right');\n\n    const switcher = () => {\n        \n        switch(state.position) { \n            case 'left':\n                switchControl.parentElement.classList.add('right');\n                switchControl.parentElement.classList.remove('left');\n                leftText.classList.remove('selected');\n                rightText.classList.add('selected');\n                state.position = 'right';\n                break;\n            case 'right':\n                switchControl.parentElement.classList.add('left');\n                switchControl.parentElement.classList.remove('right');\n                leftText.classList.add('selected');\n                rightText.classList.remove('selected');\n                state.position = 'left';\n                break;\n        }\n        callback(state.position);\n    }\n\n    switcher();\n\n    idSwitch.addEventListener('click', event => {\n        switcher();        \n    });\n};","import { actions } from 'redux/actions/action-creators';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderSpeciesSearchOptions } from 'ui/create-guide-modal/species-search-options';\nimport { renderLocation } from 'ui/create-guide-modal/location';\nimport { renderInatUser } from 'ui/create-guide-modal/inat-user';\nimport { renderCategories } from 'ui/create-guide-modal/categories';\nimport { renderSpeciesPicker } from 'ui/create-guide-modal/species-picker';\nimport { saveGuide } from 'ui/create-guide-modal/common/save-guide';\nimport { speciesSearch } from 'ui/create-guide-modal/species-search';\nimport { enums } from 'ui/helpers/enum-helper';\n\nimport actionsTemplate from 'ui/create-guide-modal/common/actions-template.html';\n\nclass CreateGuide {\n\n    constructor(step) {\n        \n        this.listeners = [];\n\n        this.steps = [\n            { number: 1, title: 'Species Picker', description: 'Provenance', nextStep: '', disabled: true, className:'species-actions',\n                nextSteps: [\n                    { id: enums.guideOption.LOCATION.name, step: 'Location' },\n                    { id: enums.guideOption.INAT.name, step: 'Location'},\n                    { id: enums.guideOption.PICKER.name, step: 'Picker'},\n                ] },\n            { number: 2, title: 'Species Picker', description: 'Location', nextStep: 'Taxa', prevStep: 'Provenance', disabled: true, className:'location-actions' },\n            { number: 2, title: 'Species Picker', description: 'Picker', nextStep: 'Species', prevStep: 'Provenance', disabled: true, className:'location-actions' },\n            { number: 3, title: 'Species Picker', description: 'Taxa', nextStep: 'Species', disabled: true, className:'taxa-actions' },\n            { number: 4, title: 'Species Picker', description: 'Species', nextStep: 'View Guide', disabled: true, className:'filter-actions' }\n        ];\n\n        this.currentStep = this.steps.find(s => s.number == step);\n        \n        this.modal = document.getElementById('createGuide');\n\n        if(!this.modal) return;\n\n        this.modalTitle = this.modal.querySelector('.js-modal-title header');\n        this.navigationContainer = this.modal.querySelector('.js-modal-guide-navigation');\n        this.progressSteps = this.modal.querySelectorAll('.js-modal-guide-progress > div > div');\n        \n        this.previousStepActionArrow = this.modal.querySelector('.js-left');\n        this.previousStepActionTxt = this.modal.querySelector('.js-left .title');\n        \n        this.optionsTxt = this.modal.querySelector('.js-centre .title');\n        \n        this.nextStepActionArrow = this.modal.querySelector('.js-right');\n        this.nextStepActionTxt = this.modal.querySelector('.js-right .title');\n\n        this.progressSteps.forEach((ps,index) => {\n            ps.innerHTML = this.steps[index].description;\n        });\n\n        this.config = this.config || store.getState().config;\n\n        this.getConfig = () => {\n            return this.config;\n        }\n    \n        this.setConfig = (config) => {\n            this.config = config;\n            actions.boundUpdateConfig(config);\n        }\n\n        this.getCurrentStep = () => {\n            return this.currentStep;\n        }\n\n        this.setCurrentStep = step => {\n            this.currentStep = this.steps.find(s => s.number === step);\n        }\n\n        this.user = store.getState().user;\n\n        // prevent user rescaling which is caused by autocomplete\n\n        // const viewport = document.querySelector(\"meta[name=viewport]\");\n        //       viewport.setAttribute('content', 'width=device-width, initial-scale=1, user-scalable=no');\n    }\n\n    addStepActions(nextStep) {\n        \n        if(!nextStep) return;\n        \n        const parent = this.modal.querySelector('.js-step-action-content');\n              parent.innerHTML = '';\n        const template = document.createElement('template');\n              template.innerHTML = actionsTemplate;\n        const description = this.steps.find(step => step.number === this.currentStep.number).description;\n\n        renderTemplate({ className: nextStep.className }, template.content, parent);\n\n        const options = this.modal.querySelector('.js-options > h1');\n\n        switch(description) {\n            case 'Provenance':\n                options.innerHTML = 'How do you want to select your species?';\n                renderSpeciesSearchOptions(this);\n                break;\n            case 'Location':                                \n                options.innerHTML = 'Filter species by location and season.'\n                switch(this.option) {\n                    case enums.guideOption.LOCATION.name:\n                        renderLocation(this.modal, this);\n                        break;\n                    case enums.guideOption.INAT.name:\n                        renderInatUser(this.modal, this);\n                        break;\n                    case enums.guideOption.PICKER.name:\n                        const chosenOnes = this.modal.querySelector('.js-chosen');\n                              chosenOnes.classList.add('hide-important');\n                        document.querySelector('.js-step-action-content .location-actions').classList.add('species-picker-actions');\n                        renderSpeciesPicker({\n                            container: this.modal,\n                            config: this.config,\n                            setConfig: this.setConfig\n                        }, this.modal.querySelector('.js-actions'));\n                        const title = this.modal.querySelector('.js-options > h1');\n                              title.innerHTML = 'Add species by name.';            \n                        break;\n                }\n                break;\n            case 'Taxa':\n                options.innerHTML = 'Filter species by taxa.'\n                renderCategories(this.modal, this);\n                break;\n            case 'Species':\n                setTimeout(() => {\n                    speciesSearch(this);\n                });\n                break;\n        }\n    }\n\n    goToNextStep(nextStep, direction, option = null, next = null) {\n\n        this.currentStep = next || this.steps.find(s => s.number === nextStep);\n\n        if(option === enums.guideOption.PICKER.name && direction === 'NEXT') {\n            this.currentStep = this.steps[2];\n        }\n\n        this.direction = direction;\n        this.option = option || this.option;\n\n        if(this.startLesson ) {\n            this.currentStep = { number: 0 };\n        };\n\n        if(!this.modalTitle) return;\n        \n        this.modalTitle.innerText = this.currentStep.title;\n        this.nextStepActionTxt.innerHTML = this.currentStep.nextStep;\n\n        this.progressSteps.forEach((ps,index) => {\n\n            ps.classList.remove('active');\n\n            if(index + 1 === this.currentStep.number) {\n                ps.classList.add('active');\n                for(let i = 0; i < index; i++) {\n                    this.progressSteps[i].classList.add('completed');\n                }\n            }\n        });\n        \n        this.addStepActions(this.steps.find(step => step.number === this.currentStep.number));\n\n        if(this.currentStep.number === 1) {\n            this.navigationContainer.classList.remove('progress-container');\n            this.optionsTxt.classList.remove('hide-important');\n            this.previousStepActionTxt.classList.add('hide-important');\n            this.previousStepActionArrow.classList.add('arrow-wrapper-hidden');\n            this.nextStepActionArrow.classList.add('arrow-wrapper-hidden');            \n        } else {\n            this.navigationContainer.classList.add('progress-container');\n            this.optionsTxt.classList.add('hide-important');\n            this.previousStepActionArrow.classList.remove('arrow-wrapper-hidden');\n            this.nextStepActionArrow.classList.remove('arrow-wrapper-hidden');\n            this.nextStepActionArrow.dataset.number = this.currentStep.number;\n            this.previousStepActionTxt.classList.remove('hide-important');\n            const previousStepProperties = this.currentStep.prevStep\n                                                ? this.steps.find(s => s.description === this.currentStep.prevStep)\n                                                : this.steps.find(s => s.number === (this.currentStep.number - 1));\n            \n\n            if(this.getCurrentStep().number === 4) {\n                this.previousStepActionTxt.innerHTML = this.option === enums.guideOption.PICKER.name \n                    ? this.steps[2].description\n                    : this.steps[3].description;\n            } else {\n                this.previousStepActionTxt.innerHTML = previousStepProperties.description;\n            }\n        }\n    }\n\n    saveStep(stepDescription, config) {\n        saveGuide(config || this.getConfig(), stepDescription)();\n    }\n};\n\nexport const createGuideHandler = step => {\n\n    const guide = new CreateGuide(step);\n    \n    guide.goToNextStep(step, 'NEXT');\n\n    const handleNextStepAction = event => {\n        guide.startLesson = parseInt(guide.nextStepActionArrow.dataset.number) === 4;\n        if(guide.startLesson) { \n            guide.nextStepActionArrow.setAttribute('data-dismiss','modal');\n        } else {\n            guide.nextStepActionArrow.removeAttribute('data-dismiss');\n        }\n        const step = guide.steps.find(step => step.description === guide.getCurrentStep().nextStep);\n        if(step) guide.goToNextStep(step.number, 'NEXT');\n        guide.listeners.push( { element: guide.nextStepActionArrow, handler: handleNextStepAction });\n    };\n\n    guide.nextStepActionArrow.addEventListener('click', handleNextStepAction, true);\n\n    const handlePreviousStepAction = event => {\n\n        let prevStep;\n        \n        if(guide.getCurrentStep() && guide.getCurrentStep().number === 4) {\n            prevStep = guide.option === enums.guideOption.PICKER.name ? 2 : 3;\n        } else {\n            prevStep = guide.getCurrentStep().number - 1;\n        }\n        \n        guide.goToNextStep(prevStep, 'PREVIOUS', guide.option);\n        guide.listeners.push( { element: guide.previousStepActionArrow, handler: handlePreviousStepAction });\n    };\n\n    guide.previousStepActionArrow.addEventListener('click', handlePreviousStepAction, true);\n\n    guide.callOnCreateCustomListeners = collection => {\n        onCloseModalListeners.forEach(listener => listener(collection));\n        onCloseModalListeners.pop();\n    };\n};\n\nconst onCloseModalListeners = [];\n\nexport const onCreateCustomLesson = listener => { \n    onCloseModalListeners.pop();\n    onCloseModalListeners.push(listener);\n};","// Module\nvar code = \"<div>\\n    <div class=\\\"inat snap-switch running-block\\\">\\n        <div class=\\\"embedded-switch\\\">\\n            <div class=\\\"txt-left\\\"><span>iNaturalist User</span></div>\\n            <div class=\\\"snap-switch-slider left js-snap-switch-slider\\\">\\n                <div></div>\\n            </div>\\n            <div class=\\\"txt-right\\\"><span>Project</span></div>        \\n        </div>\\n    </div>\\n\\n    <div class=\\\"location-option inat-entry\\\">\\n        <div class=\\\"input-container standard-block bottom-aligned\\\">\\n            <form id=\\\"inatForm\\\" action=\\\"#\\\">\\n                <input id=\\\"inat-identity\\\" type=\\\"text\\\" placeholder=\\\"Start typing a user or project Id.\\\">\\n            </form>\\n        </div>\\n    </div>\\n\\n    <div class=\\\"location-option chosen-guide-filter js-chosen-inat standard-block\\\">\\n        <div>Learn more about <a href=\\\"https://www.inaturalist.org/\\\" target=\\\"_blank\\\" class=\\\"underline-link\\\">iNaturalist</a>.</div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { switchHandler } from 'ui/create-guide-modal/common/snapdragon-switch';\nimport { inatAutocomplete } from 'ui/helpers/inat-autocomplete';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport inatTemplate from 'ui/create-guide-modal/inat-user-template.html';\n\nexport const renderInatUser = (modal, createGuide) => {\n\n    const config = createGuide.getConfig();\n\n    const template = document.createElement('template');\n\n    template.innerHTML = inatTemplate;\n\n    if(config.guide.inatId.key !== '-----') {\n        if(config.guide.locationType !== 'inat') {\n            config.guide.locationType = 'inat';\n            createGuide.setConfig(config);\n        }\n        createGuide.saveStep('INAT');\n    }\n\n    const parent = modal.querySelector('.js-actions');\n          parent.innerHTML = '';\n    \n    renderTemplate({ }, template.content, parent);\n\n    document.querySelector('.js-chosen > div > span:nth-child(2)').innerHTML += '<div class=\"delete-guide-link js-toggle-filter\"><input class=\"hide\" type=\"checkbox\"></div>';\n\n    let autocompleteRef;\n\n    const position = config.guide.inatId.param === 'user_id' ? 'left' : 'right';\n\n    let byType = 'users';\n\n    const inatIdentityInput = parent.querySelector('#inat-identity');\n          inatIdentityInput.focus();\n\n    const handlerInatIdentityInput = e => {\n        inatIdentityInput.removeEventListener('keypress', handlerInatIdentityInput);\n        autocompleteRef = inatAutocomplete(inatIdentityInput, byType, 'inat-autocomplete-options-container', '');\n    }\n\n    inatIdentityInput.addEventListener('keypress', handlerInatIdentityInput);\n\n    inatIdentityInput.addEventListener('click', e => {\n        e.preventDefault();\n    });\n\n    inatIdentityInput.addEventListener('keyup', e => {\n        e.preventDefault('e.keyCode: ', e.keyCode);\n    });\n\n    document.getElementById('inatForm').addEventListener('submit', e => {\n        e.preventDefault();\n        if(inatIdentityInput.value !== '') {\n            saveInatId(parent, config, createGuide, autocompleteRef);\n        }\n    });\n\n    if(config.isPortraitMode) {\n        inatIdentityInput.addEventListener('focusout', e => {\n            const container = document.querySelector('.inat-autocomplete-options-container');\n                if(container) {\n                    setTimeout(() => {\n                        saveInatId(parent, config, createGuide, autocompleteRef);\n                    });\n                    e.preventDefault();\n                }\n        });\n    }\n\n    const idSwitch = parent.querySelector('.snap-switch-slider');\n\n    const switchCallback = position => {\n        \n        byType = position === 'left' ? 'users' : 'projects';\n\n        const type = position === 'left' ? 'iNat user ID' : 'iNat project ID';\n        const param = position === 'left' ? 'user_id' : 'project_id';\n\n        config.guide.inatId.type = type;\n        config.guide.inatId.param = param;\n\n        createGuide.setConfig(config);\n    };\n\n    switchHandler(idSwitch, position, switchCallback);\n};\n\nconst saveInatId = (parent, config, createGuide, autocompleteRef) => {\n    const input = parent.querySelector('#inat-identity');\n    if (config.isLandsapeMode) {\n        input.value = '';\n        input.focus();\n    }\n    const key = input.value;\n    const id = input.name;\n    config.guide.inatId.key = key;\n    config.guide.inatId.id = id;\n    if (key !== '') {\n        config.guide.locationType = 'inat';\n        createGuide.setConfig(config);\n        createGuide.saveStep('INAT');\n        parent.querySelector('#inat-identity').value = '';\n        if (autocompleteRef) {\n            // autocompleteRef.destroy();\n        }\n    }\n}\n","// Module\nvar code = \"<div class=\\\"border-bottom\\\">\\n    <div class=\\\"running-block vertical-centred-block location-option html5-location\\\">\\n        <div class=\\\"html5-location-place\\\"><button class=\\\"btn snap-action-btn js-set-location-btn\\\"></button><span class=\\\"landscape\\\"></span></div>\\n    </div>\\n    <div class=\\\"standard-block location-option place bottom-aligned\\\">\\n        <form id=\\\"locationForm\\\" action=\\\"#\\\">\\n          <div class=\\\"standard-block\\\">\\n            <label for=\\\"#inat-place\\\" class=\\\"extra-small-text\\\">Location</label>\\n            <input id=\\\"inat-place\\\" type=\\\"text\\\" placeholder=\\\"Or start typing the name of a place.\\\">\\n            <input class=\\\"hide\\\" type=\\\"submit\\\" value=\\\"\\\">\\n          </div>\\n        </form>\\n    </div>\\n    <div class=\\\"location-option margin-top range\\\">\\n        <div class=\\\"range-slider\\\">\\n            <div class=\\\"js-range\\\"></div>\\n            <div>\\n              <span class=\\\"range-limits\\\">0km</span>\\n              <span class=\\\"margin-right\\\" style=\\\"width: 100%;\\\"><input class=\\\"set-range-input js-set-range-input\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"250\\\" value=\\\"10\\\"></span>\\n              <span class=\\\"range-limits\\\"> 250km</span>\\n              <span class=\\\"saved js-range-saved\\\"></span>\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n\\n<div class=\\\"location-filter-options\\\">            \\n    <div>\\n      <div class=\\\"black-text\\\">Species by season</div>\\n      <div class=\\\"season snap-switch margin-top margin-bottom\\\">\\n          <div class=\\\"embedded-switch\\\">\\n              <div class=\\\"txt-left\\\"><span>{{ observableMonths }}</span></div>\\n              <div class=\\\"snap-switch-slider left js-snap-switch-slider\\\">\\n                  <div></div>\\n              </div>\\n              <div class=\\\"txt-right\\\"><span>All Year</span></div>\\n          </div>\\n      </div>  \\n    </div>\\n    <div>\\n      <div class=\\\"black-text\\\">Species by observation count</div>\\n      <div class=\\\"margin-top margin-bottom\\\">\\n        <span>\\n          Top <input min=\\\"1\\\" max=\\\"500\\\" required class=\\\"medium half-margin-right js-location-no-of-records\\\" type=\\\"number\\\" value=\\\"{{ noOfRecords }}\\\"> most observed.\\n        </span>\\n      </div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { renderTemplate } from 'ui/helpers/templating';\nimport { getPlace, GooglePlaceDetails } from 'geo/geo';\nimport { inatAutocomplete } from 'ui/helpers/inat-autocomplete';\nimport { switchHandler } from 'ui/create-guide-modal/common/snapdragon-switch';\n\nimport locationTemplate from 'ui/create-guide-modal/location-template.html';\nimport googleLogoImg from 'img/powered_by_google_on_white_hdpi.png';\n\nexport const renderLocation = (modal, createGuide) => {\n\n    const config = createGuide.getConfig();\n\n    createGuide.saveStep('LOCATION');\n\n    let locationPlace = config.guide.locationPlace;\n    let autocompleteRef;\n\n    const template = document.createElement('template');\n          template.innerHTML = locationTemplate;\n    const parent = modal.querySelector('.js-actions');\n          parent.innerHTML = '';\n\n    config.guide.season.observableMonths = config.guide.season.observableMonths || config.season.observableMonths;\n\n    if(config.guide.season.observableMonths) {\n\n        const months = config.guide.season.observableMonths.map(month => month.name);\n        const observableMonths = `${months[0]}-${months[months.length - 1]}`;\n        const defaultNoOfRecords = config.guide.noOfRecords;\n\n        renderTemplate({ observableMonths, noOfRecords: defaultNoOfRecords }, template.content, parent);\n    }\n\n    const defaultLocationTxt = 'Use your current location';\n\n    const setLocationLongLatBtn = modal.querySelector('.js-set-location-btn');\n          setLocationLongLatBtn.innerHTML = defaultLocationTxt;\n\n    async function handleSetLocationLongLat(event) {\n\n        event.stopPropagation();\n        setLocationLongLatBtn.innerHTML = 'Updating location'\n        const place = await getPlace(config, true);\n        config.guide.locationType = 'longLat';\n        config.place = place;\n        config.guide.locationLongLat = place.longLocation;\n        setLocationLongLatBtn.innerHTML = defaultLocationTxt;\n        \n        createGuide.setConfig(config);\n        createGuide.saveStep('LOCATION');\n    }\n\n    setLocationLongLatBtn.addEventListener('click', handleSetLocationLongLat);\n\n    const locationPlaceInput = modal.querySelector('#inat-place');\n          locationPlaceInput.placeholder = config.isLandscapeMode\n                                            ? 'Or start typing the name of a place you are interested in.'\n                                            : 'Or start typing the name of a place.';\n          locationPlaceInput.focus();\n\n    // let counter = 0;\n\n    const handleLocationPlaceInput =  e => {\n        locationPlaceInput.removeEventListener('keypress', handleLocationPlaceInput);\n        // counter++;        \n        autocompleteRef = inatAutocomplete(locationPlaceInput, 'places', 'autocomplete-options-container', 'place');\n        // saveLocationBtn.disabled = false;        \n        // setTimeout(() => {\n        //     const googleImageContainer = modal.querySelector('#inat-place-autocomplete #googleLogoContainer');\n        //     if(!googleImageContainer && counter >= 3) {\n        //         const options = modal.querySelector('#inat-place-autocomplete');\n        //         if(options) options.innerHTML += `<div id=\"googleLogoContainer\"><img id=\"googleLogo\" src=\"${googleLogoImg}\" alt=\"\"></div>`;\n        //     }            \n        // },750);  \n    }\n\n    locationPlaceInput.addEventListener('keypress', handleLocationPlaceInput);\n\n    locationPlaceInput.addEventListener('click', e => {\n        e.preventDefault();\n    });\n\n    locationPlaceInput.addEventListener('keyup', e => {\n        e.preventDefault('e.keyCode: ', e.keyCode);\n    });\n\n    document.getElementById('locationForm').addEventListener('submit', e => {\n        e.preventDefault();\n        if(locationPlaceInput.value !== '') {\n            saveLocation(config, locationPlaceInput, locationPlace, createGuide);\n        }\n    });\n\n    if(config.isPortraitMode) {\n        locationPlaceInput.addEventListener('focusout', e => {\n            const container = document.querySelector('.autocomplete-options-container');\n                if(container) {\n                    setTimeout(() => {\n                        saveLocation(config, locationPlaceInput, locationPlace, createGuide);                   \n                    });\n                    e.preventDefault();\n                }\n        });\n    }\n\n    let range = config.guide.speciesRange;\n    const rangeTxt = modal.querySelector('.js-range');\n          rangeTxt.innerHTML = `Include species within ${range}km.`;\n\n    modal.querySelector('.js-set-range-input').value = range;\n\n    const slider = modal.querySelector('.js-set-range-input');\n    \n    const updateSlider  = event => {\n        range = event.target.value;\n        config.guide.speciesRange = range;\n        rangeTxt.innerHTML = `Include species within ${range}km.`;\n\n        createGuide.setConfig(config);\n    };\n    \n    slider.addEventListener('change', updateSlider);\n\n    createGuide.nextStepActionArrow.addEventListener('click', event => {\n        if(autocompleteRef)\n            autocompleteRef.destroy();\n    });\n\n    const idSwitch = parent.querySelector('.js-snap-switch-slider');\n\n    const switchCallback = position => {\n\n        const config = createGuide.getConfig();\n\n        const currentType = config.guide.season.type;\n\n        if(position === 'right') {\n            config.guide.season.type = 'all_year';\n        } else {\n            config.guide.season.type = 'months';\n        }\n\n        createGuide.setConfig(config);\n        \n        if(config.guide.season.type !== currentType) {\n            createGuide.saveStep('SEASON');\n        }        \n    };\n\n    const position = config.guide.season.type === 'months' ? 'left' : 'right';\n\n    switchHandler(idSwitch, position, switchCallback);\n\n    const noOfRecords = document.querySelector('.js-location-no-of-records');\n          noOfRecords.addEventListener('change', e => {\n            const config = createGuide.getConfig();\n                  config.guide.noOfRecords = parseInt(noOfRecords.value);\n            createGuide.setConfig(config);\n          });\n}\n\nconst saveLocation = (config, locationPlaceInput, locationPlace, createGuide) => {\n\n    let selectedText = locationPlaceInput.value;\n    let selectedId = locationPlaceInput.name;\n\n    config.guide.locationType = 'longLat';\n    config.guide.place.name = selectedText;\n    config.guide.locationLongLat = selectedText;\n\n    config.guide.locationType = 'longLat';\n    config.guide.locationLongLat = selectedText;\n\n    const callback = geocoderResult => {\n        if(geocoderResult && geocoderResult.length > 0) {\n            const lat = geocoderResult[0].geometry.location.lat();\n            const long = geocoderResult[0].geometry.location.lng();\n            config.guide.coordinates = { lat, long };\n            \n            locationPlaceInput.value = '';\n            \n            createGuide.setConfig(config);\n            createGuide.saveStep('LOCATION');\n        }\n    };\n    GooglePlaceDetails(selectedId, callback);\n\n    return locationPlace;\n}\n","// Module\nvar code = \"<menu>\\n  <ul class=\\\"custom-lesson-menu-options\\\" data-repeat-option=\\\"{{ options }}\\\">\\n    <li data-option=\\\"{{ option.id }}\\\">\\n        <button class=\\\"icon snap-icon-btn arrow-wrapper\\\"><span class=\\\"small-text\\\">{{ option.text }}</span><i class=\\\"far fa-arrow-alt-circle-right\\\"></i></button>\\n    </li>\\n  </ul>\\n</menu>\\n\\n<hr class=\\\"double-margin-top double-margin-bottom\\\">\\n\\n<div class=\\\"js-language-selection-container\\\"></div>\\n\\n<h3 class=\\\"standard-block centred-block js-persistence-warning\\\">\\n    <span><i class=\\\"fas fa-exclamation\\\"></i> You are not currently logged in. Your collection will not be availble outside this browser.</span>\\n</h3>\";\n// Exports\nmodule.exports = code;","import { renderTemplate } from 'ui/helpers/templating';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { languagePicker } from 'ui/screens/common/language-selection';\n\nimport speciesTemplate from 'ui/create-guide-modal/species-search-options-template.html';\n\nexport const renderSpeciesSearchOptions = createGuide => {\n\n    const header = createGuide.modal.querySelector('.js-modal-title > header');\n          header.innerHTML = 'Create your own lesson';\n\n    const options = [\n        {\n            text: 'By location and season',\n            id: enums.guideOption.LOCATION.name\n        },\n        {\n            text: 'From iNaturalist observations',\n            id: enums.guideOption.INAT.name\n        },\n        {\n            text: 'Using a name-based search',\n            id: enums.guideOption.PICKER.name\n        }\n    ];\n\n    const template = document.createElement('template');\n          template.innerHTML = speciesTemplate;\n    const parent = createGuide.modal.querySelector('.js-actions');\n          parent.innerHTML = '';\n\n    const config = createGuide.getConfig();\n\n    renderTemplate({ options }, template.content, parent);\n\n    const handleNextStepAction = event => {\n\n        const option = event.currentTarget.dataset.option;\n        const step = createGuide.steps.find(s => s.number === createGuide.getCurrentStep().number);\n        const nextStepName = step.nextSteps.find(step => step.id === option).step;\n        const nextStep = createGuide.steps.find(s => s.description === nextStepName);\n\n        createGuide.startLesson = false;        \n        createGuide.goToNextStep(createGuide.getCurrentStep().number + 1, 'NEXT', option, nextStep);\n        createGuide.listeners = [];\n        createGuide.listeners.push( { element: createGuide.nextStepActionArrow, handler: handleNextStepAction });\n    };\n\n    const lessonOptions = document.querySelectorAll('.custom-lesson-menu-options li');\n    \n    lessonOptions.forEach((option, index) => {\n        option.addEventListener('click', handleNextStepAction, true);\n    });\n\n    languagePicker(config, document.querySelector('.js-language-selection-container'), (config) => {\n        createGuide.setConfig(config);\n    });\n\n    const warning = createGuide.modal.querySelector('.js-persistence-warning');\n            \n    if(createGuide.user) {\n        warning.classList.add('hide-important');\n    }\n};","// Module\nvar code = \"<div>\\n    <div class=\\\"species-search js-species-search\\\">\\n        <div><div class=\\\"icon\\\"><i class=\\\"fas fa-sun slow-spin\\\"></i></div></div>\\n        <h2 class=\\\"standard-block\\\">This search is based on observations recorded by the public on <a class=\\\"underline-link\\\" target=\\\"_blank\\\" href=\\\"https://www.inaturalist.org/\\\">iNaturalist</a>.</h2>\\n    </div>\\n    <div>\\n        <div class=\\\"hide-empty request-feedback js-request-feedback\\\">Contacting iNaturalist</div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { listenToInatRequests } from 'api/inat/inat';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { lessonStateHandler } from 'ui/screens/lists/lesson-state-handler';\nimport { lessonStateHelper } from 'ui/screens/lists/lesson-state-helper';\nimport { speciesInGuideEditor } from 'ui/create-guide-modal/species-in-guide-editor';\nimport { snapLog, logError, logAPIError } from 'ui/helpers/logging-handler';\n\nimport spinnerTemplate from 'ui/create-guide-modal/species-search-template.html';\nimport speciesSummaryTemplate from 'ui/create-guide-modal/species-summary-template.html';\n\nexport const speciesSearch = createGuide => {\n\n    const { config, modal, option } = createGuide;\n    const { collections } = store.getState();\n\n    const template = document.createElement('template');\n          template.innerHTML = spinnerTemplate;\n\n    const parent = modal.querySelector('.js-step-action-content');\n\n    renderTemplate({ }, template.content, parent);\n\n    const feedback = document.querySelector('.js-request-feedback');\n\n    let count = 0;\n\n    const interval = setInterval(() => {\n      count = count === config.guide.iconicTaxa.length ? 0 : count;\n      feedback.innerHTML = `Fetching ${config.guide.iconicTaxa[count].common} from iNaturalist `;\n      count++;\n    }, 2000);\n\n    const nextStepActionArrow = modal.querySelector('.js-right');\n    const viewGuideIcon = nextStepActionArrow.querySelector('i');\n          viewGuideIcon.classList.add('snap-inactive');\n\n    const back = modal.querySelector('.js-left .js-arrow-wrapper');\n    const viewTaxaIcon = back.querySelector('i');\n          viewTaxaIcon.classList.add('snap-inactive');\n\n    const renderLessonSummary = collection => {\n\n      try {\n\n        if(collection && collection.items && collection.items.length === 0) {\n            feedback.innerHTML = 'No species were found. Try widening your parameters.';\n            return;\n        }\n\n        clearTimeout(interval);\n\n        template.innerHTML = speciesSummaryTemplate;\n\n        feedback.innerHTML = '';\n\n        collection.taxa = collection.guide.iconicTaxa.map(taxon => taxon.common).join(', ');\n        \n        renderTemplate({ collection }, template.content, feedback);\n\n        const icon = modal.querySelector('.icon i');\n              icon.classList.remove('slow-spin');\n\n        setTimeout(() => {\n          nextStepActionArrow.addEventListener('click', e => {\n                setTimeout( async () => {\n\n                    if(config.guide.species) {\n\n                        collection.items = collection.items.filter(item => {\n                            return R.contains(item.name, config.guide.species.map(sp => sp.name));\n                        });\n    \n                        await lessonStateHandler.changeRequest({\n                            requestType: enums.lessonState.ADD_SPECIES_TO_COLLECTION,\n                            requestArgs: {\n                                updatedConfig: config, updatedCollection: collection\n                            }\n                        });\n                    }\n\n                    if(parseInt(nextStepActionArrow.dataset.number) === 4) {\n                        createGuide.callOnCreateCustomListeners(collection);\n                        lessonStateHelper.clearGuide();\n                    }\n                });\n            });   \n        });\n\n        title.innerHTML = 'New collection species';\n\n        const editSpecies = modal.querySelector('.js-edit-species');\n              editSpecies.addEventListener('click', e => {\n                const selectedSpeciesDisplay = modal.querySelector('.js-selected-species-container');\n                      selectedSpeciesDisplay.classList.add('open');\n                      selectedSpeciesDisplay.classList.remove('hide-important');\n                      selectedSpeciesDisplay.innerHTML = '';\n                      editSpecies.classList.add('hide-important');\n                      \n                speciesInGuideEditor(config, modal, selectedSpeciesDisplay, createGuide, collection.items);\n\n                // const collectionName = modal.querySelector('#js-collection-name');\n                //       collectionName.classList.add('hide-important');\n\n                const editableCollectionName = modal.querySelector('#js-input-collection-name');\n                      editableCollectionName.classList.remove('hide-important');\n                      editableCollectionName.addEventListener('focusout', e => {      \n                          const name = e.target.value;                    \n                          // collectionName.innerHTML = name;\n                          // collectionName.classList.remove('hide-important');\n                          // editableCollectionName.classList.add('hide-important');\n                          config.guide.name = name;\n                          collection.name =  name;\n                          lessonStateHandler.changeRequest( { requestType: enums.lessonState.UPDATE_COLLECTION, requestArgs: { collection, config } });\n                          \n                      });\n              });\n\n        viewGuideIcon.classList.remove('snap-inactive');\n        viewTaxaIcon.classList.remove('snap-inactive');\n\n        } catch(e) {\n          logError(renderLessonSummary, e);\n        }\n    };\n\n    const initLesson = async collectionToLoad => {\n        \n        const counter = { \n            index: 0,\n            isLessonPaused: true\n        }\n        \n        const lesson = await lessonStateHandler.changeRequest({\n            requestType: enums.lessonState.GET_LESSON_PROGRESS,\n            requestArgs: {\n                collectionToLoad,\n                updatedCounter: counter,\n                guide: createGuide.getConfig().guide\n            }\n        });\n        \n        const collection = lesson.collection;\n              collection.guide = config.guide;\n              collection.isPrivate = true;\n        \n        renderLessonSummary(collection);\n\n        const OrdinalSuffixOf = i => {\n        var j = i % 10,\n            k = i % 100;\n        if (j == 1 && k != 11) {\n            return i + \"st\";\n        }\n        if (j == 2 && k != 12) {\n            return i + \"nd\";\n        }\n        if (j == 3 && k != 13) {\n            return i + \"rd\";\n        }\n        return i + \"th\";\n        }\n\n        let unsubscribe;\n\n        const callback = request => {\n            if(feedback) {\n                feedback.innerHTML = `Making ${OrdinalSuffixOf(request.page)} request of ${request.numberOfRequests}`;\n            } else {\n                unsubscribe(callback);\n            }\n        };\n\n        unsubscribe = listenToInatRequests(callback);\n    };\n    \n    config.guide.guideType = option;\n\n    switch(option) {\n\n        case enums.guideOption.LOCATION.name:\n            initLesson({ \n                ...collections.find(c => c.guideType === option),                \n                name: config.guide.place.name,\n                taxa: config.guide.iconicTaxa.map(i => i.common).join(', '),\n                guide: config.guide,\n                language: config.language,\n                id: collections.length + 100010, // hack to avoid clashes with existing lessons\n            });\n            break;\n\n        case enums.guideOption.INAT.name:\n            initLesson({\n                ...collections.find(c => c.guideType === option),  \n                name: `${config.guide.inatId.key}'s observations`,\n                taxa: config.guide.iconicTaxa.map(i => i.common).join(', '),\n                iconicTaxa: config.guide.iconicTaxa,\n                id: collections.length + 10000,\n            });        \n            break;\n\n        case enums.guideOption.PICKER.name:\n\n            const initPicker = async () => {\n\n                const { collection } = store.getState();\n\n                let addingExtraSpecies = false;\n                \n                if(collection.items) {\n                    addingExtraSpecies = collection.items.map(i => i.name).every(val => config.guide.species.map(s => s.name).includes(val));\n                }\n    \n                let collectionToLoad;\n    \n                if(addingExtraSpecies) {\n                    collectionToLoad = collection;\n                    await lessonStateHandler.changeRequest({\n                        requestType: enums.lessonState.ADD_SPECIES_TO_COLLECTION,\n                        requestArgs: {\n                            updatedConfig: config, updatedCollection: collectionToLoad\n                        }\n                    });\n                } else {\n                    collectionToLoad = {\n                        ...collections.find(c => c.guideType === option),\n                        species: config.guide.species,\n                        id: collections.length + 10010,\n                        name: 'Your new lesson',\n                        hasVideo: false,\n                        video: {},\n                        terms: []\n                    };\n                }\n\n                initLesson(collectionToLoad);\n            };\n\n            initPicker();\n\n            break;\n    }\n\n   const title = modal.querySelector('.js-options > h1');\n         title.innerHTML = 'Requesting species images and traits';\n};","// Module\nvar code = \"<div class=\\\"lesson-list-item one-and-half-standard-block vertical-evenly-spaced-block\\\">\\n    <!-- <div class=\\\"lesson-name\\\" id=\\\"js-collection-name\\\">\\n        <span>{{ collection.name }}</span>\\n    </div> -->\\n    <div class=\\\"lesson-name hide-important\\\" id=\\\"js-input-collection-name\\\">\\n      <label for=\\\"#new-collection-name\\\" class=\\\"extra-small-text\\\">lesson name</label>\\n      <input id=\\\"new-collection-name\\\" type=\\\"text\\\" value=\\\"{{ collection.name }}\\\">\\n    </div>\\n    <div class=\\\"lesson-taxa\\\"><span class=\\\"js-lesson-taxa-count\\\">{{ collection.items.length }}</span> <span class=\\\"js-lesson-taxa\\\">{{ collection.taxa }}</span></div>\\n</div>\\n<div class=\\\"edit-species centred-block half-standard-block js-edit-species\\\">\\n    <button class=\\\"snap-btn fit-width\\\">Edit lesson</button>\\n</div>\\n\\n<div class=\\\"selected-species-container\\\">\\n    <div class=\\\"scrollable js-selected-species-container\\\"></div>\\n</div>\";\n// Exports\nmodule.exports = code;","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon-media.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon-media.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon-media.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./snapdragon.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./species-list.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/dist/cjs.js!./species-list.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./species-list.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","// Module\nvar code = \"<div class=\\\"snapdragon-container\\\">\\n    <dl data-repeat-item=\\\"{{ glossary }}\\\" class=\\\"definition card scrollable\\\">\\n      <dt>{{ item.term }}</dt><dd>{{ item.definition }}</dd>\\n    </dl>\\n</div>\\n    \";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\n\nexport const renderHeaders = collection => {\n\n    DOM.leftHeaderTxt.innerHTML = 'Learn the planet';\n    DOM.rightHeaderTxt.innerHTML = 'Learn the planet';\n\n    setTimeout(() => {\n        \n        const { layout, lessonPlan } = store.getState();\n        const progressBar = document.querySelector('.js-right-grid progress');\n\n        if(lessonPlan) {\n\n            const questionCount = lessonPlan.layouts.filter(layout => layout.type === 'test').length;\n        \n            progressBar.max = questionCount;\n            progressBar.value = layout.roundProgressIndex || progressBar.value;\n        }\n    });\n\n    // return;\n    \n    // let lessonPlan, config, counter, layout;\n\n    // setTimeout(() => {\n    //     lessonPlan = store.getState().lessonPlan;\n    //     config = store.getState().config;\n    //     counter = store.getState().counter;\n    //     collection = store.getState().collection;\n    //     layout = store.getState().layout;\n    //     render();\n    // });\n    \n    // let PORTRAIT = false, LANDSCAPE = false, LANDSCAPE_HOME = false, COLLECTION = false, SPECIES_LIST = false;\n    // let leftHeaderText = '', rightHeaderText = '';\n\n    // const render = () => {\n\n    //     layout = layout ? layout : (lessonPlan && lessonPlan.layouts) ? lessonPlan.layouts[counter.index] : null;\n\n    //     const title = `learn the planet`;\n    \n    //     leftHeaderText = title; \n    //     rightHeaderText = config.isLandscapeMode ? 'Save the planet' : title;\n        \n    //     PORTRAIT = config.isPortraitMode;\n    //     LANDSCAPE = config.isLandscapeMode;\n    \n    //     if(collection.name) {        \n    //         COLLECTION = !!collection;\n    //         if(COLLECTION) collection.name ? leftHeaderText = collection.name : title;\n    //         if(SPECIES_LIST && PORTRAIT) rightHeaderText = collection.name;\n    //         if(LANDSCAPE_HOME) {\n    //             leftHeaderText = collection.name;\n    //             rightHeaderText = title;\n    //         }\n    //     }\n    \n    //     if(layout) {\n    \n    //         const item = collection.nextItem;\n    //         const progressBar = document.querySelector('.js-right-grid progress');\n    //         const questionCount = lessonPlan.layouts.filter(layout => layout.type === 'test').length;\n    //         const questionFormat = `Question ${ layout.roundProgressIndex } of ${questionCount}`;\n    \n    //         progressBar.max = questionCount;\n    //         progressBar.value = layout.roundProgressIndex || progressBar.value;\n            \n    //         let specimensHeaderText = '';\n    //         let lessonHeaderText = document.querySelector('.js-right-header > div:nth-child(2)');\n    \n    //         switch(layout.name) {\n    //             case 'screen-latin-to-common':\n    //                 specimensHeaderText = `${item.name} specimens`;\n    //                 break;\n    //             case 'screen-common-to-latin':\n    //             case 'specimen-images':\n    //             case 'screen-image-to-image':\n    //             case 'screen-species-card':\n    //                 specimensHeaderText = `${item.vernacularName} specimens`;\n    //                 break;\n    //             case 'history':\n    //                 if(PORTRAIT) rightHeaderText = 'Snapdragon';\n    //                 break;\n    //             default:\n    //                 specimensHeaderText = 'Species specimens';\n    //                 break;\n    //         }\n                \n    //         let SPECIMENS = false;\n    \n    //         SPECIMENS = layout.screens.find(screen => screen.name === 'specimen-images');\n    \n    //         if(SPECIMENS && !LANDSCAPE_HOME) leftHeaderText = specimensHeaderText;\n    \n    //         let TEST = false, GLOSSARY = false, SUMMARY = false, SPECIES_CARD = false, FAMILY_CARD = false;\n                              \n    //         TEST = layout.type === 'test';\n    //         GLOSSARY = layout.name === 'screen-definition-card';\n    //         SPECIES_CARD = layout.name === 'screen-species-card';\n    //         FAMILY_CARD = layout.name === 'screen-taxon-card';\n    //         SUMMARY = layout.screens.find(el => el.name === 'summary');\n            \n    //         if(GLOSSARY) rightHeaderText = 'Glossary';\n    //         if(TEST) rightHeaderText = questionFormat || '';\n    //         if(SPECIES_CARD) rightHeaderText = 'Species summary';\n    //         if(FAMILY_CARD) rightHeaderText = 'Family summary & Quick ID'\n    //         if(SUMMARY) rightHeaderText = 'Lesson progress';\n    //         if(SPECIES_LIST && PORTRAIT) rightHeaderText = collection.name;\n    //         if(LANDSCAPE_HOME) rightHeaderText = title;\n\n    //         if(LANDSCAPE) lessonHeaderText.innerHTML = `${collection.name} (${collection.items.length})`;\n    //     }\n    \n    //     DOM.leftHeaderTxt.innerHTML = leftHeaderText;\n    //     DOM.rightHeaderTxt.innerHTML = rightHeaderText;\n    // };\n};","// Module\nvar code = \"<div class=\\\"large-text centred-block standard-block\\\">Language preference</div>\\n\\n<div class=\\\"standard-block\\\">\\n    <div>Your selection will affect the vernacular names of species only.</div>\\n    <br>\\n    <div>It will not apply to lessons in progress.</div>\\n    <br>\\n</div>\\n\\n<div class=\\\"double-standard-block js-language-selection-container\\\"></div>\";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { languagePicker } from 'ui/screens/common/language-selection';\n\nimport languageTemplate from 'ui/fixtures/language-template.html';\n\nexport const renderLanguagePicker = () => {\n\n    const { config } = store.getState();\n\n    const parent = document.querySelector('#basicModal .js-modal-text');\n          parent.innerHTML = '';\n\n    const template = document.createElement('template');    \n          template.innerHTML = languageTemplate;\n\n    renderTemplate({ }, template.content, parent);\n\n    document.querySelector('#basicModal .js-modal-text-title header').innerHTML = 'Vernacular language';\n\n    languagePicker(config, document.querySelector('.js-language-selection-container'), (config) => {\n        actions.boundUpdateConfig(config);\n    });\n};","// Module\nvar code = \"<div class=\\\"modal-content\\\">\\n    <div class=\\\"snapdragon-container\\\">        \\n\\n        <div class=\\\"large-text centred-block standard-block\\\">User access</div>\\n\\n        <form id=\\\"login-form\\\">\\n            <div class=\\\"standard-block centred-block\\\">\\n                <input id=\\\"login-email\\\" type=\\\"text\\\" placeholder=\\\"Email\\\">\\n            </div>\\n            <div class=\\\"standard-block centred-block\\\">\\n                <input id=\\\"login-password\\\" type=\\\"text\\\" placeholder=\\\"Password\\\">\\n            </div>\\n            <button id=\\\"js-login-btn\\\" class=\\\"btn snap-action-btn\\\">Log in</button>\\n        </form>\\n        <div class=\\\"standard-block centred-block hide-important js-logged-in\\\">You are now logged in.</div>\\n        <div class=\\\"standard-block vertical-centred-block hide-important js-not-logged-in\\\">\\n            <span class=\\\"standard-block centred-block\\\">Please check your email and password.</span>\\n            <span class=\\\"standard-block centred-block js-message\\\"></span>\\n        </div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { DOM } from 'ui/dom';\nimport { actions } from 'redux/actions/action-creators';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport loginTemplate from 'ui/fixtures/login-template.html';\nimport logoutTemplate from 'ui/fixtures/logout-template.html';\n\nexport const renderLogin = user => {\n\n    const auth = firebase.auth();\n    \n    document.querySelector('#basicModal .js-modal-text').innerHTML = '';\n\n    const template = document.createElement('template');\n        \n    if(user) {\n\n        template.innerHTML = logoutTemplate\n\n        renderTemplate({ email: user.email }, template.content, document.querySelector('#basicModal .js-modal-text'));\n\n        document.querySelector('#basicModal .js-modal-text-title header').innerHTML = 'Snapdragon logout';\n\n        const footer = document.querySelector('.js-modal-footer');\n\n        setTimeout(() => {\n            \n            const form = document.querySelector('#logout-form');\n                  form.addEventListener('submit', e => {\n\n                e.preventDefault();\n\n                const logOut = document.querySelector('#js-logout-btn');\n                      logOut.setAttribute('disabled', 'disabled');\n\n                  auth.signOut()\n                  .then(() => {\n                    actions.boundUpdateUser(null);\n                    logOut.innerHTML = 'Success';\n                    setTimeout(() => {\n                        footer.click();\n                    }, 2500);\n                  });\n          });\n\n        }, 500);\n\n\n    } else {\n\n        template.innerHTML = loginTemplate;\n\n        renderTemplate({ }, template.content, document.querySelector('#basicModal .js-modal-text'));\n\n        document.querySelector('#basicModal .js-modal-text-title header').innerHTML = 'Snapdragon login';\n\n        const footer = document.querySelector('.js-modal-footer');\n\n        setTimeout(() => {\n\n            const email = document.querySelector('#login-email');\n                  email.focus();\n            \n            const password = document.querySelector('#login-password');   \n\n            const form = document.querySelector('#login-form');\n                  form.addEventListener('submit', e => {\n\n                    e.preventDefault();\n\n                    const logIn = document.querySelector('#js-login-btn');\n                          logIn.setAttribute('disabled', 'disabled');              \n                    \n                    auth.signInWithEmailAndPassword(email.value, password.value)\n                    .then((credentials) => {\n                        actions.boundUpdateUser({\n                            email: email.value,\n                            password: password.value\n                        });\n                        logIn.innerHTML = 'Success';\n                        setTimeout(() => {\n                            footer.click();\n                        }, 2500);\n                    })\n                    .catch( error => {\n                        const notLoggedIn = document.querySelector('.js-not-logged-in');\n                              if(notLoggedIn) notLoggedIn.classList.remove('hide-important');\n                              if(notLoggedIn) notLoggedIn.querySelector('.js-message').innerHTML = error.message;\n                    });\n                });\n\n        }, 500);\n\n    }\n};\n\nexport const renderLoggedIn = user => {\n\n    if(user) {\n        const loggedIn = document.querySelector('.js-logged-in');\n              if(loggedIn) loggedIn.classList.remove('hide-important');\n    } else {\n        const notLoggedIn = document.querySelector('.js-not-logged-in');\n              if(notLoggedIn) notLoggedIn.classList.remove('hide-important');\n        const loggedOut = document.querySelector('.js-logged-out');\n              if(loggedOut) loggedOut.classList.remove('hide-important');\n    }\n};","// Module\nvar code = \"<div class=\\\"modal-content\\\">\\n    <div class=\\\"snapdragon-container\\\">        \\n        <form id=\\\"logout-form\\\">\\n            <div class=\\\"vertical-centred-block double-standard-block\\\">\\n                <span>You are logged in with the account:</span>\\n                <span>{{ email }}</span>\\n            </div>\\n            <div>\\n                <button id=\\\"js-logout-btn\\\" class=\\\"btn snap-action-btn\\\">Log out</button>\\n            </div>\\n        </form>\\n        <div class=\\\"standard-block centred-block hide-important js-logged-out\\\">You are now logged out.</div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<li>\\n  <button id=\\\"GLOSSARY\\\" class=\\\"snap-icon-btn icon glossary js-glossary\\\" data-toggle=\\\"modal\\\" data-target=\\\"#glossaryModal\\\" aria-label=\\\"glossary\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-book-open\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Glossary</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <button id=\\\"LANGUAGE\\\" class=\\\"snap-icon-btn icon language js-language\\\" data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" aria-label=\\\"language settings\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-language\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Language</span>\\n  </button>\\n</li>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<li>\\n  <button id=\\\"PORTRAIT_HOME\\\" class=\\\"snap-icon-btn portrait icon list js-list\\\" aria-label=\\\"home\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-chalkboard\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Lesson home</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <button id=\\\"SETTINGS\\\" class=\\\"snap-icon-btn icon settings js-settings\\\" data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" aria-label=\\\"settings\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-cog\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Settings</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <button id=\\\"LOGIN\\\" class=\\\"snap-icon-btn icon login js-login\\\" data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" data-is-logged-in=\\\"false\\\" aria-label=\\\"login\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-user-slash\\\"></i>\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-user-check\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Login or logout</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <button id=\\\"GLOSSARY\\\" class=\\\"snap-icon-btn icon glossary js-glossary\\\" data-toggle=\\\"modal\\\" data-target=\\\"#glossaryModal\\\" aria-label=\\\"glossary\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-book-open\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Glossary</span>\\n  </button>\\n</li>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<li>\\n  <button id=\\\"SETTINGS\\\" class=\\\"snap-icon-btn icon settings js-settings\\\" data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" aria-label=\\\"settings\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-cog\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Settings</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <button id=\\\"LOGIN\\\" class=\\\"snap-icon-btn icon login js-login\\\" data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" data-is-logged-in=\\\"false\\\" aria-label=\\\"login\\\">\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-user-slash\\\"></i>\\n    <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-user-check\\\"></i>\\n    <span class=\\\"visually-hidden\\\">Login or logout</span>\\n  </button>\\n</li>\\n\\n<li>\\n  <a id=\\\"EMAIL\\\" class=\\\"landscape icon email js-email\\\" target=\\\"_blank\\\" href=\\\"mailto:danhartleybcn@gmail.com?subject=Learn The Planet\\\">\\n      <i aria-hidden=\\\"true\\\" focusable=\\\"false\\\" class=\\\"fas fa-envelope\\\"></i>\\n      <span class=\\\"visually-hidden\\\">Open email link</span>\\n  </a>\\n  </li>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { subscription } from 'redux/subscriptions';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { renderLessons } from 'ui/screens/lists/lesson-list';\nimport { cookieHandler } from 'ui/helpers/cookie-handler';\nimport { settingsHandler } from 'ui/fixtures/settings';\nimport { renderLogin } from 'ui/fixtures/login';\nimport { lessonStateHandler } from 'ui/screens/lists/lesson-state-handler';\nimport { quickFireHandlers } from 'ui/quick-fire-modal/quick-fire';\nimport { renderLanguagePicker } from 'ui/fixtures/language';\n\nimport navigationPortraitTemplate from 'ui/fixtures/navigation-portrait-template.html';\nimport navigationLeftTemplate from 'ui/fixtures/navigation-left-template.html';\nimport navigationRightTemplate from 'ui/fixtures/navigation-right-template.html';\n\nconst onLoseFocusListeners = [];\n\nexport const onAddLoseFocusListener = listener => {\n    onLoseFocusListeners.pop();\n    onLoseFocusListeners.push(listener);\n}\n\nexport const renderNavigation = collection => {\n\n    const { config, counter } = store.getState();\n\n    const template = document.createElement('template');\n\n    let parent;\n    \n    if(config.isPortraitMode) {\n        template.innerHTML = navigationPortraitTemplate;\n        parent = document.querySelector('.js-main-footer .js-nav-icons');\n        parent.innerHTML = '';\n        renderTemplate({ }, template.content, parent);\n    } else {\n        template.innerHTML = navigationLeftTemplate;\n        parent = document.querySelector('.js-left-footer .js-nav-icons');\n        parent.innerHTML = '';\n        renderTemplate({ }, template.content, parent);\n        template.innerHTML = navigationRightTemplate;\n        parent = document.querySelector('.js-right-footer .js-nav-icons');\n        parent.innerHTML = '';\n        renderTemplate({ }, template.content, parent);\n    }\n\n    const navIcons =  document.querySelectorAll('.js-nav-icons .icon');\n\n    navIcons.forEach(icon => {\n\n        icon.addEventListener('click', async event => {\n            \n                const clickedIcon = event.currentTarget;\n                \n                const { collection, config } = store.getState();\n\n                const toggleIconOnOff = clickedIcon => {\n                    clickedIcon.classList.add('active-icon');\n                    setTimeout(() => {\n                        clickedIcon.classList.remove('active-icon');\n                    }, 1000);\n                };\n\n                let lesson;\n\n                switch(enums.navigation.enumValueOf(clickedIcon.id)) {\n                    case enums.navigation.LANDSCAPE_HOME:\n                        const isIconActive = R.contains('active-icon', clickedIcon.classList);\n                        if(!isIconActive) {\n                            clickedIcon.classList.add('active-icon');\n                        }\n                        break;\n                    case enums.navigation.SETTINGS:\n                        toggleIconOnOff(clickedIcon);\n                        settingsHandler();\n                        break;\n                    case enums.navigation.PORTRAIT_HOME:\n                        onLoseFocusListeners.forEach(listener => listener());\n                        const activeInfoIcon = document.querySelector('.js-info.active-icon');\n                        if(activeInfoIcon) activeInfoIcon.classList.remove('active-icon');\n                        clickedIcon.classList.add('active-icon');\n                        subscription.getByRole('screen').forEach(sub => subscription.remove(sub));\n                        lesson = await lessonStateHandler.changeRequest({ requestType: enums.lessonState.PAUSE_LESSON });\n                        renderLessons();\n                        DOM.rightHeaderTxt.innerHTML = 'Learn the planet';\n                        DOM.rightHeaderScoreTxt.innerHTML = '';\n                        break;\n                    case enums.navigation.GLOSSARY:   \n                        toggleIconOnOff(clickedIcon);\n                        const { glossary } = store.getState();\n                        const definitions = !!collection.glossary\n                            ? glossary.filter(definition => R.contains(definition.taxon, collection.glossary))\n                            : glossary;\n                        quickFireHandlers.definitions(definitions);\n                        break;\n                    case enums.navigation.EMAIL:\n                        toggleIconOnOff(clickedIcon);\n                        break;\n                    case enums.navigation.LOGIN:\n                        renderLogin(store.getState().user);\n                        break;\n                    case enums.navigation.LANGUAGE:\n                        renderLanguagePicker();\n                    default:\n                        return;\n                }\n        });        \n    });\n\n    const onLoadState = (config, counter) => {\n        \n        if(config.isPortraitMode && config.collection.id !== 0 && !counter.isLessonRehydrated) {\n            navIcons.forEach(icon => icon.classList.remove('active-icon'));\n            return;\n        }\n\n        if(counter.isLessonPaused) {\n\n            if(config.isPortraitMode) {\n                const id = enums.navigation.PORTRAIT_HOME.name;\n                let icon = document.getElementById(id);\n                const returningUser = !cookieHandler.isFirstTimeVisitor();\n\n                if(id === enums.navigation.LANDSCAPE_HOME.name || (id === enums.navigation.PORTRAIT_HOME.name && returningUser)) {\n                    icon.classList.add('active-icon');\n                }\n            }\n        } else {\n            navIcons.forEach(icon => icon.classList.remove('active-icon'));\n        }\n    };\n\n    onLoadState(config, counter);\n};\n\nexport const renderLoginChanges = user => {\n};\n","// Module\nvar code = \"<!-- <div class=\\\"footer-round js-footer-round\\\">{{ layout.levelName }}, round {{ currentRound }}</div> -->\\n<div>{{ questionFormat }}</div>\\n<div class=\\\"footer-score js-footer-score\\\">\\n    <span class=\\\"hide-important\\\">{{ score.correct }} {{ scoreText }}</span>\\n    <span>Score: {{ score.correct }} / {{ score.total }}</span>\\n    <span>History: {{ history.correct }} / {{ history.total }}</span>\\n</div>\";\n// Exports\nmodule.exports = code;","import { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { actions } from 'redux/actions/action-creators';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport scoreTemplate from 'ui/fixtures/score-template.html';\n\nexport const renderScore = score => {\n    \n    const { history, collection, config, layout, lesson, lessonPlan } = store.getState();\n\n    score.mode = config.mode;\n\n    if(!layout) return;\n\n    if(score.total === layout.roundScoreCount) {\n        actions.boundUpdateHistory(score);\n    }\n\n    return;\n\n    const template = document.createElement('template');\n\n    const scoreText = config.isLandscape \n                        ? score.correct === 1 ? 'correct answer' : 'correct answers'\n                        : score.correct === 'correct';\n\n    template.innerHTML = config.isPortraitMode\n            ?   layout \n                    ? ''\n                    // ? `<div><span>{{ score.correct }} / {{ score.total }}</span></div>`\n                    : ''\n            :   layout \n                    ? scoreTemplate\n                    : '';\n\n    const runningTotal = history ? { ...history } : { correct: 0, total: 0 };\n\n    runningTotal.correct = runningTotal.correct + score.correct;\n    runningTotal.total = runningTotal.total + score.total;\n\n    const parent = config.isPortraitMode ? DOM.rightFooter.querySelector('.js-footer-score') : DOM.rightFooter;\n          parent.innerHTML = '';\n\n    let questionCount, questionFormat = '';\n\n    if(lessonPlan) {\n        questionCount = lessonPlan.layouts.filter(layout => layout.type === 'test').length;\n        questionFormat = `Question ${ layout.roundProgressIndex } of ${questionCount}`;\n    }\n\n    if(config.isPortraitMode) {\n        DOM.rightHeaderTxt.innerHTML = score.total === 0\n            ? 'Learn the planet'\n            : questionFormat;\n\n        DOM.rightHeaderScoreTxt.innerHTML = score.total === 0\n            ? config.isLandscapeMode\n                    ? '<span class=\"margin-right\">Learn the planet</span>'\n                    : '<span class=\"margin-right\"></span>'\n            : `<span class=\"margin-left\">${score.correct}/${score.total}</span>`;\n    }    \n\n    renderTemplate({ score, history: runningTotal, collection, config, layout, scoreText, currentRound: lesson.currentRound, questionFormat }, template.content, parent);\n\n    // score.mode = config.mode;\n\n    // if(!layout) return;\n\n    // if(score.total === layout.roundScoreCount) {\n    //     actions.boundUpdateHistory(score);\n    // }\n};","// Module\nvar code = \"<div class=\\\"double-standard-block vertical-centred-block\\\">\\n    <p>Clear all data (and delete your score).</p>\\n    <button class=\\\"btn snap-action-btn js-clear-cache-btn\\\">Clear all data</button>\\n</div>\\n\\n<hr>\\n\\n<div class=\\\"half-standard-block centred-block\\\">Time for answer to remain visible:</div>\\n<div class=\\\"delay-slider\\\">\\n    <div class=\\\"standard-block double-centred-block\\\">\\n        <span>0 secs</span> <input class=\\\"js-set-delay-input\\\" type=\\\"range\\\" min=\\\"0\\\" max=\\\"5\\\" value=\\\"{{ delay }}\\\"><span> 5 secs</span>\\n    </div>\\n    <button class=\\\"btn snap-action-btn js-set-delay-btn\\\">Set delay</button>\\n    <div class=\\\"half-standard-block centred-block js-delay-text\\\"></div>\\n</div>\\n\\n<hr class=\\\"portrait\\\">\\n\\n<div class=\\\"portrait js-language-selection-container\\\"></div>\\n\\n<hr class=\\\"portrait\\\">\\n\\n<div class=\\\"portrait email centred-block\\\">\\n    <a target=\\\"_blank\\\" href=\\\"mailto:danhartleybcn@gmail.com?subject=Learn The Planet\\\">\\n        <i class=\\\"fas fa-envelope\\\"></i>        \\n    </a>\\n    <span class=\\\"margin-left\\\">Contact Snapdragon</span>\\n</div>\";\n// Exports\nmodule.exports = code;","import { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { persistor } from 'redux/store';\nimport { actions } from 'redux/actions/action-creators';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { cookieHandler } from 'ui/helpers/cookie-handler';\nimport { languagePicker } from 'ui/screens/common/language-selection';\n\nimport settingsTemplate from 'ui/fixtures/settings-template.html';\n\nexport const settingsHandler = () => {\n    \n  document.querySelector('#basicModal .js-modal-text').innerHTML = '';\n\n    const template = document.createElement('template');\n    \n    template.innerHTML = settingsTemplate;\n    \n    document.querySelector('#basicModal .js-modal-text-title header').innerHTML = 'Snapdragon settings';\n\n    const { config } = store.getState();\n\n    const delay = config.callbackTime/1000;\n\n    const languages = config.languages;\n\n    renderTemplate({ delay, languages }, template.content, document.querySelector('#basicModal .js-modal-text'));\n    \n    const clearCacheBtn = document.querySelector('.js-clear-cache-btn');\n    const setDelayBtn = document.querySelector('.js-set-delay-btn');\n    const setDelayInput = document.querySelector('.js-set-delay-input');\n    const delayTxt = document.querySelector('.js-delay-text');\n\n    document.querySelector('#basicModal .modal-body').classList.remove('bird-song-bg');\n\n    delayTxt.innerHTML = delay === 1\n    ? `The current delay is ${delay} second.`\n    : `The current delay is ${delay} seconds.`;\n\n    clearCacheBtn.addEventListener('click', () => { \n        clearCacheBtn.innerText = 'Clearing cache';\n        setTimeout(() => {\n            persistor.purge();\n            clearCacheBtn.innerText = 'Cache cleared';\n            cookieHandler.removeFirstTimeVisitorCookie();\n            setTimeout(() => {                                \n                setTimeout(() => {                    \n                    window.location.reload(true);\n                }, 500);\n            }, 500);\n        }, 1000);\n    });\n\n    setDelayBtn.addEventListener('click', () => {\n        setDelayBtn.innerHTML = 'Setting delay';\n        setTimeout(() => {\n            const delay = setDelayInput.value;\n            config.callbackTime = delay * 1000;\n            actions.boundUpdateConfig(config);\n            setDelayBtn.innerHTML = 'Set delay';\n            delayTxt.innerHTML = delay === '1'\n                ? `Delay updated to ${delay} second.`\n                : `Delay updated to ${delay} seconds.`;\n        }, 500);        \n    });\n\n    languagePicker(config, document.querySelector('.js-language-selection-container'), (config) => {\n        actions.boundUpdateConfig(config);\n    });\n};","import * as R from 'ramda';\n\nconst show = (elem) => {\n    if(!elem) return;\n\telem.classList.add('is-visible');\n};\n\nconst hide = (elem) => {\n    if(!elem) return;\n\telem.classList.remove('is-visible');\n};\n\nconst toggle = (elem) => {\n    if(!elem) return;\n\telem.classList.toggle('is-visible');\n};\n\nconst hasClass = (elem, className) => {\n    if(!elem) return false;\n    const classArray = [ ...elem.classList ];\n    return R.contains(className, classArray);\n};\n\nconst removeClass = (elem, className) => {\n    if(hasClass(elem, className)) {\n        elem.classList.forEach(c => {\n            if(c === className) {\n                elem.classList.remove(c);\n            }\n        });\n    }\n};\n\nexport const elem = {\n    show, hide, toggle, hasClass, removeClass\n};","// https://github.com/GoogleChromeLabs/samesite-examples/blob/master/javascript.md\n\nconst FIRST_TIME = 'first_time';\nconst LAST_VISITED = 'last_visited';\nconst TOO_MANY_DAYS = 5;\nconst SECURE = 'SameSite=Lax;';\n\nlet cookie;\n\nconst setFirstTimeVisitorCookie = () =>  {\n    let isFirstVisit = true;\n    if (document.cookie.indexOf(FIRST_TIME) < 0) {\n      cookie = `${FIRST_TIME}=false; ${SECURE}`;\n      document.cookie = cookie;\n    } else {\n        isFirstVisit = false;\n    }\n    return isFirstVisit;\n};\n\nconst setLastVisitedCookie = date => {    \n    if (document.cookie.indexOf(LAST_VISITED) < 0) {\n      cookie = `${LAST_VISITED}=${date}; ${SECURE}`;\n      document.cookie = cookie;\n    } else {\n        setLastVisited(date);\n    }    \n};\n\nconst hasUserBeenAwayTooLong = () => {\n    const lastVisited = readCookie(LAST_VISITED);\n\n    if(!lastVisited) return false;\n\n    const timeDiff = Math.abs(new Date() - new Date(lastVisited));\n    const daysDiff = Math.ceil(timeDiff / (1000 * 60 * 60 * 24)); \n    const beenGoneTooLong = daysDiff > TOO_MANY_DAYS;\n    if(beenGoneTooLong) {\n        setLastVisited(Date());\n    }\n    return beenGoneTooLong;\n};\n\nconst isFirstTimeVisitor = () => {\n    return readCookie(FIRST_TIME) === null;\n};\n\nconst removeFirstTimeVisitorCookie = () => {\n  cookie = `${FIRST_TIME}= ; expires = Thu, 01 Jan 1970 00:00:00 GMT; ${SECURE}`;\n  document.cookie = cookie; \n};\n\nexport const cookieHandler = {\n    setFirstTimeVisitorCookie,\n    isFirstTimeVisitor,\n    removeFirstTimeVisitorCookie,\n    setLastVisitedCookie,\n    hasUserBeenAwayTooLong\n};\n\nconst readCookie = name => {\n\tvar nameEQ = name + \"=\";\n\tvar ca = document.cookie.split(';');\n\tfor(var i=0;i < ca.length;i++) {\n\t\tvar c = ca[i];\n\t\twhile (c.charAt(0)==' ') c = c.substring(1,c.length);\n\t\tif (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length,c.length);\n\t}\n\treturn null;\n}\n\nconst setLastVisited = date => {\n    const cookieValue = document.cookie.replace(/(?:(?:^|.*;\\s*)last_time\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\n    const cookieToAdd = cookieValue + `${LAST_VISITED}=${date};`;\n    cookie = `${cookieToAdd}; ${SECURE}`;\n    document.cookie = cookie;\n};\n","import { renderTextEntry } from 'ui/screens/text-entry/species-text-entry';\nimport { renderSpecimenTiles } from 'ui/screens/landscape/specimen-tiles';\nimport { renderHistory } from 'ui/screens/progress/history';\nimport { renderCard } from 'ui/screens/cards/card';\nimport { renderTaxonCard } from 'ui/screens/cards/taxon-card';\nimport { renderNonTaxonCard } from 'ui/screens/cards/non-taxon-card';\nimport { renderSummary } from 'ui/screens/progress/summary';\nimport { renderMultiStrips } from 'ui/screens/multichoice/multi-strips';\nimport { renderCompleteText } from 'ui/screens/text-entry/text-complete';\nimport { renderCultivarCard } from 'ui/screens/cards/cultivar-card';\nimport { renderMixedSpecimenImagesAndQuestion } from 'ui/screens/multichoice/portrait/mixed-specimen/mixed-specimen-combined';\nimport { renderNonTaxonCardSpecimenTiles } from 'ui/screens/cards/non-taxon-card-specimen-tiles';\nimport { renderMixedSpecimenQuestion } from 'ui/screens/multichoice/landscape/mixed-specimen/right/mixed-specimen-question';\nimport { renderMixedSpecimenImages } from 'ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images';\nimport { renderMediaPlayers } from 'ui/screens/media/landscape/media-players';\nimport { renderBonusTest } from 'ui/screens/bonus/bonus-test';\nimport { renderBonusSpecimenTiles } from 'ui/screens/bonus/bonus-specimen-tiles';\nimport { renderMixedTraitImages } from 'ui/screens/multichoice/landscape/mixed-trait/left/mixed-trait-images';\nimport { renderMixedTraitQuestion } from 'ui/screens/multichoice/landscape/mixed-trait/right/mixed-trait-question';\nimport { renderHorizontalStrips } from 'ui/screens/multichoice/horizontal-strips.js';\n\nconst functions = [\n    { name: 'mixed-specimen-questions', func: renderMixedSpecimenImagesAndQuestion },\n    { name: 'non-taxon-specimen-tiles', func: renderNonTaxonCardSpecimenTiles },\n    { name: 'text-entry', func: renderTextEntry },\n    // { name: 'specimen-images', func: renderSpecimenTiles },\n    { name: 'species-card', func: renderCard },\n    { name: 'species-scientifics', func: renderMultiStrips },\n    { name: 'species-vernaculars', func: renderMultiStrips },\n    { name: 'species-identification', func: renderMultiStrips },\n    { name: 'summary', func: renderSummary },\n    { name: 'history', func: renderHistory },\n    { name: 'epithet', func: renderMultiStrips },\n    { name: 'definition', func: renderBonusTest },\n    { name: 'family', func: renderMultiStrips },\n    { name: 'family-strips', func: renderMultiStrips },\n    { name: 'taxon-card', func: renderTaxonCard },\n    { name: 'non-taxon-card', func: renderNonTaxonCard },\n    { name: 'text-complete', func: renderCompleteText },\n    { name: 'cultivar-card', func: renderCultivarCard },\n    { name: 'visual-match', func: renderMultiStrips },\n    { name: 'trait-images', func: renderBonusSpecimenTiles },\n    { name: 'trait-property', func: renderBonusTest },\n    { name: 'lookalike-property', func: renderBonusTest },\n    { name: 'symbiotic-property', func: renderMultiStrips },\n        \n    { name: 'mixed-specimen-question', func: renderMixedSpecimenQuestion },\n    { name: 'mixed-specimen-images', func: renderMixedSpecimenQuestion },\n    // { name: 'mixed-specimen-images', func: renderMixedSpecimenImages },\n    \n    { name: 'birdsong', func: renderBonusTest },\n    { name: 'media-players', func: renderMediaPlayers },    \n\n    // { name: 'mixed-trait-images', func: renderMixedTraitImages },\n    { name: 'mixed-trait-question', func: renderMixedTraitQuestion },\n    \n    { name: 'provider-horizontal-strip-questions', func: renderHorizontalStrips },\n];\n\nexport const funcByName = name => {\n    const match = functions.find(func => func.name === name);\n    const func = match ? match.func : null;\n    return func;\n};","import autocomplete from 'autocompleter';\nimport { getAutocompleteBy } from 'api/inat/inat';\nimport { GoogleAutocomplete } from 'geo/geo';\n\n// https://github.com/kraaden/autocomplete\n\nexport const inatAutocomplete = (input, type, className, rb) => {\n\n    const MIN_LENGTH = 3;\n\n    async function getUserSuggestions(text) {\n        const users = await getAutocompleteBy(text, 'users');\n        return users.results.map(user => {\n            return { label: user.login_autocomplete, value: user.id, photo: user.icon, name: user.name };\n        });\n    }\n\n    async function getInatPlaceSuggestions(text) {        \n        const users = await getAutocompleteBy(text, 'places');\n        return users.results.map(place => {\n            return { label: place.display_name, value: place.id };\n        });\n    }    \n\n    function getPlaceSuggestions(text, update) {\n        let callback = null;\n        callback = predictions => {\n            update(predictions.map(prediction => {\n                return { label: prediction.description, value: prediction.place_id };\n            }));\n        } \n        GoogleAutocomplete(text, callback);\n    }\n\n    async function getProjectSuggestions(text) {\n        const projects = await getAutocompleteBy(text, 'projects');\n        return projects.results.map(place => {\n            return { label: place.title, value: place.id };\n        });\n    }\n    \n    const autocompleteRef = autocomplete({\n        input: input,\n        fetch: function(text, update) {\n            switch(type) {\n                case 'users':\n                    getUserSuggestions(text).then(users => {\n                        update(users);\n                    });\n                    break;\n                case 'places':\n                    getPlaceSuggestions(text, update);\n                    break;\n                case 'projects':\n                    getProjectSuggestions(text).then(projects => {\n                            update(projects);\n                        });\n                    break;\n            }           \n\n        },\n        onSelect: function(item) {\n            input.value = item.label;\n            input.name = item.value;\n        },\n        className: className,\n        rb: rb,\n        minLength: MIN_LENGTH,\n        debounceWaitMs: 200\n    });\n\n    return autocompleteRef;\n};","import { clone } from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { getIPLocation } from 'geo/geo';\n\nexport const initialiseConfig = async originalConfig => {\n\n    const config = clone(originalConfig);\n\n    const observableMonths = utils.getObservableMonths(new Date(), 3);\n\n    config.season = { observableMonths };\n    config.guide.season.observableMonths = observableMonths;\n    config.guide.season.type = config.guide.season.type || 'all_year';\n\n    config.collection.id = config.collection.id || 0; \n    config.guide.locationPlace = '';\n    config.guide.place.type = '';\n    \n    try {\n        \n        const ipLocation = await getIPLocation(config);\n        \n        if(ipLocation) {\n            const location = ipLocation.city ? `${ipLocation.city}, ${ipLocation.country_name}` : ipLocation;\n            config.ipLocation = location;\n            config.guide.locationType = 'longLat';\n            config.guide.locationLongLat = location;\n            config.guide.place.name = location;\n            config.guide.coordinates = {\n                lat: ipLocation.latitude,\n                long: ipLocation.longitude\n            }; \n        }\n        else {\n            config.guide.locationPlace = 'Earth';\n            config.guide.locationType = 'place';\n            config.guide.place = { id: 'any', name: 'Earth' };\n        }\n\n    } catch(e) {            \n        config.guide.locationPlace = 'Earth';\n        config.guide.locationType = 'place';\n        config.guide.place = { id: 'any', name: 'Earth' };\n    }    \n\n    return config;\n}","import { store } from 'redux/store';\nimport { actions } from 'redux/actions/action-creators';\nimport { elem } from 'ui/helpers/class-behaviour';\nimport { markTest} from 'ui/helpers/test-handler';\nimport { subscription } from 'redux/subscriptions';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nexport const scoreHandler = (type, test, callback, config) => {\n    \n    switch(type) {\n        case 'radio':\n        case 'text':\n            return genericScoreHandler(test, callback, config);\n        case 'block':\n            blockScoreHander(test, callback, config);\n            break;\n        case 'strip':   \n            stripScoreHandler(test, callback, config);\n            break;\n        case 'image':\n            imageScoreHandler(test, callback, config);\n            break;\n        case 'image-match':\n            simpleScoreHandler(test, callback, config);\n            break;\n    }\n};\n\nexport const renderScoreHTMLResponse = response => {\n    const html = response.success\n            ? `<div class=\"answer-box-success\">\n                <span class=\"icon\"><i class=\"fas fa-check\"></i></span><span class=\"answer-response\">${ response.correct }</span>\n                </div>`\n            : `<div class=\"answer-box-alert\">\n                <span class=\"icon\"><i class=\"fas fa-times\"></i></span><span class=\"answer-response\">${response.answer || response.incorrect}</span>\n            </div>`;\n    return html;\n};\n\nconst showResponseToAnswerHandler = response => {\n    const questionText = document.querySelector(response.container) || document.querySelector('.js-txt-question');\n    if(questionText) {\n          questionText.innerHTML = renderScoreHTMLResponse(response);\n    }\n}\n\nexport const continueLessonHandler = (btn, score, timer) => {\n        \n    btn.disabled = false;\n    btn.style.cursor = 'pointer';\n\n    btn.addEventListener('click', event => {\n        btn.disabled = true;\n        window.clearTimeout(timer);\n        subscription.removeSubs();\n        bindScore(score);\n    });\n};\n\nconst simpleScoreHandler = (test, callback, config) => {\n    \n    const score = markTest(test);\n\n    const delay = score.success ? config.callbackTime : config.callbackTime + config.callbackDelay;\n\n    subscription.removeSubs();\n\n    const scoreUpdateTimer = setTimeout(()=>{\n        bindScore(score);      \n    }, delay);\n\n    if(callback) {\n        callback(score, scoreUpdateTimer);\n    } else {\n        continueLessonHandler(document.querySelector('.js-continue-lesson-btn'), score, scoreUpdateTimer);\n    }\n\n    let correct = `Correct`;\n    let incorrect = `Incorrect`;\n\n    showResponseToAnswerHandler({ success: score.success, correct, incorrect });\n}\n\nconst genericScoreHandler = (_score, callback, config) => {\n    \n    const { itemId, question, answer, target, layoutCount, points, names, questionText, answers } = _score;\n    const test = { itemId, ...question, answer, points, names, questionText, answers };\n\n    const score = markTest(test);\n\n    let responseTxt = (test.names && test.names.length > 0) ? test.names[0] : test.binomial;\t\n    let labelTxt = 'Species';\t\n\n    if(score.taxon === 'genus') {\n        responseTxt = score.genus;\n        labelTxt = 'Genus name';\n    }\n\n    if(score.taxon === 'species') {\n        responseTxt = score.species;\n        labelTxt = 'Species name';\n    }\n    if(score.taxon === 'name') {\n        responseTxt = score.binomial;\n        labelTxt = 'Latin name';\n    }\n\n    if(score.taxon === 'family') {\n        responseTxt = score.question;\n        labelTxt = 'Family name';\n    }\n\n    let correct = `Correct`;\n    let incorrect = `Incorrect`;\n\n    const container = window.matchMedia(\"(max-height: 568px)\").matches ? '.js-check-answer' : '.js-txt-question';\n\n    showResponseToAnswerHandler({ success: score.success, correct, incorrect,  container, answer: score.question });\n\n    score.layoutCount = layoutCount;\n\n    const delay = score.success ? config.callbackTime : config.callbackTime + config.callbackDelay;\n\n    subscription.removeSubs(); \n\n    const scoreUpdateTimer = setTimeout(()=>{\n        bindScore(score);               \n    }, delay);\n\n    if(callback) callback(score, scoreUpdateTimer);\n\n    return { score, scoreUpdateTimer };\n};\n\nconst blockScoreHander = (test, callback, config) => {\n    \n    const score = markTest(test);\n\n    const delay = score.success ? config.callbackTime : config.callbackTime + config.callbackDelay;\n\n    subscription.removeSubs();\n\n    const scoreUpdateTimer = setTimeout(()=>{\n        bindScore(score);        \n    }, delay);\n\n    callback(score, scoreUpdateTimer, config);\n};\n\nconst stripScoreHandler = (test, callback, config) => {    \n\n    const { items, taxon } = test;\n\n    const handleClickEvent = e => {\n      \n        e.preventDefault();\n\n        const target = e.target;\n\n        if(elem.hasClass(target, 'disabled')) return;\n\n        const answerNode = target;\n        const answer = answerNode.innerText.trim();\n        const answerIndex = answerNode.dataset.answerIndex;\n        const name = answerNode.dataset.name;\n        const vernacular = target.dataset.vernacular;\n\n        test.taxon = 'name';\n        test.vernacular = vernacular;\n        test.question = taxon.question;\n        test.answer = (name && name !== '') ? { term: answer, name } : answer;\n            \n        const score = markTest({...test, answeredIndex: parseInt(answerIndex), answers: [] });\n\n        target.classList.add(score.colour);\n\n        items.forEach(strip => {   \n            const stripAnswer = strip.querySelector('button');\n            const stripAnswerIndex = parseInt(stripAnswer.dataset.answerIndex);\n            const stripAnswerName = stripAnswer.dataset.name || '';\n            \n            stripAnswer === '' \n                ? score.answers.push(stripAnswer.innerText) \n                : score.answers.push({\n                    term: stripAnswer.innerText,\n                    name: stripAnswerName\n                });\n            \n            if(stripAnswerIndex === score.answerIndex) {\n                strip.classList.add('snap-success');\n            } else if(stripAnswerIndex === score.answeredIndex) {\n              strip.classList.add('snap-alert');\n            }\n        });     \n        \n        if(callback) {\n            callback(score);\n        } else {\n            const _callback = (score) => {\n\n                const delay = score.success ? config.callbackTime : config.callbackTime + config.callbackDelay;\n\n                const scoreUpdateTimer = setTimeout(()=>{\n                    subscription.removeSubs();\n                    bindScore(score);\n                }, delay);\n            \n                continueLessonHandler(document.querySelector('.js-continue-lesson-btn'), score, scoreUpdateTimer);\n\n                // screen is always null\n                if(screen.name === 'family-strips') {\n                    document.querySelector('.js-question-question').innerHTML = item.taxonomy.family;\n                    document.querySelector('.js-question-help').classList.add('hide');\n                }\n            };\n            _callback(score);\n        }\n            \n        let correct = `Correct`;\n        let incorrect = `Incorrect`;\n\n        showResponseToAnswerHandler({ success: score.success, correct, incorrect });\n\n        items.forEach(item => item.classList.add('disabled'));\n    };\n\n    items.forEach(selected => {        \n        selected.addEventListener('click', handleClickEvent);\n    });\n\n    window.addEventListener('keydown', e => {\n      if(e.key === 'Enter') {\n        handleClickEvent(e);\n      }                  \n    }, { once: true });\n};\n\nconst imageScoreHandler = (test, callback, config) => {\n\n    const { items, taxon } = test;\n\n    items.forEach(tile => {\n        tile.addEventListener('click', event => {\n\n            const img = event.target;\n            const answer = img.dataset.answer;\n\n            if(!answer) return;\n\n            test.taxon = 'name';\n            test.question = taxon.name\n            test.answer = answer;\n            const score = markTest(test);\n\n            tile.style.filter = 'saturate(100%)';\n\n            img.parentNode.style.filter = 'saturate(100%)';\n\n            items.forEach(tile => {\n                tile.style.filter = 'saturate(10%)';\n                tile.style.opacity = .3;\n                if(tile.dataset.answer.trim().toLowerCase() === taxon.name.trim().toLowerCase()) {\n                    tile.style.filter = 'saturate(100%)';\n                    tile.style.opacity = 1;\n                }\n            });\n\n            const delay = score.success ? config.callbackTime : config.callbackTime + config.callbackDelay;\n\n            subscription.removeSubs();\n\n            const scoreUpdateTimer = setTimeout(() => {\n                bindScore(score);\n            }, delay);\n                \n            if(callback) callback(score, scoreUpdateTimer);\n        });\n    });\n};\n\nexport const bindScore = score => {\n\n    const { collection } = store.getState();\n\n    score.collectionId = collection.id;\n\n    actions.boundUpdateScore(score);\n};","import * as R from 'ramda';\n\nexport const cleanText = text => {\n    return text.term ? text.term.toLowerCase() : text.toLowerCase().replace(/ /g,'');\n};\n\nexport const isAnswerEqualToQuestion = (question, answer) => {\n\n\n    const eqValues = R.compose(R.isEmpty, R.symmetricDifference);\n\n    return eqValues(cleanText(question), cleanText(answer));\n};\n\nconst isAnswerCorrect = score => {\n\n    let isCorrect;\n\n    if(score.answeredIndex) {\n        return parseInt(score.answeredIndex) === score.answerIndex;\n    }\n\n    score.answer = score.answer.trim();\n\n    isCorrect = isAnswerEqualToQuestion(score.question, score.answer);\n\n    // score.clue = score.clue ? score.clue.toLowerCase().replace(/ /g,'') : null;\n\n    // isCorrect = score.clue ? score.answer.indexOf(score.clue) > -1 : isCorrect;\n\n    switch(score.taxon) {\n        case 'vernacular':\n            score.names = score.names.map(name => name.toLowerCase());\n            if(score.names && score.names.length > 0) {\n                const alternativeIsCorrect = R.contains(score.answer, score.names);                \n                if(!isCorrect && alternativeIsCorrect) score.alternativeAccepted = true;\n                isCorrect = isCorrect || alternativeIsCorrect;\n            }\n        break;\n    }\n    return isCorrect;\n};\n\nconst isTraitAnswerCorrect = score => {\n    const doArraysHaveSameValues = R.compose(R.isEmpty, R.symmetricDifference);\n    return doArraysHaveSameValues(score.answer, score.question);\n};\n\nexport const markTest = test => {\n\n    const score = R.clone(test);\n\n    score.success = score.trait ? isTraitAnswerCorrect(score) : isAnswerCorrect(score);\n    score.colour  = score.success ? 'snap-success' : 'snap-alert';\n    \n    return score;\n};","import * as R from 'ramda';\n\nimport { actions } from 'redux/actions/action-creators';\nimport { store } from 'redux/store';\n\nconst getItems = (taxa, includeTechnicalTerms = false) => {\n    \n    const glossary = store.getState().glossary;\n\n    const items = glossary.filter(definition => R.contains(definition.taxon, taxa));\n\n    let selectedItems = [];\n\n    includeTechnicalTerms\n        ? selectedItems = items\n        : selectedItems = items.filter(item => item.technical !== 'true');\n\n    return selectedItems.filter(item => R.contains(item.taxon, taxa));\n};\n\nconst getBranches = items => {\n    \n    let branches = [ ...new Set(items.map(item => item.branch)) ];\n        branches = branches.map(branch => {\n            return {\n                name: branch,\n                count: items.filter(item => item.branch == branch).length\n            }\n          });\n    return branches;\n};\n\nconst getQuickFire = (glossary, type, collection) => {\n\n    const items = collection.terms\n            ? glossary.filter(definition => R.contains(definition.id, collection.terms))\n            : glossary;\n\n    const taxa = [ ...new Set(items.map(definition => definition.taxon))];\n\n    const filter = {\n          iconicTaxa: taxa,\n          option: {\n                key: \"0\",\n                value: \"multiple choice\" // depends on type???\n          }\n    };\n    \n    const quickFire = {\n        index: 0,\n        isComplete: false,\n        items,\n        count: items.length,\n        filter,\n        type,\n        termScore: {\n            total: 0,\n            correct: 0,\n            incorrect: 0,\n            isCorrect: null,\n            isIncorrect: null,\n            rounds: [],\n            passes: [],\n            fails: []\n        },\n        poolSize: items.length,\n        terms: collection.terms,\n        onClickFiltersLinkListeners: [],\n        onClickGlossaryLinkListeners: [],\n        lessonId : collection.id\n    };\n\n    quickFire.filter.taxa = filter.iconicTaxa.map(taxon => {\n        const iconicTaxon = {\n            name: taxon,\n            count: items.filter(item => item.taxon === taxon).length\n        }\n        return iconicTaxon;\n    });\n\n    quickFire.filter.taxa = quickFire.filter.taxa.filter(taxon => taxon.count > 0);\n\n    actions.boundCreateQuickFire(quickFire);\n\n    return quickFire;\n};\n\nexport const quickFireAPI = {\n    getItems,\n    getBranches,\n    getQuickFire\n};","// Module\nvar code = \"<div class=\\\"quick-fire\\\">\\n    \\n    <div class=\\\"margin-left centred-block standard-block padding-top\\\">\\n        Answer <input min=\\\"1\\\" max=\\\"{{ quickFire.count }}\\\" required class=\\\"big half-margin-left half-margin-right js-input-quick-fire\\\" type=\\\"number\\\" value=\\\"{{ quickFire.count }}\\\">\\n        <span class=\\\"landscape\\\">questions selected at random from <span class=\\\"js-quick-fire-count\\\">{{ quickFire.count }}</span> terms.</span>\\n        <span class=\\\"portrait\\\">from <span class=\\\"js-quick-fire-count\\\">{{ quickFire.count }}</span> terms.</span>\\n    </div>\\n\\n    <div class=\\\"landscape half-standard-block\\\"></div>\\n    <div class=\\\"portrait padding\\\"></div>\\n    \\n    <ul class=\\\"quick-fire-taxa margin-left js-quick-fire-taxa\\\" data-repeat-taxon=\\\"{{ quickFire.filter.taxa }}\\\">\\n        <li class=\\\"custom-control custom-checkbox\\\" data-name=\\\"{{ taxon.name }}\\\">\\n            <input type=\\\"checkbox\\\" class=\\\"custom-control-input\\\" id=\\\"{{ taxon.name }}\\\" checked>\\n            <label class=\\\"custom-control-label\\\" for=\\\"{{ taxon.name }}\\\">{{ taxon.name }}</label>\\n            <span data-taxon=\\\"{{ taxon.name }}\\\" class=\\\"\\\">{{ taxon.count }}</span>\\n        </li>\\n    </ul>\\n\\n    <div class=\\\"landscape half-standard-block\\\"></div>\\n    <div class=\\\"portrait padding\\\"></div>\\n\\n    <div class=\\\"btn-group btn-group-toggle quick-fire-branches js-quick-fire-branches\\\" data-toggle=\\\"buttons\\\" data-repeat-branch=\\\"{{ branches }}\\\">\\n        <label data-key=\\\"{{ branch.name }}\\\" class=\\\"btn btn-secondary margin-left active\\\" data-value=\\\"{{ branch.name }}\\\">\\n          <input type=\\\"checkbox\\\" name=\\\"branches\\\" id=\\\"{{ branch.name }}\\\" autocomplete=\\\"off\\\"> {{ branch.name }}\\n          <span data-name=\\\"{{ branch.name }}\\\">{{ branch.count }}</span>\\n        </label>        \\n    </div>\\n\\n    <div class=\\\"landscape half-standard-block\\\"></div>\\n    <div class=\\\"portrait half-padding\\\"></div>\\n\\n    <div class=\\\"btn-group btn-group-toggle margin-left quick-fire-options margin-bottom js-quick-fire-filter-options\\\" data-toggle=\\\"buttons\\\" data-repeat-option=\\\"{{ options }}\\\">\\n        <label data-key=\\\"{{ option.key }}\\\" class=\\\"btn btn-secondary margin-right\\\" data-value=\\\"{{ option.value }}\\\">\\n          <input type=\\\"radio\\\" name=\\\"options\\\" id=\\\"{{ option.key }}\\\" autocomplete=\\\"off\\\"> {{ option.value }}\\n        </label>\\n    </div>\\n\\n    <div class=\\\"landscape half-standard-block\\\"></div>\\n\\n    <div class=\\\"low-relief-block standard-block centred-block horizontal-evenly-spaced-block\\\">\\n        <div class=\\\"custom-control custom-checkbox\\\">\\n            <input type=\\\"checkbox\\\" class=\\\"custom-control-input js-quick-fire-technical\\\" id=\\\"technical\\\">\\n            <label class=\\\"custom-control-label\\\" for=\\\"technical\\\">Include technical (advanced)</label>\\n        </div>\\n        <div>\\n            <div class=\\\"btn snap-action-btn js-quick-fire-reset\\\">Reset filters</div>\\n        </div>\\n    </div>\\n\\n    <div class=\\\"centred-block absolute-bottom\\\">\\n        <button class=\\\"btn snap-action-btn js-create-quick-fire\\\">Start quick-fire review</button>\\n    </div>\\n\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\n\nconst selectAnswers = (quickFire, quickFireItems) => {\n\n    quickFire.spareItems = quickFire.spareItems || R.take(5, quickFireItems);\n\n    quickFire.question = quickFireItems.splice(0,1)[0];\n\n    let items = quickFireItems.filter(item => item.branch === quickFire.question.branch);\n\n    const itemCount = items ? items.length : 0;\n    const requiredItems = 3;\n\n    if (itemCount <= requiredItems) {\n        const itemsToAdd = R.take((requiredItems - itemCount), quickFire.spareItems.filter(sp => !R.contains(sp.term, items.map(i => i.term)) && sp.term !== quickFire.question.term ));\n              itemsToAdd.forEach(item => items.push(item));\n    }\n\n    let answers = R.take(3, items);\n        answers.push(quickFire.question);\n        answers = utils.shuffleArray(answers);\n        answers = answers.map((item, index) => {\n            return {\n                term: item.term,\n                index\n            };\n        });\n\n    return answers;\n};\n\nexport const quickFireLogic = {\n    selectAnswers\n};","// Module\nvar code = \"<div class=\\\"quick-fire\\\">\\n\\n    <div class=\\\"margin-left centred-block standard-block justify-space-between\\\">\\n        <h2>\\n            <span>Question {{ total }} of {{ count }}</span>\\n        </h2>\\n        <div class=\\\"margin-right\\\">\\n            <button class=\\\"btn snap-btn small-text js-quick-review-progress\\\">Progress</button>\\n        </div>\\n    </div>\\n\\n    <div class=\\\"centred-block double-standard-block modal-background-relief border-light js-quick-fire-definition\\\">\\n        <span class=\\\"padding\\\">{{ question.definition }}</span>\\n    </div>\\n\\n    <ul id=\\\"0\\\" class=\\\"strips description margin-top js-quick-layouts js-quick-fire-options\\\" data-repeat-answer=\\\"{{ answers }}\\\">\\n        <li class=\\\"strip\\\" id=\\\"{{ answer.term }}\\\" role=\\\"group\\\" aria-label=\\\"answers to the question\\\">\\n            <button class=\\\"snap-icon-btn\\\" data-answer-index=\\\"{{ answer.index }}\\\">\\n                <span>{{ answer.term }}</span>\\n            </button>\\n          </li>\\n      </ul>\\n\\n    <div id=\\\"1\\\" class=\\\"hide vertical-block centred-block margin-top js-quick-layouts quick-fire-text-entry js-quick-fire-text-entry\\\">\\n        <div class=\\\"centred-block standard-block\\\">\\n            <input type=\\\"text\\\" placeholder=\\\"Enter the term that fits this description\\\">\\n        </div>\\n        <div class=\\\"half-standard-block\\\">\\n            <div class=\\\"hide centered-block js-quick-fire-hint\\\">\\n                <span class=\\\"margin-left latin\\\">Hint: </span><span>The answer has two words.</span>\\n            </div>\\n        </div>\\n        \\n    </div>\\n\\n    <div class=\\\"vertical-centred-block centred-block absolute-bottom\\\">\\n\\n      <div class=\\\"margin-left centred-block standard-block js-quick-fire-message\\\"></div>\\n\\n      <div class=\\\"half-standard-block\\\">\\n          Score {{ correct }} of {{ answered }}\\n      </div>  \\n\\n      <div class=\\\"action-update\\\">\\n          <button disabled class=\\\"btn snap-action-btn js-continue-quick-fire-btn\\\">Continue lesson</button>\\n      </div>\\n    </div>\\n\\n</div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"quick-fire\\\">\\n\\n    <div class=\\\"justify-space-between centred-block margin-left standard-block js-quick-fire-summary\\\">\\n        <div>\\n            <span>You have answered all of the questions.</span>\\n        </div>\\n        <div class=\\\"margin-right padding-left nowrap\\\">\\n          <button class=\\\"btn snap-btn small-text js-quick-review-continue-review\\\">Vocab</button>\\n        </div>\\n    </div>\\n\\n    <div class=\\\"border-light standard-block padding-left centred-block modal-background-relief js-score-text-summary\\\">\\n        You have scored {{ score.correct }} out of {{ score.total }} so far.\\n    </div>\\n\\n    <ul class=\\\"margin-top nav nav-pills nav-fill quick-review-tabs js-quick-review-tabs mb-3\\\" role=\\\"tablist\\\">\\n        <li class=\\\"nav-item\\\">\\n            <a class=\\\"nav-link\\\" href=\\\"#\\\" id=\\\"js-quick-review-correct\\\" data-toggle=\\\"pill\\\" role=\\\"tab\\\">\\n                <span class=\\\"landscape\\\">Correct answers</span>\\n                <span class=\\\"portrait\\\">Correct</span>\\n            </a>\\n        </li>\\n        <li class=\\\"nav-item\\\">\\n            <a class=\\\"nav-link active\\\" href=\\\"#\\\" id=\\\"js-quick-review-incorrect\\\" data-toggle=\\\"pill\\\" role=\\\"tab\\\">\\n                <span class=\\\"landscape\\\">Incorrect answers</span>\\n                <span class=\\\"portrait\\\">Incorrect</span>\\n            </a>\\n        </li>\\n      </ul>\\n\\n    <div class=\\\"scrollable accordions-container\\\">\\n\\n        <div id=\\\"accordion-correct\\\" data-type=\\\"js-quick-review-correct\\\" class=\\\"hide-important quick-review-answers js-quick-review-answers\\\" data-repeat-pass=\\\"{{ passes }}\\\">\\n            <div class=\\\"card quick-fire-summary-row margin-bottom\\\">\\n                <div class=\\\"card-header capitalise\\\" id=\\\"pass_header_{{ pass.index }}\\\">\\n                <div data-toggle=\\\"collapse\\\" data-target=\\\"#pass_target_{{ pass.index }}\\\" aria-expanded=\\\"true\\\" aria-controls=\\\"pass_target_{{ pass.index }}\\\">\\n                    <div>{{ pass.term }}</div>                    \\n                </div>\\n                </div>\\n            </div>\\n            <div id=\\\"pass_target_{{ pass.index }}\\\" class=\\\"collapse\\\" aria-labelledby=\\\"pass_header_{{ pass.index }}\\\" data-parent=\\\"#accordion-correct\\\">\\n                <div class=\\\"card-body\\\">\\n                    <div>{{ pass.definition }}</div>\\n                    <div class=\\\"centred-block half-standard-block\\\">\\n                      <span class=\\\"sr-only\\\">Opens in new window</span>\\n                      <a class=\\\"small-text underline-link underline-link-left-margin {{ pass.showWikiClass }}\\\" href=\\\"{{ pass.wiki }}\\\" target=\\\"_blank\\\">\\n                        <span class=\\\"sr-only\\\">Opens in new window</span>\\n                        <span>View Wikipedia page for {{ pass.term }} in a new window</span>\\n                        <i aria-hidden=\\\"true\\\" class=\\\"super fas fa-external-link-alt\\\"></i>\\n                      </a>                      \\n                    </div>\\n                </div>\\n            </div>\\n        </div>\\n\\n        <div id=\\\"accordion-incorrect\\\" data-type=\\\"js-quick-review-incorrect\\\" class=\\\"quick-review-answers js-quick-review-answers\\\" data-repeat-fail=\\\"{{ fails }}\\\">\\n            <div class=\\\"card quick-fire-summary-row margin-bottom\\\">\\n                <div class=\\\"card-header capitalise\\\" id=\\\"fail_header_{{ fail.index }}\\\">\\n                <div data-toggle=\\\"collapse\\\" data-target=\\\"#fail_target_{{ fail.index }}\\\" aria-expanded=\\\"true\\\" aria-controls=\\\"fail_target_{{ fail.index }}\\\">\\n                    <div>{{ fail.term }}</div>\\n                </div>\\n                </div>\\n            </div>\\n            <div id=\\\"fail_target_{{ fail.index }}\\\" class=\\\"collapse\\\" aria-labelledby=\\\"fail_header_{{ fail.index }}\\\" data-parent=\\\"#accordion-incorrect\\\">\\n                <div class=\\\"card-body\\\">\\n                    <div>{{ fail.definition }}</div>\\n                    <div class=\\\"centred-block half-standard-block\\\">\\n                      <a class=\\\"small-text underline-link underline-link-left-margin {{ fail.showWikiClass }}\\\" href=\\\"{{ fail.wiki }}\\\" target=\\\"_blank\\\">\\n                        <span class=\\\"sr-only\\\">Opens in new window</span>\\n                        <span>View Wikipedia page for {{ fail.term }} in a new window</span>\\n                        <i aria-hidden=\\\"true\\\" class=\\\"super fas fa-external-link-alt\\\"></i>\\n                      </a>\\n                    </div>\\n                    <div class=\\\"small-text margin-top\\\"><span>You answered: </span><span>{{ fail.answer }}</span></div>\\n                </div>\\n            </div>\\n        </div>\\n\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { enums } from 'ui/helpers/enum-helper';\n\nconst renderResponse = (isCorrect, term) => {\n    return isCorrect\n    ? `<span class=\"centred-block icon\"><i class=\"fas fa-check extra-large-text correct-answer-color margin-right\"></i>That is correct.</span>`\n    : `<span class=\"centred-block icon\"><i class=\"fas fa-times extra-large-text incorrect-answer-color margin-right\"></i>The correct answer is <span class=\"answer-response half-margin-left\">'${term}'.</span></span>`;\n\n};\n\nconst updateBranchCounts = (quickFire, branchOptions) => {\n\n    const items = quickFire.terms ? quickFire.items.filter(item => R.contains(item.id, quickFire.terms)) : quickFire.items;\n\n    branchOptions.forEach(branchBadge => {\n    branchBadge.innerHTML = items.filter(item => item.branch === branchBadge.dataset.name).length;\n    });\n};\n\nconst updateTaxonCounters = (quickFire, taxonCounters, includeTechnicalTerms) => {\n\n    const items = quickFire.terms ? quickFire.items.filter(item => R.contains(item.id, quickFire.terms)) : quickFire.items;\n\n    taxonCounters.forEach(taxonBadge => {\n        taxonBadge.innerHTML = includeTechnicalTerms\n            ? items.filter(item => item.taxon === taxonBadge.dataset.taxon).length\n            : items.filter(item => item.taxon === taxonBadge.dataset.taxon && !item.technical).length;\n    });\n\n    return includeTechnicalTerms\n        ? items\n        : items.filter(item => !item.technical);\n};\n\nconst updateTotalCounts = (quickFire, input, counters, branchCounters, taxonCounters, includeTechnicalTerms = false) => {\n\n    updateBranchCounts(quickFire, branchCounters);\n    const terms = updateTaxonCounters(quickFire, taxonCounters, includeTechnicalTerms);\n\n    quickFire.count = terms.length;\n\n    counters.forEach(counter => {\n        counter.innerHTML = quickFire.count;\n    });\n    \n    input.value = quickFire.count;\n    quickFire.poolSize = parseInt(input.value);\n};\n\nconst scoreMultipleChoice = (quickFire, answer, quickFireMessage) => {\n\n    const isCorrect = answer === quickFire.question.term;\n\n    quickFire.question.answer = answer;\n        \n    quickFire.termScore.total++;\n\n    if(isCorrect) {\n        quickFire.termScore.correct++;\n        quickFire.termScore.isCorrect = true;\n        quickFire.termScore.isIncorrect = false;\n        quickFire.termScore.passes.push(quickFire.question);\n    } else {\n        quickFire.termScore.incorrect++;\n        quickFire.termScore.isCorrect = false;\n        quickFire.termScore.isIncorrect = true;\n        quickFire.termScore.fails.push(quickFire.question);\n    }\n\n    quickFireMessage.innerHTML = renderResponse(isCorrect, quickFire.question.term.toLowerCase());\n};\n\nconst scoreTextEntry = (quickFire, quickFireInput, quickFireMessage, timer, continueQuickFireBtn) => {\n\n    if (quickFire.filter.option.key === '1') {\n\n        const brackets = /\\(.+?\\)/;\n\n        const term = quickFire.question.term;\n\n        const acceptableAnswers = term.split(',').map(answer => {\n            \n            let acceptable = answer;\n                acceptable = acceptable.replace(brackets, '');\n                acceptable = acceptable.trim();\n                acceptable = acceptable.toLowerCase();\n\n            return acceptable;\n        });\n        \n        const isCorrect = R.contains(quickFireInput.value.trim().toLowerCase(), acceptableAnswers);\n        \n        quickFire.termScore.total++;\n        \n        if (isCorrect) {\n            quickFire.termScore.correct++;\n            quickFire.termScore.passes.push(quickFire.question);\n        }\n        else {\n            quickFire.termScore.incorrect++;\n            quickFire.termScore.fails.push(quickFire.question);\n        }\n        \n        quickFireMessage.innerHTML = renderResponse(isCorrect, quickFire.question.term.toLowerCase());\n\n        timer = setTimeout(() => {\n            continueQuickFireBtn.click();\n        }, store.getState().config.callbackTime + 500);\n    }\n\n    return timer;\n};\n\nconst readyTemplate = headerTemplate => {\n\n    const template = document.createElement('template');\n          template.innerHTML = headerTemplate;\n\n    const modal = document.querySelector('#glossaryModal');\n\n    const parent = modal.querySelector('.js-modal-text');\n          parent.innerHTML = '';   \n\n    return { template, modal, parent };\n};\n\nconst updateHeaders = (screen, links, getQuickFire, quickFireActions) => {\n\n    const { glossary, filters, questions } = links;\n\n    const hide = 'hide-important';\n\n    const quickFire = getQuickFire();\n\n    const loadGlossary = e => {\n        quickFireActions.quickFireGlossary(quickFire.items);\n        if(quickFire.linkFromLesson) {\n            questions.classList.remove(hide);\n            filters.classList.add(hide);\n        } else {\n            filters.classList.remove(hide);\n        }\n    };\n\n    const loadFilters = e => {\n        quickFireActions.quickFireFilters(quickFire.linkFromLesson);\n    };\n\n    const handleGlossaryLink = () => {\n\n        quickFire.onClickGlossaryLinkListeners = quickFire.onClickGlossaryLinkListeners || [];\n\n        if(quickFire.onClickGlossaryLinkListeners.length < 1) {\n            glossary.addEventListener('click', loadGlossary, { once: true });\n            quickFire.onClickGlossaryLinkListeners.push('filters');\n        }\n    };\n\n    const handleFiltersLink = () => {\n\n        quickFire.onClickFiltersLinkListeners = quickFire.onClickFiltersLinkListeners || [];\n\n        if(quickFire.onClickFiltersLinkListeners.length < 1) {\n            filters.addEventListener('click', loadFilters, { once: true }, true);\n            quickFire.onClickFiltersLinkListeners.push('filters');\n        }\n    };\n    \n    switch(screen) {        \n        case enums.quickFireStep.FILTERS:\n            filters.classList.add(hide);\n            glossary.classList.remove(hide);\n            handleGlossaryLink();\n        break;\n            \n        case enums.quickFireStep.QUESTIONS:\n            filters.classList.remove(hide);\n            filters.innerHTML = 'Vocab filter';\n            handleGlossaryLink();\n            handleFiltersLink();\n        break;\n\n        case enums.quickFireStep.GLOSSARY:\n            filters.classList.remove(hide);\n            filters.innerHTML = 'Vocab filter';\n            questions.classList.add(hide);\n            handleFiltersLink();\n        break;\n    }\n};\n\nexport const quickFireUI = {\n    updateTotalCounts,\n    updateHeaders,\n    scoreMultipleChoice,\n    scoreTextEntry,\n    readyTemplate\n};","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { utils } from 'utils/utils';\nimport { elem } from 'ui/helpers/class-behaviour';\nimport { actions } from 'redux/actions/action-creators';\nimport { subscription } from 'redux/subscriptions';\nimport { iconicTaxa  } from 'api/snapdragon/iconic-taxa';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { quickFireAPI } from 'ui/quick-fire-modal/quick-fire-api';\nimport { quickFireUI } from 'ui/quick-fire-modal/quick-fire-ui';\nimport { quickFireLogic } from 'ui/quick-fire-modal/quick-fire-logic';\n\nimport glossaryTemplate from 'ui/fixtures/glossary-template.html';\nimport templateCreateQuickFire from 'ui/quick-fire-modal/quick-fire-filters-template.html';\nimport templateQuestionQuickFire from 'ui/quick-fire-modal/quick-fire-questions-template.html';\nimport templateSummaryQuickFire from 'ui/quick-fire-modal/quick-fire-summary-template.html';\n\nconst headers = (step, quickFire) => {\n\n    const getQuickFire = () => quickFire;\n\n    const modal = document.querySelector('#glossaryModal');\n\n    const links = { \n        glossary: modal.querySelector('.js-modal-text-title'),\n        filters: modal.querySelector('.js-quick-fire-filters'),\n        questions: modal.querySelector('.js-quick-fire-questions')\n    };\n\n    quickFireUI.updateHeaders(step, links, getQuickFire, quickFireActions);\n};\n\nconst filters = async linkFromLesson => {\n\n    const args = await init();\n\n    const { template, modal, parent } = quickFireUI.readyTemplate(templateCreateQuickFire);\n\n    headers(enums.quickFireStep.FILTERS, { items: args.items, onClickFiltersLinkListeners: [], onClickGlossaryLinkListeners: [] });\n\n    let { items, type, filter } = args;\n\n    const resetQuickFire = () => {\n        actions.boundUpdateQuickFire(quickFireAPI.getQuickFire(store.getState().glossary, enums.quickFireType.DEFINITION, {}));\n        quickFireFilters(quickFire.linkFromLesson);\n    };\n\n    let state = store.getState().quickFire || quickFireAPI.getQuickFire(items, filter, type);\n    let quickFire = R.clone(state);\n        quickFire = quickFire.isComplete ? resetQuickFire() : quickFire;\n        quickFire.linkFromLesson = linkFromLesson || false;\n        quickFire.onClickFiltersLinkListeners = [];\n        quickFire.onClickGlossaryLinkListeners = [];\n\n    actions.boundUpdateQuickFire(quickFire);\n\n    const options = [\n        { key: 0, value: 'multiple choice' },\n        { key: 1, value: 'text entry' },\n        // { key: 2, value: 'multiple choice followed by text entry' },\n        // { key: 3, value: 'mixed multiple choice and text entry' },\n    ];\n\n    const branches = quickFireAPI.getBranches(items);\n\n    renderTemplate({ quickFire, options, branches }, template.content, parent);\n\n    const counters = document.querySelectorAll('.js-quick-fire-count');\n    const branchCounters = document.querySelectorAll('.js-quick-fire-branches label > span');\n    const taxonCounters = document.querySelectorAll('.js-quick-fire-taxa li > span');\n\n    const input = document.querySelector('.js-input-quick-fire');\n          input.addEventListener('input', e => {\n            quickFire.poolSize = parseInt(e.target.value);          \n          });\n          setTimeout(() => {\n            input.focus();\n          }, 250);\n\n    quickFire.poolSize = parseInt(input.value);\n\n    const updateArray = (arr, elem) => {\n        if(arr.find(e => e === elem)) {\n            return arr.filter(iconicTaxon => iconicTaxon !== elem); \n        } else {\n            arr.push(elem);\n            return arr;\n        }\n    };\n\n    const getFilterTaxa = () => quickFire.filter.iconicTaxa;\n\n    const taxa = document.querySelectorAll('.js-quick-fire-taxa li');\n          taxa.forEach(taxon => {\n\n              const chkBox = taxon.querySelector('input');\n\n              if(!R.contains(taxon.dataset.name, quickFire.filter.iconicTaxa)) {\n                  chkBox.click();\n              }\n\n              taxon.addEventListener('change', async e => {\n                const selectedTaxon = e.target.id;\n                const updatedTaxa = updateArray(getFilterTaxa(getIncludeTechnicalTerms), selectedTaxon);\n                quickFire.filter.iconicTaxa = updatedTaxa;\n                quickFire.items = quickFireAPI.getItems(updatedTaxa);\n                quickFireUI.updateTotalCounts(quickFire, input, counters, branchCounters, taxonCounters, getIncludeTechnicalTerms());\n              });\n          });\n\n    let includeTechnicalTerms = quickFire.lessonId ? true : false;\n\n    const getIncludeTechnicalTerms = () => includeTechnicalTerms;\n      \n    quickFireUI.updateTotalCounts(quickFire, input, counters, branchCounters, taxonCounters, getIncludeTechnicalTerms());\n\n    const createQuickFireBtn = document.querySelector('.js-create-quick-fire');\n          createQuickFireBtn.innerHTML = quickFire.termScore.total === 0 ? 'Start vocab review' : 'Continue your vocab review';\n          createQuickFireBtn.addEventListener('click', e => {\n            questions(quickFire);\n          }, { once: true });\n\n    const quickFireOptions = document.querySelectorAll('.js-quick-fire-filter-options .btn');\n    \n    quickFire.filter.option.key === \"0\"\n      ? quickFireOptions[0].click()\n      : quickFireOptions[1].click();\n    \n    quickFireOptions[parseInt(quickFire.filter.option.key)].classList.add('active');\n\n    quickFireOptions[0].addEventListener('click', e => {\n      e.preventDefault();\n      if(!elem.hasClass(e.target, 'active')) {\n        e.target.classList.add('active');\n        quickFire.filter.option = {\n            key: e.target.dataset.key,\n            value: e.target.dataset.value\n        };\n        quickFireOptions[1].classList.remove('active');\n      }\n    });        \n\n    quickFireOptions[1].addEventListener('click', e => {\n      e.preventDefault();\n      if(!elem.hasClass(e.target, 'active')) {\n        e.target.classList.add('active');\n        quickFire.filter.option = {\n            key: e.target.dataset.key,\n            value: e.target.dataset.value\n        };\n        quickFireOptions[0].classList.remove('active');\n      }\n    });        \n\n    const branchOptions = document.querySelectorAll('.js-quick-fire-branches label');\n\n    if(quickFire.filter.branches) {\n\n        branchOptions.forEach(branch => {\n            if(!R.contains(branch.dataset.key, quickFire.filter.branches)) {\n                branch.click();\n            }\n        });    \n    }\n\n    branchOptions.forEach(branch => {\n        branch.addEventListener('click', e => {\n        setTimeout(async() => {\n                let checkedBranches = Array.from(branchOptions).filter(b => elem.hasClass(b, 'active'));\n                    checkedBranches = checkedBranches.map(b => b.dataset.key);\n                quickFire.filter.branches = checkedBranches;\n                quickFire.items = await quickFireAPI.getItems(quickFire.filter.iconicTaxa);\n                quickFire.items = quickFire.items.filter(item => R.contains(item.branch, checkedBranches));\n                quickFireUI.updateTotalCounts(quickFire, input, counters, branchCounters, taxonCounters, getIncludeTechnicalTerms());\n            });\n        });\n    });\n\n    const technical = document.querySelector('.js-quick-fire-technical');\n          technical.addEventListener('change', async e => {\n            includeTechnicalTerms = e.target.checked;\n            quickFire.filter.includeTechnicalTerms = includeTechnicalTerms;\n            quickFire.items = quickFire.items || await quickFireAPI.getItems(quickFire.filter.iconicTaxa, includeTechnicalTerms);\n            quickFireUI.updateTotalCounts(quickFire, input, counters, branchCounters, taxonCounters, getIncludeTechnicalTerms());\n          });\n\n    if(includeTechnicalTerms) technical.click();\n\n    const reset = document.querySelector('.js-quick-fire-reset');\n          reset.addEventListener('click', e => {\n            resetQuickFire();\n          });\n};\n\nconst questions = state => {\n\n    let quickFire;\n\n    if(!state) return;\n    else quickFire = R.clone(state);\n\n    quickFire.onClickGlossaryLinkListeners = [];\n\n    headers(enums.quickFireStep.QUESTIONS, quickFire);\n\n    const { template, modal, parent } = quickFireUI.readyTemplate(templateQuestionQuickFire);\n\n    let timer;    \n\n    if(quickFire.poolSize > quickFire.termScore.total) {\n\n        let answers = quickFireLogic.selectAnswers(quickFire, utils.shuffleArray(quickFire.items));\n\n        renderTemplate({ question: quickFire.question, \n                answers, total: quickFire.termScore.total + 1, \n                count: quickFire.poolSize,\n                correct: quickFire.termScore.correct, \n                answered: quickFire.termScore.total \n        }, template.content, parent);\n\n        const layouts = document.querySelectorAll('.js-quick-layouts');\n              layouts.forEach(layout => {\n                  layout.classList.add('hide-important');\n                  if(layout.id === quickFire.filter.option.key) layout.classList.remove('hide-important');  \n              });\n\n        const quickFireMessage = document.querySelector('.js-quick-fire-message');\n\n        const options = Array.from(document.querySelectorAll('.js-quick-fire-options > li'));\n              options.forEach(option => {\n                option.addEventListener('click', e => {\n                    const button = e.target;\n                    const term = button.querySelector('span').innerHTML;\n                    const answer = term;\n                    quickFireUI.scoreMultipleChoice(quickFire, answer, quickFireMessage);\n                    continueQuickFireBtn.disabled = false;\n                    if(quickFire.termScore.isIncorrect) {\n                        option.classList.add('snap-alert');\n                    }\n                    options.forEach(option => {\n                        if(option.id === quickFire.question.term) {\n                            option.classList.add('snap-success');\n                        }\n                    });\n                    timer = setTimeout(() => {\n                        continueQuickFireBtn.click();\n                    }, store.getState().config.callbackTime);\n                }, { once: true });\n              });\n              setTimeout(() => {\n                options[0].querySelector('button').focus();\n              }, 500);\n\n        const quickFireInputContainer = modal.querySelector('.js-quick-fire-text-entry');\n        const quickFireInput = modal.querySelector('.js-quick-fire-text-entry input');\n        \n        if(quickFire.filter.option.key === '1') {\n            quickFireInputContainer.classList.remove('hide-important');\n            quickFireInput.focus();\n        }\n        \n        const continueQuickFireBtn = document.querySelector('.js-continue-quick-fire-btn');\n              continueQuickFireBtn.addEventListener('click', e => {\n                continueQuickFireBtn.setAttribute(\"disabled\", true);\n                quickFire.items = quickFire.items.filter(item => item.term !== quickFire.question.term);\n                subscription.add(quickFireQuestions, 'quickFire', 'modal');\n                actions.boundUpdateQuickFire(quickFire);\n                clearTimeout(timer);        \n              }, { once: true });\n\n        let check = true;\n\n        quickFireInput.addEventListener('keydown', event => {\n            if (event.keyCode == 9 && check) {\n                check = false;\n                timer = quickFireUI.scoreTextEntry(quickFire, quickFireInput, quickFireMessage, timer, continueQuickFireBtn);\n                continueQuickFireBtn.disabled = false;\n            }\n        });\n\n        quickFireInput.addEventListener('keypress', event => {\n            if (event.keyCode == 13 && check) {\n                check = false;\n                timer = quickFireUI.scoreTextEntry(quickFire, quickFireInput, quickFireMessage, timer, continueQuickFireBtn);\n                continueQuickFireBtn.disabled = false;\n            }            \n        });\n\n        quickFireInput.addEventListener('blur', e => {\n            if(check && e.target.value.length > 2) {\n                check = false;\n                timer = quickFireUI.scoreTextEntry(quickFire, quickFireInput, quickFireMessage, timer, continueQuickFireBtn);\n                continueQuickFireBtn.disabled = false;\n            }\n        });\n\n        if((quickFire.question.term.split(' ').length > 1 || quickFire.question.term.indexOf('(') === 0) && quickFire.filter.option.key === '1') {\n            const hint = modal.querySelector('.js-quick-fire-hint');\n                  hint.classList.remove('hide');\n        }\n\n    } else {\n        summary(quickFire);        \n    }\n    \n    const review = modal.querySelector('.js-quick-review-progress');\n    if(review) {\n          review.addEventListener('click', e => {\n            summary(quickFire);\n          }, { once: true });\n    }\n};\n\nconst getTermsGlossary = (glossary, terms) => {\n\n    if(!terms || terms.length === 0) return glossary;\n\n    const definitions = [];\n\n    terms.forEach(term => {\n        const definition = glossary.find(def => def.id === term);\n        definitions.push(definition);\n    });\n\n    return definitions.filter(term => term);\n}\n\nconst definitions = async terms => {\n\n    const { template, modal, parent } = quickFireUI.readyTemplate(glossaryTemplate);\n\n    const quickFire = store.getState().quickFire || quickFireAPI.getQuickFire(terms, enums.quickFireType.DEFINITION, { collection: {} });\n\n    headers(enums.quickFireStep.GLOSSARY, quickFire);\n\n    parent.innerHTML = '';\n\n    const glossary = getTermsGlossary(terms, quickFire.terms);\n\n    renderTemplate({ glossary }, template.content, parent);\n};\n\nconst init = async () => {\n\n    let taxa = [];\n    let iconicTaxaKeys = Object.keys(iconicTaxa).map(key => key.toLowerCase());\n        iconicTaxaKeys.push('common');\n        iconicTaxaKeys.forEach(taxon => {\n            taxa.push(taxon);\n        });\n\n    const { quickFire } = store.getState();\n\n    const items = quickFire.items || await quickFireAPI.getItems(taxa);\n        \n    const args = {\n        items,\n        type: enums.quickFireType.DEFINITION,\n        filter: {\n            iconicTaxa: taxa\n        }\n    };\n    return args;\n};\n\nconst summary = quickFire => {\n\n    const { template, modal, parent } = quickFireUI.readyTemplate(templateSummaryQuickFire);\n\n    const passes = quickFire.termScore.passes;\n          passes.forEach((pass, i) => {\n            pass.index = i;\n            pass.wiki = pass.wiki || '';\n            pass.showWikiClass = pass.wiki.length > 0 ? '' : 'hide-important'\n          });\n    const fails = quickFire.termScore.fails;\n          fails.forEach((fail, i) => {\n            fail.index = i;\n            fail.wiki = fail.wiki || '';\n            fail.showWikiClass = fail.wiki.length > 0 ? '' : 'hide-important';\n          });\n\n    renderTemplate({ score: quickFire.termScore, passes, fails }, template.content, parent);\n\n    const answers = modal.querySelectorAll('.js-quick-review-answers');\n    const tabs = modal.querySelectorAll('.js-quick-review-tabs a');\n    \n    tabs.forEach(tab => {\n        tab.addEventListener('click', e => {\n            const type = e.target.id;\n            answers.forEach(t => {\n                t.dataset.type === type\n                    ? t.classList.remove('hide-important')\n                    : t.classList.add('hide-important');\n            });\n        });\n    });\n\n    const summaryText = modal.querySelector('.js-quick-fire-summary div:nth-child(1) > span');\n    const scoreSummary = modal.querySelector('.js-score-text-summary');\n    const continueReview = modal.querySelector('.js-quick-review-continue-review');\n\n    quickFire.isComplete = quickFire.poolSize === quickFire.termScore.total;\n\n    if(quickFire.isComplete) {\n        summaryText.innerHTML = '<span class=\"emphasis\">You have answered all of the questions correctly.</span>';\n        scoreSummary.classList.add('modal-background-relief-emphasis');\n        scoreSummary.innerHTML = `You scored ${quickFire.termScore.correct} out of ${quickFire.termScore.total}.`;        \n        if(quickFire.termScore.incorrect > 0) {\n            summaryText.innerHTML = `<span class=\"emphasis\">You've answered the questions, but not all correctly.</span>`;\n            continueReview.innerHTML = `<span>Continue</span>`;            \n            continueReview.addEventListener('click', e => {\n                const quickFireRevision = quickFireAPI.getQuickFire(quickFire.termScore.fails, enums.quickFireType.DEFINITION, {});\n                quickFireQuestions(quickFireRevision);\n            }, { once: true });            \n        } else {\n            continueReview.classList.add('hide-important');\n            continueReview.addEventListener('click', e => {\n                questions(quickFire);\n            }, { once: true });\n        }\n    } else {\n        summaryText.innerHTML = `<span>You have answered ${quickFire.termScore.total} of ${quickFire.poolSize} questions.</span>`;\n        continueReview.addEventListener('click', e => {\n            questions(quickFire);\n        }, { once: true });\n    }\n};\n\nexport const quickFireHandlers = {\n    filters,\n    questions,\n    headers,\n    init: quickFireAPI.getQuickFire,\n    definitions\n};\n\nconst quickFireFilters = linkFromLesson => {\n    quickFireHandlers.filters(linkFromLesson);\n};\n\nconst quickFireQuestions = quickFire => {\n    quickFireHandlers.questions(quickFire);\n};\n\nconst quickFireGlossary = glossary => {\n    quickFireHandlers.definitions(glossary);\n};\n\nconst quickFireActions = {\n    quickFireFilters,\n    quickFireQuestions,\n    quickFireGlossary\n};","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { renderSpecimenTiles } from 'ui/screens/landscape/specimen-tiles';\nimport { renderMixedSpecimenImages } from 'ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images';\n\nexport const renderBonusSpecimenTiles = bonusLayout => {\n\n    const collection = R.clone(store.getState().collection);\n          collection.nextItem = bonusLayout.item;\n          collection.nextItem = collection.nextItem || collection.items[collection.itemIndex];\n    \n    const lookalikesCount = bonusLayout.item \n            ? bonusLayout.overrides.trait.lookalikes ? bonusLayout.overrides.trait.lookalikes.length + 1 : 0 // lookalikes + item itself\n            : 0;\n\n    if(lookalikesCount > 0) {\n        let noOfImagesPerItem = 6 / lookalikesCount;\n        // renderMixedSpecimenImages(collection, noOfImagesPerItem, [ collection.nextItem, ...bonusLayout.overrides.trait.lookalikes]);\n    } else {\n        renderSpecimenTiles(collection);\n    }\n\n};","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { renderMultiStrips } from 'ui/screens/multichoice/multi-strips';\nimport { renderMixedSpecimenQuestion } from 'ui/screens/multichoice/landscape/mixed-specimen/right/mixed-specimen-question';\n\nexport const renderBonusTest = bonusLayout => {\n\n    const collection = R.clone(store.getState().collection);\n\n    collection.nextItem = bonusLayout.item;\n\n    if(bonusLayout.overrides && bonusLayout.overrides.trait && bonusLayout.overrides.trait.name === 'lookalikes') {\n        collection.items = [ ...bonusLayout.overrides.trait.lookalikes, collection.nextItem ];\n        renderMixedSpecimenQuestion(collection, bonusLayout);\n    } else {        \n        renderMultiStrips(collection, bonusLayout);\n    }\n\n};\n","// Module\nvar code = \"<div class=\\\"snapdragon-container\\\">\\n    <div class=\\\"cultivar revision card\\\">\\n        <div class=\\\"taxon-highlight\\\"><span>{{ item.name }}</span><hr></div>\\n        <div class=\\\"title\\\">The following cultivars are all derived from the single species {{ item.name }}:</div>\\n        <div>\\n            <div class=\\\"list-group-headers\\\">\\n                <span>Name</span><span>Variety</span><span class=\\\"landscape\\\">Form</span><span class=\\\"landscape\\\">More</span>\\n            </div>        \\n            <div class=\\\"scrollable\\\">\\n                <ul class=\\\"list-group list-group-flush\\\" data-repeat-cultivar=\\\"{{ cultivars }}\\\">\\n                    <li class=\\\"list-group-item\\\">\\n                        <span>{{ cultivar.vernacular }}</span>\\n                        <span>{{ cultivar.variety }}</span>\\n                        <span class=\\\"landscape\\\">{{ cultivar.form }}</span>\\n                        <span class=\\\"landscape\\\"><a class=\\\"underline-link\\\" href=\\\"{{ cultivar.wiki }}\\\" title=\\\"{{ cultivar.wikiAlt }}\\\">WIKI</a> <a class=\\\"underline-link\\\" href=\\\"{{ cultivar.eol }}\\\" target=\\\"_blank\\\" title=\\\"{{ cultivar.eolAlt }}\\\">EOL</a></span>\\n                    </li>\\n                </ul>\\n            </div>\\n        </div>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport cultivarTemplate from 'ui/screens/cards/cultivar-card-template.html';\n\nexport const renderCultivarCard = collection => {\n\n    const item = collection.nextItem;\n    const { lessonPlan, layout, config } = store.getState();\n\n    const cultivarCollection = lessonPlan.layouts.find(layout => layout.name === 'screen-cultivar-card').cultivars;\n\n    const cultivars = cultivarCollection.subspecies.map(sub => {\n        let locale = sub.names.find(n => n.language === config.language);\n        locale = locale || sub.names.find(n => n.language === 'en');\n        return {\n            vernacular: locale.vernacularName || '',\n            variety: sub.variety || '',\n            form: sub.form || '',\n            eol: locale.eol || '',\n            eolAlt: locale.eol || 'N/A',\n            wiki: locale.wiki || '',\n            wikiAlt: locale.wiki || 'N/A'\n        }\n    });\n\n    const template = document.createElement('template');\n\n    template.innerHTML = cultivarTemplate;\n\n    const parent = DOM.rightBody;\n    parent.innerHTML = '';\n\n    const context = {\n        rank: 'cultivar',\n        item: item,\n        cultivars: cultivars\n    }\n\n    renderTemplate(context, template.content, parent);\n\n    document.querySelectorAll('[title=\"N/A\"]').forEach(a => a.style.display = 'none');\n};","import { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { modalImagesHandler } from 'ui/helpers/image-handler';\nimport { subscribeToNonTaxaSelection } from 'ui/screens/cards/non-taxon-card';\nimport specimensTemplate from 'ui/screens/landscape/specimen-tiles-template.html';\n\nexport const renderNonTaxonCardSpecimenTiles = collection => {\n\n    const { config } = store.getState(); \n\n    const callback = images => {\n\n        const template = document.createElement('template');\n\n        template.innerHTML = specimensTemplate;\n\n        const parent = DOM.leftBody;\n        parent.innerHTML = '';\n\n        renderTemplate({images}, template.content, parent);\n\n        modalImagesHandler(document.querySelectorAll('.js-tiles .square'), null, collection, config);\n    };\n\n    const item = collection.nextItem;\n\n    if(!item) return;\n\n    subscribeToNonTaxaSelection(callback);    \n};","import { lessonListScrollHandler } from 'ui/screens/lists/lesson-list-scroll-handler';\nimport { renderLessons } from 'ui/screens/lists/lesson-list';\n\nconst onCloseModal = () => {\n\n    const modal = document.querySelector('#lessonModal');\n    const closer = modal.querySelector('.js-modal-footer');\n          closer.addEventListener('click', e => {\n            const contents = modal.querySelector('.js-modal-text');\n                  contents.innerHTML = `\n                    <div class=\"lesson-spinner double-centred-block\">\n                        <div class=\"icon\"><i class=\"fas fa-sun slow-spin\"></i></div>\n                    </div>\n                  `;\n            // renderLessons();\n            // const activeLesson = document.querySelector('.highlighted-for-review-row');\n            // lessonListScrollHandler.scrollToTitle(activeLesson.dataset.lessonId);\n          });\n\n      // remove subscriptions? e.g. renderScoreSummary\n\n};\n\nexport const lessonModalHandler = {\n    onCloseModal\n};","// Module\nvar code = \"<div class=\\\"snapdragon-container test-card-container js-test-card-container\\\">\\n    <div class=\\\"js-test-card\\\">\\n        <div id=\\\"test-card-header\\\" class=\\\"question-container\\\">\\n            <div class=\\\"iconic-icon double-centred-block js-iconic-icon\\\">\\n                <i class=\\\"\\\"></i>\\n            </div>\\n            <div class=\\\"hide-empty question-header\\\">\\n                <div>\\n                    <div class=\\\"names-container {{ headerClassName }}\\\">\\n                        <div>\\n                            <h2 class=\\\"vernacular-name\\\">{{ vernacularName }}</h2>\\n                            <span class=\\\"hide-empty names-badge\\\"></span>\\n                        </div>\\n                        <div>\\n                            <h2 class=\\\"binomial\\\">{{ binomial }}</h2>\\n                            <span class=\\\"names-badge traits-count-badge js-traits-count-badge\\\"></span>\\n                            <h2 class=\\\"term-header hide-empty js-term-header\\\">{{ term }}</h2>\\n                        </div>\\n                    </div>                \\n                </div>\\n            </div>\\n\\n            <div class=\\\"card-link-container\\\">\\n                <i class=\\\"far fa-arrow-alt-circle-right js-card-link\\\"></i>\\n            </div>\\n        </div>\\n        <form action=\\\"\\\">\\n          <fieldset>\\n            <div class=\\\"test-card-question standard-block centred-block js-test-card-question border-bottom\\\">            \\n                <div class=\\\"question question-txt {{ className }}\\\">\\n                    <div>\\n                      <legend class=\\\"hide-empty question-question js-question-question\\\">{{ question }}</legend>\\n                      <legend class=\\\"hide-empty question-help js-question-help\\\">{{ help }}</legend>\\n                      <legend class=\\\"hide-empty question-statement js-statement-para\\\">{{ statement }}</legend>\\n                      <legend class=\\\"hide-empty margin-top question-provider-question js-question-para\\\">{{ providerQuestion }}</legend>\\n                    </div>\\n                </div>\\n            </div>\\n            <div class=\\\"test-card-content js-test-card-content scrollable\\\">\\n                <!-- Specific test content goes here -->\\n            </div>\\n          </fieldset>\\n      </form>\\n        <div class=\\\"text-question js-txt-question\\\"></div>\\n        <div class=\\\"action-update-container\\\">\\n            <div class=\\\"action-update\\\">\\n                <button disabled class=\\\"btn snap-action-btn js-continue-lesson-btn\\\">Continue lesson</button>\\n            </div>\\n        </div>\\n    </div> \\n</div>\\n<div class=\\\"swap-out-card js-species-container\\\"></div>\\n<div class=\\\"swap-out-card js-taxon-container\\\"></div>\\n<div class=\\\"swap-out-card js-summary-container\\\"></div>\";\n// Exports\nmodule.exports = code;","import { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { renderIcon } from 'ui/helpers/icon-handler';\nimport { renderCard } from 'ui/screens/cards/card';\nimport { renderTaxonCard } from 'ui/screens/cards/taxon-card';\nimport { renderNonTaxonCard } from 'ui/screens/cards/non-taxon-card';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderScoreSummary } from 'ui/screens/progress/score-summary';\n\nimport testCardTemplate from 'ui/screens/cards/test-card-template.html';\n\nexport const renderTestCardTemplate = (collection, context) => {\n\n    const template = document.createElement('template');\n          template.innerHTML = testCardTemplate;\n\n    const { config } = store.getState();\n\n    const modal = config.isLandscapeMode ? document.querySelector('#lessonModal') : document;\n\n    const parent = config.isLandscapeMode \n                        ? modal.querySelector('.js-modal-text')\n                        : DOM.rightBody ;\n          parent.innerHTML = '';\n\n    const header = modal.querySelector('.js-modal-text-title');\n          header.innerHTML = collection.name;\n\n    context.className = context.className || '';\n    context.headerClassName = context.headerClassName || '';\n\n    context.statement = context.statement || '';\n    context.providerQuestion = context.providerQuestion || '';\n\n    renderTemplate(context, template.content, parent);\n\n    const progressLink = modal.querySelector('.js-review-progress');\n\n    if(progressLink) {\n\n        progressLink.innerHTML = 'Progress';\n        progressLink.addEventListener('click', e => {\n\n          const summaryContainer = modal.querySelector('.js-summary-container');\n\n          const renderSummaryCard = () => {\n\n              renderScoreSummary(collection.id, summaryContainer);\n\n              let count = 1;\n\n              const toggleScreens = (screenOne, screenTwo) => {\n                  hideCurrentCard(screenOne);\n                  progressLink.innerHTML = count % 2 === 0 ? 'Progress' : 'Quiz';\n                  count++;\n                  screenTwo.classList.remove('swap-out-card');\n                  progressLink.addEventListener('click', e => {                    \n                      toggleScreens(screenTwo, screenOne);\n                  }, { once: true });\n              };\n\n              toggleScreens(testCardContainer, summaryContainer);\n          };\n\n          renderSummaryCard();\n\n        }, { once: true });\n\n        progressLink.focus();\n    }\n\n    toggleStatementAndQuestion(config);\n\n    const testCardContainer = modal.querySelector('.js-test-card-container');\n    const testCard = modal.querySelector('.js-test-card-container');\n    const testCardIcon = testCard.querySelector('.js-card-link');\n\n    const item = collection.nextItem || collection.items[context.bonus.itemIndex];\n\n    const hideCurrentCard = (container, card) => {\n\n        container.classList.add('swap-out-card');\n        container.classList.remove('swap-in-card');\n\n        if(card) {\n            card.classList.add('swap-out-card');\n            card.classList.remove('swap-in-card');\n        }\n    };\n\n    const showNextCard = (container, selector) => {\n                \n        container.classList.remove('swap-out-card');\n        // container.classList.add('swap-in-card');\n\n        const card = modal.querySelector(selector);\n        const icon = card.querySelector('.js-card-link');\n              icon.classList.remove('disabled-icon');\n\n        return { card, icon };\n    }\n\n    testCardIcon.addEventListener('click', async event => {\n        \n        const speciesContainer = modal.querySelector('.js-species-container');\n        const taxonContainer = modal.querySelector('.js-taxon-container');\n\n        const renderSpeciesCard = async () => {\n\n            renderCard(collection, 'SWAP_OUT', item, speciesContainer, false);\n                    \n            setTimeout(() => {            \n\n                hideCurrentCard(testCardContainer, testCard);\n\n                const { card: speciesCard, icon: speciesIcon } = showNextCard(speciesContainer, '.js-species-card');\n\n                speciesIcon.addEventListener('click', async event => {\n\n                    item.lichen \n                        ? renderNonTaxonCard('SWAP_OUT', item.keyTrait, taxonContainer, item.images.find(i => i.starred) ? item.images.find(i => i.starred).url : item.images[0].url)\n                        : renderTaxonCard(collection, 'SWAP_OUT', item, taxonContainer, false);\n                    \n                    hideCurrentCard(speciesContainer, speciesCard);\n\n                    const { card: taxonCard, icon: taxonIcon } = item.lichen\n                        ? showNextCard(taxonContainer, '.js-non-taxon-card')\n                        : showNextCard(taxonContainer, '.js-taxon-card');\n\n                    taxonIcon.addEventListener('click', event => {\n                        hideCurrentCard(taxonContainer, taxonCard);\n                        showNextCard(testCardContainer, '.js-test-card');\n                    });\n                });\n\n            }, 500);\n        };\n\n        await renderSpeciesCard();\n    });\n\n    renderIcon(item.taxonomy, modal);\n\n    let testContentParent = modal.querySelector('.js-test-card-content');\n\n    return testContentParent;\n};\n\nconst toggleStatementAndQuestion = config => {\n\n    if(config.isLandscapeMode) return;\n    \n    const statement = document.querySelector('.js-statement-para');\n    const question = document.querySelector('.js-question-para');\n\n    question.classList.add('hide');\n\n    var iterations = 20;\n    var i = 0;\n\n    var interval = setInterval(function() { \n            if(i % 2) {\n                question.classList.add('hide');\n                statement.classList.remove('hide');\n            } else {\n                question.classList.remove('hide');\n                statement.classList.add('hide');\n            }\n            i++; \n            if(i >= iterations) clearInterval(interval);\n    }, 5000);\n\n};\n","// Module\nvar code = \"<div class=\\\"filter-language-option-block\\\">    \\n    <div class=\\\"filter-options\\\">\\n        <div class=\\\"language-options\\\">\\n            <div class=\\\"dropdown\\\">\\n                <button class=\\\"btn smaller-text snap-btn dropdown-toggle\\\" type=\\\"button\\\" id=\\\"taxonLanguageBtn\\\" data-toggle=\\\"dropdown\\\" aria-haspopup=\\\"true\\\" aria-expanded=\\\"false\\\">\\n                    Taxon language\\n                </button>\\n                <div class=\\\"dropdown-menu\\\" aria-labelledby=\\\"dropdownMenuButton\\\" data-repeat-language=\\\"{{ languages }}\\\">\\n                    <a id=\\\"{{ language.lang }}\\\" class=\\\"dropdown-item\\\" href=\\\"#\\\">{{ language.name }}</a>\\n                </div>\\n            </div>\\n        </div>        \\n    </div>\\n    <h2 class=\\\"half-standard-block centred-block\\\">Common names will be shown in<span id=\\\"taxonLanguageTxt\\\">English</span>.</h2>\\n</div>\";\n// Exports\nmodule.exports = code;","import { renderTemplate } from 'ui/helpers/templating';\n\nimport languageSelectionTemplate from 'ui/screens/common/language-selection-template.html';\n\nexport const languagePicker = (config, parent, listener) => {\n\n    const languages = config.languages;\n\n    const template = document.createElement('template');\n          template.innerHTML = languageSelectionTemplate;\n    \n    parent.innerHTML = '';\n\n    renderTemplate({ languages }, template.content, parent);\n\n    const taxonLanguageBtn = document.querySelector('#taxonLanguageBtn');\n          taxonLanguageBtn.innerHTML = `Taxon language [ ${languages.find(l => l.lang === config.language).name} ] `;\n\n    const taxonLanguageTxt = document.querySelector('#taxonLanguageTxt');\n          taxonLanguageTxt.innerHTML = languages.find(l => l.lang === config.language).name;\n\n    document.querySelectorAll('.dropdown-item').forEach(language => {\n        language.addEventListener('click', event => {\n            config.language = languages.find(l => l.lang === event.target.id).lang;\n            const name = languages.find(l => l.lang === event.target.id).name;\n            taxonLanguageBtn.innerHTML = `Taxon language [ ${name} ]`;\n            taxonLanguageTxt.innerHTML = name;\n            listener(config);\n        });    \n    });\n\n};","// Module\nvar code = \"<div class=\\\"home-scrolling-container js-home-scrolling-container\\\">\\n    \\n    <div class=\\\"title standard-block double-centred-block border-bottom\\\">{{ title }}</div>\\n\\n    <div class=\\\"snapdragon-intro padding\\\">\\n        <div class=\\\"half-standard-block\\\">\\n            <span class=\\\"js-species-summary\\\">{{ speciesSummary }}</span>\\n        </div>\\n        <!-- <div class=\\\"half-standard-block\\\">\\n            <span>Common taxon names are in {{ language }}.</span>\\n        </div> -->\\n        <div class=\\\"half-standard-block\\\">\\n            <span>{{ season }}</span>\\n        </div>\\n\\n        <div class=\\\"centred-block standard-block landscape js-intro-text\\\">{{ lessonIntro }}</div>\\n    </div>\\n\\n    <div class=\\\"scrollable\\\"></div>                \\n</div>\";\n// Exports\nmodule.exports = code;","import { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport textIntroTemplate from 'ui/screens/home/home-lesson-intro-text-template.html';\n\nexport const textSetup = (collection, config) => {\n\n    let speciesCount = getSpeciesCount(collection);\n\n    const iconicTaxa = collection.guide\n                            ? collection.guide.iconicTaxa\n                            : collection.iconicTaxa || [ ...new Set(collection.items.map(i => i.iconicTaxon)) ];\n\n    const language = config.languages.find(l => l.lang === config.language).name; // place in guide, and copy to collection\n\n    const template = document.createElement('template');\n          template.innerHTML = textIntroTemplate;\n\n    const months = collection.guide ? collection.guide.season.observableMonths.map(month => month.name) : [];\n    const observableMonths = months.length > 0 ? `${months[0]}-${months[months.length - 1]}` : '';\n    const season = months.length === 0\n                    ? 'Species observations are drawn from the whole year.'\n                    : collection.guide.season === 'all_year'\n                        ? 'Species observations are drawn from the whole year.'\n                        : `Species observations are from ${observableMonths}.`;\n\n    let speciesSummary = getSpeciesSummary(iconicTaxa, speciesCount);\n\n    let lessonIntro = collection.intro || '';\n\n    const summary = {\n        speciesCount,\n        iconicTaxa,\n        title: collection.name,\n        language,\n        observableMonths,\n        season,\n        speciesSummary,\n        lessonIntro\n    };\n\n    DOM.rightBody.innerHTML = '';\n\n    renderTemplate(summary, template.content, DOM.rightBody);\n\n    setTimeout(() => {\n        ({ speciesCount, speciesSummary } = handleSpeciesUpdate(speciesCount, collection, speciesSummary, iconicTaxa));\n    }, 500);\n    \n    setTimeout(() => {\n        ({ speciesCount, speciesSummary } = handleSpeciesUpdate(speciesCount, collection, speciesSummary, iconicTaxa));\n    }, 1500);\n};\n\nconst handleSpeciesUpdate = (speciesCount, collection, speciesSummary, iconicTaxa) => {\n    if (speciesCount === '--') {\n        speciesCount = getSpeciesCount(collection);\n        document.querySelector('.js-species-summary').innerHTML = speciesSummary = getSpeciesSummary(iconicTaxa, speciesCount);\n    }\n    return { speciesCount, speciesSummary };\n};\n\nconst getSpeciesSummary = (iconicTaxa, speciesCount) => {\n    return iconicTaxa.length === 1\n        ? `${speciesCount} species in ${iconicTaxa.length} taxon.`\n        : `${speciesCount} species in ${iconicTaxa.length} taxa.`;\n};\n\nconst getSpeciesCount = collection => {\n    let count = (collection.itemNames && collection.itemNames.length > 0)\n        ? collection.itemNames.length\n        : collection.items ? collection.items.length : 0;\n    return count === 0 ? '--' : count;\n};","import { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { videoSetup } from 'ui/screens/home/home-lesson-intro-video';\nimport { textSetup } from 'ui/screens/home/home-lesson-intro-text';\n\nexport const renderLessonIntro = collection => {\n\n    const { config, videoPlayer, collection: lesson } = store.getState();\n\n    collection = { ...collection, items: lesson.items };\n\n    collection.hasVideo ? videoSetup(collection, videoPlayer || [], DOM.rightBody) : textSetup(collection, config);\n    \n}","// Module\nvar code = \"<div class=\\\"home-container\\\">  \\n    <div class=\\\"snapdragon-header double-centred-block\\\">\\n        <h1>\\n          <a href=\\\"\\\">Welcome</a>\\n        </h1>\\n    </div>    \\n    <main id=\\\"main\\\" class=\\\"snapdragon-intro scrollable js-snapdragon-intro\\\">\\n\\n        <h3>Learn The Planet is a collection of a video lessons about the natural world.</h3>\\n\\n        <h4 class=\\\"centred-block landscape\\\">\\n            <i class=\\\"margin-left extra-large-text fab fa-youtube youtube-icon\\\"></i><span class=\\\"margin-left\\\">Click to watch a lesson video.</span>\\n        </h4>\\n\\n        <h4 class=\\\"centred-block landscape\\\">\\n            <i class=\\\"margin-left extra-large-text fas fa-glasses youtube-icon \\\"></i><span class=\\\"margin-left\\\">Click to see lesson species.</span>            \\n        </h4>\\n\\n        <h4 class=\\\"landscape\\\">\\n            <button class=\\\"btn snap-btn extra-small-text fit-width\\\" disabled style=\\\"opacity: 1;\\\">Vocab test</button>\\n            <span class=\\\"margin-left\\\">Brush up on terms and definitions.</span>\\n        </h4>\\n\\n        <h4 class=\\\"landscape\\\">\\n            <button class=\\\"btn snap-btn extra-small-text fit-width\\\" disabled style=\\\"opacity: 1;\\\">Lesson Quiz</button>\\n            <span class=\\\"margin-left\\\">Test yourself on the contents of a lesson.</span>\\n        </h4>\\n\\n        <br class=\\\"landscape\\\">\\n        <br class=\\\"landscape\\\">\\n\\n        <h4 class=\\\"portrait\\\">\\n            Tap on the home icon <span><i class=\\\"fas fa-chalkboard\\\"></i></span> below to get started, then select an <span><i class=\\\"fab fa-youtube youtube-icon\\\"></i></span> icon to begin a lesson.\\n        </h4>\\n\\n        <h5>These lessons took time and effort to make; Learn The Planet would like to thank the people who created them.</h5>\\n\\n      </main>\\n</div>\";\n// Exports\nmodule.exports = code;","import { subscription } from 'redux/subscriptions';\nimport { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderLessons } from 'ui/screens/lists/lesson-list';\nimport { cookieHandler } from 'ui/helpers/cookie-handler';\n\nimport homeTemplate from 'ui/screens/home/home-template.html';\n\nexport const renderHome = (counter, forceIntroDisplay = false) => {\n    \n    subscription.remove(subscription.getByName('renderHome'));\n    \n    const isFirstTimeVisitor = cookieHandler.setFirstTimeVisitorCookie();\n\n    if(counter.index > 0 && !counter.isLessonPaused) return;\n\n    let { config } = store.getState();\n\n    if(config.isLandscapeMode || forceIntroDisplay) {\n        renderLessons();\n    }\n\n    // if(config.isLandscapeMode || isFirstTimeVisitor || forceIntroDisplay) {\n    //     renderSnapdragonIntro();\n    // }\n\n    if(config.isPortraitMode && !isFirstTimeVisitor) {\n        renderLessons();\n    }\n};\n\nconst renderSnapdragonIntro = () => {\n    \n    const template = document.createElement('template');\n          template.innerHTML = homeTemplate;\n\n    DOM.rightBody.innerHTML = '';\n\n    renderTemplate({}, template.content, DOM.rightBody);\n}\n","// Module\nvar code = \"<div class=\\\"standard-block border-bottom double-centred-block\\\"></div>\\n<div class=\\\"tiles-container\\\">\\n    <div class=\\\"squares js-tiles\\\" data-repeat-image=\\\"{{ images }}\\\">\\n        <div>\\n            <img class=\\\"square\\\"                    \\n            src=\\\"{{ image.medium }}\\\"\\n            data-toggle=\\\"modal\\\" data-target=\\\"#imageModal\\\"\\n            data-item-name=\\\"{{ image.itemName }}\\\"\\n            data-url=\\\"{{ image.url }}\\\" />\\n        </div>              \\n    </div>\\n</div>\\n\\n<div class=\\\"lesson-companion\\\">\\n    <!-- 9 things about Dill: #1 -->\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils'; \nimport { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { modalImagesHandler } from 'ui/helpers/image-handler';\nimport { imageUseCases, prepImagesForCarousel, prepImageForCarousel, scaleImage } from 'ui/helpers/image-handler';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nimport specimensTemplate from 'ui/screens/landscape/specimen-tiles-template.html';\n\nexport const renderSpecimenTiles = collection => {\n\n    const item = collection.nextItem;\n\n    if(!item) return;\n\n    renderItemSpecimenTiles(item);\n};\n\nconst renderItemSpecimenTiles = item => {\n    \n    const { config, collection, layout } = store.getState();\n\n    const hasTiles = layout.itemIndex === layout.prevItemIndex && !!document.querySelector('.js-tiles');\n\n    if(hasTiles) return;\n\n    const familes = [ 'family-strips', 'family', 'taxon-card' ];\n\n    const collectionItems = collection.allItems || collection.items;\n\n    let images, items;\n    \n    if (R.contains(layout.screens[1].name, familes)) {        \n        const family = collectionItems.filter(i => i.family.name.toLowerCase() === item.taxonomy.family.toLowerCase());\n        images = R.take(6, utils.shuffleArray(getImagesFromItemFamily(family, config, imageUseCases.SPECIES_CARD)));\n        items = images.map(image => collectionItems.find(item => item.name === image.itemName));\n    } else {\n        images = R.take(6, utils.shuffleArray(R.clone(item.images)));\n        images = prepImagesForCarousel({ name: item.name, itemCommon: item.itemCommon, images }, config, imageUseCases.SPECIES_CARD);\n        items = [item];\n    }\n\n    images = images.map(image => {\n        return scaleImage(image, imageUseCases.VISUAL_MATCH, config);\n    });\n\n    renderSpecimenImageTiles({ items: items }, images, item);\n};\n\nconst renderSpecimenImageTiles = (collection, images, item) => {\n\n    const { layout, config } = store.getState();\n\n    const acceptableScreens = [ 'specimen-images', 'trait-images' ]; // lookalike options?\n\n    let screen = layout.screens.find(screen => R.contains(screen.name, acceptableScreens));\n\n    if(!screen) return;\n\n    const template = document.createElement('template');\n\n    template.innerHTML = specimensTemplate;    \n\n    const parent = DOM.leftBody;\n          parent.innerHTML = '';\n\n    snapLog('renderSpecimenImageTiles, image medium values:', images.map(i => i.medium));\n\n    renderTemplate({ images }, template.content, parent);\n\n    modalImagesHandler(document.querySelectorAll('.js-tiles .square'), item, collection, config);\n};\n\nconst getImagesFromItemFamily = (family, config, useCase) => {\n\n    let itemImages, items;\n\n    itemImages = R.flatten(family.map(i => {\n        return { images: i.images, item: { name: i.name, itemCommon: i.names[0].vernacularName, vernacularName: i.names[0].vernacularName, names: i.names } };\n    }));\n\n    if (itemImages.length < 6) {\n        \n        let pool = itemImages.map(image => {\n            const item = family.find(i => i.name === image.item.name);\n            return {\n                images: item.images,\n                item: {\n                    name: item.name,\n                    itemCommon: item.names[0].vernacularName,\n                    vernacularName: item.names[0].vernacularName,\n                    names: item.names\n                }\n            };\n        });\n        let pooledImages = R.flatten(pool);\n            pooledImages.forEach(pooledImage => {\n                pooledImage.images.forEach(image => {\n                    itemImages.push({ images: pooledImage.images, item: pooledImage.item });\n                });\n            });\n    }\n\n    items = itemImages.map(image => image.item);\n    \n    items.forEach(i => {\n        const itemName = i.name;\n        i.images = family.find(i => i.name === itemName).images;\n    });\n\n    const uniqueImages = [];\n\n    const getUniqueImage = (image, index, uniqueImages) => {\n        let uniqueImage = image.images.find(i => i.starred);\n        if(uniqueImage) {\n            uniqueImage = R.contains(uniqueImage.title, uniqueImages.map(i => i.title)) ? null : uniqueImage;\n        }\n        if(uniqueImage) {\n            uniqueImages.push(uniqueImage);\n            return uniqueImage;\n        }\n        else {\n            uniqueImage = image.images[index];\n            if(uniqueImage && !R.contains(uniqueImage.title, uniqueImages.map(i => i.title))) {\n                uniqueImages.push(uniqueImage);\n                return uniqueImage;\n            }\n        }\n    }; \n\n    const familyImages = [];\n\n    itemImages.forEach((image, index) => {\n        let imageToPrep = getUniqueImage(image, index, uniqueImages);\n        if(imageToPrep) {\n            familyImages.push(prepImageForCarousel(imageToPrep, index, image.item, config, useCase));\n        }\n    });\n\n    return familyImages;\n}\n","import { onCreateCustomLesson } from 'ui/create-guide-modal/create-guide';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { lessonListEventHandler } from 'ui/screens/lists/lesson-list-event-handler';\n\nimport lessonTemplate from 'ui/screens/lists/lesson-template.html';\n\nexport const renderCustomLesson = (lessons, savedLessons, videoPlayer, score, config) => {\n\n    onCreateCustomLesson(collection => {\n\n        const parent = document.querySelector('.lesson-list > .scrollable');\n        const template = document.createElement('template');\n              template.innerHTML = lessonTemplate;\n        \n        const lesson = lessonListEventHandler.onLoadLessonViewState(collection, savedLessons, videoPlayer, score, config);\n              lesson.hideVideoClass = 'hide-important';\n              lesson.hideTextIntroClass = '';\n        \n        lessons.push(lesson);\n        \n        lesson.icon = lesson.icon || \"https://static.inaturalist.org/photos/57604885/small.jpeg?1575746307\";\n\n        renderTemplate({ lesson }, template.content, parent);\n        \n        const title = document.querySelector(`.js-lesson-title[data-lesson-id=\"${lesson.id}\"]`);\n        lessonListEventHandler.onLessonTitleClickHandler(title, lessons);\n\n        const reviewLink = document.querySelector(`.js-review-link[data-lesson-id=\"${lesson.id}\"]`);\n        lessonListEventHandler.onReviewClickHandler(reviewLink, lessons);\n\n        const chevron = document.querySelector(`.js-lesson-list-chevron[data-lesson-id=\"${lesson.id}\"]`);\n\n        if(chevron) {\n          chevron.classList.remove('landscape');\n          lessonListEventHandler.onLessonIconClickHandler(chevron, lessons, config, false);\n        }\n\n        const youtubeLessonIcon = document.querySelector(`.js-lesson-list-youtube[data-lesson-id=\"${lesson.id}\"]`);\n        if(youtubeLessonIcon) {\n          youtubeLessonIcon.classList.add('hide-important');\n        }\n\n        const scrollOptions = {\n          left: 0,\n          top: 1000,\n          behavior: 'smooth'\n        }\n            \n        document.querySelector('.js-lesson-container').scrollTo(scrollOptions);\n    });\n};","// Module\nvar code = \"<div class=\\\"lesson-list-item one-and-half-standard-block vertical-evenly-spaced-block\\\">\\n    <div class=\\\"lesson-name\\\" id=\\\"js-input-collection-name\\\">\\n        <input type=\\\"text\\\" value=\\\"{{ collection.name }}\\\">\\n    </div>\\n    <div class=\\\"margin-left lesson-taxa\\\"><span class=\\\"js-lesson-taxa-count\\\">{{ collection.items.length }}</span> <span class=\\\"js-lesson-taxa\\\">{{ collection.taxa }}</span></div>\\n</div>\\n\\n<div class=\\\"selected-species-container\\\">\\n    <div class=\\\"open scrollable js-selected-species-container\\\"></div>\\n</div>\";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { actions } from 'redux/actions/action-creators';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { speciesInGuideEditor } from 'ui/create-guide-modal/species-in-guide-editor';\n\nimport lessonEditTemplate from 'ui/screens/lists/lesson-edit-template.html';\n\nexport const renderEditLesson = collection => {\n\nconst init = async () => {\n\n    const { config } = store.getState();\n\n    const template = document.createElement('template');\n          template.innerHTML = lessonEditTemplate;\n\n    const modal = document.querySelector('#basicModal');\n    const parent = modal.querySelector('.js-modal-text');\n          parent.innerHTML = '';\n\n    renderTemplate({ collection }, template.content, parent);\n    \n    const header = modal.querySelector('.js-modal-text-title');\n          header.innerHTML = 'Edit lesson';\n\n    const selectedSpeciesDisplay = modal.querySelector('.js-selected-species-container');\n          selectedSpeciesDisplay.innerHTML = '';\n    \n    const createGuide = {\n        setConfig: config => {\n        actions.boundUpdateConfig(config);\n        }\n    };\n\n    speciesInGuideEditor(config, modal, selectedSpeciesDisplay, createGuide, collection.items);\n};\n\ninit();\n\n};","import * as R from 'ramda';\n\nimport { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { elem } from 'ui/helpers/class-behaviour';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { renderLessonIntro } from 'ui/screens/home/home-lesson-intro';\nimport { renderEditLesson } from 'ui/screens/lists/lesson-edit';\nimport { lessonListScrollHandler } from 'ui/screens/lists/lesson-list-scroll-handler';\nimport { videoHandler } from 'ui/screens/lists/video-handler';\nimport { lessonStateHandler } from 'ui/screens/lists/lesson-state-handler';\n\nconst onLoadLessonViewState = (collection, videoPlayer, score, config) => {\n\n  const taxa = collection.iconicTaxa ? collection.iconicTaxa.map(taxon => taxon.common).join(', ') : '';\n\n  collection.taxa = taxa;\n  collection.hasVideo = collection.video && !R.isEmpty(collection.video) ? true : false;\n  collection.showVideoIconClass = collection.hasVideo ? '' : 'hide-important';\n  collection.videoState = videoHandler.setVideoState(videoPlayer || [], collection);\n  collection.reviewState = 'Lesson Quiz';\n\n  collection.hasTermsClass = collection.terms && Array.isArray(collection.terms) && collection.terms.length > 0 ? '' : 'hide-important';\n  collection.isCollectionEditableClass = '';\n\n  return collection;  \n};\n\nconst onLoadLessonsViewState = (collections, videoPlayer, score, config) => {\n  return collections.map(collection => {\n    return onLoadLessonViewState(collection, videoPlayer, score, config);\n  });\n};\n\nconst onClickViewState = (e, lessons) => {\n\n  const icon = e.currentTarget;\n  const isYoutubeIcon = elem.hasClass(icon, 'js-lesson-list-youtube');\n  const isChevronIcon = elem.hasClass(icon, 'js-lesson-list-chevron');\n  const row = icon.parentElement.parentElement;\n  const lessonId = parseInt(icon.dataset.lessonId);\n  const lesson = lessons.find(l => l.id === lessonId);\n  const container = document.querySelector(`.js-species-container[data-container-id=\"${lessonId}\"]`);\n  const speciesList = document.querySelector(`#species_list_id_${lessonId}`);\n  const reviewLink = document.querySelector(`.js-review-link[data-lesson-id=\"${lessonId}\"]`);\n\n  let action = isYoutubeIcon ? enums.userEvent.START_LESSON : isChevronIcon ? enums.userEvent.TOGGLE_SPECIES_LIST : enums.userEvent.DEFAULT;\n  lessonStateHandler.recordUserAction(action);\n\n  hideOtherContentAndRevertChevrons(lessonId);\n\n  const isSpeciesListAvailable = !!speciesList;\n  const isSpeciesListHidden = elem.hasClass(speciesList, 'hide');\n\n  const lessonVideoState = document.querySelector(`.js-lesson-video-state[data-lesson-id=\"${lessonId}\"]`);\n  const iconIsChevron = !icon.dataset.lessonIsYoutubeIcon;\n\n  const state = {\n    requiresSpeciesList: !isSpeciesListAvailable,\n    revealSpeciesList: isSpeciesListAvailable && isSpeciesListHidden,\n    hideSpeciesList: isSpeciesListAvailable && !isSpeciesListHidden && iconIsChevron\n  };\n\n  return { icon, lesson, state, speciesList, container, lessonVideoState, reviewLink, row, isYoutubeIcon };\n};\n\nconst onLessonIconClickHandler = (icon, lessons, config, startLesson) => {\n  \n  return icon.addEventListener('click', async e => {      \n\n    const { icon, lesson, state, speciesList, container, lessonVideoState, row, isYoutubeIcon } = onClickViewState(e, lessons);\n\n    const isItemActive = item => {\n      if(item.hasOwnProperty('isActive')) {\n        return item.isActive;\n      } else {\n        return true;\n      }\n    };\n\n    lesson.items = lesson.items.filter(item => isItemActive(item));\n\n    if(config.isLandscapeMode) {\n\n      const lessonYoutubeIcons = document.querySelectorAll('.lesson-list-selected-lesson .youtube-icon');\n            lessonYoutubeIcons.forEach(icon => icon.parentElement.classList.remove('youtube-green-fg'));\n\n      if(icon.dataset.lessonIsYoutubeIcon) {\n        icon.classList.add('youtube-green-fg');\n        const chevron = document.querySelector(`.js-lesson-list-chevron[data-lesson-id=\"${icon.dataset.lessonId}\"]`);\n              chevron.innerHTML = `<i class=\"fas fa-chevron-up\" data-lesson-id=\"${lesson.id}\"></i>`;\n      }\n\n      let siblingChevron;\n\n      if(state.requiresSpeciesList) {\n        await loadAndDisplaySpeciesList(icon, lesson, container);\n      }\n\n      if(startLesson) {\n        renderLessonIntro(lesson);\n        siblingChevron = icon.parentElement.parentElement.parentElement.children[1].children[0].children[1];\n        if(isYoutubeIcon) {\n          if(state.hideSpeciesList) {\n            siblingChevron.innerHTML = `<i class=\"fas fa-chevron-down\" data-lesson-id=\"${lesson.id}\"></i>`;\n          }\n        }\n      } else {\n        if(!isYoutubeIcon) {\n          if(state.hideSpeciesList) {\n            icon.innerHTML = `<i class=\"fas fa-chevron-down\" data-lesson-id=\"${lesson.id}\"></i>`;\n          } else if(!state.revealSpeciesList) {\n            icon.innerHTML = `<i class=\"fas fa-chevron-up\" data-lesson-id=\"${lesson.id}\"></i>`;\n          }\n        }\n      }\n\n      if(state.revealSpeciesList) {        \n        speciesList.classList.remove('hide');\n        if(!isYoutubeIcon) {\n          icon.innerHTML = `<i class=\"fas fa-chevron-up\" data-lesson-id=\"${lesson.id}\"></i>`;\n        }\n      }\n      if(state.hideSpeciesList) {\n        speciesList.classList.add('hide');\n        lessonVideoState.innerHTML = videoHandler.setVideoState(store.getState().videoPlayer || [], lesson);\n      }\n    }\n\n    if(config.isPortraitMode) {\n\n      if(state.requiresSpeciesList) {\n        await loadAndDisplaySpeciesList(icon, lesson, container);\n      }\n\n      renderLessonIntro(lesson);\n      \n      lessonStateHandler.changeRequest({\n        requestType: enums.lessonState.RENDER_SPECIES_LIST,\n        requestArgs: { lesson, container: DOM.rightBody.querySelector('.js-home-scrolling-container .scrollable') }\n      });\n    }\n\n    row.classList.add('lesson-list-selected-lesson');\n  });\n};\n\nconst onLessonTitleClickHandler = (title, lessons) => {\n    title.addEventListener('click', e => {\n          const lesson = lessons.find(lesson => lesson.id === parseInt(title.dataset.lessonId));\n          renderEditLesson(lesson);\n    });\n};\n\nconst onReviewClickHandler = reviewLink => {    \n\n  reviewLink.addEventListener('click', async e => {\n\n    lessonStateHandler.recordUserAction(enums.userEvent.START_LESSON_REVIEW);\n\n    const lessonId = reviewLink.dataset.lessonId;\n    // const loadingMessage = document.querySelector(`.js-loading-review-message[data-lesson-id=\"${lessonId}\"]`);\n    //       loadingMessage.classList.remove('hide');\n\n    //       setTimeout(() => {\n    //         loadingMessage.classList.add('hide');\n    //       }, 2000);\n\n    const { lesson } = store.getState();\n\n    lessonStateHandler.changeRequest({\n      requestType: enums.lessonState.BEGIN_OR_RESUME_LESSON,\n      requestArgs: {\n        id: reviewLink.dataset.lessonId\n      }\n    });\n  });\n};\n\nconst hideOtherContentAndRevertChevrons = selectedLessonId => {\n\n  const upChevrons = Array.from(document.querySelectorAll('.js-lesson-list-chevron .fa-chevron-up'));\n\n  upChevrons.forEach(chevron => {\n    \n    const chevronLessonId = parseInt(chevron.dataset.lessonId);\n\n    if(chevronLessonId !== selectedLessonId) {\n      \n      chevron.click();\n        \n      const lesson = document.querySelector(`.js-lesson-list-carousel-item[data-lesson-id=\"${chevronLessonId}\"]`);\n            lesson.classList.remove('highlighted-for-review-row');\n    }\n  });\n};\n\nconst loadAndDisplaySpeciesList = async(icon, lesson, container) => {\n\n  Array.from(icon.parentElement.children).forEach(child => child.dataset.selected = true);\n\n  if(userAction && userAction.name === enums.userEvent.START_LESSON.name) { return; }\n\n  const { userAction, config } = store.getState();\n\n  await lessonStateHandler.changeRequest({\n    requestType: enums.lessonState.RENDER_SPECIES_LIST,\n    requestArgs: { lesson, container }\n  });\n\n  lessonListScrollHandler.scrollToTitle(lesson.id);\n};\n\nexport const lessonListEventHandler = {\n  onLoadLessonViewState,\n  onLoadLessonsViewState,\n  onLessonIconClickHandler,\n  onReviewClickHandler,\n  onLessonTitleClickHandler,\n  hideOtherContentAndRevertChevrons\n};","// Module\nvar code = \"<div class=\\\"lesson-list-header centred-block btn standard-block\\\">\\n    <div class=\\\"standard-block js-toggle-element\\\">\\n        <div>\\n            <div class=\\\"main-header\\\">\\n                <h2>Lessons</h2>\\n            </div>\\n        </div>\\n    </div>\\n    <div class=\\\"margin-right standard-block js-toggle-control\\\">    \\n        <button data-toggle=\\\"modal\\\" data-target=\\\"#createGuide\\\" class=\\\"btn snap-btn margin-right small-text js-create-custom-lesson\\\">Create lesson</button>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import lessonListHeaderTemplate from 'ui/screens/lists/lesson-list-header-template.html';\n\nexport const renderLessonListHeader = parent => {\n\n    const header = document.createElement(\"div\");\n          header.innerHTML = lessonListHeaderTemplate;\n\n    const sibling = document.querySelector('.lesson-list .scrollable');\n\n    parent = document.querySelector('.lesson-list');\n    parent.insertBefore(header, sibling);\n};","const siblingsBefore = lessonId => {\n        \n    let siblings = document.querySelectorAll('.js-lesson-list-item:not(.hide-important)');\n    let sibling = siblings[0];\n    let index = 0;\n\n    const before = [];\n    \n    while(sibling) {\n      index++;\n      if(parseInt(sibling.dataset.lessonId) !== lessonId) {\n        before.push(sibling);\n        sibling = siblings[index];\n      } else {\n        sibling = null;\n      }\n    }\n\n    return before.length;\n  };\n\nconst scrollToTitle = lessonId => {\n  setTimeout(() => {\n    const standardBlock = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--vhRow').replace('px', ''));\n    const rows = siblingsBefore(lessonId);\n    const top = standardBlock * (rows);\n\n    const scroll = document.querySelector('.lesson-list .scrollable');\n    if(scroll) scroll.scrollTop = top;\n  });\n};\n\nexport const lessonListScrollHandler = {\n  scrollToTitle\n}","// Module\nvar code = \"<div class=\\\"lesson-list js-lesson-list\\\">\\n    <ul class=\\\"scrollable js-lesson-container\\\" data-toggle=\\\"buttons\\\">\\n    </ul>\\n</div>\";\n// Exports\nmodule.exports = code;","import { enums } from 'ui/helpers/enum-helper';\nimport { DOM } from 'ui/dom';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { createGuideHandler } from 'ui/create-guide-modal/create-guide';\nimport { quickFireHandlers } from 'ui/quick-fire-modal/quick-fire';\nimport { renderLessonListHeader } from 'ui/screens/lists/lesson-list-header';\nimport { renderLesson } from 'ui/screens/lists/lesson';\nimport { renderCustomLesson } from 'ui/screens/lists/lesson-custom';\nimport { lessonListEventHandler } from 'ui/screens/lists/lesson-list-event-handler';\n\nimport lessonListTemplate from 'ui/screens/lists/lesson-list-template.html';\n\nexport const renderLessons = () => {\n\n    let { config, collections, lessons: savedLessons, videoPlayer, score } = store.getState();\n\n    const template = document.createElement('template');\n          template.innerHTML = lessonListTemplate;\n\n    let lessons = lessonListEventHandler.onLoadLessonsViewState(collections.filter(collection => (collection.isActive === undefined || collection.isActive)), videoPlayer, score, config);\n        lessons = lessons.sort(function(a,b){\n              const tsa = a.create ? a.create.seconds : 0;\n              const tsb = b.create ? b.create.seconds : 0;\n            return tsb - tsa;\n        });\n\n    let parent = config.isPortraitMode ? DOM.rightBody : DOM.leftBody;\n        parent.innerHTML = '';\n\n    renderTemplate({}, template.content, parent);\n\n      lessons.forEach(lesson => renderLesson(lesson));\n\n      renderLessonListHeader(parent);\n\n      const createCustomLessonBtn = parent.querySelector('.js-create-custom-lesson');          \n            createCustomLessonBtn.addEventListener('click', e => {\n                  createGuideHandler(1);\n                  lessonListEventHandler.hideOtherContentAndRevertChevrons(0);\n            });    \n\n      const lessonTitles = document.querySelectorAll('.js-lesson-title');\n            lessonTitles.forEach(title => lessonListEventHandler.onLessonTitleClickHandler(title, lessons));\n\n      const youtubeLessonIcons = document.querySelectorAll('.js-lesson-list-youtube');\n            youtubeLessonIcons.forEach(youtube => lessonListEventHandler.onLessonIconClickHandler(youtube, lessons, config, true));\n      highlightActiveLesson(youtubeLessonIcons);\n\n      const chevrons = document.querySelectorAll('.js-lesson-list-chevron');\n            chevrons.forEach(chevron => lessonListEventHandler.onLessonIconClickHandler(chevron, lessons, config, false));\n      highlightActiveLesson(chevrons);\n\n      const reviews = document.querySelectorAll('.js-review-link');\n            reviews.forEach(reviewLink => lessonListEventHandler.onReviewClickHandler(reviewLink));\n      highlightActiveLesson(reviews);\n\n      setTimeout(() => {      \n\n            let terms = document.querySelectorAll('.js-terms-review-link');\n                terms.forEach(term => {\n                  let termsReviewLink = term.querySelector('button');\n                  termsReviewLink.addEventListener('click', e => {                         \n                        const lesson = lessons.find(lesson => lesson.id === parseInt(termsReviewLink.dataset.lessonId));\n                        if(lesson.terms) {\n                              const { glossary } = store.getState();\n                              setTimeout(() => {\n                                    const { quickFire } = store.getState();\n                                    if(quickFire && quickFire.lessonId === lesson.id) {\n                                          quickFireHandlers.questions(quickFire);\n                                    } else {\n                                          quickFireHandlers.questions({ ...quickFireHandlers.init(glossary, enums.quickFireType.DEFINITION, lesson), linkFromLesson: true });\n                                    }\n                              },150);\n                        }\n                });\n            });\n            highlightActiveLesson(terms);\n\n      },100);\n\n      renderCustomLesson(lessons, savedLessons, videoPlayer, score, config);      \n};\n\nconst highlightActiveLesson = lessons => {\n      lessons.forEach(lesson => lesson.addEventListener('click', e => {\n            \n            const rows = document.querySelectorAll('.js-lesson-list-carousel-item');\n                  rows.forEach(row => row.classList.remove('highlighted-for-review-row'));\n            const row = document.querySelector(`.js-lesson-list-carousel-item[data-lesson-id=\"${lesson.dataset.lessonId}\"]`);\n            if (row)\n                  row.classList.add('highlighted-for-review-row');\n\n            // lessonListScrollHandler.scrollToTitle(lesson.dataset.lessonId);\n      }));\n};\n\n","// Module\nvar code = \"<li>\\n  <div data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"relative lesson-list-carousel-item js-lesson-list-carousel-item\\\">\\n      <div class=\\\"landscape double-centred-block\\\">\\n          <img class=\\\"lesson-icon\\\" src=\\\"{{ lesson.icon }}\\\" alt=\\\"{{ lesson.name }}\\\">\\n      </div>\\n      <div data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"lesson-list-item js-lesson-list-item\\\" data-has-video=\\\"{{ lesson.hasVideo }}\\\">\\n          <div>            \\n              <div class=\\\"lesson-name js-lesson-title\\\" data-lesson-id=\\\"{{ lesson.id }}\\\">\\n                  <span data-toggle=\\\"modal\\\" data-target=\\\"#basicModal\\\" id=\\\"lesson_{{ lesson.id }}\\\" class=\\\"lesson-title margin-right {{ lesson.isCollectionEditableClass }}\\\">{{ lesson.name }}</span>\\n              </div>\\n              <div class=\\\"lesson-taxa\\\" data-lesson-id=\\\"{{ lesson.id }}\\\">{{ lesson.taxa }}</div>\\n              <div class=\\\"latin hide-empty js-lesson-video-state\\\" data-lesson-id=\\\"{{ lesson.id }}\\\">{{ lesson.videoState }}</div>         \\n          </div> \\n          <div data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"lesson-review js-lesson-review\\\">\\n              <div class=\\\"flex\\\">\\n                  <div class=\\\"centred-block fit-width\\\">\\n                    <span class=\\\"lesson-terms-review {{ lesson.hasTermsClass }} margin-right fit-width js-terms-review-link\\\" data-toggle=\\\"modal\\\" data-target=\\\"#glossaryModal\\\" data-lesson-id=\\\"{{ lesson.id }}\\\">\\n                        <button data-lesson-id=\\\"{{ lesson.id }}\\\" aria-label=\\\"vocab test for {{ lesson.name }} lesson\\\" class=\\\"btn snap-btn extra-small-text\\\" data-toggle=\\\"modal\\\" data-target=\\\"#glossaryModal\\\">Vocab test</button>\\n                    <span>\\n                  </div>\\n                  <div class=\\\"vertical-centred-block relative\\\">\\n                    <span class=\\\"\\\">\\n                      <button data-toggle=\\\"modal\\\" data-target=\\\"#lessonModal\\\" data-lesson-id=\\\"{{ lesson.id }}\\\" aria-label=\\\"{{ lesson.name }} lesson quiz\\\" class=\\\"landscape btn snap-btn extra-small-text margin-right fit-width js-review-link\\\">{{ lesson.reviewState }}</button>\\n                      <button data-lesson-id=\\\"{{ lesson.id }}\\\" aria-label=\\\"{{ lesson.name }} lesson quiz\\\" class=\\\"portrait btn snap-btn extra-small-text margin-right fit-width js-review-link\\\">{{ lesson.reviewState }}</button>\\n                    </span>\\n                    <span data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"hide-important inline-progress-container js-review\\\">\\n                    <span class=\\\"absolute\\\">&nbsp;</span>\\n                    </span>\\n                    <span data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"hide margin-right js-loading-review-message\\\">\\n                        <span><i class=\\\"fas fa-sync slow-spin\\\"></i></span>\\n                    </span>                  \\n                  </div>\\n              </div>\\n          </div>\\n      </div>\\n      <div class=\\\"lesson-list-action-icons js-lesson-list-action-icons\\\">\\n          <div class=\\\"\\\">\\n              <button data-lesson-id=\\\"{{ lesson.id }}\\\" data-lesson-is-youtube-icon=\\\"true\\\" class=\\\"snap-icon-btn fit-width js-lesson-list-youtube\\\" aria-label=\\\"play video for the lesson {{ lesson.name }}\\\">\\n                <i class=\\\"fab fa-youtube youtube-icon {{ lesson.hideVideoClass }}\\\"></i>\\n                <i class=\\\"fas fa-glasses youtube-icon {{ lesson.hideTextIntroClass }}\\\"></i>\\n              </button>\\n              <button data-lesson-id=\\\"{{ lesson.id }}\\\" class=\\\"landscape snap-icon-btn fit-width js-lesson-list-chevron\\\" aria-label=\\\"species list for the lesson {{ lesson.name }}\\\">\\n                <i class=\\\"fas fa-chevron-down\\\"></i>\\n              </button>\\n          </div>\\n      </div>\\n  </div>\\n  <div data-container-id=\\\"{{ lesson.id }}\\\" class=\\\"species-container js-species-container\\\"></div>\\n</li>\";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport lessonTemplate from 'ui/screens/lists/lesson-template.html';\n\nexport const renderLesson = (lesson) => {\n\n      const { config, lessons, layout } = store.getState();\n\n      const template = document.createElement('template');\n            template.innerHTML = lessonTemplate;\n\n      lesson.hideVideoClass = lesson.hasVideo ? '' : 'hide-important';\n      lesson.hideTextIntroClass = lesson.hasVideo ? 'hide-important' : '';\n\n      const savedLesson = lessons.find(saved => saved.collection.id === lesson.id);\n\n      lesson.isPaused = !!savedLesson || config.collection.id === lesson.id;\n      lesson.icon = lesson.icon || \"https://static.inaturalist.org/photos/57604885/small.jpeg?1575746307\";\n\n      renderTemplate({ lesson }, template.content, document.querySelector('.js-lesson-container'));\n\n      if(savedLesson) {\n            renderReview(savedLesson.layout, savedLesson.collection, null, config);\n      } \n      \n      if(config.collection.id === lesson.id) {\n\n            const row = document.querySelector(`.js-lesson-list-carousel-item[data-lesson-id=\"${lesson.id}\"]`)\n                  if(row) row.classList.add('highlighted-for-review-row');\n\n            if(config.isLandscapeMode) {\n                  setTimeout(() => {\n                        const reviewLink = row.querySelector('.js-review-summary');                  \n                        if(reviewLink) reviewLink.click();\n                  });\n            }\n\n            // current lesson whose current state is not yet saved\n            if(layout && layout.roundScoreCount) {\n                  renderReview(layout, lesson, 'progress-icon', config);\n            }\n      }\n}; \n\nconst renderReview = (layout, lesson, className, config) => {\n      const progressBar = document.querySelector('.js-right-grid progress');\n      const value = !!layout.roundProgressIndex ? layout.roundProgressIndex : progressBar ? progressBar.value : 0;\n      const review = `<progress class=\"absolute\" value=\"${ value }\" max=\"${layout.roundScoreCount}\"></progress>`;\n      const parent = document.querySelector(`.js-review[data-lesson-id=\"${lesson.id}\"]`);\n            parent.innerHTML = review;\n\n      const reviewLinkBtn = document.querySelector(`.js-review-link[data-lesson-id=\"${lesson.id}\"]`);\n            reviewLinkBtn.innerText = 'Resume Quiz';\n};\n","export const renderMediaPlayers = collection => {\n\n    let isAudio = true;\n\n    const mediaPlayers = isAudio \n                ? document.querySelectorAll('.media-audio-players')\n                : document.querySelectorAll('.media-video-players');\n};","// Module\nvar code = \"<div class=\\\"strips description js-rptr-strips\\\" data-repeat-answer=\\\"{{ answers }}\\\">\\n  <div class=\\\"strip\\\">\\n      <button class=\\\"btn snap-icon-btn\\\" data-answer-index=\\\"{{ answer.index }}\\\">\\n        <span>{{ answer.term }}</span>\\n      </button>\\n  </div>\\n</div>\\n    \";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { utils } from 'utils/utils';\nimport { scoreHandler } from 'ui/helpers//score-handler';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport stripTemplate from 'ui/screens/multichoice/horizontal-strips.html';\n\nexport const renderHorizontalStrips = collection => {\n\n    const { config, lesson, layout } = store.getState();\n\n    const item = collection.nextItem || collection.items[collection.itemIndex];\n\n    const binomial = layout.provider.name || layout.provider.taxon;\n    const statement = layout.provider.statement;\n    const providerQuestion = layout.provider.question;\n\n    const parent = renderTestCardTemplate(collection, { vernacularName: item.vernacularName, binomial, question: '', help: '', term: '', className: '', headerClassName: '', bonus: undefined, statement, providerQuestion });\n\n    const template = document.createElement('template');\n          template.innerHTML = stripTemplate;\n\n    let answers = utils.shuffleArray([ ...layout.provider.answers, layout.provider.answer ]);\n\n    answers = answers.map((answer, index) => {\n        return {\n            term: answer,\n            index\n        }\n    });\n\n    renderTemplate({ answers }, template.content, parent);\n\n    document.querySelector('.js-test-card-question').classList.add('calendar-block');\n    document.querySelector('.js-test-card-question').classList.remove('standard-block');\n\n    const strips = document.querySelectorAll('.js-rptr-strips .strip');\n    const taxon = { name: item.taxonomy.family, binomial: item.name, question: layout.provider.answer.term };\n\n    const test = { itemId: item.id, items: strips, taxon, binomial: item.name, \n        questionCount: lesson.questionCount, vernacularName: item.vernacularName,\n        layoutCount: lesson.layoutCount, points: layout.points, clue: '', \n        answerIndex: answers.findIndex(a => a.term === layout.provider.answer), answers, \n        questionText: providerQuestion, statement };\n\n    scoreHandler('strip', test, null, config);\n};","// Module\nvar code = \"<div class=\\\"hide-important\\\">mixed-specimen-images-template.html</div>\\n<div class=\\\"standard-block border-bottom double-centred-block\\\"></div>\\n<div>\\n    <div class=\\\"tiles-container squares js-tiles\\\" data-repeat-image=\\\"{{ images }}\\\">\\n        <div>\\n            <img class=\\\"square\\\"                    \\n            src=\\\"{{ image.medium }}\\\"\\n            data-item-name=\\\"{{ image.itemName }}\\\" \\n            data-url=\\\"{{ image.url }}\\\" />\\n        </div>                \\n    </div>    \\n</div>\\n<div class=\\\"lesson-companion\\\">\\n    <!-- 9 things about Dill: #1 -->\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { firestore } from 'api/firebase/firestore';\nimport { scoreHandler } from 'ui/helpers//score-handler';\nimport { store } from 'redux/store';\nimport { utils } from 'utils/utils';\nimport { itemProperties } from 'ui/helpers/data-checking';\nimport { imageUseCases, scaleImage } from 'ui/helpers/image-handler';\nimport { DOM } from 'ui/dom';\nimport { iconicTaxa, matchIcon } from 'api/snapdragon/iconic-taxa';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { getPoolItems } from 'snapdragon-engine/pool-handler';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nimport specimensTemplate from 'ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images-template.html';\n\nlet listenersToImageSelection = [];\nlet listenersToUserAnswer = [];\n\nexport const listenToUserAnswer = listener => { \n    listenersToUserAnswer.push(listener);\n};\n\nexport const listenToImageSelection = listener => {\n    listenersToImageSelection.push(listener);\n};\n\nexport const renderMixedSpecimenImages = (collection, noOfImagesPerItem, preselectedItems, randomSelection = false) => {\n\n    let imagesPerItem = noOfImagesPerItem || 1;\n\n    const { config, score, lesson } = store.getState();\n\n    const item = R.clone(collection.nextItem);\n\n    if(!item) return;\n\n    const template = document.createElement('template');\n          template.innerHTML = specimensTemplate;\n\n    const parent = DOM.leftBody;\n          parent.innerHTML = '';\n\n    const renderSpecimenImages = async () => {\n\n        const mixedItems = preselectedItems || await getPoolItems(collection);\n\n        const images = utils.shuffleArray(mixedItems).map((item, index) => {\n            \n            let itemImages = randomSelection\n                    ? utils.shuffleArray(item.images)\n                    : item.images.filter(i => i.starred).length > 0 ? item.images.filter(i => i.starred) : utils.shuffleArray(item.images);\n\n            // add more images to starred image, if there is one (when the count will always be 1)\n            if(itemImages.length < imagesPerItem) {\n                itemImages = [ ...itemImages, ...R.take(imagesPerItem -itemImages.length, utils.shuffleArray(item.images).filter(i => !i.starred)) ];\n            }\n            \n\n            return itemImages.map((image, imageIndex) => {\n                if(imageIndex < imagesPerItem) {\n                    if(image.url) {\n                        return { index: index + imageIndex, ...image, medium: scaleImage(image, imageUseCases.MIXED_SPECIMENS, config).medium, itemName: item.name };\n                    } else {\n                        imagesPerItem++;\n                    }\n                }\n            }).filter(image => image);\n        }).flat();\n\n        parent.innerHTML = '';\n\n        snapLog('renderSpecimenImages, image medium values:', images.map(i => i.medium));\n        \n        renderTemplate({ images }, template.content, parent);\n\n        setTimeout(() => {\n            listenersToImageSelection.forEach((listener, index) => {\n                if(index === 0) {\n                    listener(images);\n                }\n            });\n        }, 250);\n            \n        const callback = (score, scoreUpdateTimer) => {\n            listenersToUserAnswer.forEach(listener => listener(score, scoreUpdateTimer));\n        };\n\n        const imageTiles = document.querySelectorAll('.js-tiles img');\n\n        imageTiles.forEach(image => {\n            image.addEventListener('click', async event => {\n                \n                const selectedImage = event.target;\n                const selectedName = selectedImage.dataset.itemName;\n                const selectedItem = await firestore.getSpeciesByName(selectedName);\n\n                const question = item.name;\n                const answer = selectedItem.name;\n\n                const answers = []\n\n                imageTiles.forEach(tile => {\n                    answers.push({ value: tile.dataset.itemName, url: scaleImage({ url:tile.dataset.url }).small });                \n                    if(tile.dataset.itemName !== item.name) {\n                        tile.classList.add('desaturate');\n                    }\n                });\n\n                const questionItem = await firestore.getSpeciesByName(question);\n                const answerItem = await firestore.getSpeciesByName(question);\n\n                const test = { ...score, itemId: item.id, \n                    question, answer, binomial: item.name, \n                    questionCount: lesson.questionCount, layoutCount: lesson.layoutCount, \n                    points: 0, icon: matchIcon(item.taxonomy, iconicTaxa),\n                    vernacularName: itemProperties.getVernacularName(questionItem, config),\n                    answerVernacularName: itemProperties.getVernacularName(answerItem, config),\n                    answers,\n                    questionText: config.isPortraitMode ? 'Swipe and tap to ID' : 'Identify this species'\n                };\n\n                    delete test.answeredIndex;\n                    \n                scoreHandler('image-match', test, callback, config);\n            });\n        });\n    };\n\n    renderSpecimenImages();\n};      ","// Module\nvar code = \"<div class=\\\"mixed-specimen-container\\\">\\n    <div class=\\\"margin-bottom\\\">\\n        <span>You are choosing from</span>\\n        <br>\\n        <br>\\n        <span>\\n            Species shown (in no particular order):\\n        </span>\\n    </div>        \\n    <ul class=\\\"images-names-txt js-images-names-txt\\\"></ul>\\n    <div class=\\\"vertical-evenly-spaced-block\\\">\\n        <button class=\\\"btn snap-action-btn btn-auxiliary js-help-txt\\\">Click to refresh selection</button>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { returnIcon } from 'ui/helpers/icon-handler';\nimport { firestore } from 'api/firebase/firestore';\nimport { bindScore } from 'ui/helpers//score-handler';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\nimport { itemProperties } from 'ui/helpers/data-checking';\nimport { listenToImageSelection, listenToUserAnswer, renderMixedSpecimenImages } from 'ui/screens/multichoice/landscape/mixed-specimen/left/mixed-specimen-images';\nimport { renderMixedSpecimenImagesAndQuestion } from 'ui/screens/multichoice/portrait/mixed-specimen/mixed-specimen-combined';\nimport { renderTemplate } from 'ui/helpers/templating';\n\nimport mixedSpecimenQuestionTemplate from 'ui/screens/multichoice/landscape/mixed-specimen/right/mixed-specimen-question-template.html';\n\nexport const renderMixedSpecimenQuestion = (collection, bonusLayout) => {\n\n    const { config, layout } = store.getState();\n\n    renderMixedSpecimenImagesAndQuestion(collection);\n    \n    return;\n\n    const item = R.clone(collection.nextItem);\n\n    let question = config.isPortraitMode ? 'Slide to ID this species' : 'Identify this species';\n    let help = '(Click on the matching photo.)';\n\n    if(bonusLayout) {\n        question = bonusLayout.overrides.question || question;\n        help = bonusLayout.overrides.help || help;\n    }\n\n    const parent = renderTestCardTemplate(collection, { vernacularName: item.vernacularName, binomial: item.name, question, help, term: '' });\n    \n    const template = document.createElement('template');\n          template.innerHTML = mixedSpecimenQuestionTemplate;\n\n    const instructions = `Identify & Select`;\n    const binomial = item.name;\n\n    renderTemplate({ instructions, binomial }, template.content, parent);\n\n    const subheader = document.querySelector('.mixed-specimen-container > div > span:nth-child(1)');\n          subheader.innerHTML = `Click the picture of <span>${item.vernacularName} </span> from among those on the left.`;\n\n    const listenToImageChangeHandler = async images => {        \n\n        const uniqueSpecies = [ ...new Set(utils.shuffleArray(images).map(i => i.itemName)) ];\n\n        const speciesList = document.querySelector('.js-images-names-txt');\n\n        if(!speciesList) return;\n\n        speciesList.innerHTML = \"\";\n\n        const speciesItems = await Promise.all(uniqueSpecies.map(async species => {\n\n            const imageItem = await firestore.getSpeciesByName(species);\n            const vernacularName = itemProperties.getVernacularName(imageItem, config);\n            const taxonIcon = returnIcon(imageItem);\n\n            return `<li id=\"${species}\">${taxonIcon}<span>${vernacularName}</span><span class=\"binomial margin-left\">${imageItem.name}</li>`;\n        }));\n\n        speciesList.innerHTML = speciesItems.join('');\n    };\n\n    listenToImageSelection(listenToImageChangeHandler);\n\n    const continueLessonBtn = document.querySelector('.js-continue-lesson-btn');\n\n    const pendingScore = {};\n\n    listenToUserAnswer((score, scoreUpdateTimer) => {\n        \n        continueLessonBtn.disabled = false;\n        pendingScore.score = score;\n        pendingScore.scoreUpdateTimer = scoreUpdateTimer;\n    });\n\n    continueLessonBtn.addEventListener('click', () => {\n        window.clearTimeout(pendingScore.scoreUpdateTimer);\n        bindScore(pendingScore.score);        \n    });\n\n    document.querySelector('.js-help-txt').addEventListener('click', () => {\n        const noOfImagesPerItem = layout.bonus ? 6 / collection.items.length : 1;\n        const preselectedItems = layout.bonus ? collection.items : null;\n        // renderMixedSpecimenImages(collection, noOfImagesPerItem, preselectedItems, true);\n    });    \n};\n","// Module\nvar code = \"<div class=\\\"standard-block border-bottom double-centred-block\\\"></div>\\n<div class=\\\"squares traits js-tiles\\\" data-repeat-trait=\\\"{{ traits }}\\\">\\n    <div data-repeat-value=\\\"{{ trait }}\\\">\\n        <img class=\\\"square\\\"                    \\n        src=\\\"{{ value.img.url }}\\\"\\n        data-term=\\\"{{ value.term }}\\\"\\n        data-url=\\\"{{ value.img.url }}\\\" />\\n    </div>                \\n</div>\\n\\n<div class=\\\"lesson-companion\\\">\\n    <!-- 9 things about Dill: #1 -->\\n</div>\";\n// Exports\nmodule.exports = code;","import { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { DOM } from 'ui/dom';\nimport { mixedTraitHandler } from 'ui/screens/multichoice/landscape/mixed-trait/mixed-trait-handler';\n\nimport imagesTemplate from 'ui/screens/multichoice/landscape/mixed-trait/left/mixed-trait-images-template.html';\n\nexport const renderMixedTraitImages = collection => {\n\n    const { layout } = store.getState();\n\n    const template = document.createElement('template');\n          template.innerHTML = imagesTemplate;\n\n    const parent = DOM.leftBody;\n            parent.innerHTML = '';\n    \n    renderTemplate({ traits: layout.traits }, template.content, parent);\n\n    const traitTiles = document.querySelectorAll('.js-tiles div');\n    traitTiles.forEach(tile => {\n        if(tile.querySelector('img').src.indexOf('png') > -1) {\n        traitTiles.forEach(tile => tile.classList.add('png'));\n        }\n    });\n\n    if(layout.requiredTraits.length > 1) {\n        traitTiles.forEach(tile => tile.classList.add('multiple'));\n    }\n\n    traitTiles.forEach(tile => mixedTraitHandler.onClickTileHandler(tile, layout.requiredTraits, traitTiles));\n};","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { scoreHandler, bindScore } from 'ui/helpers//score-handler';\nimport { firestore } from 'api/firebase/firestore';\nimport { utils } from 'utils/utils';\nimport { traitsHandler } from 'ui/helpers/traits-handler';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nconst onTraitsReadyListeners = [];\nconst onTraitsReady = listener => {\n    onTraitsReadyListeners.push(listener);\n};\n\nconst onTraitClickedListeners = [];\nconst onTraitClicked = listener => {\n    onTraitClickedListeners.push(listener);\n};\n\nconst getMatchingTrait = (layoutTraits, traitValues) => {\n\n    try {\n        let requiredTraitValues, trait;\n\n        for (let [key, obj] of Object.entries(traitValues)) {\n            let t;\n            layoutTraits.map(t => { \n                if(t.toLowerCase() === utils.toCamelCase(key).toLowerCase()) {\n                    requiredTraitValues = obj.value.map(v => v.toLowerCase());\n                    trait = t;\n                }\n            }) \n        };\n    \n        return { requiredTraitValues, trait };\n    } catch (e) {\n      logError(getMatchingTrait, e);\n      return { requiredTraitValues: [], trait: {}};\n    }\n\n};\n\nconst fetchTraits = async (trait, requiredTraitValues, required) => {\n\n    const glossary = store.getState().glossary;\n\n    let traits = await firestore.getTraitDefinitions(glossary, required, trait);\n        traits.forEach(t => {\n            t.term = t.term.toLowerCase();\n            if(t.alt) t.alt = t.alt.toLowerCase();\n            return t;\n        });\n\n    if(!requiredTraitValues) return { traits: null, requiredTraits: null};\n\n    let multiples = traitsHandler.getNMultiplesFromArray(traits.map(t => t.term), requiredTraitValues.length);\n\n        multiples = multiples.filter(multiple => {\n            return !traitsHandler.doArraysHaveSameValues(multiple, requiredTraitValues);\n        });\n        \n        let requiredTraits = traits.filter(t => R.contains(t.term, requiredTraitValues));\n        \n        multiples = utils.shuffleArray([ ...R.take(5, multiples), requiredTraitValues ]);\n\n        traits = multiples.map(multiple => {\n            return multiple.map(term => traits.find(trait => trait.term === term));\n        });\n\n    onTraitsReadyListeners.forEach(listener => listener(traits, requiredTraits));\n\n    return { traits, requiredTraits };\n};\n\nconst pendingScore = {};\n\nconst callback = (score, scoreUpdateTimer) => {\n    const continueLessonBtn = document.querySelector('.js-continue-lesson-btn');\n          continueLessonBtn.disabled = false;\n    pendingScore.score = score;\n    pendingScore.scoreUpdateTimer = scoreUpdateTimer;\n    \n    continueLessonBtn.addEventListener('click', () => {\n        window.clearTimeout(pendingScore.scoreUpdateTimer);\n        bindScore(pendingScore.score);        \n    });\n};\n\nconst onClickTileHandler = (tile, requiredTraits, tiles) => {\n\n    const { config, lesson, collection } = store.getState();\n\n    const item = collection.nextItem;\n\n    tile.addEventListener('click', e => {\n        \n        const tile = e.currentTarget;\n        const traits = Array.from(tile.querySelectorAll('img')).map(t => t.dataset.term);\n        const images = Array.from(tiles).map(t => t.querySelector('img').dataset);\n        const answers = images.map(i => { return { value: i.term, url: i.url } })\n        const test = {\n            points: 0,\n            binomial: item.name, \n            trait: true,\n            question: requiredTraits.map(trait => trait.term),\n            answer: traits,\n            questionCount: lesson.questionCount, \n            layoutCount: lesson.layoutCount,\n            answers,\n            questionText: 'Match the trait'\n        }\n        scoreHandler('image-match', test, callback, config);\n\n        tiles.forEach(tile => {\n            if(!traitsHandler.doArraysHaveSameValues(Array.from(tile.querySelectorAll('img')).map(img => img.dataset.term), requiredTraits.map(trait => trait.term))) {\n                tile.querySelectorAll('img').forEach(img => img.classList.add('desaturate'));\n            }\n        });\n})};\n\nexport const mixedTraitHandler = {\n    getMatchingTrait,\n    fetchTraits,\n    onTraitsReady,\n    onTraitClicked,\n    onClickTileHandler\n};","// Module\nvar code = \"<div class=\\\"mixed-specimen-container\\\">\\n    <div class=\\\"margin-bottom\\\"><span>{{ help }}</span></div>\\n    <ul class=\\\"traits-names-txt js-traits-names-txt\\\" data-repeat-trait=\\\"{{ traits }}\\\">\\n        <li>\\n            <img src=\\\"{{ trait.img.url }}\\\" alt=\\\"{{ trait.term }}\\\">\\n            <span>{{ trait.term }}</span>\\n        </li>\\n    </ul>\\n</div>\";\n// Exports\nmodule.exports = code;","import { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\nimport { renderMultiStrips } from 'ui/screens/multichoice/multi-strips';\n\nimport questionTemplate from 'ui/screens/multichoice/landscape/mixed-trait/right/mixed-trait-question-template.html';\n\nexport const renderMixedTraitQuestion = collection => {\n\n    const init = async () => {\n\n        const { layout, collection, config } = store.getState();\n\n        const template = document.createElement('template');\n              template.innerHTML = questionTemplate;\n        \n        const item = collection.nextItem;\n        const question = 'Match the trait';\n        const help = `Select the correct ${utils.fromCamelCase(layout.trait)}`;\n    \n        const parent = renderTestCardTemplate(collection, { vernacularName: item.vernacularName, binomial: item.name, question, help, term: '' });              \n\n        renderMultiStrips(collection, null, { traits: layout.traits, requiredTraits: layout.requiredTraits, item, question, help });\n\n        // if(config.isPortraitMode) {\n        //     renderMultiStrips(collection, null, { traits: layout.traits, requiredTraits: layout.requiredTraits, item, question, help });\n        //     return;\n        // }\n\n        // parent.innerHTML = '';\n        // renderTemplate({ traits: Array.from(new Set(layout.traits.flat())), help }, template.content, parent);\n        // document.querySelectorAll('.js-traits-names-txt img').forEach(img => {\n        //     if(img.src.indexOf('png') > -1) {\n        //         img.classList.add('png');\n        //     }\n        // });\n    };\n\n    init();\n};","// Module\nvar code = \"<ul class=\\\"strips description js-rptr-strips\\\" data-repeat-answer=\\\"{{ answers }}\\\">\\n  <li class=\\\"strip\\\">\\n      <button class=\\\"btn snap-icon-btn\\\" data-answer-index=\\\"{{ answer.index }}\\\" data-name=\\\"{{ answer.name }}\\\" data-names=\\\"{{ answer.names }}\\\">\\n          <span>{{ answer.term }}</span>\\n      </button>\\n    </li>\\n</ul>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"strips description js-rptr-strips\\\" data-repeat-answer=\\\"{{ answers }}\\\">\\n    <div class=\\\"strip\\\">\\n        <button class=\\\"double-centred-block btn snap-icon-btn\\\" data-answer-index=\\\"{{ answer.index }}\\\">\\n            <img width=\\\"25px\\\" height=\\\"25px\\\" src=\\\"{{ answer.img.url }}\\\" alt=\\\"\\\">\\n            <span>{{ answer.term }}</span>\\n        </button>\\n    </div>\\n  </div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { epithets } from 'api/botanical-latin';\nimport { itemProperties } from 'ui/helpers/data-checking';\nimport { getPoolItems } from 'snapdragon-engine/pool-handler';\nimport { scoreHandler } from 'ui/helpers//score-handler';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\nimport { matchTaxon, iconicTaxa } from 'api/snapdragon/iconic-taxa';\nimport { firestore } from 'api/firebase/firestore';\nimport { lessonStateHelper } from 'ui/screens/lists/lesson-state-helper';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nimport stripTemplate from 'ui/screens/multichoice/multi-strips-template.html';\nimport stripWithImageTemplate from 'ui/screens/multichoice/multi-strips-with-images.html';\n\nimport audioMediaTemplate from 'ui/screens/common/audio-media-template.html';\n\nexport const renderMultiStrips = (collection, bonus, args) => {\n\n    try {\n\n        const { config, lesson, layout, userAction } = store.getState();\n\n        if(lessonStateHelper.overrideLesson(userAction, config)) { return; }\n\n        const item = collection.nextItem || collection.items[collection.itemIndex];\n\n        const taxon = matchTaxon(item.taxonomy, iconicTaxa);                        \n    \n        const screen = bonus ? bonus.screen || layout.screens[1] : layout.screens[1];\n\n        let defaultQueryLimit = 6, defaultLanguage = 'en';\n\n        defaultLanguage = config.language;\n\n        const init = async () => {\n\n            const render = (answer, answers, overrides) => {\n\n                const vernacularName = (overrides && overrides.vernacularName !== undefined) ? overrides.vernacularName : item.vernacularName;\n                const binomial = (overrides && overrides.binomial !== undefined) ? overrides.binomial : item.name;\n                const question = (overrides && overrides.question) ? overrides.question : 'Match the name';\n                const helpDefault = config.isLandscapeMode ? '(Select the name below.)' : '(Tap on the name below.)';\n                const help = (overrides && overrides.help !== undefined) ? overrides.help : helpDefault;\n                const term = (overrides && overrides.term !== undefined) ? overrides.term : '';\n                const className = (overrides && overrides.className !== undefined) ? overrides.className : '';\n                const headerClassName = (overrides && overrides.headerClassName !== undefined) ? overrides.headerClassName : '';\n                const clue = (overrides && overrides.clue !== undefined) ? overrides.clue : null;\n                \n                const parent = renderTestCardTemplate(collection, { vernacularName, binomial, question, help, term, className, headerClassName, bonus });\n\n                const template = document.createElement('template');\n                      template.innerHTML = answer.img ? stripWithImageTemplate : stripTemplate;\n\n                answers.forEach((answer, index) => {\n                    answer.index = index;\n                    answer.name = answer.name || '';\n                    answer.names = answer.names ? answer.names.join(', ') : '';\n                });\n\n                renderTemplate({ answers }, template.content, parent);\n\n                const strips = document.querySelectorAll('.js-rptr-strips .strip');\n\n                if(overrides.italicise) strips.forEach(strip => strip.classList.add('binomial'));\n\n                const taxon = { name: item.taxonomy.family, binomial: item.name, question: answer.term };\n\n                const test = { \n                    itemId: item.id, \n                    items: strips, \n                    taxon, binomial: \n                    item.name, \n                    questionCount: lesson.questionCount, \n                    layoutCount: lesson.layoutCount, \n                    points: layout.points, \n                    clue, \n                    answerIndex: answers.findIndex(a => a.term === answer.term),\n                    questionText: question\n                };\n                        \n                scoreHandler('strip', test, null, config);\n            }\n\n            if(screen.name === 'species-scientifics') {\n\n                const renderBinomialQuestions = async () => {\n\n                    let answer, answers, help;\n\n                    const buildQuestion = async () => {\n\n                        answer = { term: item.name };\n                        answers = await getPoolItems(collection, 6);\n                        answers = R.take(8, answers).filter(s => s.name.toLowerCase() !== item.name.toLowerCase()).map(s => s.name);\n                        answers = R.take(5, answers);\n                        answers.push(item.name);\n                        answers = answers.map(a => { return { term: a } });\n                        answers = utils.shuffleArray(answers);\n                        \n                        help = config.isLandscapeMode ? '(Select the answer)' : '(Tap on the answer)';\n                    }\n\n                    await buildQuestion();\n\n                    render( answer, answers, { binomial: 'Latin name', question: 'What\\'s the latin name?', help, italicise: true });\n                };\n\n                renderBinomialQuestions();\n            }\n\n            if(screen.name === 'species-vernaculars') {\n\n                const renderVernacularQuestions = async () => {\n\n                    let answer, answers, help;\n\n                    const buildQuestion = async () => {\n\n                        answer = { term: item.vernacularName };   \n                        answers = await getPoolItems(collection, 6);\n                        answers = answers.map(a => itemProperties.getVernacularName(a, config, false, 'vernacularName', defaultLanguage));\n                        answers = R.take(5, answers.filter(a => a !== item.vernacularName));\n                        answers = utils.shuffleArray([item.vernacularName, ...answers]);\n                        answers = answers.map(a => { return { term: a } });\n                \n                        help = config.isLandscapeMode ? '(Select the answer)' : '(Tap on the answer)';\n                    };\n\n                    await buildQuestion();\n\n                    render(answer, answers, { vernacularName: 'Common name', question: `What's the common name?`, help });\n                };\n\n                renderVernacularQuestions();\n            }\n\n            if(screen.name === 'species-identification') {\n\n                const renderIdQuestions = async () => {\n\n                    let answer, answers, help;\n\n                    const buildQuestion = async () => {\n\n                        answer = { term: item.quickId };   \n                        answers = await getPoolItems(collection, 6);\n                        answers = answers.map(a => a.quickId);\n                        answers = R.take(5, answers.filter(a => a !== item.quickId));\n                        answers = utils.shuffleArray([item.quickId, ...answers]);\n                        answers = answers.map(a => { return { term: a } });\n                \n                        help = config.isLandscapeMode ? '(Select the answer)' : '(Tap on the answer)';\n                    };\n\n                    await buildQuestion();\n\n                    render(answer, answers, { vernacularName: item.vernacularName, question: 'Which description fits?', help });\n                };\n\n                renderIdQuestions();\n            }\n\n            if(screen.name === 'family-strips') {\n\n                const random = utils.getRandomInt(2);\n\n                const type = random === 0 ? 'identification' : 'summary';\n\n                const number = config.isPortraitMode ? 4 : 4;\n\n                const families = await firestore.getFamiliesByIconicTaxon(taxon.rank, taxon.value, item.lichen, config);\n                const answer = { term: item.family[type], name: item.family.name } || { type: { term: `Missing ${type}`}, name: item.family.name };\n                const alternativeFamilies = R.take(number-1, R.take(number, utils.shuffleArray(families))).filter(f => f.name.toLowerCase() !== item.taxonomy.family.toLowerCase());\n                let alternatives = alternativeFamilies.filter(f => f[type] && f[type] !== undefined && f[type] !== '').map(f => { return { type: f[type], name: f.name, names: f.names } });\n                    alternatives = alternatives.map(a => { return { term: a.type, name: a.name, names: a.names } });\n                let answers = utils.shuffleArray([answer, ...alternatives]);                    \n                \n                const help = config.isLandscapeMode ? '(Select the description below.)' : '(Tap on the description.)';\n\n                render(answer, answers, { question: 'Match species family', help, clue: item.taxonomy.family });\n            }\n\n            if(screen.name === 'epithet') {\n                \n                const epithet = layout.epithet.latin.join(', ');\n                const number = config.isPortraitMode ? 6 : 6;\n                \n                let alternatives = R.take(number-1, utils.shuffleArray(epithets)).filter(e => !R.contains(e.latin, epithet));\n                    alternatives = alternatives.map(e => e.en.join(', '));\n                    alternatives = alternatives.map(a => { return { term: a } });\n                let answer = epithets.find(e => e.latin.join(', ').toUpperCase() === epithet.toUpperCase());\n                    answer = answer ? answer[config.language][0] : epithet;\n                    answer = { term: answer };\n                \n                const answers = utils.shuffleArray([answer, ...alternatives]);\n                \n                if(config.isLandscapeMode) {            \n                    render(answer, answers, { question: layout.epithet.latin.join(', '), help: '(Match the latin term)' });\n                } else {\n                    render(answer, answers, { question: 'Match latin word', help: '', vernacularName: '', binomial: '', term: layout.epithet.latin.join(', ') });\n                }\n            }\n\n            if(screen.name === 'definition') {\n                render({ term: bonus.question }, bonus.answers.map(a => { return { term: a } }), bonus.overrides);\n            }\n\n            if(screen.name === 'family') {\n\n                const indices = config.isPortraitMode ? [5,6] : [5,6];\n\n                let families = await firestore.getFamiliesByIconicTaxon(taxon.rank, taxon.value, item.lichen, config);\n                let family = item.taxonomy.family;\n                let otherFamilies = R.take(indices[0], R.take(indices[1], utils.shuffleArray(families)).filter(family => family.name.toLowerCase() !== item.taxonomy.family.toLowerCase()));\n                let otherFamiliesLatinNames = otherFamilies.map(family => family.name);\n                let otherFamiliesCommonNames = otherFamilies.map(of => of.names[0]);\n                \n                let answer, answers;\n\n                const random = utils.getRandomInt(2);\n\n                switch(random) {            \n                    case 0:\n                        answer = { term: item.family.vernacularName };\n                        otherFamiliesCommonNames = otherFamiliesCommonNames.map(a => { return { term: a } });\n                        answers = utils.shuffleArray([answer, ...otherFamiliesCommonNames]);\n                        if(answer === undefined) console.log('Missing question - case 0 - in multi-strips for: ', item.name);\n                        render(answer, answers, { question: 'Match family name' });\n                    break;\n                    case 1:\n                        answer = { term: family };\n                        otherFamiliesLatinNames = otherFamiliesLatinNames.map(a => { return { term: a } });\n                        answers = utils.shuffleArray([answer, ...otherFamiliesLatinNames]);\n                        if(answer === undefined) console.log('Missing question - case 1 - in multi-strips for: ', item.name);\n                        render(answer, answers, { question: 'Match family name', italicise: true });\n                    break;\n                } \n            }\n\n            if(screen.name === 'trait-property') {\n\n                render({ term: bonus.question }, bonus.answers.map(a => { return { term: a } }), bonus.overrides);\n\n                if(bonus.overrides.trait && bonus.overrides.trait.name === 'song') {\n\n                        const renderBirdsong = async () => {\n\n                            const parent = document.querySelector('.js-question-help');\n                                  parent.innerHTML = '';\n\n                            const template = document.createElement('template');\n                                  template.innerHTML = audioMediaTemplate;\n\n                            const xcID = bonus.overrides.trait.value[0];\n\n                            const mp3 = await firestore.getBirdsong(xcID);\n                            \n                            renderTemplate({ mp3, title: item.name }, template.content, parent);\n\n                            const header = document.querySelector('.js-test-card-question');\n                                  header.classList.remove('standard-block');\n                                  header.classList.add('double-standard-block');\n\n                            const content = document.querySelector('.js-test-card-content');\n                                  content.classList.add('test-card-content-less-standard-block');\n                        };\n\n                        renderBirdsong();\n                }\n            }\n\n            if(layout.name === 'mixed-trait-images') {\n\n                // portrait only - redirect from renderMixedTraitImages\n\n                const { traits, requiredTraits, item, question, help } = args;\n\n                const answers = R.flatten(traits);\n                const answer = requiredTraits[0];\n\n                render(answer, answers, { binomial: item.name, question, help, italicise: true});\n\n            }\n        }\n\n        init();\n\n    } catch(e) {\n        console.error('Crashed out somwhere on multi-strips with this error: ', e);        \n    }\n};","// Module\nvar code = \"<div class=\\\"species-card-images carousel js-test-card-container-images\\\"></div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { itemProperties } from 'ui/helpers/data-checking';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\nimport { scoreHandler, bindScore } from 'ui/helpers//score-handler';\nimport { imageSlider } from 'ui/screens/common/image-slider';\nimport { imageUseCases, prepImagesForCarousel, scaleImage } from 'ui/helpers/image-handler';\nimport { getPoolItems } from 'snapdragon-engine/pool-handler';\nimport { snapLog, logError } from 'ui/helpers/logging-handler';\n\nimport mixedSpecimenTemplate from 'ui/screens/multichoice/portrait/mixed-specimen/mixed-specimen-combined-template.html';\n\nexport const renderMixedSpecimenImagesAndQuestion = collection => {\n\n    const { config, lesson, layout, score } = store.getState();\n\n    const item = R.clone(collection.nextItem);\n\n    if(!item) return;\n\n    const init = async () => {\n\n        const getPortraitImages = images => {\n            const multiImages = utils.flatten(images.map(image => { \n                const images = image.srcs.filter(i => i.starred).length === 0 ? R.take(1, utils.shuffleArray(image.srcs)) : image.srcs.filter(i => i.starred);\n                const item = { name: image.itemName, images };\n                return prepImagesForCarousel(item, config, imageUseCases.MIXED_SPECIMENS);\n            }));\n            return multiImages;\n        }\n\n        const items = await getPoolItems(collection);\n\n        let images = items.map((item, index) => { \n            return { index: index + 1, srcs: item.images, itemName: item.name };\n        });\n\n        images = getPortraitImages(images);\n\n        let question = config.islandscapeMode ? 'Find then click to ID' : 'Swipe and tap to ID';\n\n        let parent = renderTestCardTemplate(collection, { vernacularName: item.vernacularName, binomial: item.name, question, help: '(Click on the matching photo.)', term: '' });\n            parent.innerHTML = '';\n            \n        const template = document.createElement('template');\n              template.innerHTML = mixedSpecimenTemplate;\n        \n        renderTemplate({}, template.content, parent);\n\n        parent = document.querySelector('.js-test-card-container-images');\n\n        imageSlider({ config, images: utils.shuffleArray(images), parent, identifier: 'mixed-specimens' });\n\n        const continueLessonBtn = document.querySelector('.js-continue-lesson-btn');\n        const boundScore = {};\n\n        const answers = [];\n\n        images.forEach(image => {\n            answers.push({ value: image.itemName, url: scaleImage({ url:image.url }).small });\n        });\n\n        document.querySelectorAll('#imageSlider_mixed-specimens .carousel-item img').forEach(img => {\n            \n            img.addEventListener('click', event => {\n\n                const layer = event.target;\n                const selectedName = layer.dataset.itemName;\n                const question = item.name;\n                const answer = selectedName || 'incorrect';\n                const isCorrect = answer === question;\n                const answerIcon = document.createElement('span');\n                      answerIcon.innerHTML = isCorrect \n                            ? '<span class=\"icon\"><i class=\"fas fa-check-circle\"></i></span>'\n                            : '<span class=\"icon\"><i class=\"fas fa-times-circle\"></i></span>';\n\n                const test = { ...score, itemId: item.id, \n                    question, answer, binomial: item.name, \n                    questionCount: lesson.questionCount, layoutCount: lesson.layoutCount, \n                    points: layout.points,\n                    answers,\n                    questionText: config.isPortraitMode ? 'Swipe and tap to ID' : 'Identify this species',\n                    vernacularName: itemProperties.getVernacularName(item, config),\n                };\n\n                const callback = (score, scoreUpdateTimer) => {\n                    boundScore.score = score;\n                    boundScore.scoreUpdateTimer = scoreUpdateTimer;\n                    continueLessonBtn.disabled = false;          \n                    if(!score.success) {\n                        const wrongItem = items.find(item => item.name === score.answer);\n                        const vernacularName = itemProperties.getVernacularName(wrongItem, config);\n                        const name = vernacularName || score.answer;\n                    }\n                };\n\n                scoreHandler('image-match', test, callback, config);  \n            });\n        });\n\n        continueLessonBtn.addEventListener('click', event => {\n\n            if(!score.success) {            \n                setTimeout(() => {\n                    window.clearTimeout(boundScore.scoreUpdateTimer);\n                    bindScore(boundScore.score);\n                });\n            } else {\n                window.clearTimeout(boundScore.scoreUpdateTimer);\n                bindScore(boundScore.score);\n            }\n\n        });\n    };\n\n    try {\n      init();\n    } catch(e) {\n      logError('renderMixedSpecimenImagesAndQuestion init', e);\n    }\n};\n","import { store } from 'redux/store';\nimport { renderLessons } from 'ui/screens/lists/lesson-list';\n\nexport const renderHistory = history => {\n            \n    const { collection} = store.getState();\n\n    renderLessons();\n}    ","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\n\nexport const getLessonScores = (history, lesson, stateScore, savedScore) => {\n\n      if(!history) return [ stateScore ];\n\n      const historyIsUpToDate = R.contains(stateScore.binomial, history.scores.map(s => s.binomial));\n\n      let scores = [];\n\n      if(lesson.isNextRound) {\n            scores = historyIsUpToDate\n                  ? history.scores\n                  : stateScore.total === 0\n                        ? history.scores\n                        : [...history.scores, stateScore];\n      } else {\n            scores = historyIsUpToDate\n                  ? history.scores\n                  : [...history.scores, stateScore];\n      }\n      \n      return scores;\n};\n\nconst getSummaryRows = (rows) => {\n      rows = rows.map((r, i) => {\n            const _r = {\n                  ...r, id: `${i}${utils.toCamelCase(r.binomial)}`, question: r.question.term ? r.question.term : r.question, \n                        answers: r.answers.map(a => { return getAnswer(a, r); })\n            };\n            return _r;\n      });\n      return rows;\n};\n\nexport const scoreSummaryHandler = {\n    getLessonScores,\n    getSummaryRows\n}\n\nfunction getAnswer(a, r) {\n      \n      const isObj = typeof a === 'object';\n\n      const value = isObj ? a.value || a.term : a;\n      const hasImage = isObj && !!a.url;\n      const url = isObj ? a.url : '';\n      const question = r.question.term || r.question;\n      const isTrue = \n                  value !== \"\" && \n                          (utils.parseToLowerCase(value) === utils.parseToLowerCase(question))\n                        // || R.contains(value, r.answer))\n\n      const isWrongAnswer = !isTrue && utils.parseToLowerCase(value) === utils.parseToLowerCase(r.answer);\n      const name = isObj ? a.name || '' : '';\n      \n      const answer = {\n            value,\n            url,\n            hasImage,\n            isTrue,\n            isWrongAnswer,\n            name\n      };\n      return answer;\n}\n","// Module\nvar code = \"<div class=\\\"horizontal-evenly-spaced-block js-no-questions\\\">\\n    <span>You haven't answered any questions yet.</span>\\n</div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"score-summary-row species\\\">\\n    <div></div>\\n    <div>\\n        <div></div>\\n        <div>\\n            <span>{{ vernacularName }}</span>\\n            <span class=\\\"latin\\\">{{ binomial }}</span>\\n        </div>                \\n    </div>\\n    <div>{{ score }}</div>\\n</div>\\n\\n    <div data-repeat-row=\\\"{{ rows }}\\\">\\n\\n    <div class=\\\"collapsed score-summary-row header\\\" data-toggle=\\\"collapse\\\" data-target=\\\"#{{ row.id }}\\\" aria-expanded=\\\"false\\\" aria-controls=\\\"{{ row.id }}\\\">  \\n        <div data-is-true=\\\"{{ row.success }}\\\">\\n            <i class=\\\"fas fa-check\\\"></i>\\n            <i class=\\\"fas fa-times\\\"></i>\\n        </div>\\n        <div>\\n            <div class=\\\"binomial\\\">{{ row.statement }}</div>\\n            <div>{{ row.questionText }}</div>\\n        </div>\\n        <div>\\n            <i class=\\\"fas fa-chevron-down\\\"></i>\\n        </div>\\n    </div>\\n    \\n    <div id=\\\"{{ row.id }}\\\" class=\\\"collapse score-summary-row in-columns\\\" data-repeat-answer=\\\"{{ row.answers }}\\\" data-parent=\\\"#accordion\\\">  \\n        <div data-question=\\\"{{ ^.row.question }}\\\">\\n            <div>                    \\n            </div>\\n            <div data-is-true=\\\"{{ answer.isTrue }}\\\" data-is-wrong-answer=\\\"{{ answer.isWrongAnswer }}\\\">\\n                <div>\\n                    <img data-has-image=\\\"{{ answer.hasImage }}\\\" src=\\\"{{ answer.url }}\\\" alt=\\\"{{ answer.value }}\\\">\\n                </div>\\n                <div>\\n                    <span>{{ answer.value }}</span><span class=\\\"hide-empty margin-left\\\">{{ answer.name }}</span>\\n                </div>\\n                <div></div>\\n            </div>\\n            <div></div>\\n        </div>\\n    </div>\\n\\n</div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"snapdragon-container score-summary-container js-test-card-container\\\">\\n    <div class=\\\"js-summary-card\\\">\\n        <div class=\\\"test-card-question standard-block centred-block js-test-card-question\\\">            \\n            <div class=\\\"question question-txt \\\">\\n                    <div>\\n                        <span class=\\\"hide-empty question-question js-question-question\\\">Quiz progress</span>\\n                        <span class=\\\"hide-empty question-statement\\\"></span>\\n                    </div>\\n                </div>\\n        </div>\\n        <div id=\\\"accordion\\\" class=\\\"score-summary scrollable review-summary\\\">\\n            <div class=\\\"score-summary-row-title\\\">\\n                <div>\\n                    <div class=\\\"double-centred-block\\\">\\n                        <span class=\\\"uppercase\\\">{{ collection.name }}</span>\\n                    </div>\\n                    <div class=\\\"double-centred-block\\\">\\n                        <span>Round {{ lesson.currentRound }} of {{ lesson.rounds }}</span>\\n                    </div>                \\n                </div>\\n            </div>\\n            <div class=\\\"score-summary-footer running-block centred-block\\\">\\n                <button class=\\\"btn snap-btn fit-width js-continue-link\\\">Continue lesson</button>\\n            </div>\\n            <div class=\\\"js-score-summary-rows\\\"></div>\\n            <div class=\\\"score-summary-footer running-block centred-block\\\">\\n                <button class=\\\"btn snap-btn fit-width js-continue-link\\\">Continue lesson</button>\\n            </div>\\n        </div>    \\n    </div>\\n</div>\\n\";\n// Exports\nmodule.exports = code;","import { enums } from 'ui/helpers/enum-helper';\nimport { itemProperties } from 'ui/helpers/data-checking';\nimport { store } from 'redux/store';\nimport { DOM } from 'ui/dom';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { lessonStateHandler } from 'ui/screens/lists/lesson-state-handler';\nimport { lessonStateHelper } from 'ui/screens/lists/lesson-state-helper';\nimport { scoreSummaryHandler } from 'ui/screens/progress/score-summary-handler';\n\nimport summaryTemplate from 'ui/screens/progress/score-summary-template.html';\nimport summaryRowTemplate from 'ui/screens/progress/score-summary-row-template.html';\nimport summaryNoRowTemplate from 'ui/screens/progress/score-summary-no-row-template.html';\n\nexport const renderScoreSummary = (lessonId, summaryContainer) => {\n\n      const init = () => {\n\n            const { lessons, score: stateScore, userAction } = store.getState();\n\n            const { collection, history, config, score: savedScore } = lessons.length > 0\n                        ? !!lessons.find(l => l.collection.id === parseInt(lessonId))\n                              ? lessons.find(l => l.collection.id === parseInt(lessonId))\n                              : store.getState()\n                        : store.getState();\n      \n            const { lesson } = store.getState();\n      \n            if(lessonStateHelper.overrideLesson(userAction, config)) { return; }\n      \n            const template = document.createElement('template');\n                  template.innerHTML = summaryTemplate;\n      \n            const parent = config.isLandscapeMode\n                        ? summaryContainer || document.querySelector('#lessonModal .js-modal-text')\n                        : DOM.rightBody ;\n                  parent.innerHTML = '';\n            \n            renderTemplate({ collection, lesson }, template.content, parent);\n\n            const actionLinks = document.querySelectorAll('.js-continue-link');\n\n            setTimeout(() => {\n              actionLinks[0].focus();\n            }, 250);\n\n            if(summaryContainer) {\n                  actionLinks.forEach(link => link.classList.add('snap-inactive'));\n            }\n\n            if(lesson.layoutName === 'summary') {\n                  const progressLink = document.querySelector('.js-review-progress');\n                        progressLink.innerHTML = '';\n            }\n            \n            let scores = scoreSummaryHandler.getLessonScores(history, lesson, stateScore, savedScore).reverse();\n                scores.forEach(s => renderScoreSummaryRow(scores, s, config));\n      \n            const handleContinueLesson = async e => {\n                e.preventDefault();\n                lessonStateHandler.changeRequest({\n                      requestType: enums.lessonState.NEXT_ROUND,\n                      requestArgs: {\n                        id: lessonId,\n                        lesson: { ...lesson, isNextRound: true }\n                      }\n                    });\n            };\n      \n            const handleNewLesson = async event => {                   \n                  await lessonStateHelper.purgeLesson();\n            };\n      \n            if(lesson.isLessonComplete) {\n                  actionLinks.forEach(actionLink => {\n                        actionLink.innerHTML = 'START NEW LESSON';\n                        actionLink.addEventListener('click', handleNewLesson, { once: true });\n                  });\n            } else {\n                  actionLinks.forEach(actionLink => {\n                        actionLink.addEventListener('click', handleContinueLesson, { once: true });\n                  });\n            }\n\n            window.addEventListener('keydown', e => {\n              if(e.key === 'Enter') {\n                handleContinueLesson(e);\n              }                  \n            }, { once: true });\n      };\n\n      init();\n}\n\nconst renderScoreSummaryRow = (scores, s, config) => {\n    \n      const template = document.createElement('template');\n            template.innerHTML = summaryRowTemplate;\n\n      const parent = document.querySelector('.js-score-summary-rows');\n            \n      if(s.total === 0) {\n            parent.innerHTML = '';\n            template.innerHTML = summaryNoRowTemplate;            \n            renderTemplate({ }, template.content, parent);\n            return;\n      }\n      let rows = [ ...s.passes, ...s.fails ];\n          rows = scoreSummaryHandler.getSummaryRows(rows);          \n\n      const vernacularName = s.vernacularName || itemProperties.getVernacularName(s.binomial, config);\n\n      renderTemplate({ vernacularName, binomial: s.binomial, rows, score: `${s.correct}/${s.total}` }, template.content, parent);\n\n      if(scores.length > 0) {\n            const noQuestionsText = parent.querySelector('.js-no-questions');                  \n            if(noQuestionsText) {\n                  noQuestionsText.innerHTML = '';\n            }\n      }\n};","import { subscription } from 'redux/subscriptions';\nimport { store } from 'redux/store';\nimport { renderScoreSummary } from 'ui/screens/progress/score-summary';\n\nexport const renderSummary = history => {\n\n    subscription.remove(subscription.getByName('renderSummary'));\n\n    const { collection } = store.getState();\n\n    renderScoreSummary(collection.id);\n\n    return;\n};\n\n","import { store } from 'redux/store';\nimport { renderInput } from 'ui/screens/text-entry/text-entry';\n\nexport const renderTextEntry = (collection) => {\n\n    const { layout } = store.getState();\n\n    const screen = layout.screens.filter(el => el.name === 'text-entry')[0];\n    const item = collection.nextItem;\n    \n    if(!screen) return;\n\n    item.vernacular = item.vernacularName;\n\n    const q = screen.taxon === 'name' ? item.name : \n                    screen.taxon === 'vernacular' \n                        ? item.vernacularName\n                        : item.taxonomy[screen.taxon];\n\n    const question = { binomial: item.name, species: item.taxonomy.species, genus: item.taxonomy.genus, taxon: screen.taxon, question: q, common: item.vernacularName };\n\n    renderInput(screen, question);\n};","// Module\nvar code = \"<div class=\\\"centred-block standard-block\\\">\\n    <button class=\\\"btn snap-icon-btn block\\\">\\n      <span class=\\\"given genus\\\">{{ genus }}</span>\\n    </button>\\n    <button class=\\\"btn snap-icon-btn block\\\">\\n      <span class=\\\"species\\\">{{ species }}</span>\\n    </button>\\n</div>\\n<div class=\\\"text-complete-container\\\">\\n    <div class=\\\"margin-bottom landscape\\\">Click to select the correct name:</div>\\n    <div class=\\\"margin-bottom portrait\\\">Tap to select the correct name:</div>\\n    <div class=\\\"pool js-pool\\\" data-repeat-answer=\\\"{{ answers }}\\\">    \\n        <button type=\\\"submit\\\" class=\\\"btn snap-icon-btn block\\\">\\n            <span>{{ answer.value }}</span>\\n        </button>\\n    </div>\\n</div>\";\n// Exports\nmodule.exports = code;","import * as R from 'ramda';\n\nimport { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { scoreHandler, continueLessonHandler } from 'ui/helpers//score-handler';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\n\nimport completeTemplate from 'ui/screens/text-entry/text-complete-template.html';\n\nexport const renderCompleteText = (collection) => {\n\n    const item = collection.nextItem;\n\n    const { layout, config, lessonPlan } = store.getState();\n\n    const screen = layout.screens.filter(el => el.name === 'text-complete')[0];\n    \n    if(!screen) return;\n\n    let question, genus, species, givenTaxon, vernacularName, binomial, questionTxt;\n\n    vernacularName = item.vernacularName;\n    binomial = item.name;\n    questionTxt = 'Complete the latin name';\n\n    switch(screen.type) {\n        case 'text-complete-genus':\n            question = item.taxonomy.genus;\n            genus = '---';\n            species = item.taxonomy.species;\n            binomial = `--- ${item.taxonomy.species}`;\n            givenTaxon = 'genus';\n            questionTxt = 'Select genus name';\n            break;\n        case 'text-complete-species':\n            question = item.taxonomy.species;\n            genus = item.taxonomy.genus;\n            species = '---';\n            binomial = `${item.taxonomy.genus} ---`;\n            givenTaxon = 'species';\n            questionTxt = 'Select species name';\n            break;\n    }\n\n    const parent = renderTestCardTemplate(collection, { vernacularName, binomial, question: questionTxt, help: '(Select the name below.)', term: '' });\n\n    const template = document.createElement('template');\n\n    template.innerHTML = completeTemplate;\n\n    const numerOfItems = config.isPortraitMode ? 4 : 5;\n\n    // broaden pool to species matching iconic taxon\n    const itemTaxons = collection.items.map(item => {\n        switch(givenTaxon) {\n            case 'genus':\n                return item.taxonomy.genus;\n            case 'species':\n                return item.taxonomy.species;\n            default:\n                return item.name;\n        }\n    });\n    const pool = R.take(numerOfItems, utils.shuffleArray(itemTaxons).filter(utils.onlyUnique).filter(itemTaxon => itemTaxon !== item.taxonomy[givenTaxon])).filter(item => item !== undefined);\n    pool.push(item.taxonomy[givenTaxon]);\n\n    let answers = utils.shuffleArray(pool);\n\n    answers = answers.map((answer, index) => {\n      return {\n        index,\n        value: answer\n      }\n    });\n\n    renderTemplate({ genus, species, answers }, template.content, parent);\n\n    setTimeout(() => {\n      const block = document.querySelectorAll('.pool .block')[0];\n            block.focus(); \n    },1000);\n\n    const score = { itemId: item.id, binomial: item.name, question: item.taxonomy[givenTaxon], callbackTime: config.callbackTime, layoutCount: lessonPlan.layouts.length, points: layout.points };\n\n    const callback = (score, scoreUpdateTimer, config) => {\n\n        const iconColour  = score.success ? 'answer-box-success' : 'answer-box-alert';\n\n        const answerIcon = score.success\n            ? `<span class=\"icon\"><i class=\"fas fa-check\"></i></span>`\n            : `<span class=\"icon\"><i class=\"fas fa-times\"></i></span>`;\n\n        const response = score.success ? `Correct` : `Incorrect`;\n        \n        document.querySelector('.js-txt-question').innerHTML = `<div class=\"${iconColour}\"><span>${answerIcon}</span><span>${ response }</span</div>`;        \n\n        document.querySelectorAll('.block span').forEach(block => {\n            if(block.innerText === score.answer) {\n                score.success\n                    ? block.parentElement.classList.add('snap-success')\n                    : block.parentElement.classList.add('snap-alert');\n            }\n            if(block.innerText === score.question) {\n                block.parentElement.classList.add('snap-success');\n            }\n        });\n\n        continueLessonHandler(document.querySelector('.js-continue-lesson-btn'), score, scoreUpdateTimer);\n    };\n\n    document.querySelectorAll('.js-pool button').forEach(answer => {\n        answer.addEventListener('click', e => {\n          e.preventDefault();\n          const button = e.target;\n          const answer = button.innerText;\n          if(question === item.taxonomy.species) {\n              document.querySelector('.species').innerText = answer;                \n          } else {\n              document.querySelector('.genus').innerText = answer;\n          }\n          score.answer = answer;\n          score.answers = answers;\n          score.questionText = questionTxt;\n          scoreHandler('block', score, callback, config);\n        });\n    });    \n};\n","// Module\nvar code = \"<div class=\\\"js-test-card-container-images species-card-images\\\"></div>\\n<div class=\\\"text-entry\\\">\\n    <input class=\\\"js-txt-input\\\" type=\\\"text\\\" placeholder=\\\"Genus\\\">\\n</div>\\n<div class=\\\"landscape help-txt binomial js-help-txt\\\"></div>\";\n// Exports\nmodule.exports = code;","// Module\nvar code = \"<div class=\\\"centred-block standard-block\\\">\\n    <input disabled class=\\\"js-txt-input\\\" type=\\\"text\\\" placeholder=\\\"Genus\\\" autocomplete=\\\"off\\\" autocorrect=\\\"off\\\" autocapitalize=\\\"off\\\" spellcheck=\\\"false\\\">        \\n</div>\\n<div>\\n    <div class=\\\"help-txt binomial margin-left js-help-txt\\\"></div>\\n</div>\\n<div class=\\\"text-entry-container\\\">    \\n    <div class=\\\"js-pool-letters pool margin-left margin-top margin-bottom\\\"></div>\\n    <div class=\\\"horizontal-buttons\\\">\\n        <button class=\\\"btn btn-tertiary js-toggle-keyboard\\\">Enable keyboard</button>\\n        <button class=\\\"btn btn-tertiary js-delete-letter\\\">Delete last letter</button>\\n        <button class=\\\"btn snap-action-btn js-check-answer\\\">Check answer</button>\\n    </div>    \\n</div>\";\n// Exports\nmodule.exports = code;","import { utils } from 'utils/utils';\nimport { store } from 'redux/store';\nimport { renderTemplate } from 'ui/helpers/templating';\nimport { scoreHandler, bindScore } from 'ui/helpers//score-handler';\nimport { imageUseCases, prepImagesForCarousel } from 'ui/helpers/image-handler';\nimport { imageSlider } from 'ui/screens/common/image-slider';\nimport { renderTestCardTemplate } from 'ui/screens/cards/test-card';\n\nimport { onAddLoseFocusListener } from 'ui/fixtures/navigation';\n\nimport textEntryTemplate from 'ui/screens/text-entry/text-entry-templates.html';\nimport textEntryPortraitTemplate from 'ui/screens/text-entry/text-entry-portrait-templates.html';\n\nexport const renderInput = (screen, question) => {\n\n    const { lessonPlan, collection, config, layout } = store.getState();\n\n    const item = collection.nextItem;\n\n    let vernacularName, binomial, questionTxt;\n\n    questionTxt = 'Complete the latin name';\n\n    switch(question.taxon) {\n        case 'genus': \n            vernacularName = item.vernacularName;\n            binomial = binomial = `--- ${question.species}`;\n            questionTxt = 'Enter the genus name';\n            break;\n        case 'species': \n            vernacularName = item.vernacularName;\n            binomial = binomial = `${question.genus} ---`;\n            questionTxt = 'Enter the species name';\n            break;\n        case 'name': \n            vernacularName = item.vernacularName;\n            binomial = binomial = `--- ---`;\n            questionTxt = 'Enter full latin name';\n            break;\n        case 'vernacular':\n            vernacularName = '--- ---';\n            binomial = item.name;\n            questionTxt = 'Enter the common name';\n            break;\n    }\n\n    const help = config.isLandscapeMode ? '(Complete the name below.)' : '(Scroll to see more images.)';\n\n    const parent = renderTestCardTemplate(collection, { vernacularName, binomial, question: questionTxt, help, term: '' });\n\n    const template = document.createElement('template');\n          template.innerHTML = config.isLandscapeMode ? textEntryTemplate : textEntryPortraitTemplate;\n    \n    renderTemplate({ }, template.content, parent);\n\n    const inputTxt = document.querySelector('.js-txt-input');\n    const helpTxt = document.querySelector('.js-help-txt');\n\n    switch(question.taxon) {\n        case 'genus': \n            inputTxt.setAttribute('placeholder', 'Enter genus name');\n            helpTxt.innerHTML = `--- ${question.species}`;\n            break;\n        case 'species': \n            inputTxt.setAttribute('placeholder', 'Enter species name');\n            helpTxt.innerHTML = `${utils.capitaliseFirst(question.genus)} ---`;\n            break;\n        case 'name': \n            inputTxt.setAttribute('placeholder', 'Enter latin name');\n            helpTxt.innerHTML = `--- ---`;\n            break;\n        case 'vernacular':\n            inputTxt.setAttribute('placeholder', 'Enter common name');\n            helpTxt.innerHTML = `-----`;\n            break;\n    }\n\n    const boundScore = {};\n\n    const answerBtn = document.querySelector('.js-check-answer');\n\n    const callback = (score, scoreUpdateTimer) => {        \n        boundScore.scoreUpdateTimer = scoreUpdateTimer;\n        boundScore.score = score;\n    };\n\n    const scoreEventHandler = e => {\n        e.preventDefault();\n        const answer = document.querySelector('.js-txt-input').value;\n        const score = { \n            itemId: item.id, question, answer, target: e.target, \n            layoutCount: lessonPlan.layouts.length, points: layout.points, \n            names: item.vernacularNames, questionText: questionTxt, \n            answers: [question.question, answer]\n        };\n        scoreHandler('text', score, callback, config);\n        if(answerBtn) answerBtn.disabled = true;\n        document.querySelector('.js-continue-lesson-btn').disabled = false;\n        if(helpTxt) helpTxt.innerHTML = question.taxon === 'vernacular' ? item.vernacularName : item.name;\n    };\n\n    const loseFocusMobileHandler = e => {\n        document.removeEventListener('focusout', loseFocusMobileHandler);\n        const answer = document.querySelector('.js-txt-input').value;\n        const score = { \n            itemId: item.id, question, answer: document.querySelector('.js-txt-input').value, target: e.target, \n            layoutCount: lessonPlan.layouts.length, points: layout.points, \n            names: item.vernacularNames, questionText: questionTxt,\n            answers: [question.question, answer]\n        };\n        scoreHandler('text', score, callback, config);\n        document.querySelector('.js-continue-lesson-btn').disabled = false;\n    };\n\n    if(config.isLandscapeMode) {\n        answerBtn.addEventListener('click', scoreEventHandler, { once: true });\n    }\n    \n    if(config.isPortraitMode) renderPortrait(item, config);\n    else renderLandscape(item, config, question);\n\n    document.querySelector('.js-continue-lesson-btn').addEventListener('click', e => {\n        window.clearTimeout(boundScore.scoreUpdateTimer);\n        bindScore(boundScore.score);\n    }, { once: true });\n\n    if(config.isPortraitMode) {\n\n        // hide attribution for now - space issue various across devices\n        const attribution = document.querySelector('.js-attribution-layer');\n              attribution.classList.add('hide-important');\n        const indicators = document.querySelector('.js-carousel-indicators');\n              indicators.classList.add('hide-important');\n    }\n};\n\nconst renderPortrait = (item, config) => {\n    \n    const images = prepImagesForCarousel(item, config, imageUseCases.TEXT_ENTRY);\n\n    const parent = document.querySelector('.js-test-card-container-images');\n\n    imageSlider({ config, images, parent });\n};\n\nconst renderLandscape = (item, config, question) => {\n    \n    let answer = question[question.taxon];\n    \n    let pool;\n\n    switch(question.taxon) {\n        case 'vernacular':\n            pool = item.vernacularName.toLowerCase();\n            answer = question.common;\n            break;\n        case 'genus':\n            pool = item.taxonomy.genus.toLowerCase();\n            break;\n        case 'species':\n            pool = item.taxonomy.species.toLowerCase();\n            break;\n        case 'binomial':\n        case 'name':\n            pool = item.name.toLowerCase();\n            answer = question.binomial;\n            break;\n    }\n\n    let letterBlocks = '';\n\n    utils.shuffleArray(Array.from(pool)).forEach( (letter, index) => {\n        if(letter === ' ') letter = '&nbsp;';\n        letterBlocks += `<span id=\"${index}\" class=\"block\">${letter}</span>`\n    });\n\n    document.querySelector('.js-pool-letters').innerHTML = letterBlocks;\n\n    const input = document.querySelector('.js-txt-input');\n\n    const letters = [];\n\n    const deleteLetter = letter => {\n        let value = document.querySelector('.js-txt-input').value;\n        let activeBlocks = Array.from(document.querySelectorAll('.block.active'));\n        let activeLetters = Array.from(value);\n        let activeBlock = activeBlocks.find(block => block.innerText.trim() === activeLetters[activeLetters.length-1].trim());\n        let lastLetter = letter || activeBlock;\n        if(value.length > 0){\n            let indexInInput = value.lastIndexOf(lastLetter.innerHTML);            \n            let newValue = '';\n            let letters = Array.from(value);\n            letters.splice(indexInInput,1);\n            letters.forEach(letter => newValue += letter);            \n            input.value = newValue;\n        }\n        let correctBlocks = Array.from(document.querySelectorAll('.correct'));\n            correctBlocks.forEach(b => b.classList.remove('correct'));\n            correctBlocks.forEach(b => b.classList.add('active'));\n        if(lastLetter) {\n          lastLetter.classList.remove('active');\n          letters.forEach(l => {            \n              if(l.id === lastLetter.id) {\n                  const letterIndex = letters.indexOf(l);\n                  if(letterIndex > -1)\n                      letters.splice(letterIndex,1);\n              }\n          });        \n        }\n    };\n\n    const blocks = document.querySelectorAll('.block');\n\n    blocks.forEach(block => {\n        block.addEventListener('click', e => {\n          e.preventDefault();\n          const letter = e.target;\n          if(letter.classList.contains('active')) {\n              deleteLetter(letter);\n          } else {\n              letter.classList.add('active');\n              letters.push(letter);\n              if(letter.innerHTML === '&nbsp;')\n                  input.value += ' ';\n              else\n                  input.value += letter.innerHTML;\n          }\n          if(input.value === answer.toLowerCase()) {\n              blocks.forEach(block => block.classList.add('correct'));\n          }\n        });\n    });\n\n    document.querySelector('.js-delete-letter').addEventListener('click', e => {\n      e.preventDefault();\n      deleteLetter();\n    });\n\n    const keyboardBtn = document.querySelector('.js-toggle-keyboard');          \n          keyboardBtn.addEventListener('click', e =>{\n            e.preventDefault();\n            const disabled = input.hasAttribute('disabled');\n            if(disabled) {\n                keyboardBtn.innerHTML = 'Enable letters';\n                input.removeAttribute('disabled');\n                input.focus();\n            } else {\n                keyboardBtn.innerHTML = 'Enable keyboard'\n                input.setAttribute('disabled', 'disabled');\n            }\n          });\n\n    setTimeout(() => {\n      keyboardBtn.focus();\n    }, 500);\n\n    const blockArray = [ ...blocks ];    \n    const entries = [];\n    let selectedBlock;\n\n    input.addEventListener('input', e => {\n        e.preventDefault();\n        if(!e.data) return;\n        let entry = e.data.toLowerCase();\n        entry = entry === ' ' ? '&nbsp;' : entry;\n        entries.push(entry);\n        selectedBlock = blockArray.find(block => block.innerHTML === entry);\n        if(selectedBlock) selectedBlock.classList.add('active');\n        if(input.value === answer.toLowerCase()) {\n            blockArray.forEach(block => block.classList.add('correct'));\n        }\n    });\n\n    input.addEventListener('keyup', e => {\n        e.preventDefault();\n        if(e.keyCode === 8) { // Backspace\n          const entry = entries.pop();\n          selectedBlock = blockArray.find(block => block.innerHTML === entry);\n          if(selectedBlock) selectedBlock.classList.remove('active');\n        }            \n    });\n};\n","import { store } from 'redux/store';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { setupHandler } from 'ui/setup/setup-handler';\n\nexport const nextItem = layout => {\n\n    const { counter, lessonPlan, config, lesson, collection } = store.getState();\n\n    const args = { layout, counter, lessonPlan, config, lesson, collection };\n\n    if(setupHandler.isRequired(enums.nextStep.NEXT_ITEM, args)) {\n        setupHandler.actionUpdate(enums.nextStep.NEXT_ITEM, { layout });\n    }\n};","import { store } from 'redux/store';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { setupHandler } from 'ui/setup/setup-handler';\n\nexport const nextLayout = counter => {\n\n    const { layout, lessonPlan, config, lesson, collection } = store.getState();\n\n    const args = { layout, counter, lessonPlan, config, lesson, collection };\n\n    const isRequired = setupHandler.isRequired(enums.nextStep.NEXT_LAYOUT, args);\n\n    if(isRequired) {\n        const nextLayout = lessonPlan.layouts[counter.index];\n        setupHandler.actionUpdate(enums.nextStep.NEXT_LAYOUT, { layout: nextLayout, config });\n    }\n};","import * as R from 'ramda';\n\nimport { store } from 'redux/store';\nimport { lessonPlanner } from 'snapdragon-engine/lesson-planner';\nimport { lessonPlans } from 'snapdragon-config/lesson-plans';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { setupHandler } from 'ui/setup/setup-handler';\n\n\nexport const nextLesson = counter => {\n\n    const { layout, config, lesson, collection } = store.getState();\n\n    const args = { layout, counter, config, lesson, collection };\n\n    if(setupHandler.isRequired(enums.nextStep.NEXT_LESSON, args)) {\n\n        const planId = config.isPortraitMode ? collection.lessonPlanPortrait : collection.lessonPlanLandscape;    \n        const lessonPlan = R.clone(lessonPlans.find(plan => plan.id === planId && plan.portrait === config.isPortraitMode));\n\n        args.lessonPlan = lessonPlan;\n\n        if(setupHandler.isRequired(enums.nextStep.NEXT_ROUND, args)) {\n\n            // asyncFunc will return collection, lessonPlan and lesson\n\n            const asyncFunc = lessonPlanner.createLessonPlan(lessonPlan, config, R.clone(collection), R.clone(lesson)).then(props => {\n                if(!props) return;\n                return { lessonPlan: props.updatedLessonPlan, collection: props.updatedCollection, lesson: props.updatedLesson };\n            });\n\n            if(asyncFunc === null) return;\n\n            setupHandler.actionUpdate(enums.nextStep.NEXT_LESSON, { asyncFunc });\n        }\n    }\n};","import { subscription } from 'redux/subscriptions';\nimport { actions } from 'redux/actions/action-creators';\nimport { enums } from 'ui/helpers/enum-helper';\nimport { lessonStateHandler } from 'ui/screens/lists/lesson-state-handler';\n\nconst isRequired = (step, args) => {\n\n    const { layout, counter, lessonPlan, config, lesson, collection } = args;\n\n    let required = false;\n\n    switch(step) {\n        case enums.nextStep.NEXT_ITEM:\n            required = layout && !layout.bonus;\n            break;\n        case enums.nextStep.NEXT_LAYOUT:\n            if(counter.isLessonPaused) {\n                required = false;\n            } else {\n                required = lessonPlan && lessonPlan.layouts;\n                required = required && lessonPlan.layouts[counter.index] !== null;\n            }\n            break;\n        case enums.nextStep.NEXT_LESSON:\n            required =      (config.collection.id > 0 && !counter.isLessonPaused) // new lesson\n                        ||  (config.collection.id > 0 && config.collection.id !== collection.id); // new lesson from new collection\n            break;\n        case enums.nextStep.NEXT_ROUND:\n            required = counter.index === 0 && lesson.isNextRound && collection.items && collection.items.length > 0;\n            break;\n    }\n\n    return required;\n};\n\nconst actionUpdate = (step, args) => {\n\n    const { layout, config, asyncFunc } = args;\n\n    switch(step) {\n        case enums.nextStep.NEXT_ITEM:\n            actions.boundNextItem(layout.itemIndex);\n            break;\n        case enums.nextStep.NEXT_LAYOUT:\n            actions.boundNextLayout(layout);\n            subscription.addSubs(layout, config);\n            lessonStateHandler.changeRequest({\n                requestType: enums.lessonState.SAVE_LESSON_PROGRESS,\n            });\n            break;\n        case enums.nextStep.NEXT_LESSON:\n            actions.boundNextLesson(asyncFunc);\n            break;\n    }\n}\n\nexport const setupHandler = {\n    isRequired,\n    actionUpdate\n}"],"sourceRoot":""}